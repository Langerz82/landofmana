!function s(n,a,o){function r(t,e){if(!a[t]){if(!n[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}i=a[t]={exports:{}},n[t][0].call(i.exports,function(e){return r(n[t][1][e]||e)},i,i.exports,s,n,a,o)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<o.length;e++)r(o[e]);return r}({1:[function(e,t,i){var s=e("../lib/class"),c=e("../utils");t.exports=Area=s.Class.extend({init:function(e,t,i,s,n,a,o,r){this.id=t;t=G_TILESIZE;this.gx=i,this.gy=s,this.x=i*t,this.y=s*t,o&&(this.x,this.width,this.y,this.height),this.width=n*t,this.height=a*t,this.map=e,this.elipse=o||!1,this.excludeId=r||-1},_getRandomPosition:function(e,t,i){i=i||30;for(var s,n,a={},o=0,r=Math.min(t.height,t.width);o<i;){if(this.elipse?(s=2*Math.random()*Math.PI,n=c.randomRangeInt(0,~~(r/2)),a.x=Math.round(e.x+n*Math.cos(s)),a.y=Math.round(e.y+n*Math.sin(s))):(a.x=e.x+c.randomInt(2*t.width)-t.width,a.y=e.y+c.randomInt(2*t.height)-t.height),this.contains(a.x,a.y,0))if(!this.map.isColliding(a.x,a.y))break;o++}return i<=o?null:a},_getRandomPositionForEntity:function(e,t,i){return this._getRandomPosition(e,{width:t,height:t},i)},_getRandomPositionInsideArea:function(e){return this._getRandomPosition(this,this,e)},contains:function(e,t,i){var s,n;return this.elipse?(s=this.x,n=this.y,s=Math.sqrt(Math.pow(e-s,2)+Math.pow(t-n,2))<this.width/2,1===i||-1===this.excludeId?s:0===i&&(n=s,(i=this.map.mobLiveAreas[this.elipseId])?n&&!i.contains(e,t,1):n)):e>=this.x&&t>=this.y&&e<this.x+this.width&&t<this.y+this.height}}),t.exports=Area},{"../lib/class":44,"../utils":66}],2:[function(e,t,i){e("../utils");e=e("./area").extend({init:function(e,t,i,s,n,a){this._super(e,t,i,s,n,a)},isValidPosition:function(e,t){return this.map&&this.map.isValidPosition(e,t)}});t.exports=e},{"../utils":66,"./area":1}],3:[function(i,e,t){var s=i("./entityarea"),n=(i("underscore"),i("../message"));e.exports=ChestArea=s.extend({init:function(e,t,i,s,n,a,o,r,c,l){this._super(e,t,o,r,c,l),this.nb=s,this.minLevel=n,this.maxLevel=a,this.respawns=[],this.map=e,this.setNumberOfEntities(this.nb),this.chests=[37]},spawnChests:function(){for(var e=0;e<this.nb;e+=1)this.addToArea(this._createRandomChestInsideArea())},_createRandomChestInsideArea:function(){return this._createChest()},_createChest:function(){var e=this,t=e.map.entities.spaceEntityRandomApart(2,e._getRandomPositionInsideArea.bind(e,20)),t=new(i("./chest"))(++e.map.entities.entityCount+2e4,t.x,t.y,e.map,e,e.minLevel,e.maxLevel);return e.map.entities.addChest(t),e.addToArea(t),t},respawnChest:function(t,e){var i=this;e=t.spawnDelay||e,this.removeFromArea(t),setTimeout(function(){var e=i.map.entities.spaceEntityRandomApart(2,i._getRandomPositionInsideArea.bind(i,20));t.x=e.x,t.y=e.y,i.addToArea(t),i.map.entities.addChest(t),i.map.entities.sendBroadcast(new n.Spawn(t))},e)}}),e.exports=ChestArea},{"../message":49,"./chest":void 0,"./entityarea":4,underscore:310}],4:[function(e,t,i){var s=e("./area"),e=(e("../utils"),s.extend({init:function(e,t,i,s,n,a,o,r){this._super(e,t,i,s,n,a,o,r),this.entities=[],this.hasCompletelyRespawned=!0},removeFromArea:function(e){e=_.indexOf(_.pluck(this.entities,"id"),e.id);this.entities.splice(e,1),this.isEmpty()&&this.hasCompletelyRespawned&&this.emptyCallback&&(this.hasCompletelyRespawned=!1,this.emptyCallback())},onEmpty:function(e){this.emptyCallback=e},addToArea:function(e){e&&null!==e.kind&&(this.entities.push(e),e.area=this),this.isFull()&&(this.hasCompletelyRespawned=!0)},setNumberOfEntities:function(e){this.nbEntities=e},isEmpty:function(){return!_.any(this.entities,function(e){return!e.isDead})},isFull:function(){return!this.isEmpty()&&this.nbEntities===_.size(this.entities)},respawn:function(t,e){var i=this;e=t.spawnDelay||e,this.removeFromArea(t),setTimeout(function(){var e=i.map.entities.spaceEntityRandomApart(2,i._getRandomPositionInsideArea.bind(i,20),i.entities);e&&(t.spawnX=e.x,t.spawnY=e.y,t.setPosition(e.x,e.y)),t.respawn()},e)}}));t.exports=e},{"../utils":66,"./area":1}],5:[function(e,t,i){e=e("../lib/class").Class.extend({init:function(e,t,i,s,n,a){this.map=e,this.elipse=t,this.x=i*G_TILESIZE,this.y=s*G_TILESIZE,this.width=n*G_TILESIZE,this.height=a*G_TILESIZE},contains:function(e){var t,i;return elipse?elipse?!!e&&(t=this.x,i=this.y,i=(t=Math.sqrt(Math.pow(e.x-t,2)+Math.pow(e.y-i,2)))<this.width/2&&t<this.height/2,console.log("this.elipseId="+this.elipseId),i):void 0:!!e&&e.x>=this.x&&e.y>=this.y&&e.x<this.x+this.width&&e.y<this.y+this.height}});t.exports=e},{"../lib/class":44}],6:[function(e,t,i){var s=e("./entityarea");e("underscore"),e("../message");t.exports=MobArea=s.extend({init:function(e,t,i,s,n,a,o,r,c,l,p,u,d,h,m){this._super(e,t,a,o,r,c,d,h),this.nb=i,this.minLevel=s,this.maxLevel=n,this.respawns=[],this.level=m,this.include=null,l&&("string"==typeof l&&0<=l.indexOf(",")?this.include=l.split(","):this.include=[l]),this.exclude=null,p&&("string"==typeof p&&0<=p.indexOf(",")?this.exclude=p.split(","):this.exclude=[p]),this.setNumberOfEntities(this.nb),this.definite=null,u&&(this.definite=u)},addMobs:function(e){if(this.mobs=[],Array.isArray(this.definite))for(var t of this.definite)this.mobs.push(MobData.Kinds[t]);else{if(e&&this.level&&(this.minLevel=e+this.minLevel,this.maxLevel=e+this.maxLevel),levelMobs=MobData.getByLevelRange(this.minLevel,this.maxLevel),this.mobs=this.mobs.concat(levelMobs),Array.isArray(this.include))for(var t of this.include)this.mobs.push(MobData.Kinds[t]);if(Array.isArray(this.exclude))for(t=this.mobs.length;0<=--t;)for(var i of this.exclude)if(this.mobs[t].kind===i){this.mobs.splice(t,1);break}}},spawnMobs:function(){for(var e=0;e<this.nb;++e)this.addToArea(this._createRandomMobInsideArea(),this.exclude)},_createMob:function(e){var t=this.map.entities.spaceEntityRandomApart(2,this._getRandomPositionInsideArea.bind(this,100));return t?this.map.entities.addMob(e,t.x,t.y,this):null},_createRandomMobInsideArea:function(){var e=0;if(!this.mobs||0===this.mobs.length)return null;if(1===this.mobs.length)return this._createMob(this.mobs[0].kind);var t=0,i=this.mobs.length;if(0===i)return console.warn("mobs length === 0 aborting create."),null;for(var s=0;s<i;++s){for(var n=0;n<this.mobs[s].spawnChance;++n)s*i+n,this.mobs[s].kind;t+=this.mobs[s].spawnChance}for(var a,e=0,o=Utils.randomInt(t-1),s=0;s<this.mobs.length;++s){if(o<=(a=this.mobs[s].spawnChance)){e=this.mobs[s].kind;break}o-=a}return 0===e?(console.info("this.mobs="+JSON.stringify(this.mobs)),console.warn("mob kind === 0 aborting create."),null):this._createMob(e)},respawnMob:function(e,t){var i=this,s=(t=e.spawnDelay||t,e);setTimeout(function(){var e=i.map.entities.spaceEntityRandomApart(3,i._getRandomPositionInsideArea.bind(i,20));e&&(s.spawnX=e.x,s.spawnY=e.y,s.setPosition(e.x,e.y)),s.respawnCallback&&s.respawnCallback()},t)},isNextTooEntity:function(e,t){t=t||G_TILESIZE;for(var i of this.entities)if(Math.abs(e.x-i.x)<G_TILESIZE&&Math.abs(e.y-i.y)<G_TILESIZE)return!0;return!1}})},{"../message":49,"./entityarea":4,underscore:310}],7:[function(e,t,i){var s=e("../message");e("../formulas"),e("../area/chestarea");t.exports=MobCallback=Class.extend({init:function(){},setCallbacks:function(e){e.onRespawn(function(){this.respawn()}),e.onStep(function(e,t){}),e.onRequestPath(function(e,t){var i=[this],e=(this.target&&i.push(this.target),this.map.entities.findPath(this,e,t,i));return e&&1===e.length&&console.error(this.id+" "+JSON.stringify(e)),e&&1<e.length?(this.orientation=this.getOrientation([this.x,this.y],e[1]),t=new s.MovePath(this,e),this.map.entities.sendNeighbours(this,t),e):null}),e.onStopPathing(function(e,t){this.hasTarget()||this.setAiState(mobState.IDLE),this.aiState===mobState.CHASING&&this.mobAI.checkReturn(this,e,t)}),e.onStartPathing(function(){}),e.onAbortPathing(function(){msg=new s.Move(this,this.orientation,2,this.x,this.y),this.map.entities.sendNeighbours(this,msg),this.target||this.setAiState(mobState.IDLE)}),e.onKilled(function(e,t){e instanceof Player&&(e.skillHandler.setXPs(),this.world.taskHandler.processEvent(e,PlayerEvent(EventType.DAMAGE,this,t)))}),e.onDeath(function(e){e instanceof Player&&this.world.taskHandler.processEvent(e,PlayerEvent(EventType.KILLMOB,this,1)),this.world.loot.handleDropItem(this,e)})}})},{"../area/chestarea":3,"../formulas":36,"../message":49}],8:[function(e,t,i){t.exports=NpcMoveCallback=Class.extend({init:function(){},setCallbacks:function(e){var i=e;e.onStep(function(t,i,s){try{t.map.entities.entitygrid[t.y][t.x]=0,t.map.entities.entitygrid[s][i]=1}catch(e){console.info(e.stack),console.info(t.x+","+t.y+","+i+","+s),console.info(t.id),console.info(t.path),console.info(t.step)}}),e.onRequestPath(function(e,t){e=i.entity.map.entities.findPath(i.entity,e,t);return e&&0<e.length?(t=new Messages.MovePath(i.entity,e),i.entity.map.entities.sendNeighbours(i.entity,t),e):null})}})},{}],9:[function(e,t,i){t.exports=PlayerCallback=Class.extend({init:function(){},setCallbacks:function(e){function i(e,t,i){console.info("onStopPathing"),s.entities.pathfinder.isPathTicksTooFast(e,e.fullpath,e.startMovePathTime)?(console.error("path - isPathTicksTooFast = true."),e.resetMove(e.sx,e.sy)):(e.setPosition(t,i),e.sx=e.x,e.sy=e.y,console.info("p.x:"+e.x+",p.y="+e.y),n(e))}var s=this,t=e,n=(this.player=e,this.entities=t.map.entities,t.onStep(function(e,t,i){}),t.onRequestPath(function(e,t){return s.entities.findPath(this,e,t)}),function(e){e.packetHandler.processAttack()});t.onStopPathing(function(e,t){console.info("onStopPathing"),i(this,e,t)}),t.onAbortPathing(function(e,t){console.info("onAbortPathing"),i(this,e,t)}),t.checkStopDanger=function(e,t){var i,s,n=!1;return(-1!==e.ex||-1!==e.ey)&&(e.x===e.ex&&e.y===e.ey||(i=e.x,s=e.y,(n=t===Types.Orientations.LEFT&&e.x<e.ex||t===Types.Orientations.RIGHT&&e.x>e.ex||t===Types.Orientations.UP&&e.y<e.ey||t===Types.Orientations.DOWN&&e.y>e.ey?!0:n)&&(e.setPosition(e.ex,e.ey),console.warn("WARN - PLAYER "+e.id+" not stopping."),console.warn("orientation: "+Utils.getOrientationString(t)),console.warn("x :"+i+",y :"+s),console.warn("sx:"+e.ex+",sy:"+e.ey)),n))},t.checkStartMove=function(e,t){var i=this;if(i.x===e&&i.y===t)return!0;var s=Math.abs(i.x-e),n=Math.abs(i.y-t),a=Math.trunc(i.x)-Math.trunc(e)==0,o=Math.trunc(i.y)-Math.trunc(t)==0;if(a&&0!==n||o&&0!==s){a=[[i.x,i.y],[e,t]];if(!i.endMoveTime||!i.map.entities.pathfinder.isPathTicksTooFast(i,a,i.endMoveTime))return console.error("FIXED MOVE"),i.fixMove(e,t),!0}return console.error("PLAYER NOT IN CORRECT POSITION"),console.info("p.x:"+i.x+",p.y:"+i.y),console.info("c.x:"+e+",c.y:"+t),console.error("dx:"+s+",dy:"+n),i.resetMove(i.x,i.y),!1},t.correctMove=function(e,t){var i=this;-1===i.ex&&-1===i.ey||i.x===e&&i.y===t||(console.warn("ERROR - MOVING NOT SYNCHED PROPERLY, FORCING CLIENT UPDATE"),console.info("player, orientation:"+i.moveOrientation),console.info("player, x:"+i.x+",y:"+i.y),console.info("player, sx:"+i.sx+",sy:"+i.sy),console.info("player, ex:"+i.ex+",ey:"+i.ey),i.resetMove(i.sx,i.sy))},t.setMoveStopCallback(function(){var e=this;console.info("setMoveStopCallback"),console.info("player, x:"+e.x+",y:"+e.y),e.checkStopDanger(e,e.moveOrientation),e.correctMove(e.ex,e.ey),e.endMoveTime=Date.now(),n(e)}),t.onTeleport(function(){t.forEachAttacker(function(e){e instanceof Mob&&e.returnToSpawn()}),t.clearAttackerRefs()}),t.onKilled(function(e,t){}),t.onDeath(function(e){t.world.loot.handleDropItem(t,e)})}})},{}],10:[function(e,t,i){cls=e("./lib/class"),_=e("underscore"),GameTypes=e("../shared/js/gametypes"),ItemTypes=e("../shared/js/itemtypes"),Types=GameTypes,Utils=e("./utils")},{"../shared/js/gametypes":349,"../shared/js/itemtypes":350,"./lib/class":44,"./utils":66,underscore:310}],11:[function(e,t,i){var e=e("../../shared/data/appearance.json"),s=[],n={weapon:[],weaponarcher:[],armor:[],armorarcher:[]};_.each(e,function(e,t){s.push({name:e.name,type:e.type,sprite:e.sprite,buy:e.buy}),n[e.type]&&n[e.type].push({key:t,val:e})}),t.exports.ItemGearTypes=n,t.exports.Data=s,t.exports.getSpriteByID=function(e){return s[e].sprite}},{"../../shared/data/appearance.json":333}],12:[function(e,t,i){MobData=e("./mobdata"),SkillData=e("./skilldata"),ItemData=e("./itemdata"),AppearanceData=e("./appearancedata"),MobSpeechData=e("./mobspeechdata"),ItemLootData=e("./itemlootdata"),NpcData=e("./npcdata"),LangData=e("./langdata"),QuestData=e("./questdata"),NotifyData=e("./notificationdata"),EntitySpawnData=e("./entityspawndata")},{"./appearancedata":11,"./entityspawndata":13,"./itemdata":14,"./itemlootdata":15,"./langdata":16,"./mobdata":17,"./mobspeechdata":18,"./notificationdata":19,"./npcdata":20,"./questdata":21,"./skilldata":22}],13:[function(e,t,i){var s=e("../../shared/data/entity_spawn.json"),n=e("fs"),a=[],o=0;_.each(s,function(e,t){a[o++]=e});t.exports.EntitySpawnData=a,t.exports.addSpawn=function(e,t,i){a.push({id:e,x:t,y:i})},t.exports.saveSpawns=function(){n.writeFile("./shared/data/entity_spawn.json",JSON.stringify(a),function(e,t){if(e)return console.info(e)})}},{"../../shared/data/entity_spawn.json":335,fs:void 0}],14:[function(e,t,i){var s,n=e("underscore"),a=e("../../shared/data/items2.json"),o=e("../../shared/data/craft.json"),r=0;for(s of o)s.id=r++;var c={0:null};n.each(a,function(e,t){c[e.id]={name:e.name,type:e.type||"object",damageType:e.damageType||"none",typemod:e.typemod||"none",modifier:e.modifier||0,hand:e.hand||0,sprite:e.sprite||"",spriteName:e.spriteName||"",offset:e.offset||[0,0],buy:e.buy||0,buycount:e.buycount||1,staticsheet:0<e.staticsheet?e.staticsheet:0,level:e.level||e.modifier,legacy:e.legacy||0,craft:(e=>{var t,i=[];for(t of o)t.o===e&&i.push(t);return i})(e.id)}}),ItemTypes.setKindData(c),t.exports.Kinds=c,t.exports.CraftData=o},{"../../shared/data/craft.json":334,"../../shared/data/items2.json":337,underscore:310}],15:[function(e,t,i){var s=e("underscore"),e=e("../../shared/data/itemloot.json"),n=[];s.each(e,function(e,t){n[t]={name:e.name,rarity:e.rarity,sprite:e.sprite,offset:e.offset,include:e.include||null}}),t.exports.ItemLoot=n},{"../../shared/data/itemloot.json":336,underscore:310}],16:[function(e,t,i){var s=e("underscore"),e=e("../../shared/data/lang.json"),n={};s.each(e,function(e,t){n[t]=e}),t.exports.Data=n},{"../../shared/data/lang.json":338,underscore:310}],17:[function(e,t,i){var s=e("underscore"),e=e("../../shared/data/mobs.json"),n={},a={};s.each(e,function(e,t){t=n[t.toLowerCase()]={key:t.toLowerCase(),kind:e.kind,attackMod:e.attackMod||1,defenseMod:e.defenseMod||1,attackRateMod:e.attackRateMod?1/e.attackRateMod:1,hpMod:e.hpMod||1,attack:e.attackMod?3*e.attackMod:3,defense:e.defenseMod?3*e.defenseMod:3,hp:e.hpMod?150*e.hpMod:150,xp:e.xpMod?10*e.xpMod:10,minLevel:e.minLevel||1,maxLevel:e.maxLevel||99,aggroRange:e.aggroRange?e.aggroRange+1:4,attackRange:e.attackRange||1,isAggressive:1===e.isAggressive,attackRate:e.attackRateMod?1500*e.attackRateMod:1500,reactionDelay:e.reactionMod?256*e.reactionMod:256,moveSpeed:e.moveSpeedMod?~~(300+200*e.moveSpeedMod):500,respawn:e.respawnMod?3e4*e.respawnMod:3e4,dropRate:e.dropRate||1,spawnChance:e.spawnChance||50,dropBonus:e.dropBonus||0,drops:e.drops||null,modDamage:{hammer:1,axe:1,sword:1,bow:.9}};e.modDamage&&Object.assign(t.modDamage,e.modDamage),a[e.kind]=t});t.exports.Properties=n,t.exports.Kinds=a,t.exports.isMob=function(e){return!!a[e]},t.exports.forEachMobKind=function(e){for(var t in MobKinds)e(MobKinds[t][0],t)},t.exports.getByLevelRange=function(e,t){for(var i in levelRange=[],a){i=a[i];(0<i.level&&i.level>=e&&i.level<=t||0<i.minLevel&&0<i.maxLevel&&(e>=i.minLevel&&e<=i.maxLevel||t>=i.minLevel&&t<=i.maxLevel))&&levelRange.push(i)}return levelRange}},{"../../shared/data/mobs.json":339,underscore:310}],18:[function(e,t,i){var s=e("underscore"),e=e("../../shared/data/mobs_speech.json"),n={};s.each(e,function(e,t){n[t]=e}),t.exports.Speech=n},{"../../shared/data/mobs_speech.json":340,underscore:310}],19:[function(e,t,i){var s=e("underscore"),e=e("../../shared/data/notifications.json"),n={},a=0;s.each(e,function(e,t){n[a++]={textid:e.textid,interval:e.interval}}),t.exports.Notifications=n},{"../../shared/data/notifications.json":341,underscore:310}],20:[function(e,t,i){var s=e("underscore"),n=e("../../shared/data/npcs.json"),e=(e("../../shared/data/npc_english.json"),e("../../shared/data/npc_names_eng.json")),a={},o=n;s.each(o,function(e,t){a[e.uid]={uid:e.uid,kind:t,name:e.name||e.uid}});t.exports.Properties=a,t.exports.Kinds=o,t.exports.isNpc=function(e){return!!o[e]},t.exports.NPCnames=e},{"../../shared/data/npc_english.json":342,"../../shared/data/npc_names_eng.json":344,"../../shared/data/npcs.json":345,underscore:310}],21:[function(e,t,i){e("../utils");var s,n=e("../quest"),a=e("../../shared/data/quests.json"),o={},r={};for(s in a){var c=a[s],l=(console.info("data:"+JSON.stringify(c)),{}),c=(l.id=s,l.npcQuestId=c.npcKind,l.raw=c,l.npcKind=c.npcKind,l.type=c.type,l.level=c.level,l.data1=c.data1||0,l.data2=c.data2||0,l.count=0,l.status=0,l.gold=c.gold||0,l.reward=c.reward||[],l.expMultiplier=c.expMultiplier||1,c.object&&(l.object=getQuestObject([c.object.type,c.object.kind,c.object.count||0,c.object.chance||0,c.object.level||[0,99]])),c.object2&&(l.object2=getQuestObject([c.object2.type,c.object2.kind,c.object2.count||0,c.object2.chance||0,c.object2.level||[0,99]])),Object.assign(new n,l));o[(c.data=l).id]=c,r[l.npcKind]||(r[l.npcKind]=[]),r[l.npcKind].push(c)}console.info(JSON.stringify(r)),t.exports.Data=o,t.exports.NpcData=r},{"../../shared/data/quests.json":346,"../quest":58,"../utils":66}],22:[function(e,t,i){var s,n=e("../../shared/data/skills2.json"),a=(e("../effecthandler"),[]);for(s in n){var o=n[s];console.info(s+"="+JSON.stringify(o)),a.push({skillType:o.skillType,targetType:o.targetType||0,duration:o.duration||0,durationPL:o.durationPL||0,recharge:o.recharge?1e3*o.recharge:0,aoe:o.aoe||0,countTotal:o.countTotal||0,effectTypes:(e=>{var t,i=[];for(t of e)i.push(new EffectType("target"===t[0],t[1],t[2],t[3]));return i})(o.effects)})}console.info("skills: "+JSON.stringify(a)),t.exports.Skills=a},{"../../shared/data/skills2.json":347,"../effecthandler":23}],23:[function(e,t,i){EffectType=cls.Class.extend({init:function(e,t,i,s){this.entity=null,this.isTarget=e,this.phase=t,this.stat=i,this.modValue=parseFloat(s)||0,this.active=!1},apply:function(e,t,i,s){if(!t.isDead&&this.phase==i){var n=0,a=0,o=0,r=!0;switch(this.stat){case"hp":n=t.stats.hp,o=a=t.stats.hpMax;break;case"ep":n=t.stats.ep,o=a=t.stats.epMax;break;case"attack":a=n=t.stats.attack;break;case"defense":a=n=t.stats.defense;break;case"damage":n=0,a=s;break;default:r=!1}switch(r&&(this.diff=this.getModDiff(e,n,a,o)),this.stat){case"hp":t.modHealthBy(this.diff);break;case"ep":t.stats.ep+=this.diff,t.stats.ep=Utils.clamp(0,t.stats.epMax,t.stats.ep);break;case"attack":t.stats.mod.attack=this.diff;break;case"defense":t.stats.mod.defense=this.diff;break;case"damage":t.stats.mod.damage=this.diff;break;case"freeze":1===this.modVal?t.freeze=!0:t.freeze=!1;break;case"slow":t.moveSpeed+=this.modVal}}},getModDiff:function(e,t,i,s){e=this.modValue*e.level,e=this.modValue<1?0<s?Math.round(e*s):Math.round(e*t):Math.round(e);return 0!==t&&(0<e?0<s&&s<t+e&&(e=s-t):e<0&&t+e<0&&(e=-t)),e}});var o=cls.Class.extend({init:function(e,t,i){this.handler=e,this.source=e.entity,this.skillId=t,this.data=SkillData.Skills[t],console.info("SkillEffect - skillId:"+t),this.targetType=this.data.targetType,this.activeTimer=0,this.duration=(this.data.durationPL?this.data.durationPL*this.level:this.data.duration)||0,this.duration*=1e3,this.countTotal=this.data.countTotal||0,this.count=0,this.effectTypes=this.data.effectTypes,this.level=i,this.interval=null,this.targets=[]},getTargets:function(e,t,i){switch(this.targetType){case"self":return[this.source];case"enemy":case"ally":return[e];case"ally_aoe":return(s=e.map.entities.getPlayerAround(e,this.data.aoe)).unshift(this.source),s;case"enemy_aoe":var s;return(s=e.map.entities.getMobsAround(e,this.data.aoe)).unshift(e),s}return[]},apply:function(e,t,i){var s=this;0<this.duration&&(this.activeTimer=0,this.interval&&(clearInterval(this.interval),this.interval=null),this.interval=setInterval(function(){s.activeTimer>s.duration?(s.applyEffects("end",0),clearInterval(s.interval),s.interval=null):(s.applyEffects("interval",0),s.activeTimer+=2e3)},2e3)),0<this.countTotal&&(this.count=0),this.targets=this.getTargets(e,t,i),this.applyEffects("start",0)},applyEffect:function(e,t,i,s){var n=t.activeEffects.indexOf(this);n<0&&t.activeEffects.push(this),e.apply(this,t,i,s),0<=n&&"end"===i&&t.activeEffects.splice(n,1)},applyEffects:function(e,t){for(var i of this.effectTypes)if(i.phase===e)if(i.isTarget)for(var s of this.targets)this.applyEffect(i,s,e,t);else this.applyEffect(i,this.source,e,t);"end"===e&&(this.count=0,this.activeTimer=0,this.handler.removeSkillEffect(this))},endEffects:function(){for(var e of this.targets){for(var t of e.activeEffects)for(var i of t.effectTypes)i.apply(t,e,"end",0);e.activeEffects=[]}},onInterval:function(e,t){0==this.duration&&(this.applyEffects(e,t),"afterhit"==e&&0<this.countTotal&&this.count===this.countTotal?(this.applyEffects("end",0),this.count=0):"onhit"==e&&0<this.countTotal&&this.count++)}}),s=cls.Class.extend({init:function(e){this.entity=e,this.skills=e.skills,this.skillEffects=[]},interval:function(e,t){t=t||0;for(var i of this.entity.activeEffects)i.onInterval(e,t)},cast:function(e,t,i,s){var n=this.skills[e],a=n.skillLevel,e=new o(this,e,a);this.skillEffects.push(e),n.xp(1),e.level=n.skillLevel,e.apply(t,i,s)},removeSkillEffect:function(e){e=this.skillEffects.indexOf(e);0<=e&&this.skillEffects.splice(e,1)}});t.exports=EffectType,t.exports=o,t.exports=s},{}],24:[function(e,t,i){var s=e("./entitymoving"),a=e("../message"),o=e("../timer"),r=e("../transition");t.exports=Character=s.extend({init:function(e,t,i,s,n,a){this._super(e,t,i,s,n,a),this.nextX=-1,this.nextY=-1,this.prevX=-1,this.prevY=-1,this.atkSpeed=100,this.moveSpeed=100,this.setMoveRate(this.moveSpeed),this.walkSpeed=150,this.idleSpeed=Utils.randomInt(750,1e3),this.setAttackRate(1024),this.target=null,this.unconfirmedTarget=null,this.attackers={},this.isDead=!1,this.attackingMode=!1,this.followingMode=!1,this.engagingPC=!1,this.observeTimer=new o(4096),this.step=0,this.orientation=this.setRandomOrientation(),this.movement=new r(this),this.path=null,this.newDestination=null,this.adjacentTiles={},this.stats={},this.stats.hp=0,this.stats.hpMax=0,this.stats.ep=0,this.stats.epMax=0,this.attackCooldown=null,this.moveCooldown=null,this.attackerLevel=0,this.defenderLevel=0,this.moveLevel=0,this.armor=null,this.weapon=null,this.freeze=!1,this.activeEffects=[],this.effects={},this.invincible=!1,this.mod={accuracy:1,damage:1,defence:1,attack:1,attackTime:1,crit:1,dot:0,dr:0,time:0,daze:0,hate:0},this.neighboursUpdated=!1},hit:function(e){this.setOrientation(e),this.stop()},onAggro:function(e){this.aggro_callback=e},onCheckAggro:function(e){this.checkaggro_callback=e},checkAggro:function(){this.checkaggro_callback&&this.checkaggro_callback()},aggro:function(e){this.aggro_callback&&this.aggro_callback(e)},onDeath:function(e){this.death_callback=e},hurt:function(){this.stopHurting(),this.sprite=this.hurtSprite,this.hurting=setTimeout(this.stopHurting.bind(this),75)},stopHurting:function(){this.sprite=this.normalSprite,clearTimeout(this.hurting)},engage:function(e){this.attackingMode=!0,this.setTarget(e)},disengage:function(){this.attackingMode=!1,this.followingMode=!1,this.removeTarget()},isAttacking:function(){return this.attackingMode},isAttackedBy:function(e){return 0!==Object.keys(this.attackers).length&&this.attackers.hasOwnProperty(e.id)&&this.attackers[e.id]===e},isAttacked:function(){return!(0===Object.keys(this.attackers).length)},addAttacker:function(e){this.isAttackedBy(e)||(this.attackers[e.id]=e)},removeAttacker:function(e){this.isAttacked()&&delete this.attackers[e.id]},removeAttackers:function(){this.attackers={}},clearAttackerRefs:function(){var t=this;this.forEachAttacker(function(e){e.removeAttacker(t)})},forEachAttacker:function(t){_.each(this.attackers,function(e){t(e)})},waitToAttack:function(e){this.unconfirmedTarget=e},isWaitingToAttack:function(e){return this.unconfirmedTarget===e},canAttack:function(){return!(!1!==this.isDead||!this.attackCooldown.isOver())},setAttackRate:function(e){this.attackCooldown=new o(e)},createAttackLink:function(e){this.hasTarget()&&this.removeTarget(),this.setTarget(e),e.addAttacker(this),this.addAttacker(e)},removeTarget:function(){this.target&&(this.target instanceof Character&&this.target.removeAttacker(this),this.removetarget_callback&&this.removetarget_callback(this.target.id),this.target=null)},onRemoveTarget:function(e){this.removetarget_callback=e},hasTarget:function(){return!(null===this.target)},canInteract:function(e){return this.isInReach(e.x,e.y)},canReach:function(e){G_TILESIZE;return 1===this.attackRange?this.isInReach(e.x,e.y,this.orientation):1<this.attackRange&&~~(Utils.realDistance([e.x,e.y],[this.x,this.y])/G_TILESIZE)<=this.attackRange},clearTarget:function(){this.target=null},clearTarget:function(){this.target=null},setTarget:function(e){var t;null===e?this.removeTarget():this.target!==e?(this.hasTarget()&&this.removeTarget(),this.unconfirmedTarget=null,this.target=e,this.settarget_callback&&(t=this.target.spriteName,MobData.Kinds[e.kind])&&t&&this.settarget_callback(e,t,e.level)):console.info(e.id+" is already the target of "+this.id)},lookAt:function(e){e&&(this.orientation=this.getOrientationTo(e))},die:function(e){console.warn("CHARACTER DIED!!!!!!!!!!!!!!!!!!!!!"),this.forceStop(),this.removeTarget(),this.isDead=!0,this.freeze=!0,this.removeAttackers(),this.endEffects(),this.death_callback&&this.death_callback(e)},endEffects:function(){for(var e of this.activeEffects)e.endEffects();this.activeEffects=[]},resetHP:function(){var e="function"==typeof this.getHPMax?this.getHPMax():this.stats.hpMax,t=(this.stats.hpMax=e)-this.stats.hp;this.stats.hp=e,msg=new a.ChangePoints(this,t,0),this.map.entities.sendNeighbours(this,msg)},resetEP:function(){var e="function"==typeof this.getEPMax?this.getEPMax():this.stats.epMax;this.stats.epMax=e,this.stats.ep=e},setHP:function(e){e=e||"function"==typeof this.getHPMax?this.getHPMax():this.stats.hpMax,this.stats.hp=e},setEP:function(e){e=e||"function"==typeof this.getEPMax?this.getEPMax():this.stats.epMax,this.stats.ep=e},setHPMax:function(e){e=e||"function"==typeof this.getHPMax?this.getHPMax():this.stats.hpMax,this.stats.hpMax=e},setEPMax:function(e){e=e||"function"==typeof this.getEPMax?this.getEPMax():this.stats.epMax,this.stats.epMax=e},onDamage:function(e,t,i,s,n){t=t||0,i=i||0,s=s||0,n=n||0,this.invincible||(this.stats.hp,0<t&&this.addAttacker(e),0!==t&&(this.stats.hp=Utils.clamp(0,this.stats.hpMax,this.stats.hp-t)),0!==i&&(this.stats.ep=Utils.clamp(0,this.stats.epMax,this.stats.ep-i)),t=new a.Damage([e,this,-t,-i,s,n]),this.map.entities.sendNeighbours(e,t))},canMove:function(){return!(!1!==this.isDead||!this.moveCooldown.isOver())},modHealthBy:function(e){var t=this.stats.hp,i=this.stats.hpMax;return this.stats.hp=Utils.clamp(0,i,t+e),this.changePoints(e,0)},modEnergyBy:function(e){var t=this.stats.ep,i=this.stats.epMax;return this.stats.ep=Utils.clamp(0,i,t+e),this.changePoints(0,e)},hasFullHealth:function(){return this.stats.hp===this.stats.hpMax},hasFullEnergy:function(){return this.stats.ep===this.stats.epMax},changePoints:function(e,t){return new a.ChangePoints(this,e,t)},setMaxHpMax:function(e){this.stats.hpMax=e,this.stats.hp=e},setAttackRange:function(e){this.attackRange=e*G_TILESIZE},clean:function(){this.forEachAttacker(function(e){e.disengage(),e.idle()})},onRemove:function(e){this.remove_callback=e},getClosestSpot:function(e,t,i){var s=this.getSpotsAroundFrom(e,t=t||1,i=i||1);this.x,this.y;for(o of s)this.map.isColliding(o.x,o.y)&&s.splice(s.indexOf(o),1);var n,a,o,r,c,l=this.map.entities.getCharactersAround(e,i),p=G_TILESIZE>>1;for(o of s){n=o.x,a=o.y;for(var u of l)u&&this!==u&&(r=u.x,c=u.y,u.isMovingPath()&&(u=u.getLastMove())&&(r=u[0],c=u[1]),Math.abs(n-r)<=p)&&Math.abs(a-c)<=p&&s.splice(s.indexOf(o),1)}return 0===s.length?null:(s.sort(function(e,t){return e.d-t.d}),{x:s[0].x,y:s[0].y})},followAttack:function(e){e=this.getClosestSpot(e,1,this.attackRange);e&&e.x&&e.y&&this.moveTo_(e.x,e.y)},isAlive:function(){return!this.isDead}}),t.exports=Character},{"../message":49,"../timer":60,"../transition":61,"./entitymoving":27}],25:[function(e,t,i){e=e("./item").extend({init:function(e,t,i,s,n,a,o){this._super(e,Types.EntityTypes.CHEST,t,i),this.map=s,this.level=Utils.randomRangeInt(a,o),this.setDrops(),this.area=n,this.spawnDelay=3e4},handleRespawn:function(){this.droppedItem=!1,this.area&&this.area instanceof ChestArea&&this.area.respawnChest(this,this.spawnDelay)},setDrops:function(){this.drops={};var e,t=10*Math.ceil(this.level/10);for(e in ItemData.Kinds){var i=ItemData.Kinds[e];if(i){if("attack"==i.typemod||"defense"==i.typemod)switch(t){case i.modifier+10:this.drops[e]=20;break;case i.modifier:this.drops[e]=10;break;case i.modifier-10:this.drops[e]=5;break;case i.modifier-20:this.drops[e]=2}if("craft"==i.typemod)switch(t){case i.modifier+10:this.drops[e]=400;break;case i.modifier:this.drops[e]=200;break;case i.modifier-10:this.drops[e]=100;break;case i.modifier-20:this.drops[e]=50}}}}});t.exports=e},{"./item":28}],26:[function(e,t,i){var s=e("../message");t.exports=Entity=cls.Class.extend({init:function(e,t,i,s,n,a){this.type=t,this.id=e,this.kind=i,this.map=a,this.mapIndex=a.index,this.shadowOffsetY=0,this.isLoaded=!1,this.isHighlighted=!1,this.visible=!0,this.isFading=!1,this.prevX=0,this.prevY=0,this.prevOrientation=null,this.name="",this.nameOffsetY=-10,this.isCritical=!1,this.isHeal=!1,this.shadowOffsetY=0,this.setPosition(Number(s),Number(n)),this.orientation=Utils.randomOrientation()},setName:function(e){this.name=e},setPosition:function(e,t){var i,s=G_TILESIZE,n=(this.x=e)>>4,a=(this.y=t)>>4,e=(void 0===this.gx&&(this.gx=n),void 0===this.gy&&(this.gy=a),e%s==0&&(this.gx=n),t%s==0&&(this.gy=a),~~(n/G_SPATIAL_SIZE)),t=~~(a/G_SPATIAL_SIZE);this.hasOwnProperty("spx")||(this.spx=e),this.hasOwnProperty("spy")||(this.spy=t),this.hasOwnProperty("spatialMap")||(this.spatialMap=this.map),this.spatialMap===this.map?this.spx!==e||this.spy!==t?(i=this.map.entities.spatial[this.spy][this.spx],Utils.removeFromArray(i,this)):(i=this.map.entities.spatial[t][e]).includes(this)||i.push(this):(i=this.spatialMap.entities.spatial[this.spy][this.spx],Utils.removeFromArray(i,this)),this.spx=e,this.spy=t,this.spatialMap=this.map},ready:function(e){this.ready_func=e},clean:function(){},log_info:function(e){console.info("["+this.id+"] "+e)},log_error:function(e){console.error("["+this.id+"] "+e)},getDistanceToEntity:function(e){var t=Math.abs(e.x-this.x),e=Math.abs(e.y-this.y);return e<t?t:e},isAdjacent:function(e){var t=!1;return t=e?!(1<this.getDistanceToEntity(e)):t},isAdjacentNonDiagonal:function(e){var t=!1;return t=!this.isAdjacent(e)||this.x!==e.x&&this.y!==e.y?t:!0},isDiagonallyAdjacent:function(e){return this.isAdjacent(e)&&!this.isAdjacentNonDiagonal(e)},forEachAdjacentNonDiagonalPosition:function(e){e(this.x-1,this.y,Types.Orientations.LEFT),e(this.x,this.y-1,Types.Orientations.UP),e(this.x+1,this.y,Types.Orientations.RIGHT),e(this.x,this.y+1,Types.Orientations.DOWN)},_getBaseState:function(){return[parseInt(this.id,10),parseInt(this.type),parseInt(this.kind),this.name,parseInt(this.map.index),parseInt(this.x),parseInt(this.y),parseInt(this.orientation||0)]},getMapIndex:function(){return this.map.index},getState:function(){return this._getBaseState()},spawn:function(){return new s.Spawn(this)},despawn:function(){return new s.Despawn(this)},getPositionNextTo:function(e){var t,i=null;return e&&(i={},t=Utils.random(4),i.x=e.x,i.y=e.y,0===t&&(i.y-=16),1===t&&(i.y+=16),2===t&&(i.x-=16),3===t)&&(i.x+=16),i},setRandomOrientation:function(){0===(r=Utils.random(4))&&(this.orientation=Types.Orientations.LEFT),1===r&&(this.orientation=Types.Orientations.RIGHT),2===r&&(this.orientation=Types.Orientations.UP),3===r&&(this.orientation=Types.Orientations.DOWN)},isWithinDist:function(e,t,i){i=i||G_TILESIZE;e=Math.abs(this.x-e),t=Math.abs(this.y-t);return e<=i&&t<=i},isWithinDistEntity:function(e,t){return this.isWithinDist(e.x,e.y,t)},isNextTooEntity:function(e){return this.isWithinDist(e.x,e.y,G_TILESIZE)},isNextTooPosition:function(e,t){return this.isWithinDist(e,t,G_TILESIZE)},isOverEntity:function(e){return this.isWithinDist(e.x,e.y,G_TILESIZE>>1)},isOverPosition:function(e,t){return this.isWithinDist(e,t,G_TILESIZE>>1)},isOverlappingEntity:function(e){return this.isWithinDist(e.x,e.y,G_TILESIZE-1)},getSpriteName:function(e){return AppearanceData.getSpriteByID(e)},destroy:function(){}}),t.exports=Entity},{"../message":49}],27:[function(e,t,i){var s=e("./entity"),n=(e("../message"),e("../timer")),o=e("../transition");t.exports=EntityMoving=s.extend({init:function(e,t,i,s,n,a){this._super(e,t,i,s,n,a),this.nextX=-1,this.nextY=-1,this.prevX=-1,this.prevY=-1,this.moveSpeed=100,this.setMoveRate(this.moveSpeed),this.walkSpeed=150,this.idleSpeed=Utils.randomInt(750,1e3),this.followingMode=!1,this.engagingPC=!1,this.step=0,this.orientation=this.setRandomOrientation(),this.movement=new o,this.path=null,this.newDestination=null,this.adjacentTiles={},this.moveCooldown=null,this.freeze=!1},setOrientation:function(e){e&&(this.orientation=e||0)},idle:function(e){this.setOrientation(e)},walk:function(e){this.setOrientation(e)},getOrientationTo:function(e){return this.x<e.x?Types.Orientations.RIGHT:this.x>e.x?Types.Orientations.LEFT:this.y>e.y?Types.Orientations.UP:Types.Orientations.DOWN},getOrientationTo:function(e){return this.getOrientation([this.x,this.y],[e.x,e.y])},isFacing:function(e,t){var i=this.x-e,s=this.y-t;switch(this.orientation){case 1:return 0<s;case 2:return s<0;case 3:return 0<i;case 4:return i<0}return!1},isFacingEntity:function(e){return this.isFacing(e.x,e.y)},getOrientation:function(e,t){var i=Math.abs(e[0]-t[0]),s=Math.abs(e[1]-t[1]);return s<i?e[0]>t[0]?Types.Orientations.LEFT:Types.Orientations.RIGHT:i<s?e[1]>t[1]?Types.Orientations.UP:Types.Orientations.DOWN:Types.Orientations.NONE},isInReach:function(e,t,i,s,n){var i=i||this.orientation,a=G_TILESIZE,n=n||a>>1,s=s||a+n,o=n,r=n;switch(i){case Types.Orientations.UP:case Types.Orientations.DOWN:r=s;break;case Types.Orientations.LEFT:case Types.Orientations.RIGHT:o=s;break;case Types.Orientations.NONE:return!1}return Math.abs(this.x-e)<=o&&Math.abs(this.y-t)<=r},lookAt:function(e,t){return this.orientation=this.getOrientationTo([e,t]),this.idle(this.orientation),this.orientation},lookAtEntity:function(e){return e&&(this.orientation=this.getOrientationTo(e)),this.orientation},lookAtTile:function(e,t){var i=G_TILESIZE>>1,e=Utils.getGridPosition(e,t),e=Utils.getPositionFromGrid(e.gx,e.gy);this.lookAt(e.x+i,e.y+i)},moveTo_:function(e,t,i){return this._moveTo(e,t,i)},_moveTo:function(e,t,i){this.destination={x:e,y:t},this.adjacentTiles={},this.isMovingPath()?this.continueTo(e,t):(e=this.requestPathfindingTo(e,t))&&this.followPath(e)},requestPathfindingTo:function(e,t){if(Array.isArray(this.path)&&0<this.path.length)return this.path;if(this.request_path_callback)return this.request_path_callback(e,t);console.info(this.id+" couldn't request pathfinding to "+e+", "+t),console.info("char x:"+this.x+",y: "+this.y+", x:"+e+"y: "+t);try{throw new Error}catch(e){console.info(e.stack)}return null},onRequestPath:function(e){this.request_path_callback=e},onStartPathing:function(e){this.start_pathing_callback=e},onStopPathing:function(e){this.stop_pathing_callback=e},onAbortPathing:function(e){this.abort_pathing_callback=e},followPath:function(e){e&&(this.path=e,this.step=0,this.followingMode&&e.pop(),this.start_pathing_callback)&&this.start_pathing_callback(e)},continueTo:function(e,t){this.newDestination={x:e,y:t}},go:function(e,t){this.isAttacking()?this.disengage():this.followingMode&&(this.followingMode=!1,this.target=null),this.moveTo_(e,t)},follow:function(e,t){e=this.getClosestSpot(e,t);e&&e.x&&e.y&&this.moveTo_(e.x,e.y)},getLastMove:function(){var e;return this.path?[(e=this.path[this.path.length-1])[0],e[1]]:null},stopInPath:function(e,t){this.isMovingPath()&&this.map.entities.pathfinder.isInPath(this.path,[e,t])&&(this.setPosition(e,t),this.interrupted=!0,this.forceStop())},getSpotsAroundFrom:function(e,t,i){t=t||1,i=i||1;for(var s=[],n=Math.min(t,i),a=Math.max(t,i),o=n;o<=a;++o)s=s.concat(this.getSpotsAround(e,o));return s},getSpotsAround:function(e,t){for(var i,s,n=(t=t||1)*G_TILESIZE,a=4*t,t=[e.x,e.y],o=t[0],r=t[1],c=this.x,l=this.y,p=[],u=2*Math.PI/a,d=0,h=0;h<a;++h)d+=u,i=~~(o+Math.sin(d)*n),s=~~(r+Math.cos(d)*n),p.push([i,s]);for(var m,f=[],v=(p=p.filter((t,e,i)=>i.findIndex(e=>e[0]===t[0]&&e[1]===t[1])===e)).length,h=0;h<v;++h)m=p[h],f.push({d:Utils.realDistance([c,l],m),x:m[0],y:m[1]});return f},getClosestSpot:function(e,t,i){for(var s=this.getSpotsAroundFrom(e,t=t||1,i=i||1),n=s.length-1;0<=n;--n){var a=s[n];game.mapContainer.isColliding(a.x,a.y)&&s.splice(n,1)}return s.sort(function(e,t){return e.d-t.d}),{x:s[0].x,y:s[0].y}},isOverlapping:function(){var e;for(e of this.map.entities.getCharactersAround(this,1))if(e&&this!==e&&this.isOverlappingEntity(e))return!0;return!1},stop:function(){this.isMovingPath()&&(this.interrupted=!0,this.moving=!1)},forceStop:function(){this.movement.stop(),this.orientation=0,this.moveOrientation=0,this.isMovingPath()&&(this.interrupted&&this.abort_pathing_callback&&this.abort_pathing_callback(this.x,this.y),this.interrupted=!1,this.path=null,this.newDestination=null,this.isReadyToMove=!0,this.followingMode=!1)},forceStopMove:function(){console.info("character - forceStopMove - called"),this.movement.stop(),this.moveOrientation=0,this.freeze=!1,this.movestop_callback&&this.movestop_callback()},setMoveStopCallback:function(e){this.movestop_callback=e},onHasMoved:function(e){this.hasmoved_callback=e},hasMoved:function(){this.setDirty(),this.hasmoved_callback&&this.hasmoved_callback(this)},setMoveRate:function(e){this.moveSpeed=e,this.walkSpeed=~~(e/4),this.moveCooldown=new n(e),this.tick=Math.round(1e3/this.moveSpeed)},getPathIndex:function(e){return null===!this.path||0===this.path.length||e<0||e>=this.path.length?null:this.path[e]},updateMovement:function(){var e=this.path,t=this.step;!e||t>e.length-1||(this.orientation=this.getOrientation([this.x,this.y],e[t]),this.walk(this.orientation))},nextStepPath:function(){return 0===this.step&&(this.step++,this.updateMovement()),this.step<this.path.length&&this.x===this.path[this.step][0]&&this.y===this.path[this.step][1]&&(this.step++,this.updateMovement(),!0)},nextStep:function(){var e,t,i=!1,s=!1;return(i=this.isMovingPath()&&!this.freeze?i:this.interrupted=!0)||(s=this.nextStepPath(),this.step>=this.path.length&&(i=!0),this.step_callback&&this.step_callback()),this.hasChangedItsPath()?(this.setPosition(this.x,this.y),e=this.newDestination.x,t=this.newDestination.y,e=this.requestPathfindingTo(e,t),this.newDestination=null,this.followPath(e),!0):(i&&(this.stop_pathing_callback&&(this.stop_pathing_callback(this.x,this.y),this.forceStop()),s=!0),s)},onBeforeMove:function(e){this.before_move_callback=e},onBeforeStep:function(e){this.before_step_callback=e},onStep:function(e){this.step_callback=e},isMoving:function(){return this.movement.inProgress},isMovingPath:function(){return this.path&&0<this.path.length},hasNextStep:function(){return this.path&&this.path.length-1>this.step},hasChangedItsPath:function(){return!(null===this.newDestination)},isNear:function(e,t){var i=!1,s=Math.abs(this.x-e.x),e=Math.abs(this.y-e.y);return i=s<=t*G_TILESIZE&&e<=t*G_TILESIZE?!0:i},isNextToo:function(e,t,i){i=i||this.orientation,i=G_TILESIZE;return Math.abs(this.x-e)<=i&&Math.abs(this.y-t)<=i},movePath:function(e,t){this.orientation=this.getOrientationTo([e[1][0],e[1][1]]),this.walk(),this.path=e,this.step=0},nextDist:function(e,t,i,s){switch(e=e||this.x,t=t||this.y,s=s||1,i=i||this.orientation){case 1:return[e,t-s];case 2:return[e,t+s];case 3:return[e-s,t];case 4:return[e+s,t]}return[e,t]},nextMove:function(e,t,i,s){return this.nextDist(e,t,i,1)},nextTile:function(e,t,i,s){return this.nextDist(e,t,i,G_TILESIZE)},move:function(e,t,i,s,n){this.orientation=t,1===i&&t!==Types.Orientations.NONE?(this.forceStop(),this.setPosition(s,n),this.walk(t)):0!==i&&2!==i&&t!==Types.Orientations.NONE||(this.forceStop(),this.setPosition(s,n))},canMove:function(){return!(!1!==this.isDead||!this.moveCooldown.isOver())},onRemove:function(e){this.remove_callback=e},isWithinPath:function(e){var t=null;if("Object"==typeof e&&0<e.x&&0<e.y?t=[e.x,e.y]:Array.isArray(e)&&2===e.length&&(t=[e[0],e[1]]),t&&null!==this.path&&0!==this.path.length)for(var i=this.path.length,s=0;s<i;++s)if(this.path[s][0]===t[0]&&this.path[s][1]===t[1])return{x:t[0],y:t[1],step:s};return null},setFreeze:function(e,t){var i=this;e<=0?i.freeze=!1:(this.freeze=!0,this.freeze_callback=setTimeout(function(){i.freeze=!1,t&&t(i)},e))},getState:function(){return this._getBaseState()}}),t.exports=EntityMoving},{"../message":49,"../timer":60,"../transition":61,"./entity":26}],28:[function(e,t,i){e=e("./entity");t.exports=Item=e.extend({init:function(e,t,i,s,n,a){var o=i.itemKind;this._super(t,e,o,s,n,a),this.isStatic=!1,this.isFromChest=!1,this.orientation=Types.Orientations.DOWN,this.experience=0,this.data=ItemData.Kinds[o],this.room=i},handleDespawn:function(e){var t=this;this.blinkTimeout=setTimeout(function(){e.blinkCallback(),t.despawnTimeout=setTimeout(e.despawnCallback,e.blinkingDuration)},e.beforeBlinkDelay)},destroy:function(){this.blinkTimeout&&clearTimeout(this.blinkTimeout),this.despawnTimeout&&clearTimeout(this.despawnTimeout),this.isStatic&&this.scheduleRespawn(3e4)},scheduleRespawn:function(e){var t=this;setTimeout(function(){t.respawnCallback&&t.respawnCallback()},e)},onRespawn:function(e){this.respawnCallback=e},getState:function(){return[parseInt(this.id,10),parseInt(this.type),parseInt(this.room.itemKind),this.data&&this.data.hasOwnProperty("name")?this.data.name:"",parseInt(this.map.index),parseInt(this.x),parseInt(this.y),parseInt(this.orientation),parseInt(this.room.itemNumber)]},getName:function(){return this.data.name},toString:function(){return this.room.itemKind+" "+this.room.itemNumber+" "+this.room.itemDurability+" "+this.room.itemDurabilityMax+" "+this.room.itemExperience+" "+this.x+" "+this.y}})},{"./entity":26}],29:[function(e,t,i){var s=e("./character"),n=e("../message"),a=e("../area/mobarea");t.exports=Mob=s.extend({init:function(e,t,i,s,n,a){this._super(e,Types.EntityTypes.MOB,t,i,s,n),this.world=this.map.entities.world,this.data=MobData.Kinds[this.kind],0<this.data.level?this.level=this.data.level:this.level=a?Utils.randomRangeInt(Math.max(this.data.minLevel,a.minLevel),Math.min(this.data.maxLevel,a.maxLevel)):Utils.randomRangeInt(this.data.minLevel,this.data.maxLevel),this.level=this.level;e=Number(i),t=Number(s);this.spawnX=e,this.spawnY=t,this.stats={},this.stats.attack=this.data.attack*this.level,this.stats.defense=this.data.defense*this.level,this.stats.hp=Math.max(this.data.hp*this.level-40,1),this.stats.hpMax=this.stats.hp,this.stats.ep=this.data.ep*this.level,this.stats.epMax=this.stats.ep,this.stats.xp=this.data.xp*this.level,this.stats.mod={attack:0,defense:0,damage:0,health:0},this.hatelist=[],this.hateCount=0,this.respawnTimeout=null,this.returnTimeout=null,this.isDead=!1,this.aggroRange=this.data.aggroRange,this.attackRange=this.data.attackRange,this.isAggressive=this.data.isAggressive,this.moveSpeed=this.data.moveSpeed,this.setMoveRate(this.moveSpeed),this.setAttackRate(this.data.attackRate),this.setAggroRate(this.data.reactionDelay>>2),this.setMoveAI(Utils.randomRangeInt(50,150)),this.setItemLoot(),this.drops={},this.questDrops={},this.setDrops(),this.spawnDelay=this.data.respawn,this.canCall=!0,this.orientation=Utils.randomOrientation(),this.isReturning=!1,this.target=null,this.droppedItem=!1,this.isBlocking=!1,this.freeze=!1,this.aiState=mobState.IDLE,this.effects={},this.activeEffects=[],this.damageCount={},this.dealtCount={},this.creatureMulti=1},createBoss:function(e){for(var t in this.creatureMulti=e,this.stats.hp*=e,this.stats.hpMax*=e,this.spawnDelay*=e,this.resetHP(),this.drops)ItemTypes.isEquipment(t)&&(this.drops[t]*=e)},getXP:function(){return this.data.xp*this.data.attackMod*this.data.defenseMod*this.data.attackRateMod*this.data.hpMod*this.level*this.creatureMulti},setMoveAI:function(e){this.moveAICooldown=new Timer(e)},canMoveAI:function(){return this.moveAICooldown.isOver()},resetMoveAI:function(e){this.moveAICooldown.lastTime=e},setAggroRate:function(e){this.aggroCooldown=new Timer(e)},canAggro:function(){return this.aggroCooldown.isOver()},resetAggro:function(e){this.aggroCooldown.lastTime=e},onKilled:function(e){this.on_killed_callback=e},onDamage:function(e,t,i,s,n){this.stats.hp;var a=t/this.stats.hpMax,a=(log.info("dmgRatio: "+a),this.stats.hp);this._super(e,t,i,s,n),0<(a-=this.stats.hp)&&(console.info("onDamage hpDiff:"+a),this.onHitByEntity(e,a)),this.stats.hp<=0&&this.die(e)},destroy:function(){this.isDead=!0,this.endEffects(),this.forgetEveryone(),this.clearTarget(),this.resetBars(),this.resetPosition(),this.handleRespawn(),this.damageCount={},this.dealtCount={}},onHitEntity:function(e,t){this.dealtCount.hasOwnProperty(e.id)||(this.dealtCount[e.id]=0),this.dealtCount[e.id]+=t},onHitByEntity:function(e,t){this.damageCount.hasOwnProperty(e.id)||(this.damageCount[e.id]=0),this.damageCount[e.id]+=t},resetBars:function(){this.stats.hp=this.stats.hpMax,this.stats.ep=this.stats.epMax},hates:function(t){return _.any(this.hatelist,function(e){return e.entity===t})},increaseHateFor:function(t,e){this.hates(t)?_.detect(this.hatelist,function(e){return e.entity===t}).hate+=e:this.hatelist.push({entity:t,hate:e}),this.returnTimeout&&(clearTimeout(this.returnTimeout),this.returnTimeout=null)},getMostHated:function(e){var t=_.sortBy(this.hatelist,function(e){return e.hate});_.size(this.hatelist);return t&&t[0]?t[0].entity:null},forgetPlayer:function(t){this.hatelist=_.reject(this.hatelist,function(e){return e.entity.id===t}),0===this.hatelist.length&&this.returnToSpawn()},forgetEveryone:function(){this.hatelist=[],this.damageCount={},this.dealtCount={},this.clearAttackerRefs(),this.removeAttackers()},handleRespawn:function(){var e=this;this.area&&this.area instanceof a?this.area.respawnMob(e,this.spawnDelay):setTimeout(function(){e.respawnCallback&&e.respawnCallback()},this.spawnDelay)},onRespawn:function(e){this.respawnCallback=e},respawn:function(){this.spawnX=this.x,this.spawnY=this.y,this.isDead=!1,this.droppedItem=!1,this.invincible=!1,this.resetBehaviour(),this.activeEffects=[],this.map.entities.sendNeighbours(this,new n.Spawn(this))},resetBehaviour:function(){this.disengage(),this.forceStop(),this.forgetEveryone(),this.setAiState(mobState.IDLE),this.freeze=!1},resetPosition:function(){this.setPosition(this.spawnX,this.spawnY)},returnToSpawn:function(){var e=this;if(this.aiState!==mobState.RETURNING)if(this.setAiState(mobState.RETURNING),this.forceStop(),this.hasTarget()&&this.clearTarget(),this.forgetEveryone(),this.invincible=!0,this.freeze=!1,this.x===this.spawnX&&this.y===this.spawnY)this.returnedToSpawn();else if(this.go(this.spawnX,this.spawnY),console.warn("returnToSpawn - Path: "+JSON.stringify(this.path)),this.path&&0!==this.path.length){var t=this.map.entities.pathfinder.getPathTicks(this.path,this.spawnX,this.spawnY),t=Math.max(0,~~(t/(this.tick/G_FRAME_INTERVAL_EXACT)));console.info("returnToSpawn.delay = "+t),console.info("id="+this.id+",x="+this.spawnX+",y="+this.spawnY),setTimeout(function(){console.info("st - id="+e.id+",x="+e.spawnX+",y="+e.spawnY),e.returnedToSpawn()},t)}else{try{throw new Error}catch(e){console.error(e.stack)}this.returnedToSpawn()}},onMove:function(e){this.moveCallback=e},move:function(e,t){this.setPosition(e,t),this.orientation=Utils.getOrientationFromLastMove(this),this.moveCallback&&this.moveCallback(this)},distanceToPos:function(e,t){return Utils.distanceTo(this.x,this.y,e,t)},setItemLoot:function(){for(var e in this.loot={},this.lootTotal=0,ItemLootData.ItemLoot){var t=ItemLootData.ItemLoot[e],t=~~(1e3/t.rarity*t.rarity);0<t&&(this.loot[e]=t),this.lootTotal+=this.loot[e]}this.lootTotal=~~this.lootTotal},setDrops:function(){Math.ceil(this.level/10);for(var e in ItemData.Kinds){var t=ItemData.Kinds[e];t&&1!==t.legacy&&(t=t.level-this.level,ItemTypes.isEquipment(e))&&(0<=t&&t<5&&(this.drops[e]=1),-5<=t&&t<0&&(this.drops[e]=2),-10<=t)&&t<-5&&(this.drops[e]=5)}15<=this.level&&this.level<25&&(this.drops[310]=250),25<=this.level&&this.level<35&&(this.drops[311]=250),35<=this.level&&this.level<45&&(this.drops[312]=250),45<=this.level&&(this.drops[313]=250),this.level<20?this.drops[34]=250:this.drops[36]=250},Speech:function(e,t){return null},getState:function(){return this._getBaseState().concat([this.level,this.stats.hp,this.stats.hpMax])},setAiState:function(e){this.aiState=e},die:function(e){var t=this;console.info("Entity is dead"),this.map.entities.sendBroadcast(this.despawn()),_.each(this.attackers,function(e){t.on_killed_callback&&t.on_killed_callback(e,t.damageCount[e.id]),e.onKillEntity(t,t.damageCount[e.id],t.dealtCount[e.id])}),this._super(e),this.destroy()},onKillEntity:function(e){},baseCrit:function(){var e=this.stats.attack+this.stats.mod.attack;return~~Utils.clamp(5,500,~~(e+0))},baseCritDef:function(){var e=this.stats.defense+this.stats.mod.defense;return~~Utils.clamp(5,500,~~(e+0))},baseDamage:function(){var e=~~(12*this.level);return~~(e+=(this.stats.attack+this.stats.mod.attack)*(6-Math.min(3,.1*this.level)))},baseDamageDef:function(){var e=~~(2*this.level);return~~(e+=2*(this.stats.defense+this.stats.mod.defense))},canReach:function(e){var t=this.orientation,e=(this.lookAtEntity(e),this._super(e));return this.orientation=t,e},dropGold:function(){return Utils.randomRangeInt(2*this.level,3*this.level)*this.creatureMulti},returnedToSpawn:function(){console.info("mob.returnedToSpawn"),this.resetHP(),this.resetPosition(),this.resetBehaviour(),this.invincible=!1},handleMobHate:function(e,t){console.info("handleMobHate"),e&&e instanceof Player&&(this.increaseHateFor(e,t),0<this.stats.hp)&&(e=this.getMostHated())&&this.createAttackLink(e)},aggroPlayer:function(e,t){this.resetAggro(0),this.attackingMode=!0,this.handleMobHate(e,1),this.setAiState(mobState.AGGRO),this.attackTimer=Date.now(),this.freeze=!1},endEffects:function(){for(var e of this.activeEffects)e.endEffects();this.activeEffects=[]},goRoam:function(e){this.go(e.x,e.y),this.path&&(this.aiState=mobState.ROAMING,this.spawnX=e.x,this.spawnY=e.y)},canRoam:function(){return!(this.hasTarget()||this.isDead||this.isReturning||this.isMoving()||this.aiState!==mobState.IDLE)}}),t.exports=Mob},{"../area/mobarea":6,"../message":49,"./character":24}],30:[function(e,t,i){var s=e("./entity"),n=(e("../utils"),e("../message")),e=s.extend({init:function(e,t,i,s,n,a,o){this._super(e,Types.EntityTypes.NODE,t,i,s,n),this.stats={},this.level=a,this.setDrops(),this.spawnDelay=6e4,this.spriteName="nodeset"+t,this.animName="node"+o},getState:function(){return this._getBaseState().concat([this.level,this.spriteName,this.animName,this.weaponType])},onDeath:function(e){this.death_callback=e},die:function(){this.isDead=!0,this.map.entities.sendNeighbours(this,new n.Despawn(this)),this.handleRespawn(),this.death_callback&&this.death_callback()},setDrops:function(){this.drops={},2===this.kind&&(1===this.level&&(this.drops[301]=2e3),2===this.level&&(this.drops[302]=2e3),3===this.level?this.drops[303]=2e3:this.drops[304]=2e3)},respawn:function(){this.isDead=!1,this.map.entities.sendNeighbours(this,new n.Spawn(this))},handleRespawn:function(){var e=this;this.area&&this.area instanceof Area?this.area.respawn(this,this.spawnDelay):setTimeout(function(){e.respawn(),e.respawnCallback&&e.respawnCallback()},this.spawnDelay)}});t.exports=e},{"../message":49,"../utils":66,"./entity":26}],31:[function(e,t,i){var s=e("./character"),a=e("../message"),o=e("../entityquests"),r=e("../../shared/data/npc_names.json"),e=s.extend({init:function(e,t,i,s,n){if(i+=8,s+=8,this._super(e,Types.EntityTypes.NPCMOVE,t,i,s,n),this.armor=0,this.weapon=0,this.gender=t%2,this.setMoveRate(350),this.name=r[t%r.length],this.map.entities.world.npcMoveCallback.setCallbacks(this),this.entityQuests=new o(this),this.npcQuestId=this.kind,QuestData.NpcData.hasOwnProperty(this.kind)){e=QuestData.NpcData[this.kind];if(e&&0<e.length){var a;for(a of e)this.entityQuests.quests[a.id]=a}}},getState:function(){return this._getBaseState().concat(this.npcQuestId)},talk:function(e){var t,i=this,s=e,n=!1;e.quests.forQuestsType(QuestType.GETITEMKIND,function(e){e.npcQuestId===i.npcQuestId&&s.quests.questAboutItemComplete(e,null)&&(n=!0)}),n||(0===Object.keys(this.entityQuests.quests).length?this.entityQuests.dynamicQuests(e):(t=-1,this.entityQuests.hasQuest(e)||((t=this.entityQuests.getNextQuestId(e))?(t=new a.Dialogue(this,"QUESTS_"+t),e.sendPlayer(t)):this.entityQuests.sendNoQuest(e))))},randomMove:function(){var e;this.hasTarget()||this.isDead||this.isMoving()||1!==Utils.randomRangeInt(0,100)||0===this.map.entities.getPlayerAroundCount(this,20)||!(e=this.map.entities.getRandomPosition(this,2))||e.x===this.x&&e.y===this.y||this.go(e.x,e.y)},checkMove:function(e){this.isDead||!this.freeze&&this.isMoving()&&this.canMove()&&this.nextStep()}});t.exports=e},{"../../shared/data/npc_names.json":343,"../entityquests":34,"../message":49,"./character":24}],32:[function(e,t,i){var s=e("./entity"),e=(e("./player"),e("../utils"),e("../message"),s.extend({init:function(e,t,i,s,n){i+=8,s+=8,this._super(e,Types.EntityTypes.NPCSTATIC,t,i,s,n),this.map=n},talk:function(e){if(console.info("talk"),console.info("kind: "+this.kind),44===this.kind){if(console.info("THIS IS FOR COLLECTING ITEMS NPC."),e.questStatus)for(var[t,i]of Object.entries(e.questStatus))console.info("questStatus"+JSON.stringify(i)),1==i.type&&i.count<=i.objectCount&&e.questAboutItem(i,null)}else for(var s in e.quests)if(s.npcKind===this.kind)return}}));t.exports=e},{"../message":49,"../utils":66,"./entity":26,"./player":33}],33:[function(e,t,i){var s=e("./character"),l=e("../message"),n=(e("../formulas"),e("../items/bank"),e("../items/equipment"),e("../items/inventory"),e("../skillhandler")),v=e("../effecthandler"),a=e("../packets/packethandler"),o=e("../playerquests");Quest=e("../quest"),t.exports=Player=s.extend({init:function(e,t,i){this.user=t,this.world=e,this.server=e,this.connection=i,this.map=this.world.maps[0],this._super(i.id,Types.EntityTypes.PLAYER,1,0,0,this.map,0),this.mapStatus=0,this.mapIndex=0,this.gold=new Array(2),this.skillSlots=[],this.hasLoggedIn=!1,this.hasEnteredGame=!1,this.isDead=!1,this.inventory=null,this.bank=null,this.equipment=null,this.itemStore=new Array(3),this.exp={base:0,attack:0,defense:0,move:0},this.level={base:0,attack:0,defense:0,move:0},this.stats={attack:0,defense:0,health:0,energy:0,luck:0,free:0,hp:0,hpMax:0,ep:0,epMax:0},this.stats.mod={attack:0,defense:0,damage:0,health:0},this.cooltimeTimeout=null,this.consumeTimeout=null,this.skillHandler=new n(this),this.moveSpeed=500,this.setMoveRate(this.moveSpeed),this.consumeTime=new Timer(5e3),this.attackedTime=new Timer(1e3),this.attackQueue=[],this.moveQueue=[],this.stopQueue=[],this.attackSkill=[],this.attackTimer=0,this.idleTimer=new Timer(3e5),this.world.playerCallback.setCallbacks(this),this.quests=new o(this),this.onWelcomeReady=!1,this.tut={},this.tut.move=!1,this.tut.portal=!1,this.tut.attack=!1,this.tut.attack2=!1,this.tut.buy=!1,this.tut.buy2=!1,this.tut.equip=!1,this.tut.stats=!1,this.spawnsList={},this.lastAction=Date.now(),this.knownIds=[],this.sx=0,this.sy=0,this.ex=-1,this.ey=-1,this.moveOrientation=0,this.savedAll=!1,this.savedSection=0,this.achievements=[],this.pStats=[],this.sprites=[],this.colors=[],this.shortcuts={},this.loaded=0,this.activeEffects=[],this.levels={}},start:function(e){this.worldHandler=e.worldHandler,this.connection=e,this.id=e.id,this.packetHandler=new a(this.user,this,e,this.world,this.map),this.packetHandler.loadedPlayer=!0,this.server.connect_callback(this),this.sendPlayerToClient()},destroy:function(){},getState:function(){var e=this._getBaseState(),t=this.getSprite(0),i=this.getSprite(1),t=[this.level,this.stats.hp,this.stats.hpMax,0,t,i,0,0];return e.concat(t)},send:function(e){this.connection.send(e)},resetBars:function(){var e=this.stats.hp,t=this.stats.ep,e=this.stats.hpMax-e,t=this.stats.epMax-t;this.modHealthBy(e),this.modEnergyBy(t)},onKillEntity:function(e,t,i){i=i||0;var s,n=(t=t||0)/e.stats.hpMax,n=~~(e.getXP()*n),e=1.1+.1*Utils.clamp(-10,10,e.level-this.level),a=(this.incExp(n=~~(n*e)),this.incWeaponExp(n),Math.min(5,Math.ceil(i/300)));for(s in log.warn("armorDamage:"+a),this.equipment.rooms)4!==s&&this.equipment.rooms[s]&&0<a&&this.equipment.degradeItem(s,1)&&this.equipment.addExperience(s,a);this.armorDamage=0;e=Math.min(5,Math.ceil(t/2e3));0<e&&this.equipment.degradeItem(4,1)&&this.equipment.addExperience(4,e),this.weaponDamage=0},onDamage:function(e,t,i,s,n){var a=this.stats.hp;this._super(e,t,i,s,n),a-=this.stats.hp,e.onHitEntity(this,a),this.stats.hp<=0&&(_.each(this.attackers,function(e){e.hasOwnProperty("knownIds")&&delete e.knownIds[this.id]}),this.die(e))},incExp:function(e){var e=parseInt(e),e=Math.ceil(e*this.getExpBonus()),t=(this.exp.base=parseInt(this.exp.base)+parseInt(e),this.sendPlayer(new l.Stat(1,this.exp.base,e)),this.level);return this.level=Types.getLevel(this.exp.base),t!==this.level&&this.levelUp(t),e},incAttackExp:function(e){var e=parseInt(e),e=Math.ceil(e*this.getExpBonus()*.25),t=(this.exp.attack=parseInt(this.exp.attack)+parseInt(e),this.levels.attack);return this.levels.attack=Types.getAttackLevel(this.exp.attack),t!==this.levels.attack&&this.sendPlayer(new l.LevelUp(2,this.levels.attack,this.exp.attack)),e},incDefenseExp:function(e){var e=parseInt(e),e=Math.ceil(e*this.getExpBonus()),t=(this.exp.defense=parseInt(this.exp.defense)+parseInt(e),this.stats.defense);return this.levels.defense=Types.getDefenseLevel(this.exp.defense),t!==this.levels.defense&&this.sendPlayer(new l.LevelUp(3,this.levels.defense,this.exp.defense)),e},incMoveExp:function(e){var e=parseInt(e),e=Math.ceil(e*this.getExpBonus()),t=(this.exp.move=parseInt(this.exp.move)+parseInt(e),this.levels.move);return this.levels.move=Types.getMoveLevel(this.exp.move),t!==this.levels.move&&this.sendPlayer(new l.LevelUp(4,this.levels.move,this.exp.move)),e},incWeaponExp:function(e){var t,i,s,e=parseInt(e),e=Math.ceil(e*this.getExpBonus()*.25),n=this.getWeaponType();return this.exp.hasOwnProperty(n)?(t=parseInt(this.exp[n]),i=Types.getWeaponLevel(t),t+=e,s=Types.getWeaponLevel(t),this.exp[n]=t,i!==s&&this.sendPlayer(new l.LevelUp({10:"sword",11:"bow",12:"hammer",13:"axe"}[n],s,t)),e):null},getExpBonus:function(){var t=this,i=1;return this.party&&this.party.forEachPlayer(function(e){t.isInScreen([e.x,e.y])&&(i+=.15)}),i},levelUp:function(e){for(var t=e+1;t<=this.level;++t)t<10?(this.stats.attack+=2,this.stats.defense+=2,this.stats.health+=2,this.stats.energy+=2,this.stats.luck+=2):this.stats.free+=5;this.setHPMax(),this.setEPMax(),this.sendPlayer(new l.StatInfo(this)),this.resetBars(),this.sendPlayer(new l.ChangePoints(this,0,0)),this.sendPlayer(new l.LevelUp(1,this.level,this.exp.base))},sendPlayerToClient:function(){var e,t,i,s=this,n=(console.info("sendMessage"),0),a=[Types.Messages.WC_PLAYER,0,Date.now(),s.id,s.name,s.mapIndex,s.x,s.y,s.stats.hp,s.stats.ep,s.exp.base,s.exp.attack,s.exp.defense,s.exp.move,s.exp.sword,s.exp.bow,s.exp.hammer,s.exp.axe,s.exp.logging,s.exp.mining,s.colors[0],s.colors[1],s.gold[0],s.gold[1],s.user.gems,s.stats.attack,s.stats.defense,s.stats.health,s.stats.energy,s.stats.luck,s.stats.free];for(e in console.info("sendMessage - Equipment"),a.push(Object.keys(s.equipment.rooms).length),s.equipment.rooms)var o=s.equipment.rooms[e],a=a.concat(o.toArray());for(t in s.setRange(),a.push(s.getSprite(0)),a.push(s.getSprite(1)),console.info("sendMessage - Inventory"),a.push(Object.keys(s.inventory.rooms).length),s.inventory.rooms){o=s.inventory.rooms[t];a=a.concat(o.toArray())}for(i in console.info("sendMessage - Bank"),a.push(Object.keys(s.bank.rooms).length),s.bank.rooms){o=s.bank.rooms[i];a=a.concat(o.toArray())}var r=s.quests.quests.filter(function(e){return e.status!==QuestStatus.COMPLETE});a.push(r.length);for(var c=0;c<r.length;++c){var l=r[c];console.info(JSON.stringify(l)),a=a.concat(l.toClient())}var p=s.achievements;a.push(p.length);for(var u=0;u<p.length;++u){var d=p[u];console.info(JSON.stringify(d)),a=a.concat(d.toClient(d))}s.effectHandler=new v(s),a.push(s.skills.length);for(n=0;n<s.skills.length;++n)a.push(parseInt(s.skills[n].skillXP));var h,m,f=Object.keys(s.shortcuts).length;for(m in a.push(f),s.shortcuts)(h=s.shortcuts[m])&&(a.push(parseInt(h[0])),a.push(parseInt(h[1])),a.push(parseInt(h[2])));s.world.enter_callback&&(s.world.enter_callback(s),s.connection.sendUTF8(a.join(",")),s.hasEnteredGame=!0)},fillPlayerInfo:function(e){var t,i,s=this,n=(s.mapIndex=parseInt(e.map[0]),s.map=s.server.maps[s.mapIndex],s.x=parseInt(e.map[1]),s.y=parseInt(e.map[2]),s.orientation=parseInt(e.map[3]),2===e.sprites.length&&(e.sprites[2]=151,e.sprites[3]=50),s.sprites=e.sprites.parseInt(),s.colors=e.colors,s.exp.base=parseInt(e.exps[0]),s.exp.attack=parseInt(e.exps[1]),s.exp.defense=parseInt(e.exps[2]),s.exp.move=parseInt(e.exps[3]),8<=e.exps.length?(s.exp.sword=parseInt(e.exps[4]),s.exp.bow=parseInt(e.exps[5]),s.exp.hammer=parseInt(e.exps[6]),s.exp.axe=parseInt(e.exps[7])):(s.exp.sword=0,s.exp.bow=0,s.exp.hammer=0,s.exp.axe=0),10===e.exps.length?(s.exp.logging=parseInt(e.exps[8]),s.exp.mining=parseInt(e.exps[9])):(s.exp.logging=0,s.exp.mining=0),s.level=Types.getLevel(s.exp.base),s.levels.attack=Types.getAttackLevel(s.exp.attack),s.levels.defense=Types.getDefenseLevel(s.exp.defense),s.levels.move=Types.getMoveLevel(s.exp.move),s.gold[0]=parseInt(e.gold[0]),s.gold[1]=parseInt(e.gold[1]),s.isDead=!1,s.pStats=e.pStats.parseInt(),e.stats=e.stats.parseInt(),parseInt(s.level));if(t=n,i=e.stats,(t<10?10*t:90+5*(t-9))!==i.reduce(function(e,t){return e+t},0)?n<10?(s.stats.attack=2*n,s.stats.defense=2*n,s.stats.health=2*n,s.stats.energy=2*n,s.stats.luck=2*n,s.stats.free=0):(s.stats.attack=18,s.stats.defense=18,s.stats.health=18,s.stats.energy=18,s.stats.luck=18,s.stats.free=5*(n-9)):n<10?(s.stats.attack=2*n,s.stats.defense=2*n,s.stats.health=2*n,s.stats.energy=2*n,s.stats.luck=2*n,s.stats.free=0):(s.stats.attack=e.stats[0],s.stats.defense=e.stats[1],s.stats.health=e.stats[2],s.stats.energy=e.stats[3],s.stats.luck=e.stats[4],s.stats.free=e.stats[5]),Array.isArray(e.completeQuests))s.quests.completeQuests={};else{for(var a in e.completeQuests)Number(a)||delete e.completeQuests[a];s.quests.completeQuests=e.completeQuests}if(s.setHP(),s.setEP(),s.setPointsMax(),s.resetBars(),s.setMoveRate(500),1===e.skills.length)for(var o=0;o<SkillData.Skills.length;++o)e.skills[o]=0;if(s.skillHandler.setSkills(s,e.skills),Array.isArray())for(var r of e.shortcuts)r&&(s.shortcuts[r[0]]=r);else for(var c in e.shortcuts)(r=e.shortcuts[c])&&(s.shortcuts[c]=r);s.attackTimer=Date.now()},setPointsMax:function(){this.stats.hpMax=this.stats.hp,this.stats.epMax=this.stats.ep},tutChat:function(e,t,i){var s=this,n=i;setTimeout(function(){s.map&&s.map.entities&&2<=s.mapStatus&&!1===s.tut[n]&&(s.sendPlayer(new l.Notify("TUTORIAL",e)),s.tut[n]=!0)},5e3*t)},handleInventoryEat:function(e,t){var i,e=e.itemKind;this.consumeTime.isOver()&&("health"===(e=ItemTypes.KindData[e]).typemod?(i=e.modifier,this.hasFullHealth()||this.modHealthBy(i)):"healthpercent"===e.typemod&&(i=~~(this.stats.hpMax*e.modifier/100),this.hasFullHealth()||this.modHealthBy(i)),"energy"===e.typemod&&(i=e.modifier,this.hasFullEnergy()||this.modEnergyBy(i)),this.inventory.takeOutItems(t,1))},modHealthBy:function(e){var t;if(!this.isDead)return t=this._super(e),this.sendChangePoints(e,0),t},modEnergyBy:function(e){var t=this._super(e);return this.sendChangePoints(0,e),t},sendChangePoints:function(e,t){this.map.entities.sendNeighbours(this,new l.ChangePoints(this,e,t))},getHPMax:function(){return 300+100*this.stats.health},getEPMax:function(){return 500+100*this.stats.energy},getWeapon:function(){return this.equipment.getWeapon()},getWeaponLevel:function(){var e=this.getWeapon();return e?(e=ItemTypes.KindData[e.itemKind],Types.getWeaponLevel(this.exp[e.type])):0},baseCrit:function(){var e=2*this.level,t=this.getWeapon(),t=(t&&(e=3*ItemTypes.getData(t.itemKind).modifier+2*t.itemNumber),this.stats.attack+2*this.stats.luck),t=Utils.clamp(0,500,~~(t+e));return console.info("player - baseCrit: "+t),t},baseCritDef:function(){var e,t,i=2*this.level;for(e in this.equipment.rooms)4!==e&&(t=this.equipment.rooms[e])&&(i+=3*ItemTypes.getData(t.itemKind).modifier+2*t.itemNumber);var s=this.stats.defense+2*this.stats.luck,s=Utils.clamp(0,500,~~(s+i));return console.info("player - baseCritDef: "+s),s},baseDamage:function(e){var t=this.getWeapon(),i=this.level,s=~~(t?3*ItemTypes.getData(t.itemKind).modifier+2*t.itemNumber:i),n=this.levels.attack/50+1,t=(n*=this.getWeaponLevel()/50+1,t&&(s=~~(s*(t.itemDurability/t.itemDurabilityMax*.5+.5))),this.stats.mod&&this.stats.mod.attack?this.stats.mod.attack:0),t=(s+=~~(3*this.stats.attack+t)+this.stats.luck,~~(i*n*(1+Math.max(0,(12-this.level)*(1/this.level)))*4)),i=~~(1.15*t);return n=Utils.randomRangeInt(t,i)+s,this.stats.mod&&this.stats.mod.damage&&(n+=this.stats.mod.damage),n=e&&e instanceof Mob&&(t=this.getWeaponType())?~~(n*e.data.modDamage[t]):n},baseDamageDef:function(e){var t,i=0,s=this.level+3;for(t in console.info("baseDamageDef:"),i=s,this.equipment.rooms){var n,a=this.equipment.rooms[t];a&&(n=1===t?4:2,i+=~~((ItemTypes.getData(a.itemKind).modifier*n+a.itemNumber*n)*(a.itemDurability/a.itemDurabilityMax*.5+.5)))}console.info("dealt="+i);var o=this.levels.defense/50+1,s=(console.info("power="+o),~~(s*o)),o=~~(2*s),r=(console.info("dealtrange="+i),this.mod?this.stats.mod.defense:0);return i+=~~(4*this.stats.defense+r)+this.stats.luck,console.info("dealtstats="+i),r=Utils.randomRangeInt(s,o)+i,r},modifyGold:function(e,t){return!(this.gold[t=t||0]+e<0||(this.gold[t]+=parseInt(e),this.sendPlayer(new l.Gold(this)),0!==e&&(0<e?this.sendPlayer(new l.Notify("CHAT","GOLD_ADDED",[e])):this.sendPlayer(new l.Notify("CHAT","GOLD_REMOVED",[e*=-1]))),0))},modifyGems:function(e){return e=parseInt(e),this.user.gems-e<0?(this.connection.send(new l.Notify("SHOP","SHOP_NOGEMS").serialize()),!1):(this.user.gems+=e,this.connection.send(new l.Gold(this).serialize()),!0)},saveSection:function(){console.info("SAVING SECTION: "+this.savedSection),6==++this.savedSection&&(console.info("SAVED PLAYER!!!!!: "+this.name),this.savedSection=0)},sendToUserServer:function(e){this.world?this.world.send(e.serialize()):console.warn("Player, sendToUserServer called without world being set. "+JSON.stringify(e))},save:function(e){console.info("Player - save, name:"+this.name),this.worldHandler?this.worldHandler.savePlayer(this,e):console.warn("Player, save called without worldHandler being set. ")},isArcher:function(){var e=this.getWeapon();return!(!e||!ItemTypes.isArcherWeapon(e.itemKind))},setRange:function(){this.setAttackRange(1),this.isArcher()&&this.setAttackRange(10)},setHP:function(e){this._super(e)},setEP:function(e){this._super(e)},movePath:function(e,t){t[0][0],t[0][1],t[t.length-1][0],t[t.length-1][1];var i=e[0],e=e[1];this.idleTimer.restart(),console.info("set path"),this.keyMove&&this.move(this.orientation,0,this.ex,this.ey),this.sx=this.x,this.sy=this.y,this.ex=this.x2,this.ey=this.y2,this.forceStop(),this.path=this.fullpath=t,this.step=0,this.interrupted=e,this.startMovePathTime=i},move:function(e){var t,i,s,n,a;self=this;e&&(n=e[0],a=e[1],t=e[2],i=e[3],s=e[4],console.info("nm:"+JSON.stringify(e)),this.isMovingPath()||(this.idleTimer.restart(),this.moving_callback&&(clearTimeout(this.moving_callback),this.moving_callback=null),3===a?(this.setPosition(i,s),this.forceStop()):(1==a&&(console.warn("delay=0"),this.sx=this.x,this.sy=this.y,this.ex=-1,this.ey=-1,this.startMoveTime=n,console.warn("time:"+n+",now:"+Date.now()+",diff:"+(Date.now()-n)),function(){self.movement.inProgress&&self.forceStop(),self.moving_timeout=null,self.startMoving=!0,self.moveOrientation=t,self.keyMove=!0}(),this.nextMove=null),0===a&&(console.info("move - x: "+i+", y: "+s),this.ex=i,this.ey=s,e=i===this.x&&s===this.y,n=this.sx===i&&this.sy===s,console.info("move: x="+i+",y="+s),console.info("move: this.x="+this.x+",this.y="+this.y),console.info("move: this.sx="+this.sx+",this.sy="+this.sy),e||n?(clearTimeout(this.moving_timeout),this.setPosition(i,s),this.forceStop()):(a=[[this.sx,this.sy],[i,s]],this.map.entities.pathfinder.isValidPath(this.map.grid,a)?this.map.entities.pathfinder.isPathTicksTooFast(this,a,this.startMoveTime)?this.resetMove(this.sx,this.sy):(this.setPosition(i,s),this.forceStopMove(),this.keyMove=!1,this.nextMove=null):(console.warn("INVALID PATH."),console.warn("invalidPath: "+JSON.stringify(a)),this.resetMove(this.x,this.y)))))))},getStoredItem:function(e,t,i){var s,e=this.itemStore[e],n=e.rooms;return t<0||t>=n.length?null:(s=n[t])?(n=n[t].itemNumber,(ItemTypes.isLootItem(s.itemKind)||ItemTypes.isConsumableItem(s.itemKind))&&0<i&&0<n&&n<i?e.takeOutItems(t,n):s):void 0},swapItem:function(e,t){console.info(JSON.stringify(e)),console.info(JSON.stringify(t));var i,s,n,a=this.itemStore[e[0]],o=this.itemStore[t[0]],r=a.rooms[e[1]];r&&(2===t[0]&&r&&(t[1]=o.getItemTypeIndex(r)),s=o.rooms,n=null,r!==(n=0<=t[1]?s[t[1]]:n))&&(n?this.inventory.combineItem(r,n)||o.checkItem(t[1],r)&&a.checkItem(e[1],n)&&(o.setItem(t[1],r),a.setItem(e[1],n)):0<=t[1]?(s=t,n=r,0<(i=e)[2]&&i[2]<n.itemNumber&&ItemTypes.isStackedItem(n.itemKind)?(n.itemNumber-=i[2],a.setItem(i[1],n),(n=Object.assign(new ItemRoom,n)).itemNumber=i[2],o.setItem(s[1],n)):o.setItem(t[1],r)&&a.setItem(e[1],null)):-1!==o.putItem(r)&&a.setItem(e[1],null),e&&2===e[0]&&4===e[1]||t&&2===t[0]&&4===t[1])&&this.broadcastSprites()},broadcastSprites:function(){var e=this.getSprite(0),t=(this.setSprite(0,e),this.getSprite(1));this.setSprite(1,t),this.packetHandler.broadcast(new l.setSprite(this,e,t),!1)},handleStoreEmpty:function(e,t){var i,s=t.itemKind,n=this.itemStore[e[0]],a=e[1],o=e[2];2===e[0]?console.error("handleStoreEmpty - Cannot empty equipment store."):(e=n.rooms[e[1]],i=Object.assign(new ItemRoom,e),t=this.map.entities.createItem(i,this.x,this.y),o=Utils.clamp(1,e.itemNumber,o),ItemTypes.isEquippable(s)?n.makeEmptyItem(a):(t.room.itemNumber=o,n.takeOutItems(a,o)),this.map.entities.sendNeighbours(this,t.spawn()),this.knownIds.push(t.id),this.server.handleItemDespawn(t))},sendCurrentMove:function(){var e=new l.Move(this,this.moveOrientation,0,this.x,this.y);this.map.entities.sendNeighbours(this,e)},dropGold:function(){var e=this.level,e=Math.ceil(Math.random()*e*5+e),e=Math.min(e,this.gold[0]);return this.modifyGold(-e),e},respawn:function(){this.isDead=!1,this.freeze=!1,this.hasEnteredGame=!0,this.resetBars()},setPosition:function(e,t){var i;this._super(e,t),this.holdingBlock&&(e=[[e,t],[e,t-(i=G_TILESIZE)],[e,t+i],[e-i,t],[e+i,t]][this.orientation],this.holdingBlock.setPosition(e[0],e[1]))},isInScreen:function(e){return~~(Math.abs(this.x-e[0])/G_TILESIZE)<=~~(G_SCREEN_WIDTH/2)&&~~(Math.abs(this.y-e[1])/G_TILESIZE)<=~~(G_SCREEN_HEIGHT/2)},hasWeaponType:function(e){var t;return"any"===(e=e||"any")||!!(t=this.equipment.getWeapon())&&(e?this.getWeaponType()===e:ItemTypes.isHarvestWeapon(t.itemKind))},getWeaponType:function(){var e=this.equipment.getWeapon();return e?ItemTypes.getType(e.itemKind):null},setSprite:function(e,t){0===e?this.isArcher()?this.sprites[2]=t:this.sprites[0]=t:1===e&&(this.isArcher()?this.sprites[3]=t:this.sprites[1]=t)},getSprite:function(e){var t;return 1===e?(t=this.equipment.getWeapon())?ItemTypes.getSpriteCode(t.itemKind):this.isArcher()?50:0:0===e?this.isArcher()?this.sprites[2]:this.sprites[0]:void 0},_harvest:function(t,i,s,e){var n,a,o,r,c=this;c._checkHarvest(t,i)?(n=c.x,a=c.y,o=c.getWeaponType(),c.isHarvesting=!0,r=this.exp.logging,"hammer"===o&&(r=this.exp.mining),e=~~(e*Utils.clamp(.1,1,1-Types.getSkillLevel(r)/20)),clearTimeout(c.harvestTimeout),c.harvestTimeout=setTimeout(function(){var e=!0;c.isHarvesting||(e=!1),c.x===n&&c.y===a||(e=!1),(e=!!c.hasWeaponType(o)&&e)?(s&&s(c),c.map.entities.sendNeighbours(c,new l.Harvest(c,2,t,i))):c._abortHarvest(t,i)},e),c.map.entities.sendNeighbours(c,new l.Harvest(c,1,t,i),c),c.sendPlayer(new l.Harvest(c,1,t,i,e))):c._abortHarvest(t,i)},_checkHarvest:function(e,t){return!!this.isNextTooPosition(e,t)&&!!this.hasWeaponType()},onHarvestEntity:function(i){var e=!0,s=i.weaponType,n=(this.hasWeaponType(s)||(this.sendPlayer(new l.Notify("CHAT","HARVEST_WRONG_TYPE",s)),e=!1),i.x),a=i.y;e?this._harvest(n,a,function(e){e.server.taskHandler.processEvent(e,PlayerEvent(EventType.USE_NODE,i,1)),"hammer"===s&&(e.exp.mining+=10),i.die();var t=e.world.loot.getDrop(e,i,!1);t&&t instanceof Item&&(t.x=n,t.y=a,e.world.loot.handleItemDespawn(t))},5e3+1e3*i.level):this._abortHarvest(n,a)},_abortHarvest:function(e,t){this.map.entities.sendNeighbours(this,new l.Harvest(this,2,e,t)),this.sendPlayer(new l.Notify("CHAT","HARVEST_INVALID"))},onHarvest:function(e,t){var i=Utils.getGridPosition(e,t),s=(time=this.map.entities.harvest[i.gx+"_"+i.gy],!0),n=this.getWeaponType();n||(s=!1),this.map.isHarvestTile(i,n)||(this.sendPlayer(new l.Notify("CHAT","HARVEST_WRONG_TYPE",n)),s=!1),(s=!(time&&Date.now()-time<6e4)&&s)?this._harvest(e,t,function(e){var t;e.server.taskHandler.processEvent(e,PlayerEvent(EventType.HARVEST,e,1)),"axe"===e.getWeaponType()&&(e.exp.logging+=10),e.map.entities.harvest[i.gx+"_"+i.gy]=Date.now(),e.inventory.hasRoom()&&("axe"===e.getWeaponType()&&(t=320),t=new ItemRoom([t,1,0,0]),-1!==self.inventory.putItem(t))&&(t=ItemTypes.getData(t.itemKind),e.sendPlayer(new l.Notify("CHAT","HARVEST_ADDED",t.name)))},6e3):this._abortHarvest(e,t)},resetMove:function(e,t){this.fixMove(e,t),this.sendCurrentMove()},fixMove:function(e,t){this.forceStop(),this.setPosition(e,t),this.sx=e,this.sy=t,this.ex=-1,this.ey=-1},sendPlayer:function(e){this.map.entities.sendToPlayer(this,e)},sendToPlayer:function(e,t){this.map.entities.sendToPlayer(e,t)},onKilled:function(e){this.on_killed_callback=e},onTeleport:function(e){this.on_teleport_callback=e},handleTeleport:function(){this.on_teleport_callback&&this.on_teleport_callback()},hasMoveThrottled:function(e){return Date.now()-this.lastMoveThrottle<e||(this.lastMoveThrottle=Date.now(),!1)},getXP:function(){return 20*this.level},setMap:function(e){this.map.entities.removeSpatial(this),this.packetHandler.setMap(e),this.map=e}})},{"../effecthandler":23,"../formulas":36,"../items/bank":37,"../items/equipment":39,"../items/inventory":40,"../message":49,"../packets/packethandler":51,"../playerquests":56,"../quest":58,"../skillhandler":59,"./character":24}],34:[function(e,t,i){var r=e("./quest"),c=e("./message");t.exports=EntityQuests=cls.Class.extend({init:function(e){this.entity=e,this.questsCount=0,this.quests={}},acceptQuest:function(e,t){var i;this.quests.hasOwnProperty(t)&&(i=this.quests[t],(pQuest=e.quests.getQuestById(parseInt(t)))&&pQuest.status<QuestStatus.COMPLETE?(pQuest.status=QuestStatus.INPROGRESS,e.quests.progressQuest(pQuest)):((pQuest=Object.assign(new r,i)).data=i.data,e.quests.foundQuest(pQuest)))},rejectQuest:function(e,t){},giveReward:function(e,t){var i=e.quests.completeQuests[t.id];if(!i)return!1;if(i.hasOwnProperty("reward"))return!1;var s=e.inventory.hasRoomCount();if(0<t.reward.length&&s<t.reward.length)return e.sendPlayer(new c.Notify("INVENTORY","INVENTORY_FULL")),!1;var n,a=new c.Dialogue(this.entity,"QUESTS_REWARD",[this.entity.name]);e.sendPlayer(a),0<t.gold&&e.modifyGold(parseInt(t.gold));for(n of t.reward){var o=new ItemRoom([parseInt(n.itemKind),parseInt(n.itemNumber)||1,parseInt(n.itemDurability)||null,parseInt(n.itemDurabilityMax)||null,parseInt(n.itemExperience)||0]),a=(e.inventory.putItem(o),new c.Notify("CHAT","ITEM_ADDED",[ItemData.Kinds[o.itemKind].name]));e.sendPlayer(a)}return i.reward=1,!0},hasQuest:function(e){for(var t of e.quests.quests)if(this.entity.npcQuestId===t.npcQuestId)return e.quests.progressQuest(t),!0;for(var i in this.quests){t=this.quests[i];if(e.quests.hasNpcCompleteQuest(t.npcQuestId)&&this.giveReward(e,t))return!0}return!1},getNextQuestId:function(e){for(var t in this.quests)if(!e.quests.completeQuests[t]){var i=e.quests.getQuestById(t);if(!i)return t}return null},sendNoQuest:function(e){var t=this.entity,t=new c.Dialogue(t,"QUESTS_NONE",[t.nextNpcDir,t.nextNpcName,t.name]);e.sendPlayer(t)},dynamicQuests:function(e){this.hasQuest(e)||this.createQuest(e)},getMobObject:function(){var e=self.map.entities.getMobsAround(this.entity,35);if(0!==e.length){var t=Utils.GetGroupCountArray(e,"kind");if(console.warn("entitycount="+JSON.stringify(t)),0===t.length)return null;log.info("entitycount="+JSON.stringify(t)),t.sort(function(e,t){return t[1]-e[1]}),log.info("entitycount="+JSON.stringify(t));var i=parseInt(t[0][0]),e=e.filter(function(e){return e.kind===i}),e=Utils.minProp(e,"level").level,t=parseInt(t[0][1]);return t<=0?null:MobData.Kinds[i]?getQuestObject([Types.EntityTypes.MOB,i,t,0,e,100]):null}},createQuest:function(e){var t=[1,2],t=t[Utils.randomInt(t.length-1)];e.level;t===QuestType.GETITEMKIND&&this.createQuestItemKind(e),t===QuestType.KILLMOBKIND&&this.createQuestKillMobKind(e)},createQuestItemKind:function(e){console.info("GETITEMKIND");var t,i,s,n=Utils.randomInt(ItemLootData.ItemLoot.length-1),a="02"+Utils.pad(this.entity.kind,6)+Utils.pad(this.questsCount++,4),o=e.quests.getQuestById(a);o?(o.status=QuestStatus.INPROGRESS,e.quests.questAboutItem(o)):(t=this.getMobObject())&&(t.count=0,s=30*(i=Utils.randomRangeInt(1,5))/(e.level+2),n=getQuestObject([Types.EntityTypes.ITEMLOOT,n,i,s]),o=new r([a,QuestType.GETITEMKIND,this.entity.npcQuestId,0,0,0,0,t,n]),e.quests.foundQuest(o))},createQuestKillMobKind:function(e){console.info("KILLMOBKIND");var t,i,s="01"+Utils.pad(this.entity.kind,6)+Utils.pad(this.questsCount++,4),n=e.quests.getQuestById(s);n?(n.status=QuestStatus.INPROGRESS,e.quests.progressQuest(n)):(t=this.getMobObject())&&(i=Math.max(e.level-10,10),t.count=Utils.clamp(5,i,t.count/2),t.count=5*Math.ceil(t.count/5),n=new r([s,QuestType.KILLMOBKIND,this.entity.npcQuestId,0,0,0,0,t]),e.quests.foundQuest(n))}})},{"./message":49,"./quest":58}],35:[function(e,t,i){function o(e,t){return!(("n"!==e||!s.isNumber(Number(t)))&&("s"!==e||!s.isString(t))&&("no"!==e||!s.isNull(t)&&!s.isNumber(Number(t)))&&("so"!==e||!s.isNull(t)&&!s.isString(t))&&("array"!==e||!Array.isArray(t))&&("object"!==e||"object"!=typeof t)&&(console.info("isType not type or invalid."),console.info("fmt:"+e),console.info("msg:"+JSON.stringify(t)),1))}var s=e("underscore"),n=16384,a=99999,r=173e10,c=18e11;e=new(FormatChecker=Class.extend({init:function(){this.formats={},this.formats[Types.Messages.BI_SYNCTIME]=[["n",r,c]],this.formats[Types.Messages.CW_CREATE_USER]=[["s",2,16],["s",120,120]],this.formats[Types.Messages.CW_LOGIN_USER]=[["s",2,16],["s",120,120]],this.formats[Types.Messages.CW_REMOVE_USER]=[["s",2,16],["s",120,120]],this.formats[Types.Messages.CW_CREATE_PLAYER]=[["n",0,20],["s",2,16]],this.formats[Types.Messages.CW_LOGIN_PLAYER]=[["s",2,16],["s",0,128]],this.formats[Types.Messages.CW_APPEARANCEUNLOCK]=[["n",0,177],["n",0,99999]],this.formats[Types.Messages.CW_ATTACK]=[["n",r,c],["n",0,a],["n",0,4],["n",-1,50]],this.formats[Types.Messages.CW_AUCTIONBUY]=[["n",0,9999],["n",0,3]],this.formats[Types.Messages.CW_AUCTIONDELETE]=[["n",0,9999],["n",0,3]],this.formats[Types.Messages.CW_AUCTIONOPEN]=[["n",0,3]],this.formats[Types.Messages.CW_AUCTIONSELL]=[["n",0,50],["n",0,99999999]],this.formats[Types.Messages.CW_BANKRETRIEVE]=[["n",0,96]],this.formats[Types.Messages.CW_BANKSTORE]=[["n",0,50]],this.formats[Types.Messages.CW_CHAT]=[["s",1,256]],this.formats[Types.Messages.CW_COLOR_TINT]=[["n",0,1],["s",6,6]],this.formats[Types.Messages.CW_BLOCK_MODIFY]=[["n",0,1],["n",0,a],["n",0,n],["n",0,n]],this.formats[Types.Messages.CW_LOOKUPDATE]=[["n",0,1],["n",0,999]],this.formats[Types.Messages.CW_LOOT]=[["n",0,a],["n",0,n],["n",0,n]],this.formats[Types.Messages.CW_MOVE]=[["n",r,c],["n",0,a],["n",0,2],["n",0,4],["n",0,n],["n",0,n]],this.formats[Types.Messages.CW_GOLD]=[["n",0,1],["n",0,999999999],["n",0,1]],this.formats[Types.Messages.CW_STATADD]=[["n",1,5],["n",1,1]],this.formats[Types.Messages.CW_STOREBUY]=[["n",1,3],["n",0,999],["n",0,100]],this.formats[Types.Messages.CW_CRAFT]=[["n",0,99],["n",0,100]],this.formats[Types.Messages.CW_STORE_MODITEM]=[["n",0,2],["n",0,2],["n",0,50]],this.formats[Types.Messages.CW_STORESELL]=[["n",0,2],["n",0,50]],this.formats[Types.Messages.CW_TALKTONPC]=[["n",5,6],["n",0,a]],this.formats[Types.Messages.CW_TELEPORT_MAP]=[["n",0,3],["n",0,1],["n",-1,n],["n",-1,n]],this.formats[Types.Messages.CW_SKILL]=[["n",0,50],["n",0,a]],this.formats[Types.Messages.CW_SHORTCUT]=[["n",0,7],["n",0,2],["n",0,999]],this.formats[Types.Messages.CW_PARTY]=[["n",0,4],["so",0,6],["no",0,3]],this.formats[Types.Messages.CW_HARVEST]=[["n",0,n],["n",0,n]],this.formats[Types.Messages.CW_USE_NODE]=[["n",0,a]],this.formats[Types.Messages.CW_QUEST]=[["n",0,a],["n",0,999999999999999],["n",0,9]],this.formats[Types.Messages.CW_MOVEPATH]=[["n",r,c],["n",0,a],["n",0,4],["n",0,1],["array",2,16,[["n",0,n],["n",0,n]]]],this.formats[Types.Messages.CW_WHO]=[["array",0,999,[["n",0,a]]]],this.formats[Types.Messages.CW_REQUEST]=[["n",0,3]]},checkFormatData:function(e,t){var i=Array.isArray(e)?e[0]:e;if(i=i,n=t,!(Array.isArray(i)?!!o(i[0],n)&&("no"===i[0]||"so"===i[0]||"n"===i[0]&&n>=i[1]&&n<=i[2]||"s"===i[0]&&n.length>=i[1]&&n.length<=i[2]||"array"===i[0]&&n.length>=i[1]&&n.length<=i[2]||"object"===i[0]&&Object.keys(n).length>=i[1]&&Object.keys(n).length<=i[2]||void 0):o(i,n)))return console.info("isType not type or invalid."),!1;i="array"===e[0];if(i&&(console.info("format is Array and in length."),e[3]))for(var s=0;s<t.length;++s)if(!this.checkFormat(e[3],[t[s]],!0))return!1;var n="object"===e[0];if(n&&(console.info("format is Object and in keys range."),e[3]))for(var a in t[s])if(!this.checkFormat(e[3],t[s][a]))return!1;return!0},checkFormat:function(e,t,i){i=i||!1;if(e){if(console.info("message:"+t),console.info("format:"+e),!i&&t.length!==e.length)return console.info("checkFormat - length incorrect. fmt:"+JSON.stringify(t)+", msg:"+JSON.stringify(e)),!1;i=(Array.isArray(e[0])?e[0]:e)[0];if("array"===i&&Array.isArray(t)&&0===t.length)return!Array.isArray(i)||0===i[1];if("object"===i&&"object"==typeof t&&0===Object.keys(t).length)return!Array.isArray(i)||0===i[1];for(var s=0,n=e.length;s<n;s+=1)if(!this.checkFormatData(e[s],t[s]))return!1;return!0}return console.error("Unknown message type. "),console.warn("message: "+JSON.stringify(t)),console.warn("format: "+JSON.stringify(e)),!1},check:function(e){console.info("msg:"+JSON.stringify(e));var t=e.slice(0),i=t.shift(),s=this.formats[i];if(console.info("msg: "+JSON.stringify(t)),console.info("type: "+i),s)return console.info("checkFormat type:"+i),this.checkFormat(s,t,!0);if(i===Types.Messages.CW_ITEMSLOT)return console.info("type CW_ITEMSLOT"),s=[["n",0,2],["n",0,2],["n",-1,this.inventoryMax],["n",0,this.itemCountMax]],7===t.len&&(s=s.concat([["no",0,2],["no",-1,this.inventoryMax],["no",0,this.itemCountMax]])),this.checkFormat(s,t,!0);try{throw new Error}catch(e){console.info(e.stack)}return console.error("Unknown message type: "+i),console.warn("msg="+JSON.stringify(e)),!1}})),i.check=e.check.bind(e)},{underscore:310}],36:[function(e,t,i){var a={crit:function(e,t){return Utils.randomRangeInt(0,200)<=Utils.clamp(5,195,~~(25+e.baseCrit()-t.baseCritDef()))},getAttackPower:function(e){var t=1;return e.attackTimer&&(e=Date.now()-e.attackTimer,t=~~(Utils.clamp(ATTACK_INTERVAL,ATTACK_MAX,e)/ATTACK_INTERVAL)),t},dmgAOE:function(e){var t=a.getAttackPower(e),i=~~(e.baseDamage()/2),i=(console.info("attacker baseDamage="+i),~~(i*t));return e instanceof Player&&0<i&&e.incAttackExp(i),~~i},dmg:function(e,t){var i=a.getAttackPower(e),s=e.baseDamage(t),n=t.baseDamageDef(e);console.info("attacker baseDamage="+s),console.info("defender baseDamageDef="+n);s=~~((s=~~(s*i))-~~(n*(2/3*Math.pow(1.5,i))));return e instanceof Mob&&(s=~~Math.pow(s,.9)),s=Utils.clamp(1,5e3,s),e instanceof Player&&0<s&&e.incAttackExp(s),t instanceof Player&&0<s&&t.incDefenseExp(s),~~s},pickPocket:function(e,t,i){return t.level-e.level+~~Utils.randomRange(0,100)<=i},mindControl:function(e,t){return t.level<=e.level&&0==~~Utils.randomRange(0,~~(50*t.level/e.level))},hp:function(e){return 100+40*e},energy:function(e){return 100+30*e},getExpArray:function(){}};void 0!==i&&(t.exports=a)},{}],37:[function(e,t,i){var s=e("./itemroomstore"),n=e("../message");t.exports=Bank=s.extend({init:function(e,t,i){this._super(e,t,i),this.typeIndex=1,this.maxNumber=96,this.fullMessage=new n.Notify("BANK","BANK_FULL")}})},{"../message":49,"./itemroomstore":42}],38:[function(e,t,i){e=e("../lib/class");t.exports=BaseItem=e.Class.extend({init:function(e){Array.isArray(e)&&this.set(e)},assign:function(e){this.set([Number(e.itemKind),Number(e.itemNumber),Number(e.itemDurability),Number(e.itemDurabilityMax),Number(e.itemExperience)])},set:function(e){var t=Number(e[0]);this.itemKind=t,this.itemNumber=Number(e[1]),this.itemDurability=e[2]?Number(e[2]):ItemTypes.isConsumableItem(t)||ItemTypes.isCraftItem(t)?0:900,this.itemDurabilityMax=e[3]?Number(e[3]):ItemTypes.isConsumableItem(t)||ItemTypes.isCraftItem(t)?0:900,this.itemExperience=Number(e[4])||0},addNumber:function(e){this.itemNumber+=Number(e)},save:function(){return this.toArray().join(",")},toArray:function(){return[this.itemKind,this.itemNumber,this.itemDurability,this.itemDurabilityMax,this.itemExperience]}})},{"../lib/class":44}],39:[function(e,t,i){e("./itemroom");var s=e("../message");t.exports=Equipment=cls.Class.extend({init:function(e,t,i){if(this.owner=e,this.number=t,this.maxNumber=5,this.weaponSlot=4,this.rooms={},console.info("number="+t),console.info("itemSlots="+JSON.stringify(i)),i)for(var s=0;s<i.length;s++){var n=i[s].slot;this.rooms[n]=i[s]}},makeEmptyItem:function(e){this.rooms[e]=null,delete this.rooms[e],this.setItem(e,null)},getItemIndex:function(e){for(var t in this.rooms)if(this.rooms[t]&&this.rooms[t].itemKind===e)return t;return-1},putItem:function(e){return-1},combineItem:function(e,t){return!1},checkItem:function(e,t){var i,s;return!(t&&(i=t.itemKind,s=ItemData.Kinds[i],!ItemTypes.isEquipment(i)||!(0!=e||"helm"===s.type&&this.canEquip(t,s.level))||!((1!=e||"chest"===s.type&&this.canEquip(t,s.level))&&(2!=e||"gloves"===s.type&&this.canEquip(t,s.level))&&(3!=e||"boots"===s.type&&this.canEquip(t,s.level))&&(4!=e||ItemTypes.isWeapon(i)&&this.canEquip(t,ItemTypes.getWeaponLevel(i))))))},setItem:function(e,t){this._setItem(e,t)},getItemTypeIndex:function(e){if(e){var e=e.itemKind,t=ItemData.Kinds[e];if("helm"===t.type)return 0;if("chest"===t.type)return 1;if("gloves"===t.type)return 2;if("boots"===t.type)return 3;if(ItemTypes.isWeapon(e))return 4}return-1},_setItem:function(e,t){if(t&&this.rooms[e]===t)return!1;var i=this.owner;if(t){if(!this.checkItem(e,t))return!1;(this.rooms[e]=t).slot=e}else this.rooms[e]=null,t={slot:e,itemKind:-1};return i.sendPlayer(new s.ItemSlot(2,[t])),!0},canEquip:function(e,t){var i=this.owner;e.itemKind;return!(t>i.level&&(i.sendPlayer(new s.Notify("EQUIP","EQUIPMENT_LEVEL",[t])),1))},save:function(){},degradeItem:function(e,t){var i=this.rooms[e];if(i)return i.itemDurability-=t,i.itemDurability=Math.max(0,i.itemDurability),0===i.itemDurability&&i.itemDurabilityMax<=30?(this.makeEmptyEquipment(e),!1):(this.owner.sendPlayer(new s.ItemSlot(2,[i])),!0)},addExperience:function(e,t){var i=this.rooms[e];i&&(i.itemExperience+=t,i.itemNumber<ItemTypes.getItemLevel(i.itemExperience)&&(i.itemNumber++,this.owner.sendPlayer(new s.ItemLevelUp(e,i))),i.slot=e,this.owner.sendPlayer(new s.ItemSlot(2,[i])))},toString:function(){var e=0,t=this.maxNumber+",";for(e in this.rooms){var i=this.rooms[e];i&&(t+=i.toArray().join(","))}return t},toStringJSON:function(){for(var e="[",t=!1,i=0;i<this.maxNumber;i++){var s=this.rooms[i];s&&(e+="["+s.toArray().join(",")+"],",t=!0)}return e=e.slice(0,-1),e+="]",t?e:"[]"},getWeapon:function(){return this.rooms[4]},getArmor:function(){return this.rooms[1]}})},{"../message":49,"./itemroom":41}],40:[function(e,t,i){var s=e("./itemroomstore"),n=e("../message");t.exports=Inventory=s.extend({init:function(e,t,i){this._super(e,t,i),this.typeIndex=0,this.maxNumber=50,this.fullMessage=new n.Notify("INVENTORY","INVENTORY_FULL")}})},{"../message":49,"./itemroomstore":42}],41:[function(e,t,i){e=e("./baseitem");t.exports=ItemRoom=e.extend({init:function(e){this.slot=-1,this._super(e)},toRedis:function(){return this.toArray().join(",")},toArray:function(){return[parseInt(this.slot)].concat(this._super())},toArrayNoSlot:function(){var e=this.toArray();return e.shift(),e}})},{"./baseitem":38}],42:[function(e,t,s){var n=e("../lib/class"),a=(e("./itemroom"),e("../message"));t.exports=ItemStore=n.Class.extend({init:function(e,t,i){if(this.owner=e,this.number=t,this.typeIndex=0,this.maxNumber=50,this.maxStack=100,this.fullMessage=new a.Notify("ITEMSTORE","ITEMSTORE_FULL"),this.rooms={},console.info("number="+t),i)for(var s=0;s<i.length;s++)this.rooms[i[s].slot]=i[s]},hasItem:function(e){return this.hasItems(e,1)},hasItems:function(e,t){var i,s=0;for(i in this.rooms)if(this.rooms[i]&&this.rooms[i].itemKind===e&&t<=(s+=this.rooms[i].itemNumber))return!0;return!1},hasItemCount:function(e){var t,i=0;for(t in this.rooms)this.rooms[t]&&this.rooms[t].itemKind===e&&(i+=this.rooms[t].itemNumber);return i},hasRoomCount:function(e,t){return t=t||this.maxNumber,this.maxNumber-Object.keys(this.rooms).length},hasRoom:function(e,t){return t=t||this.maxNumber,Object.keys(this.rooms).length<this.maxNumber},makeEmptyItem:function(e){this.rooms[e]=null,delete this.rooms[e],this.setItem(e,null)},getItemCount:function(e){for(var t in this.rooms)if(this.rooms[t]&&this.rooms[t].itemKind===e)return this.rooms[t].itemNumber;return 0},getItemIndex:function(e){for(var t in this.rooms)if(this.rooms[t]&&this.rooms[t].itemKind===e)return t;return-1},getEmptyIndex:function(e,t){t=t||this.maxNumber;for(var i=e=e||0;i<t;i++)if(!this.rooms[i])return i;return-1},putItem:function(e){var t=e.itemKind,i=ItemTypes.isConsumableItem(t),s=ItemTypes.isLootItem(t),t=ItemTypes.isCraftItem(t);if(i||s||t)for(var n in this.rooms)if(this.combineItem(e,this.rooms[n]))return n;return this._putItem(e)},combineItem:function(e,t){var i,s,n,a;return console.info(JSON.stringify(e)),console.info(JSON.stringify(t)),!(!e||!t||e.itemKind!==t.itemKind||ItemTypes.isEquippable(e.itemKind)||ItemTypes.isEquippable(t.itemKind)||e.itemNumber===this.maxStack||t.itemNumber===this.maxStack)&&(i=!1,s=e.slot,n=t.slot,a=this.maxStack,t.itemNumber<a&&(t.itemNumber+=e.itemNumber,a<t.itemNumber?(e.itemNumber=t.itemNumber-a,t.itemNumber=Math.min(t.itemNumber,a),-1===e.slot&&(s=this.getEmptyIndex())):e=null,i=!0),t.itemNumber<=0&&(t=null),this.setItem(s,e),this.setItem(n,t),i)},_putItem:function(e){return(i=this.getEmptyIndex())<0?(this.owner instanceof Player&&this.owner.sendPlayer(this.fullMessage),-1):(this.setItem(i,e),i)},checkItem:function(e,t){return t},setItem:function(e,t){if(t){if(!this.checkItem(e,t))return!1;(this.rooms[e]=t).slot=e}else this.rooms[e]=null,t={slot:e,itemKind:-1};return this.owner.sendPlayer(new a.ItemSlot(this.typeIndex,[t])),!0},save:function(){},removeItemKind:function(e,t){var i,s=t;for(i in this.rooms){var n=this.rooms[i];if(n&&n.itemKind===e){if(n.itemNumber>s)return n.itemNumber-=s,this.setItem(i,n),!0;s-=n.itemNumber,this.setItem(i,n=null)}}return!1},takeOutItems:function(e,t){var i=this.rooms[e];return!i||t>i.itemNumber?null:(ItemTypes.isEquippable(i.itemKind)?this.setItem(e,null):(i.itemNumber-=t,0===i.itemNumber&&(i=null),this.setItem(e,i)),i)},getRandomItemNumber:function(){var e,t,i=[];for(t in this.rooms)(e=this.rooms[t])&&0<e.itemKind&&i.push(id);var s=Utils.randomRange(0,i.length-1);return 0<i.length?i[s]:-1},toString:function(){var e=0,t=this.maxNumber+",";for(e in this.rooms){var i=this.rooms[e];i&&(t+=i.toArray().join(","))}return t},toStringJSON:function(){var e,t=null,i=[];for(e in this.rooms)(t=this.rooms[e])&&i.push(t.toArray());return JSON.stringify(i)}})},{"../lib/class":44,"../message":49,"./itemroom":41}],43:[function(e,t,i){var z;e(".././utils");function K(e,t,i,s,n,a,o,r,c,l,p,u,d){return e&&(i&&!c[n][o]&&(u[d++]={x:o,y:n}),s)&&!c[n][r]&&(u[d++]={x:r,y:n}),t&&(i&&!c[a][o]&&(u[d++]={x:o,y:a}),s)&&!c[a][r]&&(u[d++]={x:r,y:a}),u}function V(e,t,i,s,n,a,o,r,c,l,p,u,d){return e=-1<n,t=a<l,s=-1<r,o<p&&(e&&!c[n][o]&&(u[d++]={x:o,y:n}),t)&&!c[a][o]&&(u[d++]={x:o,y:a}),s&&(e&&!c[n][r]&&(u[d++]={x:r,y:n}),t)&&!c[a][r]&&(u[d++]={x:r,y:a}),u}function Y(e,t,i,s,n,a,o,r,c,l,p,u,d){return u}function $(e){return z[~~e[0]][~~e[1]]}function Q(e,t,i,s){return s(i(e.x-t.x),i(e.y-t.y))}function X(e,t,i,s){var n=e.x-t.x,e=e.y-t.y;return s(n*n+e*e)}function J(e,t,i,s){return i(e.x-t.x)+i(e.y-t.y)}return t.exports=AStar=(z=null,{AStar:function(e,t,i,s){var n,a,o,r,c,l,p,u,d,h,m,j,f,D,v,y,g,b,x,w,E,_,k,T,S,A,O=(z=e)[0].length,B=e.length,U=O*B,q=Math.abs,C=Math.max,F={},I=[],P=[{x:~~t[0],y:~~t[1],f:0,g:0,v:t[0]+t[1]*O}],R=1,H={x:~~i[0],y:~~i[1],v:~~i[0]+~~i[1]*O};switch(s){case"Diagonal":a=K;case"DiagonalFree":n=Q;break;case"Euclidean":a=K;case"EuclideanFree":C=Math.sqrt,n=X;break;default:n=J,a=Y}a=a||V;do{for(r=U,M=c=0;M<R;++M)(s=P[M].f)<r&&(r=s,c=M);if((l=P.splice(c,1)[0]).v!==H.v)for(--R,j=a,N=l.x,f=l.y,D=e,v=B,y=O,A=S=T=k=_=E=w=x=b=g=void 0,g=(f=.5+~~f)-1,b=f+1,x=(N=.5+~~N)+1,w=N-1,E=0<g&&!$([g,N]),_=b<v&&!$([b,N]),k=x<y&&!$([f,x]),T=0<w&&!$([f,w]),S=[],A=0,E&&(S[A++]={x:N,y:g}),k&&(S[A++]={x:x,y:f}),_&&(S[A++]={x:N,y:b}),T&&(S[A++]={x:w,y:f}),M=0,o=(p=j(E,_,k,T,g,b,x,w,D,v,y,S,A)).length;M<o;++M)(d=p[M]).p=l,d.f=d.g=0,d.v=~~d.x+~~d.y*O,d.v in F||(u=0,l&&(d.dir=(m=l,(h=d).x<m.x?1:m.x<h.x?2:h.y<m.y?3:m.y<h.y?4:0),void 0!==l.dir)&&l.dir!=d.dir&&(u=10),d.g=l.g+n(d,l,q,C)+u,d.f=d.g+n(d,H,q,C),F[(P[R++]=d).v]=1);else{for(M=R=0;I[M++]=[l.x,l.y],l=l.p;);var N=function(e,t){t.shift(),t.unshift([e[0],e[1]]);var i,s=null;for(i of t){if(s)if(~~s[0]==~~i[0])i[0]=s[0];else{if(~~s[1]!=~~i[1])break;i[1]=s[1]}s=i}};N(i,I),I.reverse(),N(t,I)}}while(R);if(2<I.length)for(var M=2;M<I.length;++M){var L=I[M-2],W=I[M],G=Math.abs(L[0]-W[0]),L=Math.abs(L[1]-W[1]);(0<G&&0===L||0===G&&0<L)&&I.splice(--M,1)}return I}}),AStar},{".././utils":66}],44:[function(e,t,i){var s=!1,a=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;(Class=function(){}).extend=function(e){var t,n=this.prototype,i=(s=!0,new this);for(t in s=!1,e)i[t]="function"==typeof e[t]&&"function"==typeof n[t]&&a.test(e[t])?((i,s)=>function(){var e=this._super,t=(this._super=n[i],s.apply(this,arguments));return this._super=e,t})(t,e[t]):e[t];return(Class=function(){!s&&this.init&&this.init.apply(this,arguments)}).prototype=i,(Class.constructor=Class).extend=arguments.callee,Class},void 0!==i&&(i.Class=Class)},{}],45:[function(g,a,e){!function(n){!function(){g("./common"),g("./data/data");var r=g("log"),t=g("fs"),c=g("util"),l=g("crypto"),p=(g("bison"),g("./ws")),u=g("./productionconfig"),d=g("./user/userhandler"),h=g("./user/worldhandler"),m=(g("./user/usermessage"),g("underscore")),f=g("readline").createInterface({input:process.stdin,output:process.stdout}),v=(G_LATENCY=75,G_ROUNDTRIP=2*G_LATENCY,G_TILESIZE=16,G_FRAME_INTERVALS=2,G_FRAME_INTERVAL_EXACT=1e3/60,G_FRAME_INTERVAL=~~G_FRAME_INTERVAL_EXACT,G_UPDATE_INTERVAL=~~(G_FRAME_INTERVAL*G_FRAME_INTERVALS),G_INTERVAL=G_UPDATE_INTERVAL*G_FRAME_INTERVALS,G_SPATIAL_SIZE=32,G_SCREEN_WIDTH=34,G_SCREEN_HEIGHT=18,ATTACK_INTERVAL=1e3,ATTACK_MAX=3e3,PLAYER_SAVE_INTERVAL=18e5,mobState={IDLE:1,ROAMING:2,AGGRO:3,CHASING:4,ATTACKING:5,RETURNING:6,STUCK:7},SAVING_SERVER=!1,AUCTION_SAVED=!1,PLAYERS_SAVED=!1,LOOKS_SAVED=!1,IS_EXITING=!1,null);server=null,world=null,users={},hashes={},userHandlerPackets=[],a.exports={},t.createWriteStream(n+"/../console.log",{flags:"w"}),process.stdout;function y(s){log=new r(r.INFO||r.DEBUG||r.ERROR),console.isEnabled=!0,Object.defineProperty(log,"log",{value:void 0,writable:!0,enumerable:!0}),Object.defineProperty(log,"info",{value:void 0,writable:!0,enumerable:!0}),Object.defineProperty(log,"warn",{value:void 0,writable:!0,enumerable:!0}),Object.defineProperty(log,"error",{value:void 0,writable:!0,enumerable:!0});function e(){y.closeServer()}log.log=function(e){e="LOG: "+c.format(e)+"\n";console.info(e)},log.info=function(e){e="INFO: "+c.format(e)+"\n";console.info(e)},log.warn=function(e){e="WARN: "+c.format(e)+"\n";console.warn(e)},log.error=function(e){e="ERROR: "+c.format(e)+"\n";console.error(e)};var t=new u(s),t=(t.inProduction()&&m.extend(s,t.getProductionSettings()),s.world_id),n=(MainConfig=s,g("./ws")),a=g("./worldserver"),o=(server=new n.WebsocketServer(s),console.info("Initializing RRO2 GameServer - World "+t),(world=new a("world"+i,s.nb_players_per_world,server)).run(),world.name=s.world_name,server.onStart(function(t){var e;console.info("server - onInit called."),t.userConn||(t.userConn=new p.userConnection(99999,t.userConn,t),e=s.protocol+"://"+s.user_address+":"+s.user_port,t.userConn.connect(e)),t.userConn.onConnectUser(function(e){gConnection=e,console.info("onConnectUser - Connected"),this.send([GameTypes.UserMessages.WU_CONNECT_WORLD]),console.info("server.enterWorld"),v=new d(y,t,world,e),t.userHandler=v,(world.userHandler=v).sendWorldInfo(s)})}),server.start(),server.onConnect(function(e){var t=(new Date).valueOf().toString(),i=Math.random().toString(),t=l.createHash("sha1").update(t+i).digest("hex"),i=(e.hash=t,console.warn("onConnect: hash="+t),console.info(JSON.stringify(s)),console.info("version sent"),console.info(GameTypes.Messages.WC_VERSION),e.sendUTF8(GameTypes.Messages.WC_VERSION+","+s.version+","+e.hash),new h(server,e));i.userConnection=server.userHandler.connection,e.worldHandler=i}),server.enterWorld=function(e){console.info("server.enterWorld")},server.onError(function(){console.error(Array.prototype.join.call(arguments,", "))}),server.onRequestStatus(function(){return JSON.stringify((e=worlds,t=[],m.each(e,function(e){t.push(e.playerCount)}),t));var e,t}),process.on("uncaughtException",function(e){console.info(JSON.stringify(e)),console.error("uncaughtException: "+e.stack)}),server._ioServer.on("connection",e=>{console.log("connected")}),server._ioServer.on("disconnect",function(){console.log("disconnected")}),server._ioServer.on("msg",e=>{console.log("msg="+JSON.stringify(e))}),process.on("SIGINT",e),process.on("SIGTERM",e),process.on("SIGQUIT",e),process.on("SIGHUP",e),function(){"win32"===process.platform&&f.on("SIGINT",function(){process.emit("SIGINT")}),!IS_EXITING&&f&&f.question("Command:",function(e){switch(args=e.split(" "),cmdarg=args[0],args.shift(),console.info("cmd: "+e),cmdarg){case"notify":case"say":case"announce":(e=>{world.notifyWorld(e.join(" "))})(args);break;case"banplayer":(e=>{var t=e[0];(e=parseInt(e[1]))?world.ban.banplayer(t,e):console.info("banplayer - provide how many days banned.")})(args);break;case"banuser":(e=>{var t=e[0];(e=parseInt(e[1]))?world.ban.banuser(t,e):console.info("banuser - provide how many days banned.")})(args);break;case"modgems":(e=>{var t=e[0],e=e[1];(t=world.getPlayerByName(t))&&t.user&&t.user.modifyGems(e)})(args);break;case"modgold":(e=>{var t=e[0],e=e[1];(t=world.getPlayerByName(t))&&t.modifyGold(e)})(args);break;case"exit":case"quit":case"q":case"x":y.closeServer();break;case"s":case"save":y.saveServer();break;case"forcequit":y.closeServer();break;case"reloadauction":m.each(worlds,function(e){e.auction.load()});break;default:console.info("Unknown command.")}setTimeout(o,100)})});o()}function e(e,i){t.readFile(e,"utf8",function(e,t){i(e?null:JSON.parse(t))})}var s="./config_local.json";process.argv.forEach(function(e,t,i){2===t&&(s=e)}),y.checkSaved=function(){console.info("Main - checkSaved!");var e=setInterval(function(){world.isSaved()&&(clearInterval(e),y.safe_exit())},500)},y.safe_exit=function(){server.close(),process.exit()},y.saveServer=function(){console.info("Main - saveServer!"),world&&v?(world.userHandler=v,world.save()):process.exit(1)},y.closeServer=function(){console.info("Main - closeServer!"),IS_EXITING=!0,y.saveServer(),f.close(),y.checkSaved()},e("./config.json",function(t){e(s,function(e){e?y(e):t?y(t):(console.error("Server cannot start without any configuration file."),process.exit(1))})})}.call(this)}.call(this,g("path").join(__dirname,"js"))},{"./common":10,"./data/data":12,"./productionconfig":57,"./user/userhandler":63,"./user/usermessage":64,"./user/worldhandler":65,"./worldserver":73,"./ws":74,bison:78,crypto:void 0,fs:void 0,log:192,path:void 0,readline:void 0,underscore:310,util:void 0}],46:[function(e,t,i){var o=e("fs"),r=(e("path"),e("../../shared/js/file")),s=e("../area/checkpoint"),n=e("../area/area"),a=e("../area/maparea"),e=cls.Class.extend({init:function(e,t,i,s,n){this.id=this.index=t,this.world=e,console.info("filepath: "+s+",filenameCollision: "+n);var a=this;this.name=i,this.isLoaded=!1;r.exists(s,function(e){e?o.readFile(s,function(e,t){t=JSON.parse(t);a.initMap(t,n)}):console.error(s+" doesn't exist.")}),this.tilesize=G_TILESIZE},initMap:function(e,t){this.width=e.width,this.height=e.height,this.chunkWidth=e.chunkWidth,this.chunkHeight=e.chunkHeight,this.chunkIndexes=e.chunkIndexes,this.collisions=e.collisions,this.chestAreas=e.chestAreas,this.staticChests=e.staticChests,this.staticEntities=e.staticEntities,this.spawnEntities=e.entities,this.generateCollisions=!0,this.zoneWidth=e.chunkWidth,this.zoneHeight=e.chunkHeight,this.groupWidth=Math.ceil(this.width/this.zoneWidth),this.groupHeight=Math.ceil(this.height/this.zoneHeight),this.initConnectedGroups(e.doors),this.loadTileGrid(e.data),this.loadCollisionGrid(e.collision),this.mapMobAreas=e.mobAreas,this.initCheckpoints(e.checkpoints),this.doors=this._getDoors(e),this.isLoaded=!0,this.ready=!0,this.readyFunc(this)},ready:function(e){this.readyFunc=e},tileIndexToGridPosition:function(e){var t=e%this.width,e=Math.floor(e/this.width);return{x:t*G_TILESIZE,y:e*G_TILESIZE}},GridPositionToTileIndex:function(e,t){return t*this.width+e+1},loadTileGrid:function(e){this.tile=new Array(this.height);for(var t=0;t<this.height;++t){var i=e.slice(t*this.width,(t+1)*this.width);this.tile[t]=i}},loadCollisionGrid:function(e){this.grid=new Array(this.height);for(var t=0;t<this.height;++t){var i=e.slice(t*this.width,(t+1)*this.width);this.grid[t]=i}},GroupIdToGroupPosition:function(e){e=e.split("-");return c(parseInt(e[0],10),parseInt(e[1],10))},forEachGroup:function(e){for(var t=this.groupWidth,i=this.groupHeight,s=0;s<t;s+=1)for(var n=0;n<i;n+=1)e(s+"-"+n)},getGroupIdFromPosition:function(e,t){var i=this.zoneWidth,s=this.zoneHeight;return Math.floor(e/i)+"-"+Math.floor(t/s)},getAdjacentGroupPositions:function(e){var t=this,i=this.GroupIdToGroupPosition(e),s=i.x,i=i.y,n=[c(s-1,i-1),c(s,i-1),c(s+1,i-1),c(s-1,i),c(s,i),c(s+1,i),c(s-1,i+1),c(s,i+1),c(s+1,i+1)];return _.each(this.connectedGroups[e],function(t){_.any(n,function(e){return l(e,t)})||n.push(t)}),_.reject(n,function(e){return e.x<0||e.y<0||e.x>=t.groupWidth||e.y>=t.groupHeight})},forEachAdjacentGroup:function(e,t){e&&_.each(this.getAdjacentGroupPositions(e),function(e){t(e.x+"-"+e.y)})},initConnectedGroups:function(e){var i=this;this.connectedGroups={},_.each(e,function(e){var t=i.getGroupIdFromPosition(e.x,e.y),e=i.getGroupIdFromPosition(e.tx,e.ty),e=i.GroupIdToGroupPosition(e);t in i.connectedGroups?i.connectedGroups[t].push(e):i.connectedGroups[t]=[e]})},initMobAreas:function(){var e=this.mapMobAreas,i=this;this.mobAreas={},_.each(e,function(e){var t=new MobArea(i,e.id,e.count,e.minLevel,e.maxLevel,e.x,e.y,e.w,e.h,e.include,e.exclude,e.definite,!1,-1,e.level);(i.mobAreas[e.id]=t).addMobs(),t.spawnMobs()})},initCheckpoints:function(e){var i=this;this.checkpoints={},this.startingAreas=[],_.each(e,function(e){var t=new s(i,e.id,e.x,e.y,e.w,e.h);i.checkpoints[t.id]=t,1===e.s&&i.startingAreas.push(t)})},getCheckpoint:function(e){return this.checkpoints[e]},getRandomStartingPosition:function(e){var t,i=_.size(this.startingAreas),i=Utils.randomInt(i-1);return e=e||this.startingAreas[i],1===this.index?(t=(e=new n(this,0,512,512,30,30,!0,-1))._getRandomPositionInsideArea.bind(e,100),i=this.entities.spaceEntityRandomApart(3,t),console.info("getRandomStartingPosition - x:"+i.x+",y:"+i.y),i):e?(t=e._getRandomPositionInsideArea.bind(e,100),this.entities.spaceEntityRandomApart(3,t)):null},isColliding:function(e,t){e=~~(e>>4),t=~~(t>>4),e=[e,t];return!!this.isOutOfBounds(e[0],e[1])||!!this.isCollidingGrid(e[0],e[1])},isCollidingGrid:function(e,t){return 1===this.grid[t][e]},isOutOfBounds:function(e,t){return!_.isNumber(e)||!_.isNumber(t)||e<0||e>=this.width||t<0||t>=this.height},isValidPosition:function(e,t){return _.isNumber(e)&&_.isNumber(t)&&!this.isOutOfBounds(e,t)&&!this.isColliding(e,t)},getRandomPositionCollide:function(e){e=e||[0,0,0,0];var t={},i=0;do{if(t.x=Utils.randomRangeInt(0-e[0],this.width-1-e[2]),t.y=Utils.randomRangeInt(0-e[1],this.height-1-e[3]),this.isValidPosition(t.x,t.y))break}while(i++<25);return 25<=i&&(t.x=-1,t.y=-1,console.log("getRandomPosition()-tries="+i)),t},getRandomPositionArea:function(e,t,i,s){var n={},a=G_TILESIZE,o=(e=Utils.clamp(0,this.width*a,e),t=Utils.clamp(0,this.width*a,t),i=Utils.clamp(0,this.height*a,i),s=Utils.clamp(0,this.height*a,s),0);do{if(n.x=Utils.randomRangeInt(e,t),n.y=Utils.randomRangeInt(i,s),!this.isColliding(n.x,n.y))break}while(o++<20);return 20<=o&&(n.x=-1,n.y=-1,console.log("getRandomPosition()-tries="+o)),n},getRandomPosition:function(){var e={},t=0;do{if(e.x=Utils.randomRangeInt(0,this.width*G_TILESIZE),e.y=Utils.randomRangeInt(0,this.height*G_TILESIZE),this.isColliding(e.x,e.y))break}while(t++<20);return 20<=t&&(e.x=-1,e.y=-1,console.log("getRandomPosition()-tries="+t)),e},_getDoors:function(i){console.info(JSON.stringify(i.doors));var s=[];return _.each(i.doors,function(e){e.width=e.width||1,e.height=e.height||1,console.info("door.tmap="+e.tmap);var t=new a(i,!1,e.x,e.y,e.width,e.height,-1);switch(t.minLevel=e.tminLevel||0,t.maxLevel=e.tmaxLevel||200,t.map=e.tmap||1,t.portal=1===e.p,t.quest=e.tq,t.admin=e.a,e.to){case"u":t.orientation=Types.Orientations.UP;break;case"d":t.orientation=Types.Orientations.DOWN;break;case"l":t.orientation=Types.Orientations.LEFT;break;case"r":t.orientation=Types.Orientations.RIGHT;break;default:t.orientation=Types.Orientations.DOWN}s.push(t)}),console.info("return doors"),s},isDoor:function(t,i){return _.detect(this.doors,function(e){return null!==e.contains({x:t,y:i})})},getDoor:function(t){return _.detect(this.doors,function(e){return e.contains(t)})},getSubCoordinate:function(e,t){return[e%=this.chunkWidth*this.tilesize,t%=this.chunkHeight*this.tilesize]},getSubIndex:function(e,t){return~~(t/(this.chunkHeight*this.tilesize)*this.chunkHeight+e/(this.chunkWidth*this.tilesize))},isHarvestTile:function(e,t){if(console.info("isHarvestTile"),this.isOutOfBounds(e.gx,e.gy))return!1;var i=this.getTiles(e.gx,e.gy);if(console.info("tiles: "+JSON.stringify(i)),!i||0===i.length)return!1;log.info("tiles="+JSON.stringify(i));e={axe:[678,679,698,699,855,875,274,275,294,295]};return!!e.hasOwnProperty(t)&&(Array.isArray(i)?e[t].some(function(e){return i.includes(e)}):e[t].includes(i))},getTiles:function(e,t){return this.tile[t][e]}}),c=function(e,t){return{x:e,y:t}},l=function(e,t){return e.x===t.x&&t.y==t.y};t.exports=e},{"../../shared/js/file":348,"../area/area":1,"../area/checkpoint":2,"../area/maparea":5,fs:void 0,path:void 0}],47:[function(e,t,i){e("../entity/chest");var s=e("../entity/npcstatic"),n=e("../entity/npcmove"),r=e("../message"),a=e("../mobai"),e=cls.Class.extend({init:function(e,t,i){for(var s=this,n=(s.id=e,s.map=i,s.server=t,s.world=t,s.entities={},s.players={},s.characters={},s.npcplayers={},s.mobs={},s.items={},s.equipping={},s.hurt={},s.npcs={},s.chests={},s.blocks={},s.spatial=[],Math.ceil(s.map.width/G_SPATIAL_SIZE)),a=Math.ceil(s.map.height/G_SPATIAL_SIZE),o=0,r=0;o<a;o++)for(s.spatial[o]=[],r=0;r<n;r++)s.spatial[o][r]=[];s.packets={},s.mobAreas=[],s.groups={},s.pathfinder=null,s.pathingGrid=null,s.zoneGroupsReady=!1,s.maxPackets=10,s.entityCount=0,this.mobAI=null,this.cellsize=G_TILESIZE,this.harvest={}},getSpatialEntities:function(e){for(var t=~~(Math.max(e[0],0)/G_SPATIAL_SIZE),i=~~(Math.max(e[1],0)/G_SPATIAL_SIZE),s=~~(Math.min(e[2],this.map.width-1)/G_SPATIAL_SIZE),n=~~(Math.min(e[3],this.map.height-1)/G_SPATIAL_SIZE),a=[],o=(this.spatial.length,i),r=0;o<=n;++o)for(this.spatial[o].length,r=t;r<=s;++r)for(var c of this.spatial[o][r])c&&a.push(c);return a},mapready:function(){this.initPathFinder(),this.initPathingGrid(),this.mobAI=new a(this.server,this.map)},initPathFinder:function(){this.pathfinder=new Pathfinder(this.map.width,this.map.height)},spawnNpcs:function(e){for(var t=0;t<e;++t)this._createNpc("Npc"+t)},_createNpc:function(e){var t=this,i=(pos=this.spaceEntityRandomApart(2,function(){return t.map.getRandomPosition()}),new n(++this.entityCount,0,16*pos.x,16*pos.y,t.map));return t.addNpcMove(i),i},initPathingGrid:function(){for(var e=this.map,t=(console.info("pathinggrid height:"+e.height+", width:"+e.width),new Uint8Array(e.height)),i=0,s=0;i<e.height;++i)for(t[i]=new Uint8Array(e.width),s=0;s<e.width;++s)e.grid[i][s]?t[i][s]=1:t[i][s]=0;this.entitygrid=t.slice(0),console.info("Initialized the pathing grid with static colliding cells.")},processWho:function(t){var e,i=this,s=[],n=(n=t.knownIds).parseInt(),a=~~(t.x/G_TILESIZE),o=~~(t.y/G_TILESIZE);for(e of this.getSpatialEntities([a-64,o-32,64+a,32+o]))e&&e!==t&&i.isOffset(t,e)&&s.push(e.id);a=n&&0<n.length?_.difference(s,n):s;_.each(a,function(e){var e=i.getEntityById(e);e&&e!==t&&(t.knownIds.push(e.id),i.sendToPlayer(t,e.spawn()),e.path)&&(e=new r.MovePath(e,e.path),i.sendToPlayer(t,e))})},isOffset:function(e,t,i,s,n){i=(i||0)*G_TILESIZE,s=(s||32)*G_TILESIZE,n=(n||18)*G_TILESIZE;var n=Math.max(0,e.x-s-i),a=Math.max(0,e.y-s-i),o=Math.min(this.map.width*G_TILESIZE,e.x+s+i),e=Math.min(this.map.height*G_TILESIZE,e.y+s+i);return t.y>=a&&t.y<=e&&t.x>=n&&t.x<=o},processPackets:function(){var a=this;0<a.packets.length&&console.info(JSON.stringify(a.packets)),Utils.forEach(this.packets,(e,t)=>{if(0<(len=e.length)&&null!=e){var i=a.getEntityById(t),t=a.server.socket.getConnection(t);if(i&&i.map&&2<=i.mapStatus&&null!=t){for(var s=[],n=0;n<a.maxPackets&&0!==e.length;++n)s.push(e.shift());t.send(s)}}})},sendToPlayer:function(e,t){t&&(e&&e.id in this.packets&&this.packets[e.id].push(t.serialize()),this.processPackets())},sendBroadcast:function(i,s){i&&(Utils.forEach(this.packets,function(e,t){t!==s&&e.push(i.serialize())}),this.processPackets())},sendNeighbours:function(e,t,i,s){var n,s=this.getPlayerAround(e,s=s||48);s.push(e);for(n of s)(this.packets.hasOwnProperty(n.id)&&!i||i&&n!==i)&&this.packets[n.id].push(t.serialize());this.processPackets()},isMobsOnSameTile:function(t){var i=t.x,s=t.y,n=!1,a=0,o=0;return t.path&&0<t.path.length&&(i=t.path[t.path.length-1][0],s=t.path[t.path.length-1][1]),_.each(self.mobs,function(e){o=e.isMoving()?(a=e.path[e.path.length-1][0],e.path[e.path.length-1][1]):(a=e.x,e.y),e.id!==t.id&&i===a&&s===o&&(n=!0)}),n},getFreeAdjacentNonDiagonalPosition:function(e){var s=this,n=null;return e.forEachAdjacentNonDiagonalPosition(function(e,t,i){n||s.map.isColliding(e,t)||s.isCharacterAt(e,t)||(n={x:e,y:t,o:i})}),n},getFreeFutureAdjacentNonDiagonalPosition:function(e){var s=this,n=[];return e.forEachFutureAdjacentNonDiagonalPosition(function(e,t,i){s.map.isColliding(e,t)||s.isMobAt(e,t)||n.push({x:e,y:t,o:i})}),n},getRandomPosition:function(e,t){var i=[],s=0;for(t*=G_TILESIZE;s++<10&&i.y!==e.y&&i.x!==e.x;){var n=Utils.randomRangeInt(-t,t),a=Utils.randomRangeInt(-t,t);if(i[0]=e.x+n,i[1]=e.y+a,!this.map.isColliding(i[0],i[1])&&(-1!=i[0]||-1!=i[1]))return{x:i[0],y:i[1]}}return console.info("getRandomPosition - failed"),null},spawnEntities:function(i){var s=this;_.each(s.map.spawnEntities,function(e){var t;e.type==Types.EntityTypes.NPCMOVE&&(t=s.addNpcMove(e.id,e.x*G_TILESIZE,e.y*G_TILESIZE),e.name&&(t.name=e.name),e.scriptQuests)&&(t.scriptQuests=e.scriptQuests),e.type==Types.EntityTypes.NPCSTATIC&&(t=s.addNpcStatic(e.id,e.x*G_TILESIZE,e.y*G_TILESIZE),e.name&&(t.name=e.name),e.scriptQuests)&&(t.scriptQuests=e.scriptQuests)}),console.info(JSON.stringify(s.map.staticEntities)),_.each(s.map.staticEntities,function(e,t){t=i.tileIndexToGridPosition(t);console.info("kind:"+e),NpcData.isNpc(e)&&(console.info("npc:"+e+",x:"+t.x+",y:"+t.y),s.addNpcStatic(e,t.x,t.y))})},addEntity:function(e){(this.entities[e.id]=e)instanceof Character&&(this.characters[e.id]=e)},addPlayer:function(e){console.info("addPlayer - player id: "+e.id),this.addEntity(e),this.players[e.id]=e,this.packets[e.id]=[]},addChest:function(e){this.addEntity(e),this.chests[e.id]=e},addBlock:function(e){return this.addEntity(e),this.blocks[e.id]=e},addMob:function(e,t,i,s){e=new Mob(++this.entityCount,e,t,i,this.map,s);return e.mobAI=this.mobAI,this.addEntity(e),this.mobs[e.id]=e,this.world.mobCallback.setCallbacks(e),e},addNpcStatic:function(e,t,i){e=new s(++this.entityCount,e,t,i,this.map);return this.addEntity(e),this.npcs[e.id]=e},addNpcMove:function(e,t,i){e=new n(++this.entityCount,e,t,i,this.map);return this.addEntity(e),this.npcplayers[e.id]=e},addItem:function(e){return this.addEntity(e),this.items[e.id]=e},removeSpatial:function(e){var t;e.spatialMap&&(t=this.spatial[e.spy][e.spx],Utils.removeFromArray(t,e))},removeEntity:function(e){this.removeSpatial(e),e.id in this.mobs&&delete this.mobs[e.id],e.id in this.items&&delete this.items[e.id],e.id in this.players&&delete this.players[e.id],e.id in this.chests&&delete this.chests[e.id],e.id in this.blocks&&delete this.blocks[e.id],e.id in this.characters&&delete this.characters[e.id],e.id in this.entities&&delete this.entities[e.id],e.destroy()},removePlayer:function(e){console.info("removePlayer-called");e instanceof Player&&this.sendBroadcast(e.despawn()),console.info("deleting player traces.."),this.removeEntity(e),delete this.packets[e.id]},removeNpcPlayer:function(e){console.info("removePlayer-called"),this.sendBroadcast(e.despawn(0)),this.removeEntity(e),delete this.npcplayers[e.id]},createItem:function(e,t,i){var s=++this.entityCount,n=Types.EntityTypes.ITEM;return ItemTypes.isEquippable(e.itemKind)||(n=Types.EntityTypes.ITEMLOOT),n=new Item(n,s,e,t,i,this.map),this.addItem(n),n},addStaticItem:function(e,t){return t.isStatic=!0,t.onRespawn(this.addStaticItem.bind(this,t)),this.addItem(t)},getEntityById:function(e){if(this.entities.hasOwnProperty(e))return this.entities[e]},getPlayerByName:function(e){for(var t in this.players){t=this.players[t];if(t.name===e)return t}return null},setModifyGoldByName:function(e,t){e=this.getPlayerByName(e);e&&e.modifyGold(t)},getEntitiesByPosition:function(t,i){return entities=[],this.forEachEntity(function(e){e.x===t&&e.y===i&&entities.push(e)}),entities},isCharacterAt:function(e,t){return 1===this.entitygrid[t][e]},isMobAt:function(s,n){var a=!1;return this.forEachMob(function(e){var t=e.x,i=e.y;e.path&&0<e.path.length&&(t=e.path[e.path.length-1][0],i=e.path[e.path.length-1][1]),s===t&&n===i&&(a=!0)}),a},forEachEntity:function(t){Utils.forEach(this.entities,function(e){t(e)})},forEachPlayer:function(t){Utils.forEach(this.players,function(e){t(e)})},forEachMob:function(t){Utils.forEach(this.mobs,function(e){t(e)})},forEachCharacter:function(t){Utils.forEach(this.entities,function(e){e instanceof Character&&t(e)})},forEachNpcPlayer:function(t){Utils.forEach(this.npcplayers,function(e){e instanceof Character&&t(e)})},getEntitySpatialCount:function(e,t,i){t*=G_TILESIZE;var s,n=e.x,e=e.y,t=t>>1,a=0;i=i||function(e,t){return e!==t};for(s of this.getSpatialEntities([n-t,e-t,n+t,e+t]))i(e1,s)&&a++;return a},getEntityAroundSpatial:function(e,t,i){var s,t=(t*=G_TILESIZE)>>1,n=e.x,a=e.y,o=[];i=i||function(e,t){return e!==t};for(s of this.getSpatialEntities([n-t,a-t,n+t,a+t]))i(e,s)&&o.push(s);return o},getEntityCount:function(e,t,i,s){i*=G_TILESIZE,s=s||function(e,t){return e!==t};function n(e,t){return Math.abs(t.x-e.x)<=i&&Math.abs(t.y-e.y)<=i&&s(e,t)}var a=0;if(Array.isArray(e))for(var o of e)n(t,o)&&a++;else Utils.forEach(e,function(e){n(t,e)&&a++});return a},getEntityAround:function(e,t,i,s){i*=G_TILESIZE;function n(e,t){return Math.abs(t.x-e.x)<=i&&Math.abs(t.y-e.y)<=i&&s(e,t)}var a=[];s=s||function(e,t){return e!==t};if(Array.isArray(e))for(var o of e)n(t,o)&&a.push(o);else Utils.forEach(e,function(e){n(t,e)&&a.push(e)});return a},getEachEntityAround:function(e,t,i){var e=~~(e/G_TILESIZE),t=~~(t/G_TILESIZE),s=this.getSpatialEntities([e-i,t-i,e+i,t+i]);return this.getEntityAround(s,{x:e,y:t},i)},getEntitiesAround:function(e,t){var i=~~(e.x/G_TILESIZE),s=~~(e.y/G_TILESIZE),t=t*G_TILESIZE>>1,i=this.getSpatialEntities([i-t,s-t,i+t,s+t]);return this.getEntityAround(i,e,t)},getCharactersAround:function(e,t){return this.getEntityAround(this.getEntitiesAround(e,t),e,t,function(e,t){return e!==t&&t instanceof Character})},getMobsAround:function(e,t){return this.getEntityAround(this.mobs,e,t)},getPlayerAround:function(e,t){return this.getEntityAround(this.players,e,t)},getAroundCount:function(e,t,i){return this.getEntityCount(e,t,i)},getEntityAroundCount:function(e,t){return this.getEntityCount(this.getEntitiesAround(e,t),e,t)},getPlayerAroundCount:function(e,t){return this.getEntityCount(this.players,e,t)},getPartyAround:function(e,t){return this.getEntityAround(e.party.players,e,t)},itemDespawn:function(e){this.sendNeighbours(e,new r.Despawn(e)),this.removeEntity(e)},handleEmptyChestArea:function(e){e&&this.handleItemDespawn(chest)},tryAddingMobToChestArea:function(t){_.each(this.chestAreas,function(e){e.contains(t)&&e.addToArea(t)})},findPath:function(e,t,i,s){var n=[];if(this.pathfinder&&e){var a=this.map.grid,n=null,o=[e.x,e.y];G_TILESIZE;if(this.map.isColliding(e.x,e.y))return console.warn("findPath - isColliding start."),null;var r=[t,i];if(this.map.isColliding(t,i))return console.warn("findPath - isColliding end."),null;if(o[0]===r[0]&&o[1]===r[1]){try{throw new Error}catch(e){console.info(e.stack)}return console.warn("findPath - path coordinates are the same."),null}var c,l=this.pathfinder.getShortGrid(a,o,r,3),p=l.crop,u=l.substart,d=l.subend;return(c=this.pathfinder.findDirectPath(p,u,d))?(c=this.pathfinder.getFullFromShortPath(c,l.minX,l.minY),console.info("findPath - res:"+JSON.stringify(c)),c):(n||(n=this.pathfinder.findShortPath(p,l.minX,l.minY,u,d),console.info("findPath - shortPath:"+JSON.stringify(n))),n||(console.warn("findPath - DANGER - findPath LONGGG"),n=this.pathfinder.findPath(a,o,r,!1),console.info("findPath - longPath:"+JSON.stringify(n))),n||(console.error("findPath - Error while finding the path to "+t+", "+i+" for "+e.id),null))}return null},spaceEntityRandomApart:function(e,t,i,s,n){i=i||this.entities,n=n||50;for(var a=null,o=1,r=s&&s.collision?s.collision:null,c=0;0<o&&c<n;)t&&(o=(a=t(r))?this.getAroundCount(i,a,e):0),c++;return a},isGridPositionEmpty:function(e,t){if(console.info("isGridPositionEmpty: x="+e+",y="+t),this.map.isColliding(e,t))return!1;var i={x:e,y:t},e=this.getEntitiesAround(i,1);if(0!==e.length)for(var s of e)if(s.isOverPosition(i))return!1;return!0}});t.exports=e},{"../entity/chest":25,"../entity/npcmove":31,"../entity/npcstatic":32,"../message":49,"../mobai":50}],48:[function(e,t,i){var s=e("./map"),E=e("./mapentities"),_=e("../area/mobarea"),k=e("../area/entityarea"),T=(e("../entity/npcmove"),e("../entity/node"));e("../entity/mob");t.exports=MapManager=cls.Class.extend({init:function(e){var w=this;this.server=e,this.maps={},this.mapCount=0,this.id=0,this.mapInstances={},this.loaded=!1,this.maps[0]=new s(e,0,"map0","./maps/map0.json",""),this.maps[0].ready(function(){var t=w.maps[0];t.entities=new E(w.id,w.server,t,w.server.database),t.entities.mapready(),t.entities.spawnEntities(t),t.enterCallback=function(e){return t.getRandomStartingPosition()},w.MapsReady()}),w.maps[1]=new s(e,1,"map1","./maps/map1.json",""),w.maps[1].ready(function(){var t=w.maps[1],e=(t.entities=new E(w.id,w.server,t,w.server.database),t.entities.mapready(),t.mobArea=[],new _(t,0,25,0,1,512,512,40,40,[1],null,null,!0,-1,null,null));t.mobArea.push(e),e.addMobs(),e.spawnMobs();(v=t.entities.addNpcMove(0,510*G_TILESIZE,510*G_TILESIZE)).name="Old Man",v.scriptQuests=!1;for(var i=v,s=0,n=0,a=512,o=512,r=0,c=0,l=0,p="EAST",u=0;u<40&&!(50<=l);u++){c+=u%2==0?1:0;for(var d=u%4,r=1;r<=c;r++){switch(d){case n=s=0:p="EAST",s=40;break;case 1:p="SOUTH",n=40;break;case 2:p="WEST",s=-40;break;case 3:p="NORTH",n=-40}e=new _(t,l+=1,15,1+l,1+l,a+=s,o+=n,40,40,null,null,null,!0,-1,null),t.mobArea.push(e),e.addMobs(),e.spawnMobs(),e=new _(t,l,5,2+l,2+l,a,o,20,20,null,null,null,!0,-1,null),t.mobArea.push(e),e.addMobs(),e.spawnMobs(),e=new _(t,l,1,3+l,3+l,a,o,10,10,null,null,null,!0,-1,null),t.mobArea.push(e),e.addMobs(),e.spawnMobs();for(var h of e.entities)h.createBoss(5);var m=new k(t,0,a,o,20,20,!0,-1),f=m._getRandomPositionInsideArea(30),v=t.entities.addNpcMove(l,f.x,f.y),y=new k(t,0,a,o,20,20,!0,-1);if(i.nextNpcName=v.name,i.nextNpcDir=p,i=v,0<l){var g=1;if(9===l)for(var b=0;b<6;++b){f=t.entities.spaceEntityRandomApart(2,y._getRandomPositionInsideArea.bind(y,100));(x=new T(++t.entities.entityCount,3,f.x,f.y,t,g,g)).name="node1",x.weaponType="any",m.addToArea(x),t.entities.addEntity(x)}else if(6===l)for(g=2,b=0;b<6;++b){f=t.entities.spaceEntityRandomApart(2,y._getRandomPositionInsideArea.bind(y,100));(x=new T(++t.entities.entityCount,3,f.x,f.y,t,g,g)).name="node2",x.weaponType="any",m.addToArea(x),t.entities.addEntity(x)}else if(10<l){g=Utils.clamp(1,4,1+~~(l/10));for(b=0;b<10;++b){var x,f=t.entities.spaceEntityRandomApart(2,y._getRandomPositionInsideArea.bind(y,100));(x=new T(++t.entities.entityCount,2,f.x,f.y,t,g,g)).name="node"+g,x.weaponType="hammer",m.addToArea(x),t.entities.addEntity(x)}}}}}t.enterCallback=function(e){return t.getRandomStartingPosition()},w.MapsReady()})},MapsReady:function(){this.mapCount++,console.info("mapCount="+this.mapCount),this.isMapsReady()&&!this.loaded&&(console.info("maps ready"),this.readyFunc(),this.loaded=!0)},isMapsReady:function(){return console.info("Maps Length: "+Object.keys(this.maps).length),this.mapCount===Object.keys(this.maps).length},onMapsReady:function(e){this.readyFunc=e}})},{"../area/entityarea":4,"../area/mobarea":6,"../entity/mob":29,"../entity/node":30,"../entity/npcmove":31,"./map":46,"./mapentities":47}],49:[function(e,t,i){e("underscore");var e=e("./lib/class"),s={},t=(t.exports=s,e.Class.extend({}));s.SyncTime=t.extend({init:function(e){this.localtime=e},serialize:function(){return[Types.Messages.BI_SYNCTIME,this.localtime,Date.now()]}}),s.Spawn=t.extend({init:function(e){this.entity=e},serialize:function(){return[Types.Messages.WC_SPAWN].concat(this.entity.getState())}}),s.Despawn=t.extend({init:function(e){this.id=e.id,this.mapIndex=e.map.index,this.x=e.x,this.y=e.y},serialize:function(){return[Types.Messages.WC_DESPAWN,this.id,this.mapIndex,this.x,this.y]}}),s.Move=t.extend({init:function(e,t,i,s,n){this.time=Date.now(),this.entity=e,this.orientation=t,this.state=i,this.x=s||this.entity.x,this.y=n||this.entity.y},serialize:function(){return[Types.Messages.WC_MOVE,this.time,this.entity.map.index,this.entity.id,parseInt(this.orientation),this.state,this.entity.moveSpeed,this.x,this.y]}}),s.MovePath=t.extend({init:function(e,t){this.time=Date.now(),this.entity=e,this.path=t,this.orientation=e.orientation},serialize:function(){return[Types.Messages.WC_MOVEPATH,this.time,this.entity.map.index,this.entity.id,parseInt(this.orientation),this.entity.interrupted=this.entity.interrupted?1:0,this.entity.moveSpeed].concat(this.path)}}),s.ChangePoints=t.extend({init:function(e,t,i){this.id=e.id,this.hp=e.stats.hp,this.hpMax=e.stats.hpMax,this.ep=e.stats.ep||0,this.epMax=e.stats.epMax||0,this.modhp=t,this.modep=i},serialize:function(){return[Types.Messages.WC_CHANGEPOINTS,this.id,this.hp,this.hpMax,this.modhp,this.ep,this.epMax,this.modep]}}),s.Error=t.extend({init:function(e){this.message=e},serialize:function(){return[Types.Messages.WC_ERROR,this.message]}}),s.Notify=t.extend({init:function(e,t,i){this.group=e,this.message=t,this.vars=i||[]},serialize:function(){return[Types.Messages.WC_NOTIFY,this.group,this.message].concat(this.vars)}}),s.Dialogue=t.extend({init:function(e,t,i){this.id=e.id,this.langcode=t,this.vars=i||[]},serialize:function(){return[Types.Messages.WC_DIALOGUE,this.id,this.langcode].concat(this.vars)}}),s.Quest=t.extend({init:function(e){this.quest=e},serialize:function(){var e=this.quest.toClient();return[Types.Messages.WC_QUEST].concat(e)}}),s.Achievement=t.extend({init:function(e){this.achievement=e},serialize:function(){var e=this.achievement.toClient(this.achievement);return[Types.Messages.WC_ACHIEVEMENT].concat(e)}}),s.Log=t.extend({init:function(e){this.message=e,this.message.unshift(Types.Messages.WC_LOG)},serialize:function(){return this.message}}),s.SkillLoad=t.extend({init:function(e,t){this.index=e,this.exp=t},serialize:function(){return[Types.Messages.WC_SKILLLOAD,this.index,this.exp]}}),s.SkillEffects=t.extend({init:function(e,t){this.id=e.id,this.effects=t},serialize:function(){return[Types.Messages.WC_SKILLEFFECTS,this.id].concat(this.effects)}}),s.SkillXP=t.extend({init:function(e){this.skillXPs=e},serialize:function(){var e=[Types.Messages.WC_SKILLXP];return e.push(skillXPs.length),e.concat(skillXPs),e}}),s.Chat=t.extend({init:function(e,t,i){this.playerId=e.id,this.group=t,this.message=i},serialize:function(){return[Types.Messages.WC_CHAT,this.playerId,this.group,this.message]}}),s.TeleportMap=t.extend({init:function(e,t,i){this.entity=e,this.subIndex=t,this.status=i},serialize:function(){return[Types.Messages.WC_TELEPORT_MAP,this.entity.getMapIndex(),this.subIndex,this.status,this.entity.x,this.entity.y]}}),s.Damage=t.extend({init:function(e){var t=e[0],i=e[1];this.entity1=t,this.entity2=i,this.hpMod=e[2],this.hp=i.stats.hp,this.hpMax=i.stats.hpMax,this.epMod=e[3],this.ep=i.stats.ep||0,this.epMax=i.stats.epMax||0,this.crit=e[4]?1:0,this.effects=e[5]},serialize:function(){var e=[Types.Messages.WC_DAMAGE,this.entity1.id,this.entity2.id,this.entity1.orientation,this.hpMod,this.hp,this.hpMax,this.epMod,this.ep,this.epMax,this.crit];return Array.isArray(this.effects)&&0<this.effects.length&&e.concat(this.effects),e}}),s.StatInfo=t.extend({init:function(e){this.player=e},serialize:function(){var e=this.player.stats;return[Types.Messages.WC_STATINFO,e.attack,e.defense,e.health,e.energy,e.luck,e.free,e.hp,e.hpMax,e.ep,e.epMax]}}),s.UpdateLook=t.extend({init:function(e){this.player=e},serialize:function(){return[Types.Messages.WC_LOOKUPDATE,this.player.id,this.player.sprites[0],this.player.sprites[1],this.player.colors[0],this.player.colors[1]]}}),s.AppearanceList=t.extend({init:function(e,t){this.looks=Utils.BinArrayToBase64(e.looks),this.prices=t.prices},serialize:function(){return[Types.Messages.WC_APPEARANCE,this.looks].concat(this.prices)}}),s.ItemSlot=t.extend({init:function(e,t){this.type=e,this.items=t},serialize:function(){var e,t=[Types.Messages.WC_ITEMSLOT,this.type,this.items.length];for(e of this.items)var i=null,i=-1===e.itemKind?[e.slot,e.itemKind]:e.toArray(),t=t.concat(i);return t}}),s.ItemLevelUp=t.extend({init:function(e,t){this.index=e,this.item=t},serialize:function(){if(this.item)return[Types.Messages.WC_ITEMLEVELUP,this.index,this.item.itemNumber,this.item.itemExperience]}}),s.Stat=t.extend({init:function(e,t,i){this.type=e,this.value=t,this.change=i},serialize:function(){return[Types.Messages.WC_STAT,this.type,this.value,this.change]}}),s.LevelUp=t.extend({init:function(e,t,i){this.type=e,this.level=t,this.exp=i},serialize:function(){return[Types.Messages.WC_LEVELUP,this.type,this.level,this.exp]}}),s.List=t.extend({init:function(e){this.ids=e},serialize:function(){var e=this.ids;return e.unshift(Types.Messages.WC_LIST),e}}),s.AuctionOpen=t.extend({init:function(e){this.itemData=e},serialize:function(){return this.itemData}}),s.Speech=t.extend({init:function(e,t,i){this.entityid=e.id,this.kind=t,this.value=i},serialize:function(){return[Types.Messages.WC_SPEECH,this.entityid,this.kind,this.value]}}),s.Gold=t.extend({init:function(e){this.invgold=e.gold[0],this.bankgold=e.gold[1],this.gems=e.user.gems},serialize:function(){return[Types.Messages.WC_GOLD,this.invgold,this.bankgold,this.gems]}}),s.BlockModify=t.extend({init:function(e,t,i){this.entity=e,this.id=t,this.state=i},serialize:function(){return[Types.Messages.WC_SPAWN,this.id,this.state].concat(this.entity.getState())}}),s.PartyInvite=t.extend({init:function(e){this.id=e},serialize:function(){return[Types.Messages.WC_PARTY,2,this.id]}}),s.Party=t.extend({init:function(e){this.members=e},serialize:function(){return[Types.Messages.WC_PARTY,1].concat(this.members)}}),s.PlayerInfo=t.extend({init:function(e){this.player=e},serialize:function(){return[Types.Messages.WC_PLAYERINFO,this.player.exp.base,this.player.exp.attack,this.player.exp.defense,this.player.exp.sword,this.player.exp.bow,this.player.exp.hammer,this.player.exp.axe,this.player.exp.logging,this.player.exp.mining]}}),s.setSprite=t.extend({init:function(e,t,i,s){this.id=e.id,this.sprite1=t,this.sprite2=i,this.animName=s},serialize:function(){var e=[Types.Messages.WC_SET_SPRITE,this.id,this.sprite1];return void 0!==this.sprite2&&e.push(this.sprite2),void 0!==this.animName&&e.push(this.animName),e}}),s.setAnimation=t.extend({init:function(e,t){this.id=e.id,this.animation=t},serialize:function(){return[Types.Messages.WC_SET_ANIMATION,this.id,this.animation]}}),s.Harvest=t.extend({init:function(e,t,i,s,n){this.duration=n||0,this.id=e.id,this.action=t,this.gx=i,this.gy=s},serialize:function(){var e=[Types.Messages.WC_HARVEST,this.id,this.action,this.gx,this.gy];return 0<this.duration&&e.push(this.duration),e}})},{"./lib/class":44,underscore:310}],50:[function(e,t,i){e("./message"),e("underscore");var a=e("./utils"),s=e("./formulas");t.exports=MobAI=Class.extend({init:function(e,t){this.world=this.server=this.worldServer=e,this.map=t},checkHitAggro:function(e,t){e.isStunned||e.isAttacking()||e.aiState!==mobState.IDLE||e.hasTarget()||e.isAttackedBy(t)&&this.aggroPlayer(e,t)},checkAggro:function(e){if(!e.isStunned&&!e.isAttacking()&&e.isAggressive&&e.aiState===mobState.IDLE&&!e.hasTarget()&&e.canMoveAI()){var t,i=this.map.entities.getPlayerAround(e,e.aggroRange),s=2*e.level;for(t of i)t.isAlive()&&s>=t.level&&e.aggroPlayer(t)}},checkHit:function(e){e.aiState!==mobState.ATTACKING||e.isStunned||!e.target||e.freeze||(e.canReach(e.target)?e.canAttack()&&(console.info("mob - Is Attacking"),this.handleHurt(e)):e.setAiState(mobState.CHASING))},update:function(){var e,t=this.map.entities.mobs;for(e in t){var i=t[e];if(i.isAlive()&&!i.freeze){if(i.aiState===mobState.RETURNING)return;i.canAggro()&&this.checkAggro(i),i.hasTarget()&&(this.checkChase(i),this.checkHit(i))}}},checkChase:function(e){var t=e.target;e.freeze||(t.isAlive()?(e.aiState===mobState.IDLE&&e.setAiState(mobState.AGGRO),e.aiState!==mobState.AGGRO&&e.aiState!==mobState.CHASING||(e.canReach(t)?e.isMovingPath()||e.isOverlapping()&&(e.forceStop(),e.follow(e.target),e.path)||(e.forceStop(),console.info(e.id+" within range"),e.setAiState(mobState.ATTACKING)):e.isMovingPath()||!t.isMoving()&&e.ptx===e.target.x&&e.pty===e.target.y||(e.isMoving()&&t.isMoving()?console.info(e.id+" monster and target is moving so abort."):e.canMoveAI()&&!this.checkReturn(e)&&(e.setMoveAI(a.randomRangeInt(25,50)),e.ptx=t.x,e.pty=t.y,e.followAttack(t),e.path?e.setAiState(mobState.CHASING):e.returnToSpawn())))):e.returnToSpawn())},handleHurt:function(e){var t,i;e&&e.target&&!e.freeze&&!e.target.isInvincible&&(console.info("handleHurt."),0<e.target.stats.hp)&&(e.lookAt(e.target),console.info("handleHurt - mob"),t=s.dmg(e,e.target,e.attackTimer),i=s.crit(e,e.target),e.criticalHit=!1,i&&(t*=2,e.criticalHit=!0),console.info("handleHurt"),this.server.handleDamage(e.target,e,-t,e.criticalHit),e.attackTimer=Date.now(),e.target.isAlive()||e.returnToSpawn())},checkReturn:function(e){var t;return!(e.aiState!==mobState.CHASING&&e.aiState!==mobState.STUCK&&e.aiState!==mobState.ROAMING||((t=e.target)&&!t.isAlive()?(e.returnToSpawn(),0):!(e.distanceToPos(e.spawnX,e.spawnY)>=16*G_TILESIZE||t&&e.distanceToPos(t.x,t.y)>=12*G_TILESIZE)||(console.info("RETURN TO SPAWN!"),e.returnToSpawn(),0)))},Roaming:function(e){var t,i,s=5*G_TILESIZE,n=this.map.entities.getMobsAround(e,32);for(t of n)t&&0===a.randomInt(10)&&t.canRoam()&&(i=t.area,!(i=t.map.entities.spaceEntityRandomApart(2,i._getRandomPositionForEntity.bind(i,t,s),n))||i.x===t.x&&i.y===t.y||t.goRoam(i))}})},{"./formulas":36,"./message":49,"./utils":66,underscore:310}],51:[function(e,t,i){e("../entity/character"),e("../entity/chest");var u=e("../entity/mob"),d=(e("../entity/node"),e("../message")),a=e("../formulas"),o=e("../format").check,r=(e("../skillhandler"),e("./partyhandler")),c=e("./shophandler");t.exports=PacketHandler=Class.extend({init:function(e,t,i,s,n){this.user=e,this.player=t,this.connection=i,this.world=this.server=s,this.map=t.map,this.entities=t.map.entities,this.partyHandler=new r(this),this.shopHandler=new c(this);var a=this;this.connection.listen(function(e){console.info("recv="+JSON.stringify(e));var t=parseInt(e[0]);if(t&&!o(e))a.connection.close("Invalid "+Types.getMessageTypeAsString(t)+" message format: "+e);else switch(e.shift(),a.user.lastPacketTime=Date.now(),t){case Types.Messages.BI_SYNCTIME:a.handleSyncTime(e);break;case Types.Messages.CW_REQUEST:a.handleRequest(e);break;case Types.Messages.CW_WHO:a.handleWho(e);break;case Types.Messages.CW_CHAT:a.handleChat(e);break;case Types.Messages.CW_MOVE:a.handleMoveEntity(e);break;case Types.Messages.CW_MOVEPATH:a.handleMovePath(e);break;case Types.Messages.CW_ATTACK:a.handleAttack(e);break;case Types.Messages.CW_ITEMSLOT:a.handleItemSlot(e);break;case Types.Messages.CW_STORESELL:a.shopHandler.handleStoreSell(e);break;case Types.Messages.CW_STOREBUY:a.shopHandler.handleStoreBuy(e);break;case Types.Messages.CW_CRAFT:a.shopHandler.handleCraft(e);break;case Types.Messages.CW_APPEARANCEUNLOCK:a.handleAppearanceUnlock(e);break;case Types.Messages.CW_LOOKUPDATE:a.handleLookUpdate(e);break;case Types.Messages.CW_AUCTIONSELL:a.shopHandler.handleAuctionSell(e);break;case Types.Messages.CW_AUCTIONBUY:a.shopHandler.handleAuctionBuy(e);break;case Types.Messages.CW_AUCTIONOPEN:a.shopHandler.handleAuctionOpen(e);break;case Types.Messages.CW_AUCTIONDELETE:a.shopHandler.handleAuctionDelete(e);break;case Types.Messages.CW_STORE_MODITEM:a.shopHandler.handleStoreModItem(e);break;case Types.Messages.CW_CHARACTERINFO:a.handleCharacterinfo(e);break;case Types.Messages.CW_TELEPORT_MAP:a.handleTeleportMap(e);break;case Types.Messages.CW_LOOT:a.handleLoot(e);break;case Types.Messages.CW_TALKTONPC:a.handleTalkToNPC(e);break;case Types.Messages.CW_QUEST:a.handleQuest(e);break;case Types.Messages.CW_GOLD:a.handleGold(e);break;case Types.Messages.CW_STATADD:a.handleStatAdd(e);break;case Types.Messages.CW_SKILL:a.handleSkill(e);break;case Types.Messages.CW_SHORTCUT:a.handleShortcut(e);break;case Types.Messages.CW_BLOCK_MODIFY:a.handleBlock(e);break;case Types.Messages.CW_PARTY:a.partyHandler.handleParty(e);break;case Types.Messages.CW_HARVEST:a.handleHarvest(e);break;case Types.Messages.CW_USE_NODE:a.handleUseNode(e);break;default:a.message_callback&&a.player.message_callback(e)}}),this.connection.onClose(function(){console.info("Player: "+a.player.name+" has exited the world."),a.player.save(),console.info("REMOVING PLAYER FROM WORLD."),a.exit_callback&&(console.info("exit callback."),a.exit_callback(a.player)),console.info("onClose - called"),clearTimeout(this.disconnectTimeout),this.close("onClose")})},setMap:function(e){this.map=e,this.entities=e.entities},timeout:function(){this.connection.sendUTF8("timeout"),this.connection.close("Player was idle for too long")},broadcast:function(e,t){this.broadcast_callback&&this.broadcast_callback(e,void 0===t||t)},onExit:function(e){console.info("packetHandler, onExit."),this.exit_callback=e},onMove:function(e){this.move_callback=e},onMessage:function(e){this.message_callback=e},onBroadcast:function(e){this.broadcast_callback=e},send:function(e){this.connection.send(e)},sendPlayer:function(e){this.player.sendPlayer(e)},sendToPlayer:function(e,t){this.player.sendToPlayer(e,t)},handleCharacterInfo:function(e){this.sendPlayer(new d.CharacterInfo(this.player))},handleSyncTime:function(e){console.info("handleSyncTime");e=parseInt(e[0]);this.send([Types.Messages.BI_SYNCTIME,e,Date.now()])},handleChat:function(e){e=Utils.sanitize(e[0]);console.info("Chat: "+this.player.name+": "+e),(new Date).getTime()>this.player.chatBanEndTime?this.send([Types.Messages.WC_NOTIFY,"CHAT","CHATMUTED"]):!e||""===e&&" "===e||("/w"===(e=e.substr(0,256)).split(" ",3)[0]?this.send([Types.Messages.WC_NOTIFY,"CHAT","CHATMUTED"]):this.server.sendWorld(new d.Chat(this.player,e)))},handleQuest:function(e){console.info("handleQuest");var t=parseInt(e[0]),i=parseInt(e[1]),e=parseInt(e[2]),t=this.entities.getEntityById(t);this.player.isInScreen(t)?1===e?t.entityQuests.acceptQuest(this.player,i):t.entityQuests.rejectQuest(this.player,i):console.info("player not close enough to NPC!")},handleTalkToNPC:function(e){console.info("handleTalkToNPC");parseInt(e[0]);e=parseInt(e[1]),e=this.entities.getEntityById(e);this.player.isInScreen(e)?e&&e.talk(this.player):console.info("player not close enough to NPC!")},handleAppearanceUnlock:function(e){var t,i,s=parseInt(e[0]),e=parseInt(e[1]);s<0||s>=AppearanceData.Data.length||!(t=AppearanceData.Data[s])||"armorarcher"!==t.type&&"armor"!==t.type||((i=this.server.looks.prices[s])!==e?(this.sendPlayer(new d.Notify("SHOP","SHOP_MISMATCH",[t.name])),this.server.looks.sendLooks(this.player)):(e=0)<=s&&(e=this.player.user.gems,console.info("gemCount="+e),i<=e?(this.player.user.looks[s]=1,this.player.modifyGems(-i),this.server.looks.prices[s]+=100,this.sendPlayer(new d.Notify("SHOP","SHOP_SOLD",[t.name])),this.server.looks.sendLooks(this.player)):this.sendPlayer(new d.Notify("SHOP","SHOP_NOGEMS"))))},handleLookUpdate:function(e){var t,i=parseInt(e[0]),e=parseInt(e[1]),s=this.player;e<0||e>=AppearanceData.Data.length||i<0||1<i||!(t=AppearanceData.Data[e])||"armorarcher"!==t.type&&"armor"!==t.type||(1===this.player.user.looks[e]&&0===i&&s.setSprite(0,e),s.broadcastSprites())},handleItemSlot:function(e){var t,i,s,n=parseInt(e[0]);this.player.isDead||2===(t=[Number(e[1]),Number(e[2]),Number(e[3])])[0]&&t[1]>this.player.equipment.maxNumber||(i=null,0<=t[1]&&(i=this.player.getStoredItem(t[0],t[1],t[2])),s=null,6===e.length&&(s=[Number(e[4]),Number(e[5])],t[0]===s[0])&&t[1]===s[1])||(0===n?this.player.handleInventoryEat(i,t[1]):1===n?this.player.swapItem(t,s):2===n&&this.player.handleStoreEmpty(t,i))},handleLoot:function(e){var t;console.info("handleLoot"),(item=this.entities.getEntityById(parseInt(e[0])))?(t=parseInt(e[1]),e=parseInt(e[2]),this.player.isWithinDist(t,e,24)?(console.info("item="+item.toString()),item.enemyDrop&&console.info("enemyDrop"),item instanceof Item&&0<=this.player.inventory.putItem(item.room)&&(this.server.taskHandler.processEvent(this.player,PlayerEvent(EventType.LOOTITEM,item,1)),this.broadcast(item.despawn(),!1),this.entities.removeEntity(item))):console.info("Player is not close enough to item.")):console.info("no item.")},handleAttack:function(e){console.info("handleAttack");parseInt(e[0]);var t=this.player;t.isDead||(t.movement.inProgress?t.attackQueue.push(e):this.handleHitEntity(t,e))},processAttack:function(){var e=this.player;if(e.movement.inProgress)for(var t of e.attackQueue)console.info("processAttack, handle hit"),this.handleHitEntity(e,t);this.player.attackQueue=[]},handleHitEntity:function(e,t){var s=this,i=(console.info("handleHitEntity"),console.info("message: "+JSON.stringify(t)),parseInt(t[1])),n=parseInt(t[2]),t=parseInt(t[3]);if(i<0)console.warn("invalid targetId");else{var a=this.entities.getEntityById(i);if(a){if(Date.now()-e.attackTimer<ATTACK_INTERVAL)console.warn("attack interval");else if(a instanceof Player&&e instanceof Player&&(e.level<20||a.level<20||10<Math.abs(e.level-a.level)))console.warn("pvp invalid diff");else if(a.aiState!==mobState.RETURNING)if(a.invincible)this.sendPlayer(new d.Notify("CHAT","COMBAT_TARGETINVINCIBLE")),console.warn("target invincible");else if(this.map.isColliding(e.x,e.y))console.warn("char.isColliding("+e.id+","+e.x+","+e.y+")");else{if(0<=t&&this.handleSkill([t,i,a.x,a.y]),e.setOrientation(n),e.engage(a),e===this.player){if(!e.canReach(a))return console.info("Player not close enough!"),console.info("p.x:"+e.x+",p.y:"+e.y),console.info("e.x:"+a.x+",e.y:"+a.y),void console.info("dx:"+Math.abs(e.x-a.x)+",dy:"+Math.abs(e.y-a.y));if(!e.attackedTime.isOver())return void console.warn("attackedTime is not over.");e.isHarvesting=!1,e.lastAction=Date.now()}e.isBlocking=!1,e.attackedTime.duration=500,e.hasAttacked=!0;var o=function(e,t,i){e instanceof Player&&t instanceof u&&t.mobAI.checkHitAggro(t,e),s.dealDamage(e,t,i.damage,i.crit)},t=(e.effectHandler&&e.effectHandler.interval("beforehit",0),this.calcDamage(e,a,null,0));if(e.effectHandler){e.effectHandler.interval("onhit",t.damage);for(var r of e.activeEffects){var c=r.data;if("attack"===c.skillType&&"enemy_aoe"===c.targetType){var l,p=this.calcDamageAOE(e,null,0);for(l of r.targets)l!==a&&o(e,l,p)}}}o(e,a,t),e.attackTimer&&(e.attackTimer=Date.now()),e.effectHandler&&e.effectHandler.interval("afterhit",0)}}else console.warn("invalid entity")}},calcDamageAOE:function(e,t,i){var s={damage:0,crit:0,dot:0};return s.damage=Math.round(a.dmgAOE(e)),s},calcDamage:function(e,t,i,s){var n={damage:0,crit:0,dot:0};return n.damage=Math.round(a.dmg(e,t)),0!==n.damage&&a.crit(e,t)&&(n.damage*=2,n.crit=1),n},dealDamage:function(e,t,i,s){t&&(t instanceof u&&t.aggroPlayer(e),this.server.handleDamage(t,e,-i,s),e instanceof Player&&(e.weaponDamage+=i),console.info("DAMAGE OCCURED "+i),t instanceof Player)&&t.isDead&&(e===self.player&&self.player.map.entities.sendBroadcast(new d.Notify("CHAT","COMBAT_PLAYERKILLED",[e.name,t.name])),e.pStats.pk++,t.pStats.pd++)},handleShortcut:function(e){var t=parseInt(e[0]),i=parseInt(e[1]),e=parseInt(e[2]);t<0||7<t||2===i&&(e<0||e>=SkillData.Skills.length)||(this.player.shortcuts[t]=[t,i,e])},handleSkill:function(e){var t,i,s=parseInt(e[0]),n=parseInt(e[1]),a=parseInt(e[2]),e=parseInt(e[3]),o=this.player;o.isDead||s<0||s>=o.skills.length||(t=o.skills[s],n&&!(i=this.entities.getEntityById(n)))||t.isReady()&&(o.effectHandler.cast(s,i,a,e),this.handleSkillEffects(o,i))},handleSkillEffects:function(e,t){var i=[];if(e.effects){for(var[s,n]of Object.entries(e.effects))1===n&&i.push(parseInt(s));if(this.sendToPlayer(e,new d.SkillEffects(e,i)),i=[],t){for(var[a,o]of Object.entries(t.effects))1===o&&i.push(parseInt(a));this.sendToPlayer(e,new d.SkillEffects(t,i))}}},handleMoveEntity:function(e){console.info("handleMoveEntity");var t=parseInt(e[0]),i=parseInt(e[1]),s=parseInt(e[2]),n=parseInt(e[3]),a=parseInt(e[4])||-1,e=parseInt(e[5])||-1,o=this.player;i===o.id&&(1==s&&o.hasMoveThrottled(G_LATENCY)?console.error("moveThrottled"):o.map.isColliding(a,e)?console.warn("char.isColliding("+o.id+","+a+","+e+")"):2===s?o.isMovingPath()&&o.fullpath&&(o.abort_pathing_callback(a,e),o.forceStop()):(i=[t,s,n,a,e],s&&(o.move([t,!1,o.orientation,a,e]),!o.checkStartMove(a,e))||(o.move(i),t=new d.Move(o,n,s,a,e),o.map.entities.sendNeighbours(o,t,o),this.move_callback&&this.move_callback())))},handleMovePath:function(e){console.info("handleMovePath"),console.info("message="+JSON.stringify(e));var t,i=parseInt(e.shift()),s=parseInt(e.shift()),n=(parseInt(e.shift()),0!==parseInt(e.shift())),e=e[0],a=this.player;s!==a.id||e&&a.hasMoveThrottled(G_LATENCY)||(console.info(JSON.stringify(e)),s=e[0][0],t=e[0][1],!a.checkStartMove(s,t))||a.mapStatus<2||(this.entities.pathfinder.checkValidPath(e)?this.entities.pathfinder.isValidPath(a.map.grid,e)?(a.movePath([i,n],e),s=new d.MovePath(a,e),a.map.entities.sendNeighbours(a,s)):(console.warn("handleMovePath: no valid path."),a.resetMove(a.x,a.y)):(console.warn("handleMovePath: checkValidPath false."),a.resetMove(a.x,a.y)))},handleTeleportMap:function(e){console.info("handleTeleportMap");var t,i,s,n=this,a=parseInt(e[0]),o=parseInt(e[1]),r=(console.info("status="+o),parseInt(e[2])),e=parseInt(e[3]),c=this.player;o<=0&&(e=r=-1);a<0||a>=n.server.maps.length?console.info("Map non-index"):(t=n.server.maps[a])&&t.ready?(console.warn("mapIndex: p.map.mapIndex:"+t.index),0===o?(c.forceStop(),c.mapStatus=0,c.clearTarget(),c.handleTeleport(),this.entities.removePlayer(c),pos=t.enterCallback(c),i=a,c.setMap(t),s={x:c.x,y:c.y},console.info("handleTeleportMap - x: "+r+",y:"+e),console.warn("mapIndex: p.map.mapIndex:"+t.index),s=void 0===c.prevPosX&&void 0===c.prevPosY||0===c.map.index?(c.prevPosX=c.x,c.prevPosY=c.y,n.map.getRandomStartingPosition()):1===c.map.index&&c.hasOwnProperty("prevPosX")&&c.hasOwnProperty("prevPosY")?{x:c.prevPosX,y:c.prevPosY}:n.map.getRandomStartingPosition(),n.entities.addPlayer(c),c.ex=c.sx=s.x,c.ey=c.sy=s.y,c.setPosition(s.x,s.y),c.move([Date.now(),3,1,s.x,s.y]),console.info("trying to send."),n.send([Types.Messages.WC_TELEPORT_MAP,i,1,c.x,c.y])):1===o&&(c.mapStatus=2,n.handleSpawnMap(a,c.x,c.y),n.send([Types.Messages.WC_TELEPORT_MAP,a,2,c.x,c.y]))):console.info("Map non-existant or not ready")},handleSpawnMap:function(e,t,i){var s=this.player;s.knownIds=[],s.setPosition(t,i),this.entities.processWho(s),s.map.entities.sendNeighbours(s,new d.Spawn(s),s)},handleStatAdd:function(e){var t=parseInt(e[0]),i=parseInt(e[1]),s=this.player;if(!(i<0||i>s.stats.free||t<=0||4<t)){var n=!1;switch(t){case 1:s.stats.attack+=i;break;case 2:s.stats.defense+=i;break;case 3:s.stats.health+=i,n=!0;break;case 4:s.stats.luck+=i}s.stats.free-=i,n&&(s.setHPMax(),s.setEPMax()),this.sendPlayer(new d.StatInfo(s))}},handleGold:function(e){var t=parseInt(e[0]),i=parseInt(e[1]),e=parseInt(e[2]);i<0||(9999999<i?this.sendPlayer(new d.Notify("GOLD","MAX_TRANSFER")):i>this.player.gold[t]?this.sendPlayer(new d.Notify("GOLD","INSUFFICIENT_GOLD")):(0===t&&1===e&&this.player.modifyGold(-i,0)&&this.player.modifyGold(i,1),1===t&&0===e&&this.player.modifyGold(-i,1)&&this.player.modifyGold(i,0)))},handleBlock:function(e){var t=parseInt(e[0]),i=parseInt(e[1]),s=parseInt(e[2]),n=parseInt(e[3]),a=this.player,i=this.map.entities.getEntityById(i);if(i&&i instanceof Block&&a.isNextTooEntity(i)){if(0===t)a.holdingBlock=i;else if(1===t){if(s=Utils.roundTo(s,G_TILESIZE),n=Utils.roundTo(n,G_TILESIZE),this.map.isColliding(s,n))return;i.setPosition(s,n),i.update(this.player),a.holdingBlock=null}e=new d.BlockModify(i,a.id,t);a.map.entities.sendNeighbours(a,e,a)}},handleRequest:function(e){switch(parseInt(e)){case 0:this.handleAppearanceList(e);break;case 1:this.handleRevive(e);break;case 2:this.handlePlayerInfo(e);break;case 3:this.entities.processWho(this.player)}},handleAppearanceList:function(e){this.server.looks.sendLooks(this.player)},handleRevive:function(e){var t=this.player;!0===t.isDead&&(console.info("handled Revive!!"),t.respawn(),t.map.entities.sendNeighbours(t,new d.Spawn(t),t),e=new d.Move(t,t.orientation,2,t.x,t.y),this.sendPlayer(e))},handlePlayerInfo:function(e){this.sendPlayer(new d.PlayerInfo(this.player))},handleWho:function(e){var t,i=[];for(t of i=0<e.length?e:i)this.player.knownIds.removeVal(t)},handleHarvest:function(e){var t=parseInt(e[0]),e=parseInt(e[1]);this.player.onHarvest(t,e)},handleUseNode:function(e){e=parseInt(e[0]),e=this.entities.getEntityById(e);this.player.onHarvestEntity(e)}})},{"../entity/character":24,"../entity/chest":25,"../entity/mob":29,"../entity/node":30,"../format":35,"../formulas":36,"../message":49,"../skillhandler":59,"./partyhandler":52,"./shophandler":53}],52:[function(e,t,i){var s=e("../message.js");t.exports=PartyHandler=Class.extend({init:function(e){this.ph=e,this.world=this.ph.world,this.player=this.ph.player},getPlayer:function(e){e=e.toLowerCase();var t=this.world.getPlayerByName(e);return t||(this.player.sendPlayer(new s.Notify("CHAT","NO_PLAYER_EXIST",[e])),null)},handleParty:function(e){switch(e.shift()){case 1:this.handleInvite(e);break;case 2:this.handleKick(e);break;case 3:this.handleLeader(e);break;case 4:this.handleLeave(e)}},handleInvite:function(e){var t=e[0],t=this.getPlayer(t);if(t){var e=e[1],i=this.player.party;if(this.player!==t)if(0===e)i&&5<=i.players.length?this.player.sendPlayer(new s.Notify("CHAT","PARTY_MAX_PLAYERS")):(!i||i.leader)&&t instanceof Player&&(this.player.sendToPlayer(t,new s.PartyInvite(this.player.id)),this.player.sendPlayer(new s.Notify("CHAT","PARTY_PLAYER_INVITE_SENT",[t.name])));else if(1===e){if(t.party&&t.party.removeName(t),i){if(5<=i.players.length)return void this.player.sendPlayer(new s.Notify("CHAT","PARTY_MAX_PLAYERS"));i.addName(t)}else this.world&&this.world.party?this.world.party.addParty(t,this.player):console.warn("no world or no world party.");t&&(this.player.sendToPlayer(t,new s.Notify("CHAT","PARTY_PLAYER_JOINED",[this.player.name])),this.player.sendPlayer(new s.Notify("CHAT","PARTY_PLAYER_ADDED",[t.name])))}else 2===e&&(this.player.sendPlayer(new s.Notify("CHAT","PARTY_YOU_REJECTED_INVITE",[t.name])),this.player.sendToPlayer(t,new s.Notify("CHAT","PARTY_THEY_REJECTED_INVITE",[t.name])))}},handleKick:function(e){var t,e=e[0],e=this.getPlayer(e);e&&this.player!==e&&((t=this.player.party)&&this.player===t.leader?(t.removeName(e),e instanceof Player&&this.player.sendToPlayer(e,new s.Notify("CHAT","PARTY_PLAYER_KICKED")),this.handlePartyAbandoned(t)):this.player.sendPlayer(new s.Notify("CHAT","PARTY_CANNOT_KICK")))},handleLeader:function(e){var t,e=e[0],e=this.getPlayer(e);e&&this.player!==e&&((t=this.player.party)?(this.player===t.leader?(t.setLeader(e.name),this.player.sendToPlayer(e,new s.Notify("CHAT","PARTY_YOU_LEADER")),this.player.sendPlayer(new s.Notify("CHAT","PARTY_PLAYER_LEADER",[t.leader.name]))):this.player.sendPlayer(new s.Notify("CHAT","PARTY_IS_LEADER",[t.leader.name])),t.sendMembersName()):this.player.sendPlayer(new s.Notify("CHAT","PARTY_NOT_LEADER")))},handleLeave:function(e){var t=this.player.party,i=t?t.leader:null;null!==i&&(t?(t.removeName(this.player),this.handleAbandoned(t),this.player.sendToPlayer(i,new s.Notify("CHAT","PARTY_PLAYER_LEFT",[this.player.name])),this.player!==i&&this.player.sendPlayer(new s.Notify("CHAT","PARTY_YOU_LEFT",[i.name]))):this.player.sendPlayer(new s.Notify("CHAT","PARTY_NOT_IN")))},handleAbandoned:function(e){1===e.players.length&&(this.player.sendPlayer(new s.Notify("CHAT","PARTY_ALL_LEFT")),this.player.sendPlayer(new s.Party([])),this.player!==e.players[0]&&e.players[0]instanceof Player&&(this.player.sendToPlayer(e.players[0],new s.Notify("CHAT","PARTY_ALL_LEFT")),this.player.sendToPlayer(e.players[0],new s.Party([]))),this.world&&this.world.party?this.world.party.removeParty(e):console.warn("no world or no world party."))}})},{"../message.js":49}],53:[function(e,t,i){var r=e("../message.js");t.exports=ShopHandler=Class.extend({init:function(e){this.ph=e,this.world=this.ph.world,this.player=this.ph.player},handleStoreSell:function(e){parseInt(e[0]);var t,e=parseInt(e[1]),i=this.player.itemStore[0].rooms[e];i&&(t=i.itemKind,ItemTypes.isConsumableItem(t)||ItemTypes.isLootItem(t)||(t=ItemTypes.getEnchantSellPrice(i))<0||(i=i.itemKind,this.player.inventory.makeEmptyItem(e),this.player.modifyGold(t),e=ItemTypes.KindData[i].name,this.player.sendPlayer(new r.Notify("SHOP","SHOP_SOLD",[e]))))},handleAuctionSell:function(e){var t,i,s=parseInt(e[0]),e=parseInt(e[1]);e<0||s<0||s>=this.player.inventory.maxNumber||(t=this.player.inventory.rooms[s],console.info(JSON.stringify(t)),i=t.itemKind,ItemTypes.isConsumableItem(i))||ItemTypes.isLootItem(i)||i&&(this.world.auction.add(this.player,t,e,s),this.world.auction.list(this.player,0),this.player.inventory.setItem(s,null))},handleAuctionOpen:function(e){e=parseInt(e[0]);0<=e&&e<=3&&this.world.auction.list(this.player,e)},handleAuctionBuy:function(e){var t,i,s,n,a=parseInt(e[0]),e=parseInt(e[1]);a<0||a>=this.world.auction.auctions.length||e<0||3<e||(s=this.world.auction,!(t=this.world.auction.auctions[a]))||t.playerName===this.player.name||(i=t.price)<0||(this.player.gold[0]<i?this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOGOLD")):this.player.inventory.hasRoom()?(n=t.item.itemKind,s.putItem(this.player,t.item)&&(this.player.modifyGold(-i),s=ItemTypes.KindData[n].name,this.player.sendPlayer(new r.Notify("SHOP","SHOP_SOLD",[s])),(n=this.world.getPlayerByName(t.playerName))?n.modifyGold(i):this.world.userHandler?this.world.userHandler.sendPlayerGold(t.playerName,i):console.warn("packetHander handleAuctionBuy: no world userHandler."),this.world.auction.remove(a),this.world.auction.list(this.player,e))):this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOSPACE")))},handleAuctionDelete:function(e){var t,i,s,n=parseInt(e[0]),e=parseInt(e[1]);n<0||n>=this.world.auction.auctions.length||e<0||3<e||(t=(s=this.world.auction).auctions[n])&&t.playerName===this.player.name&&(this.player.inventory.hasRoom()?(i=t.item.itemKind,s.putItem(this.player,t.item)&&(s=ItemTypes.KindData[i].name,this.player.sendPlayer(new r.Notify("SHOP","SHOP_REMOVED",[s])),this.world.auction.remove(n),this.world.auction.list(this.player,e))):this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOSPACE")))},handleStoreModItem:function(e){var t,i=parseInt(e[0]),s=parseInt(e[1]),e=parseInt(e[2]);0!==s&&2!==s||(t=this.player.itemStore[s],e<0&&e>=t.maxNumber)||(t=this.player.itemStore[s].rooms[e],0===i&&this._repairItem(s,t,e),1===i&&this._enchantItem(s,t,e))},_repairItem:function(e,t,i){var s;t&&t.itemKind&&(!ItemTypes.isEquipment(t.itemKind)||t.itemDurability===t.itemDurabilityMax||(s=~~ItemTypes.getRepairPrice(t))<=0||((goldCount=this.player.gold[0])<s?this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOGOLD")):(t.itemDurabilityMax-=50,t.itemDurability=t.itemDurabilityMax,t.itemDurabilityMax<=0?(t=null,this.player.itemStore[e].makeEmptyItem(i)):(console.info("itemNumber="+t.itemNumber),this.player.modifyGold(-s)),t.slot=i,this.player.sendPlayer(new r.ItemSlot(e,[t])),s=ItemTypes.KindData[t.itemKind].name,this.player.sendPlayer(new r.Notify("SHOP","SHOP_REPAIRED",[s])))))},_enchantItem:function(e,t,i){var s;t&&t.itemKind&&(!ItemTypes.isEquipment(t.itemKind)||(s=ItemTypes.getEnchantPrice(t))<=0||((goldCount=this.player.gold[0])<s?this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOGOLD")):(t.itemExperience=ItemTypes.itemExpForLevel[t.itemNumber-1],t.itemNumber++,t.slot=i,this.player.sendPlayer(new r.ItemSlot(e,[t])),console.info("itemNumber="+t.itemNumber),this.player.modifyGold(-s),i=ItemTypes.KindData[t.itemKind].name,this.player.sendPlayer(new r.Notify("SHOP","SHOP_ENCHANTED",[i])))))},handleStoreBuy:function(e){parseInt(e[0]);var t,i,s=parseInt(e[1]),e=parseInt(e[2]),n=null;!s||e<=0||s<0||s>=ItemTypes.KindData.length||(n=(t=ItemTypes.KindData[s]).name,0<(i=ItemTypes.getBuyPrice(s))&&(ItemTypes.Store.isBuyMultiple(s)&&(e=t.buycount),this.player.gold[0]<i?this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOGOLD")):(t=ItemTypes.isConsumableItem(s))||!t&&this.player.inventory.hasRoom()?(t=new ItemRoom([s,e,0,0,0]),-1!==this.player.inventory.putItem(t)&&(this.player.modifyGold(-i),this.player.sendPlayer(new r.Notify("SHOP","SHOP_BUY",[n])))):this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOSPACE"))))},handleCraft:function(e){var t=parseInt(e[0]),i=parseInt(e[1]),e=0;if(!(i<=0||t<0||t>=ItemData.CraftData.length)){var t=ItemData.CraftData[t],s=Number(t.o);if(ItemTypes.KindData.hasOwnProperty(s)){var n=ItemTypes.KindData[s],a=n.name,e=ItemTypes.getCraftPrice(s);if(!(e<0))if(i=ItemTypes.Store.isBuyMultiple(s)?i<n.buycount?i:n.buycount:1,this.player.gold[0]<(e*=i))this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOGOLD"));else if(0!==n.craft.length){for(var o of t.i)if(!this.player.inventory.hasItems(o[0],o[1]*i))return void this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOCRAFTITEMS"));if(this.player.inventory.hasRoom()){this.player.modifyGold(-e);for(var o of t.i)this.player.inventory.removeItemKind(o[0],o[1]*i);n=0,e=((ItemTypes.isWeapon()||ItemTypes.isArmor())&&(n=900),new ItemRoom([s,i,n,n]));-1!==this.player.inventory.putItem(e)&&this.player.sendPlayer(new r.Notify("SHOP","SHOP_BUY",[a]))}else this.player.sendPlayer(new r.Notify("SHOP","SHOP_NOSPACE"))}}else console.error("handleCraft - itemData not found for kind: "+s)}}})},{"../message.js":49}],54:[function(e,t,i){e("./lib/astar"),e("./utils");t.exports=Pathfinder=Class.extend({init:function(e,t){this.width=e,this.height=t,this.grid=null,this.blankGrid=[],this.initBlankGrid_(),this.ignored=[],this.included=[]},initBlankGrid_:function(){},isPathTicksTooFast:function(e,t,i,s){s=s||2*G_FRAME_INTERVAL,console.info("pathFinder - isPathTicksTooFast:");i=~~((Date.now()-i)*(e.tick/G_FRAME_INTERVAL_EXACT)),i=Math.max(i,0),t=this.getPathTicks(t,e.x,e.y);return i+s<t&&(console.warn("SPEED HACK DETECTED. playerTicks - actualTicks: "+t+", elapsedTicks:"+i+", tolerance:"+s),!0)},getPathTicks:function(e,t,i){count=0;var s,n=null;for(s of e){if(n){if(t==s[0]&&t==n[0]&&i>=Math.min(s[1],n[1])&&i<=Math.max(s[1],n[1])){count+=Math.abs(n[1]-i);break}if(i==s[1]&&i==n[1]&&t>=Math.min(s[0],n[0])&&t<=Math.max(s[0],n[0])){count+=Math.abs(n[0]-t);break}count+=Math.abs(s[0]-n[0])+Math.abs(s[1]-n[1])}n=s}return count},getPathTicks2:function(e){var t,i,s=0;for(i of e)t&&(s+=Math.abs(i[0]-t[0])+Math.abs(i[1]-t[1])),t=i;return s},getPathUntil:function(e,t){if(t<0)return null;var i,s,n=this.getPathTicks2(e)-t,a=[],o=0;for(s of e){if(i){var r=Math.abs(s[0]-i[0]),c=Math.abs(s[1]-i[1]);if((o+=t=r+c)===n){a.push(s);break}if(n<o){var l=s,p=o-n;0<r&&(l[0]+=s[0]-i[0]<0?p:-p),0<c&&(l[1]+=s[1]-i[1]<0?p:-p),a.push(l);break}}i=s,a.push(s)}return a},isInPath:function(e,t){var i,e=e.map(function(e){return e.slice()}),s=e.shift();for(i of e){if(s[0]===i[0]&&s[1]>=t[1]&&i[1]<=t[1]||s[1]===i[1]&&s[0]>=t[0]&&i[0]<=t[0])return!0;s=i}return!1},checkValidPath:function(e){var t,i=null;if(!Array.isArray(e)||e.length<2)return!1;for(t of e){if(i)if(i[0]!==t[0]&&i[0]!==t[1]&&i[1]!==t[0]&&i[1]!==t[1])return!1;i=t}return!0},isValidPath:function(r,e,t){for(var i=G_TILESIZE,s=r.length,n=r[0].length,a=function(e,t,i,s){e=Math.floor(e),t=Math.floor(t),i=Math.floor(i);var n=Math.min(e,t),a=Math.max(e,t);if(s){for(var o=n;o<a;o++)if(r[i][o])return!1}else for(o=n;o<a;o++)if(r[o][i])return!1;return!0},o=[],c=0;c<e.length;c++)o[c]=e[c].slice();if(!t)for(var l of o)l[0]/=i,l[1]/=i;var p,u,d=null;for(l of o){if(l[1]<0||l[1]>=s)return!1;if(l[0]<0||l[0]>=n)return!1;if(d){if(l[0]!=d[0]&&l[1]!=d[1])return!1;if(0<Math.abs(l[0]-d[0])){if(p=d[0],u=l[0],!a(p,u,l[1],!0))return!1}else if(0<Math.abs(l[1]-d[1])&&(p=d[1],u=l[1],!a(p,u,l[0],!1)))return!1}d=l}return!0},getShortGrid:function(e,t,i,s){for(var n=G_TILESIZE,a=(t=[t[0]/n,t[1]/n],i=[i[0]/n,i[1]/n],Math.max(Math.min(Math.floor(t[0]),Math.floor(i[0]))-s,0)),o=Math.min(Math.max(Math.ceil(t[0]),Math.ceil(i[0]))+s,e[0].length-1),n=Math.max(Math.min(Math.floor(t[1]),Math.floor(i[1]))-s,0),r=Math.min(Math.max(Math.ceil(t[1]),Math.ceil(i[1]))+s,e.length-1),c=(t=[t[0]-a,t[1]-n],i=[i[0]-a,i[1]-n],o=Math.min(e[0].length-1,o),r=Math.min(e.length-1,r),new Array(r-n)),l=0,p=n;p<=r;++p)c[l++]=e[p].slice(a,o);return{crop:c,minX:a,minY:n,substart:t,subend:i}},findNeighbourPath:function(e,t){var i=G_TILESIZE;return Math.abs(e[0]-t[0])<=i&&0===Math.abs(e[1]-t[1])||Math.abs(e[1]-t[1])<=i&&0===Math.abs(e[0]-t[0])?[[e[0],e[1]],[t[0],t[1]]]:null},getFullFromShortPath:function(e,t,i){var s=G_TILESIZE;if(e&&0<e.length){for(var n=e.length,a=0;a<n;++a)e[a][0]=(e[a][0]+t)*s,e[a][1]=(e[a][1]+i)*s;return console.info(JSON.stringify(e)),e}return null},findDirectPath:function(e,t,i){var s=Math.abs(Math.floor(t[0])-Math.floor(i[0])),n=Math.abs(Math.floor(t[1])-Math.floor(i[1])),a=[t,i];return 0!==s&&0!==n||!this.isValidPath(e,a)?(a=[t,[t[0],i[1]],i],log.info("mp:"+JSON.stringify(a)),this.isValidPath(e,a)?(log.info("validpath-fdp2:"+JSON.stringify(a)),a):(a=[t,[i[0],t[1]],i],log.info("mp:"+JSON.stringify(a)),this.isValidPath(e,a)?(log.info("validpath-fdp3:"+JSON.stringify(a)),a):null)):(log.info("validpath-fdp1:"+JSON.stringify(a)),a)},findShortPath:function(e,t,i,s,n){e=AStar.AStar(e,s,n);return this.getFullFromShortPath(e,t,i)},findPath:function(e,t,i,s){return this.grid=e,this.applyIgnoreList_(this.grid,!0),this.applyIncludeList_(this.grid,!0),AStar.AStar(this.grid,t,i)},findIncompletePath_:function(e,t){for(var i,s,n=[],a=AStar.AStar(this.blankGrid,e,t),o=a.length-1;0<o;--o)if(i=a[o][0],s=a[o][1],0===this.grid[s][i]){n=AStar(this.grid,e,[i,s]);break}return n},ignoreEntity:function(e){e&&this.ignored.push(e)},includeEntity:function(e){e&&this.included.push(e)},applyIgnoreList_:function(t,i){var s,n;_.each(this.ignored,function(e){s=e.isMoving()?e.nextGridX:e.gx,n=e.isMoving()?e.nextGridY:e.gy,0<=s&&0<=n&&(t[n][s]=i?0:1)})},applyIncludeList_:function(t,i){var s,n;_.each(this.included,function(e){s=e.isMoving()?0<e.path.length?e.path[e.path.length-1][0]:e.nextGridX:e.gx,n=e.isMoving()?0<e.path.length?e.path[e.path.length-1][1]:e.nextGridY:e.gy,0<=s&&0<=n&&(t[n][s]=i?1:0)})},clearIgnoreList:function(e){this.applyIgnoreList_(e,!1),this.ignored=[]},clearIncludeList:function(e){this.applyIncludeList_(e,!1),this.ignored=[]}})},{"./lib/astar":43,"./utils":66}],55:[function(e,t,i){e("./message.js");t.exports=PlayerGroup=Class.extend({init:function(e,t,i){this.players=[],this.allowOnce=i,this.group=t,this.world=e.world,this.addName(e.name),this.setLeader(e.name)},containsName:function(e){return this.players.includes(e)},setLeader:function(e){this.leader=e;e=this.players.indexOf(this.leader);0!=e&&Utils.SwapElements(this.players,0,e)},addName:function(e){var t;e&&(0===this.players.length&&(this.leader=e),this.containsName(e)||this.players.push(e),t=this.getPlayer(e))&&(this.allowOnce&&t[this.group]&&t[this.group].removeName(e),t[this.group]=this),this.sendMembersName()},getPlayer:function(e){if(e){e=this.world.getPlayerByName(e);if(e)return e}return null},sendPlayers:function(t,i){var s=this;this.forEachName(function(e){i&&this.leader===e||e&&(e=s.getPlayer(e))&&e.sendPlayer(t)})},forEachName:function(e){for(var t=this.players.length,i=0;i<t;++i)e&&e(this.players[i])},forEachPlayer:function(e){for(var t,i=this.players.length,s=0;s<i;++s)e&&(t=this.getPlayer(this.players[s]))&&e(t)},removeName:function(e){var t;e===this.leader&&(this.leader=this.players[0]),e&&(this.containsName(e)&&((t=this.getPlayer(e))&&(t[this.group]=null),this.players.removeVal(e)),this.sendMembersName())},setMemberMessage:function(e){this.memberMessage=e},sendMembersName:function(){this.memberMessage&&this.sendPlayers(new this.memberMessage(this.players),!0)}})},{"./message.js":49}],56:[function(e,t,i){var s=e("./message");t.exports=PlayerQuests=cls.Class.extend({init:function(e){this.player=e,this.quests=[],this.completeQuests={}},questAboutKill:function(e,t){var i=e.kind,s=t.count<t.object.count,i=t.type===QuestType.KILLMOBKIND&&s&&i===t.object.kind,n=e.level>=t.object.level[0]&&e.level<=t.object.level[1];(i||t.type===QuestType.KILLMOBS&&s)&&n&&(console.info("_questAboutKill - conditions met."),t.data1+=~~(e.stats.xp/1.5),++t.count===t.object.count?this.completeQuest(t,t.data1):this.progressQuest(t))},questAboutItemCheck:function(e,t){var i=t.object2.kind+1e3;t.object2.type===Types.EntityTypes.ITEMLOOT&&t.object.type===Types.EntityTypes.MOB&&t.object.kind===e.kind&&t.status!=QuestStatus.COMPLETE&&(t.count<t.object2.count||this.player.inventory.hasItemCount(i)<t.object2.count)&&(e.questDrops[i]=parseInt(10*t.object2.chance),t.object2.chance+=1)},questAboutUseNode:function(e){var t;e.count++,e.count>=e.object.count?(e.count=e.object.count,t=10*e.object.count*this.player.level,this.completeQuest(e,t)):this.progressQuest(e)},questAboutItem:function(e){console.info(JSON.stringify(e));var t=e.object2.kind+1e3,t=this.player.inventory.hasItemCount(t);e.count=t,this.progressQuest(e)},questAboutFind:function(e){var t;e.count++>=e.object.count&&e.status===QuestStatus.INPROGRESS&&(e.count=e.object.count,t=10*e.object.count*this.player.level,this.completeQuest(e,t))},questAboutItemComplete:function(e,t){if(e.count>=e.object2.count&&e.status==QuestStatus.INPROGRESS){var i=e.object2.kind+1e3;if(!this.player.inventory.hasItemCount(i))return;this.player.inventory.removeItemKind(i,e.object2.count);i=20*e.object2.count*this.player.level;return this.completeQuest(e,i),t&&t(e),!0}return!1},sendQuest:function(e){this.player.sendPlayer(new s.Quest(e))},progressQuest:function(e){e.status=QuestStatus.INPROGRESS,this.sendQuest(e)},completeQuest:function(e,t){var i;0<t&&(i=e.data?e.data.expMultiplier:1,this.player.incExp(t*i)),e.status=QuestStatus.COMPLETE,this.sendQuest(e),this.completeQuests[e.id]={npcid:e.npcQuestId},this.removeQuest(e)},removeQuest:function(e){this.quests.removeVal(e)},foundQuest:function(e){this.quests.push(e),e.status=QuestStatus.STARTED,this.sendQuest(e)},hasNpcCompleteQuest:function(e){var t,i=this.completeQuests;for(t in i){var s=i[t];if(s.hasOwnProperty("npcid")&&s.npcid===e)return!0}return!1},getQuestById:function(t){return this.quests.find(function(e){return e.id===t})},hasQuest:function(e){return null!=this.getQuestById(e)},forQuestsType:function(e,t){for(var i of this.quests)i.type===e&&t&&t(i)}})},{"./message":49}],57:[function(t,e,i){var s=t("./lib/class").Class.extend({init:function(e){this.config=e;try{this.production=t("../production_hosts/"+e.production+".js")}catch(e){this.production=null}},inProduction:function(){return null!==this.production&&this.production.isActive()},getProductionSettings:function(){if(this.inProduction())return this.production}});e.exports=s},{"./lib/class":44}],58:[function(e,t,i){e=e("./lib/class");t.exports=getQuestObject=function(e){var t={toArray:function(e){return[e.type,e.kind,e.count,e.chance,e.level[0],e.level[1]]},toClient:function(e){return[e.type,e.kind,e.count]}};return t.type=parseInt(e[0]),t.kind=parseInt(e[1])||0,t.count=parseInt(e[2])||0,t.chance=parseInt(e[3])||0,4===e.length&&(t.level=[0,99]),5===e.length&&(t.level=[parseInt(e[4]),99]),6===e.length&&(t.level=[parseInt(e[4]),parseInt(e[5])]),t},t.exports=Quest=e.Class.extend({init:function(e){e&&(this.id=parseInt(e[0]),this.type=parseInt(e[1]),this.npcQuestId=parseInt(e[2]),this.count=parseInt(e[3])||0,this.status=parseInt(e[4])||0,this.data1=parseInt(e[5])||0,this.data2=parseInt(e[6])||0,this.object=e[7]||null,this.object2=e[8]||null)},assign:function(e){this.id=parseInt(e.id),this.type=parseInt(e.type),this.npcQuestId=parseInt(e.npcQuestId),this.count=parseInt(e.count),this.status=parseInt(e.status),this.data1=parseInt(e.data1),this.data2=parseInt(e.data2),this.object=e.object,this.object2=e.object2},toArray:function(){var e=[parseInt(this.id),parseInt(this.type),parseInt(this.npcQuestId),parseInt(this.count),parseInt(this.status),parseInt(this.data1),parseInt(this.data2)];return this.object&&(e=e.concat(this.object.toArray(this.object))),e=this.object2?e.concat(this.object2.toArray(this.object2)):e},toClient:function(){var e=[this.id,this.type,this.npcQuestId,this.count,this.status,this.data1,this.data2],e=this.object?e.concat(this.object.toClient(this.object)):e.concat([0,0,0]);return e=this.object2?e.concat(this.object2.toClient(this.object2)):e.concat([0,0,0])},toString:function(){return this.toArray().join(",")}})},{"./lib/class":44}],59:[function(e,t,i){var n=e("./message.js");t.exports=SkillHandler=cls.Class.extend({init:function(e){e.skills=[],this.player=e,this.skills=this.player.skills},clear:function(){},setSkills:function(e,t){for(var i=0;i<t.length;++i){var s=new Skill(e,i,t[i]);e.skills[i]=s}},setSkill:function(e,t){e=player.skills[e];e.skillXP=t,e.skillLevel=Types.getSkillLevel(t)},setXPs:function(){for(var e=[],t=0;t<this.skills.length;++t){var i=this.skills[t],s=parseInt(i.tempXP);0<s&&(i.xp(s),e.push(t,i.skillXP),i.tempXP=0)}0<e.length&&this.player.sendPlayer(new n.SkillXP(e))}}),Skill=cls.Class.extend({init:function(e,t,i){this.player=e,console.info("skillIndex:"+t),this.skillData=SkillData.Skills[t],this.skillIndex=t,this.skillLevel=Types.getSkillLevel(i),this.skillXP=parseInt(i),(this.tempXP=0)<this.skillData.recharge&&(this.skillCooldown=new Timer(this.skillData.recharge),this.skillCooldown.lastTime=0)},getSkill:function(){return this.skillData},isReady:function(){return this.skillCooldown.isOver()},xp:function(e){0!==e&&(console.info("amount="+e),this.skillXP+=parseInt(e),(e=Types.getSkillLevel(this.skillXP,this.skillLevel))!=this.skillLevel)&&(this.skillLevel=e,this.player.effectHandler.skillEffects[this.skillIndex].level=e,this.player.sendPlayer(new n.SkillLoad(this.skillIndex,this.skillXP)))}})},{"./message.js":49}],60:[function(e,t,i){e=e("./lib/class");t.exports=Timer=e.Class.extend({init:function(e,t){this.restart(t),this.duration=e},restart:function(e){this.lastTime=e||Date.now()},isOver:function(e){var t=!1;return(e=!isNaN(e)&&null!==e&&0!==e?e:Date.now())-this.lastTime>this.duration&&(t=!0,this.lastTime=e),t}})},{"./lib/class":44}],61:[function(e,t,i){t.exports=Transition=Class.extend({init:function(e){this.startValue=0,this.endValue=0,this.duration=0,this.inProgress=!1,this.modValue=0,this.object=e},start:function(e,t,i){this.updateFunction=e,this.stopFunction=t,this.modValue=i,this.inProgress=!0},step:function(){if(this.inProgress){var e=this.modValue;if(0!==e)if(this.updateFunction)for(var t=Math.abs(e),i=0<e?1:-1,s=0;s<t;++s)if(this.updateFunction(this.object,i))return void this.stop(this.object)}},stop:function(){this.stopFunction&&this.stopFunction(this.object),this.inProgress=!1}})},{}],62:[function(e,t,i){e("./message"),e("underscore"),e("./utils");t.exports=Updater=Class.extend({init:function(e,t){var i=this;this.ws=e,this.server=e,this.map=t,this.time=Date.now(),this.whoDist=8*G_TILESIZE,this.charPathXF=function(e,t){t=e.x+t;return e.setPosition(t,e.y),e.nextStep()},this.charPathYF=function(e,t){t=e.y+t;return e.setPosition(e.x,t),e.nextStep()},this.playerPathXF=function(e,t){t=e.x+t;return e.setPosition(t,e.y),t%i.whoDist==0&&e.map.entities.processWho(e),e.nextStep()},this.playerPathYF=function(e,t){t=e.y+t;return e.setPosition(e.x,t),t%i.whoDist==0&&e.map.entities.processWho(e),e.nextStep()},this.playerKeyXF=function(e,t){t=e.x+t;return((e.startMoving||t%G_TILESIZE==0)&&i.checkCollide(e,t,e.y)||(e.startMoving=!1,e.setPosition(t,e.y),t%i.whoDist==0&&e.map.entities.processWho(e),!!e.checkStopDanger(e,e.orientation)))&&(e.forceStopMove(),!0)},this.playerKeyYF=function(e,t){t=e.y+t;return((e.startMoving||t%G_TILESIZE==0)&&i.checkCollide(e,e.x,t)||(e.startMoving=!1,e.setPosition(e.x,t),t%i.whoDist==0&&e.map.entities.processWho(e),!!e.checkStopDanger(e,e.orientation)))&&(e.forceStopMove(),!0)}},update:function(){var e,t,i=null,s=(this.time=Date.now(),this.map.entities.characters);for(e in s)s.hasOwnProperty(e)&&(!(t=s[e])||t.isDead||t.isStunned||(t instanceof Player?(this.updatePlayerKeyMovement(t),t.path&&this.updatePlayerPathMovement(t),t.neighboursUpdated=!1):t.path&&this.updateCharacterPathMovement(t),(i=t.movement)&&i.inProgress&&i.step(this.time)))},checkCollide:function(e,t,i){if(e instanceof Player)return!!e.map.isColliding(t,i)||!(!e.holdingBlock||(pos=e.nextTile(),!e.map.isColliding(pos[0],pos[1])))},moveCharacter:function(e,t,i,s){return!this.checkCollide(e,t,i,s)||(c.setPosition(c.x,c.y),console.warn("char.isColliding("+e.id+","+i+","+s+")"),!1)},updateCharacterPathMovement:function(e){var t=e.tick*G_FRAME_INTERVALS,i=e.orientation;e.isDead||e.freeze||e.isStunned||!1===e.movement.inProgress&&e.isMovingPath()&&(i===Types.Orientations.LEFT?e.movement.start(this.charPathXF,null,-t):i===Types.Orientations.RIGHT?e.movement.start(this.charPathXF,null,t):i===Types.Orientations.UP?e.movement.start(this.charPathYF,null,-t):i===Types.Orientations.DOWN&&e.movement.start(this.charPathYF,null,t))},updatePlayerPathMovement:function(e){var t=e.tick*G_FRAME_INTERVALS,i=e.orientation;e.isDead||e.freeze||e.isStunned||!1===e.movement.inProgress&&e.isMovingPath()&&(i===Types.Orientations.LEFT?e.movement.start(this.playerPathXF,null,-t):i===Types.Orientations.RIGHT?e.movement.start(this.playerPathXF,null,t):i===Types.Orientations.UP?e.movement.start(this.playerPathYF,null,-t):i===Types.Orientations.DOWN&&e.movement.start(this.playerPathYF,null,t))},updatePlayerKeyMovement:function(e){var t=e.tick*G_FRAME_INTERVALS,i=e.moveOrientation;e.freeze||e.isMovingPath()||!1===e.movement.inProgress&&0<i&&(i===Types.Orientations.LEFT?e.movement.start(this.playerKeyXF,null,-t):i===Types.Orientations.RIGHT?e.movement.start(this.playerKeyXF,null,t):i===Types.Orientations.UP?e.movement.start(this.playerKeyYF,null,-t):i===Types.Orientations.DOWN&&e.movement.start(this.playerKeyYF,null,t))}})},{"./message":49,"./utils":66,underscore:310}],63:[function(e,t,i){var s=e("./usermessage");t.exports=UserHandler=cls.Class.extend({init:function(e,t,i,s){var n=this;this.main=e,this.server=t,this.world=i,this.connection=s,this.connection.listen(function(e){console.info("recv="+JSON.stringify(e));var t=parseInt(e[0]);switch(e.shift(),t){case Types.UserMessages.UW_LOAD_PLAYER_DATA:return void n.handleLoadPlayerData(e);case Types.UserMessages.UW_LOAD_PLAYER_AUCTIONS:return void n.handleLoadPlayerAuctions(e);case Types.UserMessages.UW_LOAD_PLAYER_LOOKS:return void n.handleLoadPlayerLooks(e);case Types.UserMessages.UW_LOAD_USER_BANS:return void n.handleLoadUserBans(e);case Types.UserMessages.UW_WORLD_SAVE:return void n.handleWorldSave(e);case Types.UserMessages.UW_WORLD_CLOSE:return void n.handleWorldClose(e)}}),this.sendOldPackets()},sendOldPackets:function(){for(var e of userHandlerPackets)this.connection.send(e.serialize());userHandlerPackets=[]},onExit:function(){},send:function(e){this.connection.send(e)},handleWorldSave:function(e){console.info("handleWorldSave."),this.main.saveServer()},handleWorldClose:function(e){console.info("handleWorldClose."),this.main.safe_exit()},handleLoadPlayerAuctions:function(e){console.info("handleLoadPlayerAuctions: "+JSON.stringify(e)),e&&this.world.auction.load(e)},handleLoadPlayerLooks:function(e){console.info("handleLoadPlayerLooks: "+JSON.stringify(e)),e&&this.world.looks.load(e)},handleLoadUserBans:function(e){console.info("handleLoadUserBans: "+JSON.stringify(e)),e&&(this.world.ban?this.world.ban.loadBans(e):console.warn("world ban not loaded."))},handleLoadPlayerData:function(e){console.info("userHandler, handleLoadPlayerData.");var t=e[0],e=e[1],i=e[0][1];this.world.ban.isUserBanned(i)?console.info("USER IS BANNED."):(console.info("handleLoadPlayerData data: "+JSON.stringify(e)),this.handleLoadUserInfo(t,e[0]),this.handleLoadPlayerInfo(e[1]),this.handleLoadPlayerQuests(e[2]),this.handleLoadPlayerAchievements(e[3]),this.handleLoadPlayerItems(0,e[4]),this.handleLoadPlayerItems(1,e[5]),this.handleLoadPlayerItems(2,e[6]),i=this.player,console.info("player hash: "+i.hash),hashes[i.hash]=i,this.player=null,this.send([Types.UserMessages.WU_PLAYER_LOADED,MainConfig.protocol,MainConfig.address,MainConfig.port]))},handleLoadUserInfo:function(e,t){console.info("handleLoadUserInfo: "+JSON.stringify(t));var i=t[0],s=t[1],n=parseInt(t[2]),t=t[3],a=this.connection,o={},n=(o.hashChallenge=a.hash,o.world=this.world,o.conn=a,(o.userHandler=this).server.enterWorld(a),o.gems=n,AppearanceData.Data.length);o.looks=Utils.Base64ToBinArray(t,n),o.name=i,(player=new Player(this.world,o,a)).name=e,player.hash=s,player.loaded=0,player.worldHandler=o.worldHandler,this.player=player,this.loadedPlayer=!0},handleLoadPlayerInfo:function(e){console.info("handleLoadPlayerInfo: "+JSON.stringify(e));var t=this.player,e={name:e[0],map:e[1].split(","),stats:e[2].split(","),exps:e[3].split(","),gold:e[4].split(","),skills:e[5].split(","),pStats:e[6].split(","),sprites:e[7].split(","),colors:e[8].split(","),shortcuts:e[9],completeQuests:e[10]};console.info("shortcuts: "+JSON.stringify(e.shortcuts)),console.info("completeQuests: "+JSON.stringify(e.completeQuests)),e.shortcuts&&(e.shortcuts=JSON.parse(e.shortcuts)),e.completeQuests&&(e.completeQuests=JSON.parse(e.completeQuests)),t.fillPlayerInfo(e)},handleLoadPlayerQuests:function(e){console.info("handleLoadPlayerQuests: "+JSON.stringify(e));var t=this.player;console.info("msg="+e);try{dataJSON=JSON.parse(e);for(var i=0;i<dataJSON.length;i++){var s,n=dataJSON[i].split(",");n&&(console.info(JSON.stringify(n)),s=new Quest(n.splice(0,7)),0<n.length&&(s.object=getQuestObject(n.splice(0,6))),0<n.length&&(s.object2=getQuestObject(n.splice(0,6))),s.data=QuestData.Data.hasOwnProperty(s.id)?QuestData.Data[s.id]:null,t.quests.quests.push(s))}}catch(e){console.warn(e.stack)}},handleLoadPlayerAchievements:function(e){console.info("handleLoadPlayerAchievements: "+JSON.stringify(e));for(var t=this.player,i=getInitAchievements(),s=e.split(","),n=~~(s.length/3),a=0;a<n;++a){var o=getSavedAchievement(s.splice(0,3));t.achievements.push(o)}for(a=n;a<i.length;++a)t.achievements.push(i[a])},handleLoadPlayerItems:function(e,t){console.info("handleLoadPlayerItems: "+JSON.stringify(t));var i,s,n=this.player,a=[];console.info("getItems - data="+t);for(i of dataJSON=JSON.parse(t))i&&((s=new ItemRoom([parseInt(i[1]),parseInt(i[2]),parseInt(i[3]),parseInt(i[4]),parseInt(i[5])])).slot=parseInt(i[0]),a.push(s));t=null;0===e?(n.inventory=new Inventory(n,50,a),t=n.inventory):1===e?(n.bank=new Bank(n,96,a),t=n.bank):2===e&&(n.equipment=new Equipment(n,5,a),t=n.equipment,n.equipment.setItem=function(e,t){e=n.equipment._setItem(e,t);return n.setRange(),e}),n.itemStore[e]=t},sendToUserServer:function(e){this.connection?this.connection.send(e.serialize()):(userHandlerPackets.push(e),console.info("userHandler: sendToUserServer called without connection being set: "+JSON.stringify(e.serialize())))},sendWorldInfo:function(e){e=new s.ServerInfo(e,0);this.sendToUserServer(e)},sendWorldPlayerCount:function(e,t){this.sendToUserServer(new s.UpdatePlayerCount(e,t))},sendAuctionsData:function(e){this.sendToUserServer(new s.SavePlayerAuctions(e))},sendLooksData:function(e){this.sendToUserServer(new s.SavePlayerLooks(e))},sendBansData:function(e){this.sendToUserServer(new s.SaveUserBans(e))},sendPlayerGold:function(e,t){this.sendToUserServer(new s.SendPlayerGold(e,t))},sendPlayerLogout:function(e){this.sendToUserServer(new s.playerLoggedIn(0,e.user.name,e.name))},sendPlayersList:function(e){console.info("userHandler - sendPlayersList: "+JSON.stringify(e)),this.sendToUserServer(new s.SavePlayersList(e))}})},{"./usermessage":64}],64:[function(e,t,i){var s={},t=(t.exports=s,cls.Class.extend({}));s.UpdatePlayerCount=t.extend({init:function(e,t){this.count=e,this.maxCount=t},serialize:function(){return[Types.UserMessages.WU_UPDATE_PLAYER_COUNT,this.count,this.maxCount]}}),s.SendPlayerGold=t.extend({init:function(e,t){this.name=e,this.gold=t},serialize:function(){return[Types.UserMessages.WU_ADD_PLAYER_GOLD,this.name,this.gold]}}),s.SavePlayerAuctions=t.extend({init:function(e){this.data=e},serialize:function(){return[Types.UserMessages.WU_SAVE_PLAYER_AUCTIONS].concat(this.data)}}),s.SavePlayerLooks=t.extend({init:function(e){this.data=e},serialize:function(){return[Types.UserMessages.WU_SAVE_PLAYER_LOOKS].concat(this.data)}}),s.SaveUserBans=t.extend({init:function(e){this.data=e},serialize:function(){return[Types.UserMessages.WU_SAVE_USER_BANS,this.data]}}),s.ServerInfo=t.extend({init:function(e,t){this.config=e,this.count=t||0},serialize:function(){return[Types.UserMessages.WU_GAMESERVER_INFO,this.config.world_name,this.count,this.config.nb_players_per_world,this.config.address,this.config.port,this.config.user_password,this.config.world_key]}}),s.SavePlayersList=t.extend({init:function(e){this.data=e},serialize:function(){return[Types.UserMessages.WU_SAVE_PLAYERS_LIST,this.data]}}),s.playerLoggedIn=t.extend({init:function(e,t,i){this.status=e,this.username=t,this.playerName=i},serialize:function(){return[Types.UserMessages.WU_PLAYER_LOGGED_IN,this.status,this.username,this.playerName]}}),s.SavePlayerData=t.extend({init:function(e,t,i){this.playerName=e,this.playerData=t,this.update=i},serialize:function(){return[Types.UserMessages.WU_SAVE_PLAYER_DATA,this.playerName,this.playerData,this.update?1:0]}})},{}],65:[function(e,t,i){var s=e("../format").check,c=e("./usermessage"),n=e("../message");t.exports=WorldHandler=cls.Class.extend({init:function(e,t){var i=this;this.main=e,this.connection=t,this.playerSaveData={},this.connection.listen(function(e){console.info("recv="+JSON.stringify(e));var t=parseInt(e[0]);t&&!s(e)?i.connection.close("Invalid "+Types.getMessageTypeAsString(t)+" message format: "+e):(e.shift(),t===Types.Messages.CW_LOGIN_PLAYER&&i.handleLoginPlayer(e))})},onExit:function(){},sendPlayer:function(e){this.connection.send(e)},sendPlayerMessage:function(e){this.connection.send(e.serialize())},handleLoginPlayer:function(e){console.info("worldHandler, handleLoginPlayer: "+JSON.stringify(e));var t=e[0],e=e[1],i=null;(i=hashes.hasOwnProperty(e)?hashes[e]:i)?(e=i.user.name,users.hasOwnProperty(e)?(console.info("player user is already logged in."),this.sendPlayerMessage(new n.Error("user already logged in.")),this.connection.disconnect()):(users[e]=t,i.world&&i.world.ban?i.world.ban.isUserBanned(e)?(console.info("player user is banned from server."),this.sendPlayerMessage(new n.Error("user is banned.")),this.connection.disconnect()):(i.start(this.connection),this.sendToUserServer(new c.playerLoggedIn(1,i.user.name,t))):console.warn("handleLoginPlayer: world or world ban not set"))):(console.info("player hash does not exist."),this.connection.disconnect())},loadPlayerDataUserInfo:function(e,t){var e=e.user,i=[e.name,e.hash,Number(e.gems),Utils.BinArrayToBase64(e.looks)];t&&t(e.name,i)},loadPlayerDataInfo:function(e,t){for(var i=[e.stats.attack,e.stats.defense,e.stats.health,e.stats.energy,e.stats.luck,e.stats.free],s=[Utils.NaN2Zero(e.exp.base),Utils.NaN2Zero(e.exp.attack),Utils.NaN2Zero(e.exp.defense),Utils.NaN2Zero(e.exp.move),Utils.NaN2Zero(e.exp.sword),Utils.NaN2Zero(e.exp.bow),Utils.NaN2Zero(e.exp.hammer),Utils.NaN2Zero(e.exp.axe),Utils.NaN2Zero(e.exp.logging),Utils.NaN2Zero(e.exp.mining)],n=[e.map.index,e.x,e.y,e.orientation],a=[],o=0;o<e.skills.length;++o)a[o]=e.skills[o].skillXP;Utils.BinArrayToBase64(e.user.looks);n=[e.name,n.join(","),i.join(","),s.join(","),e.gold.join(","),a.join(","),e.pStats.join(","),e.sprites.join(","),e.colors.join(","),JSON.stringify(e.shortcuts),JSON.stringify(e.quests.completeQuests)];t&&t(e.name,n)},loadPlayerDataQuests:function(e,t){var i,s=[];for(i of e.quests.quests)i&&i.status!==QuestStatus.COMPLETE&&!_.isEmpty(i)&&s.push(i.toArray().join(","));t&&t(e.name,s)},loadPlayerDataAchievements:function(e,t){var i,s="";for(i of e.achievements)s+=i.toRedis(i).join(",")+",";s=s.slice(0,-1),t&&t(e.name,s)},loadPlayerDataItems:function(e,t,i){i&&i(e.name,t,e.itemStore[t].toStringJSON())},sendToUserServer:function(e){this.userConnection?this.userConnection.send(e.serialize()):console.info("worldHandler: sendToUserServer called without userConnection being set: "+JSON.stringify(e.serialize()))},savePlayer:function(s,n){console.info("worldHandler - savePlayer, name:"+s.name);function a(e,t){var i=o.playerSaveData[r];i.count++,i.data[e]=t,7===i.count?(e=new c.SavePlayerData(r,i.data,n),o.sendToUserServer(e),delete o.playerSaveData[r]):o.playerSaveData[r]=i}var o=this,r=(s.user.name,s.name);this.loadPlayerDataUserInfo(s,function(e,t){var i={};i.data=new Array(7),i.count=0,o.playerSaveData[r]=i,a(0,t),o.loadPlayerDataInfo(s,function(e,t){a(1,t)}),o.loadPlayerDataQuests(s,function(e,t){a(2,t)}),o.loadPlayerDataAchievements(s,function(e,t){a(3,t)}),o.loadPlayerDataItems(s,0,function(e,t,i){a(4,i)}),o.loadPlayerDataItems(s,1,function(e,t,i){a(5,i)}),o.loadPlayerDataItems(s,2,function(e,t,i){a(6,i)})})}})},{"../format":35,"../message":49,"./usermessage":64}],66:[function(e,t,i){var n={},s=e("sanitizer");n.sanitize=function(e){return s.escape(s.sanitize(e))},n.random=function(e){return Math.floor(Math.random()*e)},n.randomRange=function(e,t){return e+Math.random()*(t-e)},n.randomInt=function(e){return Math.floor(Math.random()*(e+1))},n.randomRangeInt=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},n.percentToBool=function(e){return Math.random()<.01*e},n.ratioToBool=function(e){return Math.random()<e},n.clamp=function(e,t,i){return i<e?e:t<i?t:i},n.randomOrientation=function(){var e,t=n.random(4);return 0===t&&(e=Types.Orientations.LEFT),1===t&&(e=Types.Orientations.RIGHT),2===t&&(e=Types.Orientations.UP),e=3===t?Types.Orientations.DOWN:e},n.getOrientationString=function(e){var t="NONE";return 1===e?t="UP":2===e?t="DOWN":3===e?t="LEFT":4===e&&(t="RIGHT"),t},n.getOrientationFromLastMove=function(e){var t,i,s;return e.path&&0!==e.path.length?(t=e.path[e.path.length-1][0],i=e.path[e.path.length-1][1],e=1===e.path.length?(s=e.x,e.y):(s=e.path[e.path.length-2][0],e.path[e.path.length-2][1]),s<t?Types.Orientations.RIGHT:t<s?Types.Orientations.LEFT:e<i?Types.Orientations.DOWN:i<e?Types.Orientations.UP:void 0):n.randomOrientation()},n.randomPositionNextTo=function(e){var t=e.x,e=e.y,i=n.random(4);return 0===i&&--t,1===i&&++t,2===i&&--e,3===i&&++e,{x:t,y:e}},n.Mixin=function(e,t){if(t)for(var i,s=Object.keys(t),n=s.length;n--;)i=s[n],t.hasOwnProperty(i)&&(e[i]=t[i]);return e},n.distanceTo=function(e,t,i,s){e=Math.abs(e-i),i=Math.abs(t-s);return i<e?e:i},n.manhattenDistance=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},n.realDistance=function(e,t){return~~Math.pow(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2),.5)},n.NaN2Zero=function(e){return isNaN(+e)?0:+e},n.trueFalse=function(e){return"true"===e},n.utilSleep=function(t){return new Promise(e=>setTimeout(e,t))},n.removeDoubleQuotes=function(e){return e.toString().replace(/^"(.+(?="$))"$/,"$1")},n.max=function(e,t){Math.max.apply(Math,e.map(function(e){return e[t]}))},n.min=function(e,t){Math.min.apply(Math,e.map(function(e){return e[t]}))},n.array_values=function(e){var t=[],i="";for(i in e)t[t.length]=e[i];return t},n.arraysEqual=function(e,t){if(e!==t){if(null===e||null===t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;++i)if(e[i]!==t[i])return!1}return!0},n.setEquipmentBonus=function(e){if(ItemTypes.isWeapon(e)||ItemTypes.isArcherWeapon(e)||ItemTypes.isArmor(e))for(var t=n.random(1024),i=0,s=1;s<=1024;s*=2){if(t<s)return Math.max(10-i,1);++i}return 1},n.pad=function(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i},n.checkInputName=function(e){if(null===e)return!1;if(""===e)return!1;if(" "===e)return!1;for(var t=0;t<e.length;t++){var i=e.charCodeAt(t);if(!(44032<=i&&i<=55203||12593<=i&&i<=12686||97<=i&&i<=122||65<=i&&i<=90||48<=i&&i<=57))return!1}return!0},Array.prototype.last||Object.defineProperty(Array.prototype,"last",{value:function(){return this[this.length-1]}}),Array.prototype.parseInt||Object.defineProperty(Array.prototype,"parseInt",{value:function(){return this.map(function(e){return parseInt(e,10)})}}),ArrayParseInt=function(){return this.map(function(e){return parseInt(e,10)})},String.prototype.reverse||(String.prototype.reverse=function(){return this.split("").reverse().join("")}),n.ceilGrid=function(e){return~~(e+.5)},Number.prototype.ceilGrid||(Number.prototype.ceilGrid=function(){return~~(this+.5)}),n.minProp=function(e,i){return e.reduce(function(e,t){return e[i]<t[i]?e:t})},n.maxProp=function(e,i){return e.reduce(function(e,t){return e[i]>t[i]?e:t})},n.Sleep=function(t){return new Promise(e=>setTimeout(e,t))};n.GetGroupCountArray=function(e,t){i=t;var i,s,n=e.reduce(function(e,t){return(e[t[i]]=e[t[i]]||[]).push(t),e},{}),a=[];for(s in n)a.push([s,n[s].length]);return console.info(JSON.stringify(a)),a.sort(function(e,t){return e[1]-t[1]}),a},n.roundTo=function(e,t){return Math.round(e/t)*t},n.floorTo=function(e,t){return Math.floor(e/t)*t},n.ceilTo=function(e,t){return Math.ceil(e/t)*t},n.btoa=function(e){return Buffer.from(e,"base64").toString("utf8")},n.getGridPosition=function(e,t){return{gx:e>>4,gy:t>>4}},n.getPositionFromGrid=function(e,t){return{x:e<<4,y:t<<4}},n.forEach=function(e,t){for(var i in e)if(e.hasOwnProperty(i)&&e[i]&&t&&t(e[i],i))return!0;return!1},n.removeFromArray=function(e,t){t=e.indexOf(t);0<=t&&e.splice(t,1)},n.getLockDelay=function(e){return 0},n.BinArrayToBase64=function(e){for(var t=Math.ceil(e.length/32),i=[],s=0;s<t;s++){var n=e.slice(32*s,32*s+32).join("");i.push(parseInt(n,2))}return i.toString("base64")},n.Base64ToBinArray=function(e,t){for(var i=e.toString("binary").split(","),s=new Uint8Array(32*i.length),n=0;n<i.length;++n)for(var a=parseInt(i[n]).toString(2),o=a.length,r=32*(n+1)-o,c=0;c<o;++c)s[r+c]=a[c];return s.slice(0,t)},n.SwapElements=function(e,t,i){[e[t],e[i]]=[e[i],e[t]]},n.getNumShortHand=function(e,t){return null===t&&(t=2),e<=1e3?e:e<=1e6?(e/1e3).toFixed(t)+"K":e<=1e9?(e/1e6).toFixed(t)+"M":e<=1e12?(e/1e9).toFixed(t)+"B":(e/1e12).toFixed(t)+"T"},n.Percent=function(e,t){return null===t&&(t=0),Number(100*e).toFixed(t)+"%"},n.objectToArray=function(e){var t,i=[];for(t in e){var s=e[t];s&&i.push(s)}return i},Array.prototype.removeVal||Object.defineProperty(Array.prototype,"removeVal",{value:function(e){return this.splice(this.indexOf(e),1)}}),t.exports=n},{sanitizer:212}],67:[function(e,t,i){e("../items/baseitem");var r=e("../message");t.exports=AuctionRecord=cls.Class.extend({init:function(e,t,i){this.playerName=e,this.price=t,this.item=i},save:function(){return[this.playerName,this.price].join(",")+","+this.item.toArrayNoSlot().join(",")},toArray:function(){return[this.playerName,this.price].concat(this.item.toArray())}}),t.exports=Auction=cls.Class.extend({init:function(){this.auctions=[]},load:function(e){if(console.info("auction - load: "+JSON.stringify(e)),!Array.isArray(e)||0!==e.length){auctions=[];for(var t of e){t=t.split(","),t=new AuctionRecord(t[0],parseInt(t[1]),new ItemRoom([parseInt(t[2]),parseInt(t[3]),parseInt(t[4]),parseInt(t[5]),parseInt(t[6])]));auctions.push(t)}auctions&&(this.auctions=auctions)}},save:function(e){console.info("auction - save: "+JSON.stringify(this.auctions));var t,i=[];for(t of this.auctions)t&&i.push(t.save());return e.userHandler?(e.userHandler.sendAuctionsData(i),!0):(console.info("save: world.userHandler not set."),!1)},add:function(e,t,i,s){i=new AuctionRecord(e.name,i,t);this.auctions.push(i),e.inventory.setItem(s,null),e.sendPlayer(new r.Notify("AUCTION","AUCTION_ADDED"))},remove:function(e){this.auctions[e]=null},putItem:function(e,t){return 0<=e.inventory.putItem(t)},list:function(e,t){var i,s,n,a=[Types.Messages.WC_AUCTIONOPEN,t,0],o=0;for(i of this.auctions)i&&(s=i.item.itemKind,n=e.name===i.playerName,1===t&&!n&&ItemTypes.isArmor(s)||2===t&&!n&&ItemTypes.isWeapon(s)||0===t&&n)&&(a.push(this.auctions.indexOf(i)),a=a.concat(i.toArray()),++o);a[2]=o,e.sendPlayer(new r.AuctionOpen(a))}})},{"../items/baseitem":38,"../message":49}],68:[function(e,t,i){t.exports=BanManager=Class.extend({init:function(e){this.world=e,this.userBans={}},saveBans:function(){var e,t=Date.now(),i=[];for(e in this.userBans){var s=this.userBans[e];s<t||i.push(e+","+s)}return i},loadBans:function(e){var t,i=Date.now();for(t of e){var s=t.split(",");i>s[1]||(this.userBans[s[0]]=s[1])}},isUserBanned:function(e){return!!(this.userBans.hasOwnProperty(e)&&this.userBans[e]>Date.now())},banplayer:function(e,t){e=e.toLowerCase();var e=this.world.getPlayerByName(e);e?(e=e.user.name,this.banuser(e,t)):console.info("worldServer, banplayer: player not in world.")},banuser:function(e,t){t*=864e5,this.userBans[e]=Date.now()+t},save:function(){var e;return this.world.userHandler?(e=this.saveBans(),this.world.userHandler.sendBansData(e),!0):(console.info("worldserver, save: userHandler not set"),!1)}})},{}],69:[function(e,t,i){var s=e("../message");t.exports=Looks=cls.Class.extend({init:function(){this.prices=[],this.reset()},reset:function(){console.info("LOOKS INIT");for(var e=AppearanceData.Data.length,t=0;t<e;t++)this.prices.push(500);this.prices[0]=0,this.prices[50]=0,this.prices[77]=0,this.prices[151]=0},load:function(e){e||this.reset(),this.prices=e.parseInt()},save:function(e){return console.info("LOOKS SAVED"),!this.prices||(data=this.prices.join(","),!!e.userHandler&&(e.userHandler.sendLooksData(data),!0))},modPrice:function(e,t){this.prices[e]+=t},pricesToString:function(){return this.prices.join(",")},sendLooks:function(e){e.sendPlayer(new s.AppearanceList(e.user,this))}})},{"../message":49}],70:[function(e,t,i){t.exports=LootManager=Class.extend({init:function(e){this.world=e},handleDropItem:function(e,t){var i=this.getLootItem(t,e,0);i&&i instanceof Item?(console.info("LOOT ITEM SENT!"),i.x=e.x,i.y=e.y,this.handleItemDespawn(i)):(i=this.getDroppedOrStolenItem(t,e,0))&&i instanceof Item&&(i.x=e.x,i.y=e.y,this.handleItemDespawn(i))},handleItemDespawn:function(e){e&&e.handleDespawn({beforeBlinkDelay:2e4,blinkCallback:function(){},blinkingDuration:1e4,despawnCallback:function(){e.map.entities.itemDespawn(e)}})},getLootItem:function(e,t,i){var s=null;if(!(!t instanceof Mob)){var n,a,o=Utils.randomRangeInt(0,1e3),r=t.questDrops;for(n in r){var c=r[n];if(0<=o&&o<c){s=n;break}o-=c}return s?(a=new ItemRoom([parseInt(s),1,0,0,0]),(a=t.map.entities.createItem(a,t.x,t.y,1)).count=1,a.experience=0,t.map.entities.sendNeighbours(t,a.spawn()),t.map.entities.addItem(a)):null}},getPlayerDrop:function(e,t,i){var s,n,a=t.inventory.getRandomItemNumber();if(-1!==a)return item=t.inventory.rooms[a],s=1,ItemTypes.isConsumableItem(item.itemKind)&&(s=Math.floor((Math.random()*t.level+2)/2))>item.itemNumber&&(s=item.itemNumber),i?((n=Object.assign(new ItemRoom,item)).itemNumber=s,e.sendPlayer(new Messages.Notify("CHAT","ITEM_ADDED",[ItemData.Kinds[item.itemKind].name]))):n=t.map.entities.addItem(t.map.entities.createItem(type,item,t.x,t.y,s)),t.inventory.takeOutItems(a,s),n},getDrop:function(e,t,i){if(!0!==t.droppedItem){t.droppedItem=!0;var s,n,a,o=t.drops,r=Utils.random(1e3);for(n in o){var c=o[n];if(0<=r&&r<c){s=n;break}r-=c}if(!s)return null;ItemTypes.isEquippable(s)?(c=Utils.setEquipmentBonus(s),(a=new ItemRoom([s,c,0,0,900,900])).itemExperience=ItemTypes.itemExpForLevel[c-1]):a=new ItemRoom([s,1,0,0,0,0]);var l=t.map.entities.createItem(a,t.x,t.y,1);return i?(e instanceof Player&&e.sendPlayer(new Messages.Notify("CHAT","ITEM_ADDED",[ItemData.Kinds[l.itemKind].name])),a):(t.data&&t.data.dropBonus&&(l.count+=t.data.dropBonus),t.map.entities.sendNeighbours(t,l.spawn()),l.enemyDrop=!0,t.map.entities.addItem(l))}},getGoldDrop:function(e,t,i){var s=t.dropGold();e instanceof Player&&(t=t.level-e.level,s=~~(s*=Utils.clamp(.1,1.9,1+.05*t))),e instanceof Player&&e.modifyGold(s)},getDroppedOrStolenItem:function(e,t,i){return e instanceof Player&&t instanceof Player?(this.getGoldDrop(e,t,i),this.getPlayerDrop(e,t,i)):t instanceof Mob?(this.getGoldDrop(e,t,i),this.getDrop(e,t,i)):null}})},{}],71:[function(e,t,i){var s=e("../playergroup"),n=e("../message");t.exports=PartyManager=Class.extend({init:function(e){this.world=e,this.party=[]},addParty:function(e,t){e=new s(e,"party",!0);return e.setMemberMessage(n.Party),e.addName(t.name),this.party.push(e),e},removeParty:function(e){this.party.remove(e)},removePlayer:function(e){var t;e.hasOwnProperty("party")&&e.party&&((t=e.party).removeName(e.name),e.packetHandler.partyHandler.handlePartyAbandoned(t))}})},{"../message":49,"../playergroup":55}],72:[function(e,t,i){e("../entity/entitymoving");var d=e("../message"),n=e("../../shared/data/achievements.json");t.exports.getAchievementObject=getAchievementObject=function(e){var t={toArray:function(e){return[e.index,e.data.type,e.rank,e.data.objectType,e.data.objectKind,e.count,e.data.objectCount[e.rank]]},toClient:function(e){return e.toArray(e)},toRedis:function(e){return[e.index,e.rank,e.count]}};return e&&(t.index=parseInt(e[0]),t.rank=parseInt(e[1]),t.count=parseInt(e[2]),t.data=e[3]),t},t.exports.getSavedAchievement=getSavedAchievement=function(e){return data=[e[0],e[1],e[2],n[e[0]]],Object.assign(getAchievementObject(data),null)},t.exports.getInitAchievements=getInitAchievements=function(){for(var e=[],t=n.length,i=0;i<t;++i){data=[i,0,0,n[i]];var s=Object.assign(getAchievementObject(data),null);e.push(s)}return log.info("achievements: "+JSON.stringify(e)),e},t.exports.PlayerEvent=PlayerEvent=function(e,t,i){var s={};return s.eventType=e,s.object=t,s.count=i,s},t.exports=TaskHandler=cls.Class.extend({init:function(){this.data=n},processEvent:function(i,t){var e,s=i.quests;switch(t.eventType){case EventType.KILLMOB:var n=t.object;n.questDrops={},s.forQuestsType(QuestType.KILLMOBKIND,function(e){s.questAboutKill(n,e)}),s.forQuestsType(QuestType.GETITEMKIND,function(e){s.questAboutItemCheck(n,e)});break;case EventType.LOOTITEM:s.forQuestsType(QuestType.GETITEMKIND,function(e){e.object2.kind===t.object.kind-1e3&&s.questAboutItem(e)});break;case EventType.USE_NODE:s.forQuestsType(QuestType.USENODE,function(e){e.object.kind===t.object.kind&&e.data1===t.object.level&&s.questAboutUseNode(e)})}for(e of i.achievements)this.processAchievement(i,t,e,function(e,t){return e.data.type===EventType.KILLMOB&&(0===e.data.objectKind||e.data.objectKind===t.object.kind)},2),this.processAchievement(i,t,e,function(e,t){return e.data.type===EventType.LOOTITEM&&t.object.hasOwnProperty("enemyDrop")},5),this.processAchievement(i,t,e,function(e,t){return e.data.type===EventType.DAMAGE},.02),this.processAchievement(i,t,e,function(e,t){return e.data.type===EventType.USE_NODE&&(t=t.object.weaponType,i.hasWeaponType(t))&&t===e.data.data1},5),this.processAchievement(i,t,e,function(e,t){return e.data.type===EventType.HARVEST&&(e=t.object.weaponType,i.hasWeaponType(e))&&"axe"===e},5),this.processAchievement(i,t,e,function(e,t){return e.data.type===EventType.USE_NODE&&(t=t.object.weaponType,i.hasWeaponType(t))&&t===e.data.data1},5)},processAchievement:function(e,t,i,s,n){if(t.eventType===i.data.type&&s(i,t)){var a=e.achievements.indexOf(i);if(!(a<0||a>=i.data.objectCount.length)){var o=t.count,r=i.data.objectCount[i.rank],c=i.data.objectCount.length;if(i.count+o<r)i.count+=o;else{if(i.rank===c-1&&i.count===r)return;for(;0<o;){var r=i.data.objectCount[i.rank],l=i.count,l=(i.count=Math.min(i.count+o,r),o-=r-l,e.sendPlayer(new d.Achievement(i)),~~(r*n)),p="ACHIEVEMENTS_"+a+"_COMPLETE",u=Utils.getNumShortHand(r,0);if(e.incExp(l),e.sendPlayer(new d.Notify("CHAT",p,[u,l])),i.rank===c-1&&i.count===r)return;i.rank++,o<r&&(i.count=o,o=0)}}e.sendPlayer(new d.Achievement(i))}}}})},{"../../shared/data/achievements.json":332,"../entity/entitymoving":27,"../message":49}],73:[function(e,t,i){var s=e("./lib/class"),n=(e("underscore"),e("log"),e("./entity/entity"),e("./entity/character"),e("./entity/npcstatic"),e("./entity/npcmove"),e("./entity/player")),a=(e("./entity/item"),e("./entity/chest"),e("./entity/mob"),e("./entity/node"),e("./map/mapmanager")),o=e("./message"),r=(e("util"),e("./pathfinder"),e("./updater")),c=e("./callbacks/mobcallback"),l=e("./callbacks/npcmovecallback"),p=e("./callbacks/playercallback"),u=e("./world/auction"),d=e("./world/looks"),h=e("./world/taskhandler"),m=e("./world/banmanager"),f=e("./world/partymanager"),v=e("./world/lootmanager");t.exports=World=s.Class.extend({init:function(e,t,i){var s=this;s.id=e,s.maxPlayers=t,s.socket=i,s.mapManager=new a(s),s.taskHandler=new h,s.maps=s.mapManager.maps,s.players=[],s.objPlayers={},s.ban=new m(s),s.party=new f(s),s.loot=new v(s),s.mobCallback=new c,s.playerCallback=new p,s.npcMoveCallback=new l,s.itemCount=0,s.uselessDebugging=!1,s.mapManager.onMapsReady(function(){console.info("ALL MAPS LOADED BITCHES!"),s.maps=s.mapManager.maps,Utils.forEach(s.maps,function(e,t){e.updater=new r(s,e)})}),s.auction=new u,s.looks=new d,s.lastUpdateTime=Date.now(),s.PLAYERS_SAVED=!1,s.AUCTIONS_SAVED=!1,s.LOOKS_SAVED=!1,s.BANS_SAVED=!1,s.onPlayerConnect(function(e){console.info("worldServer - onPlayerConnect."),s.players.indexOf(e)<0&&(s.players.push(e),s.userHandler.sendWorldPlayerCount(s.players.length,s.maxPlayers)),s.objPlayers[e.name.toLowerCase()]=e}),s.onPlayerRemoved(function(e){console.info("worldServer - onPlayerRemoved."),delete s.objPlayers[e.name.toLowerCase()],s.players.removeVal(e),s.userHandler.sendPlayerLogout(e),s.userHandler.sendWorldPlayerCount(s.players.length,s.maxPlayers)}),s.onPlayerEnter(function(i){i.map=s.maps[1],i.map.entities.addPlayer(i),console.info("Player: "+i.name+" has entered the "+i.map.name+" map."),i.map.entities.sendBroadcast(new o.Notify("MAP","MAP_ENTERED",[i.name,i.map.name]),!0),i.packetHandler.onBroadcast(function(e,t){i.map.entities.sendBroadcast(e,t?i.id:null)}),i.packetHandler.onExit(function(e){console.info("worldServer, packetHandler.onExit."),s.party.removePlayer(e),s.removed_callback&&s.removed_callback(e),delete users[e.user.name],e.map.entities.removePlayer(e)}),s.added_callback&&s.added_callback()}),s.onRegenTick(function(){function t(e){e instanceof n&&(!e.isAlive()||e.hasFullHealth()||e.isAttacked()||e.modHealthBy(Math.floor(e.stats.hpMax/8)))}s.forEachMap(function(e){e.entities.forEachPlayer(t)})}),s.notify=NotifyData.Notifications,Utils.forEach(s.notify,function(e){e.lastTime=Date.now()-s._idleStart}),setInterval(function(){Utils.forEach(s.notify,function(e){Date.now()-e.lastTime>=6e4*e.interval&&(s.sendWorld(new o.Notify("NOTICE",e.textid)),e.lastTime=Date.now())})},6e4)},notifyWorld:function(e){this.sendWorld(new o.Notify("GLOBAL",e))},stop:function(){this.save()},isSaved:function(){return this.PLAYERS_SAVED&&this.AUCTIONS_SAVED&&this.LOOKS_SAVED&&this.BANS_SAVED},savePlayers:function(t){var i;return this.userHandler?(i=[],Utils.forEach(this.players,function(e){i.push(e.name)}),this.userHandler.sendPlayersList(i),Utils.forEach(this.players,function(e){t?e.save(t):e.connection.disconnect()}),!0):(console.warn("worldServer save: no user server connection aborting save."),!1)},setSaves:function(e){this.PLAYERS_SAVED=e,this.AUCTIONS_SAVED=e,this.LOOKS_SAVED=e,this.BANS_SAVED=e},save:function(e){this.savePlayers(e)&&(this.PLAYERS_SAVED=!0),this.auction.save(this)&&(this.AUCTIONS_SAVED=!0),this.looks.save(this)&&(this.LOOKS_SAVED=!0),this.ban.save()&&(this.BANS_SAVED=!0),e&&this.setSaves(!1)},update:function(){this.lastUpdateTime=Date.now(),this.forEachMap(function(e){e.updater&&0<Object.keys(e.entities.players).length&&e.updater.update()})},forEachMap:function(t){Utils.forEach(this.maps,function(e){e&&e.ready&&e.isLoaded&&e.entities&&t&&t(e)})},run:function(){var t=this;setInterval(function(){t.update()},G_UPDATE_INTERVAL);setInterval(function(){t.forEachMap(function(e){e.updater&&0<Object.keys(e.entities.players).length&&e.entities.processPackets()})},16),setInterval(function(){t.forEachMap(function(e){0<Object.keys(e.entities.players).length&&e.entities.mobAI.update()})},256),setInterval(function(){for(var e of t.players)e.user&&3e5<=Date.now()-e.user.lastPacketTime&&e.connection.close("idle timeout")},6e4),setInterval(function(){t.regen_callback&&t.regen_callback()},1e4),setInterval(function(){t.forEachMap(function(t){var e=t.entities.players;Utils.forEach(e,function(e){t.entities.mobAI.Roaming(e)})})},1e3),setInterval(function(){t.save(!0)},6e5)},loggedInPlayer:function(e){return"object"==typeof this.getPlayerByName(e)},getPlayerByName:function(e){return this.objPlayers[e.toLowerCase()]},handleDamage:function(e,t,i,s){e.effects&&(console.info("entity.effects: "+JSON.stringify(e.effects)),n=[],Utils.forEach(e.effects,function(e,t){1===e&&n.push(parseInt(t))}));var n,a=-i;console.info("effects: "+JSON.stringify(n)),console.info("DAMAGE: "+i),console.info("CRIT: "+s),e.onDamage(t,a,0,s,n)},onPlayerConnect:function(e){this.connect_callback=e},onPlayerEnter:function(e){this.enter_callback=e},onPlayerRemoved:function(e){this.removed_callback=e},onRegenTick:function(e){this.regen_callback=e},sendWorld:function(t){this.forEachMap(function(e){e.entities.sendBroadcast(t)})}})},{"./callbacks/mobcallback":7,"./callbacks/npcmovecallback":8,"./callbacks/playercallback":9,"./entity/character":24,"./entity/chest":25,"./entity/entity":26,"./entity/item":28,"./entity/mob":29,"./entity/node":30,"./entity/npcmove":31,"./entity/npcstatic":32,"./entity/player":33,"./lib/class":44,"./map/mapmanager":48,"./message":49,"./pathfinder":54,"./updater":62,"./world/auction":67,"./world/banmanager":68,"./world/looks":69,"./world/lootmanager":70,"./world/partymanager":71,"./world/taskhandler":72,log:192,underscore:310,util:void 0}],74:[function(e,t,i){var s=e("underscore"),n=(e("bison"),e("./lib/class")),a=e("http"),o=e("https");let r=e("socket.io").Server;e("url"),e("./utils");var c={},l=e("zlib"),p=(e("connect"),e("fs")),u=e("socket.io-client"),e=(t.exports=c,n.Class.extend({init:function(){},start:function(){this.startCallback&&this.startCallback(this)},onStart:function(e){this.startCallback=e},onConnect:function(e){this.connectionCallback=e},onError:function(e){this.errorCallback=e},broadcast:function(e){throw"Not implemented"},forEachConnection:function(e){s.each(this._connections,e)},addConnection:function(e){this._connections[e.id]=e},removeConnection:function(e){delete this._connections[e]},getConnection:function(e){return this._connections[e]},onClose:function(e){this._close_callback=e},close:function(){this._close_callback&&this._close_callback(this)}})),t=n.Class.extend({init:function(e,t,i){this._connection=t,this._server=i,this.id=e},onClose:function(e){this.closeCallback=e},listen:function(e){this.listenCallback=e},broadcast:function(e){throw"Not implemented"},send:function(e){throw"Not implemented"},sendUTF8:function(e){throw"Not implemented"},close:function(e){console.info("Closing connection to "+this._connection.remoteAddress+". "+e),this._connection.conn.close()}});c.WebsocketServer=e.extend({_connections:{},_counter:0,init:function(e){var t=this,i=(this._super(),{}),s=(""!=e.https_cert&&(i.cert=p.readFileSync(e.https_cert)),""!=e.https_key&&(i.key=p.readFileSync(e.https_key)),a);this._protoServer=(s="https"===e.protocol?o:s).createServer(i),this._protoServer.listen(e.port,e.ip,function(){console.info("Server (only) is listening on port "+e.port)}),this._ioServer=new r(this._protoServer,{cors:{origin:"*"}}),this._ioServer.on("connection",function(e){console.info("Client socket connected from "+e.conn.remoteAddress),e.remoteAddress=e.conn.remoteAddress,e=new c.socketioConnection(t._createId(),e,t),t.connectionCallback&&t.connectionCallback(e),t.addConnection(e)}),this._ioServer.on("connect_error",function(e){console.error(e)}),this.onClose(function(e){this._protoServer.close()})},_createId:function(){return 5e4+this._counter++},broadcast:function(t){this.forEachConnection(function(e){e.send(t)})},onRequestStatus:function(e){this.statusCallback=e}}),c.socketioConnection=t.extend({init:function(e,t,i){var s=this;this._super(e,t,i);this._connection.on("message",function(e){console.info("m="+e);var t=e.charAt(0);"2"===t?(t=Buffer.from(t,"base64"),l.gunzip(t,(e,t)=>{e?console.log(e.toString()):s.listenCallback&&s.listenCallback(JSON.parse(t))})):s.listenCallback&&s.listenCallback(JSON.parse(e.substr(1)))}),this._connection.on("disconnect",function(){console.info("Client closed socket "+s._connection.conn.remoteAddress),s.closeCallback&&s.closeCallback(),s._server.removeConnection(s.id)})},send:function(e){console.info("send="+e);var i=this,e=JSON.stringify(e);2048<=e.length?l.gzip(e,{level:1},(e,t)=>{t=new Buffer(t).toString("base64"),i.sendUTF8("z|"+t)}):i.sendUTF8("1"+e)},sendUTF8:function(e){this._connection.send(e)},disconnect:function(){this._connection.disconnect()}}),c.userConnection=t.extend({init:function(e,t,i){var s=this;this._super(e,t,i),this.fnOnMessage=function(e){console.info("m="+e);var t=e.charAt(0);"2"===t?(t=Buffer.from(t,"base64"),l.gunzip(t,(e,t)=>{e?console.log(e.toString()):s.listenCallback&&s.listenCallback(JSON.parse(t))})):s.listenCallback&&s.listenCallback(JSON.parse(e.substr(1)))}},connect:function(e){var t=this;this._connection=u.connect(e,{reconnect:!0,rejectUnauthorized:!1}),this._connection.on("connect_error",function(e){console.info("Failed to establish a connection to the servers, or lost     connection"),console.info(JSON.stringify(e))}),this._connection.on("message",this.fnOnMessage),this._connection.on("connect",function(e){console.info("CONNECTED! YAYYYY"),t._connection.off("message").on("message",t.fnOnMessage),t.connectionUserCallback&&t.connectionUserCallback(t)});this._connection.on("disconnect",function(){try{throw new Error}catch(e){console.error(e.stack)}console.info("USER CONNECTION CLOSED."),t.closeCallback&&t.closeCallback(),t.disconnect()})},onConnectUser:function(e){this.connectionUserCallback=e},send:function(e){console.info("send="+e);var i=this,e=JSON.stringify(e);2048<=e.length?l.gzip(e,{level:1},(e,t)=>{t=new Buffer(t).toString("base64"),i.sendUTF8("2"+t)}):i.sendUTF8("1"+e)},disconnect:function(){console.info("USER CONNECTION - DISCONNECT."),this._connection.disconnect()},sendUTF8:function(e){if(this._connection)this._connection.emit("message",e);else{console.error("this connection not set.");try{throw new Error}catch(e){console.warn(e.stack)}}}})},{"./lib/class":44,"./utils":66,bison:78,connect:79,fs:void 0,http:void 0,https:void 0,"socket.io":285,"socket.io-client":267,underscore:310,url:void 0,zlib:void 0}],75:[function(e,t,i){function s(e){if(e){var t,i=e;for(t in s.prototype)i[t]=s.prototype[t];return i}}(i.Emitter=s).prototype.on=s.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},s.prototype.once=function(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,this.on(e,i),this},s.prototype.off=s.prototype.removeListener=s.prototype.removeAllListeners=s.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)this._callbacks={};else{var i=this._callbacks["$"+e];if(i)if(1==arguments.length)delete this._callbacks["$"+e];else{for(var s,n=0;n<i.length;n++)if((s=i[n])===t||s.fn===t){i.splice(n,1);break}0===i.length&&delete this._callbacks["$"+e]}}return this},s.prototype.emitReserved=s.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),i=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(i)for(var s=0,n=(i=i.slice(0)).length;s<n;++s)i[s].apply(this,t);return this},s.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},s.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],76:[function(e,t,i){var s=e("negotiator"),n=e("mime-types");function a(e){if(!(this instanceof a))return new a(e);this.headers=e.headers,this.negotiator=new s(e)}function o(e){return-1===e.indexOf("/")?n.lookup(e):e}function r(e){return"string"==typeof e}(t.exports=a).prototype.type=a.prototype.types=function(e){var t;if((i=e)&&!Array.isArray(i))for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];return i&&0!==i.length?this.headers.accept?(e=i.map(o),!!(t=this.negotiator.mediaTypes(e.filter(r))[0])&&i[e.indexOf(t)]):i[0]:this.negotiator.mediaTypes()},a.prototype.encoding=a.prototype.encodings=function(e){if((t=e)&&!Array.isArray(t))for(var t=new Array(arguments.length),i=0;i<t.length;i++)t[i]=arguments[i];return t&&0!==t.length?this.negotiator.encodings(t)[0]||!1:this.negotiator.encodings()},a.prototype.charset=a.prototype.charsets=function(e){if((t=e)&&!Array.isArray(t))for(var t=new Array(arguments.length),i=0;i<t.length;i++)t[i]=arguments[i];return t&&0!==t.length?this.negotiator.charsets(t)[0]||!1:this.negotiator.charsets()},a.prototype.lang=a.prototype.langs=a.prototype.language=a.prototype.languages=function(e){if((t=e)&&!Array.isArray(t))for(var t=new Array(arguments.length),i=0;i<t.length;i++)t[i]=arguments[i];return t&&0!==t.length?this.negotiator.languages(t)[0]||!1:this.negotiator.languages()}},{"mime-types":201,negotiator:203}],77:[function(e,t,i){function s(){}var n=e("crypto");s.prototype.getRandomBytes=function(e){var t,i,s=this;return 4096<(e=e||12)||(i=parseInt(4096/e),!(t=parseInt(.85*i)))||(null==this.bytesBufferIndex&&(this.bytesBufferIndex=-1),this.bytesBufferIndex==i&&(this.bytesBuffer=null,this.bytesBufferIndex=-1),(-1==this.bytesBufferIndex||this.bytesBufferIndex>t)&&(this.isGeneratingBytes||(this.isGeneratingBytes=!0,n.randomBytes(4096,function(e,t){s.bytesBuffer=t,s.bytesBufferIndex=0,s.isGeneratingBytes=!1})),-1==this.bytesBufferIndex))?n.randomBytes(e):(i=this.bytesBuffer.slice(e*this.bytesBufferIndex,e*(this.bytesBufferIndex+1)),this.bytesBufferIndex++,i)},s.prototype.generateId=function(){var t=Buffer.alloc(15);return t.writeInt32BE?(this.sequenceNumber=this.sequenceNumber+1|0,t.writeInt32BE(this.sequenceNumber,11),n.randomBytes?this.getRandomBytes(12).copy(t):[0,4,8].forEach(function(e){t.writeInt32BE(Math.random()*Math.pow(2,32)|0,e)}),t.toString("base64").replace(/\//g,"_").replace(/\+/g,"-")):Math.abs(Math.random()*Math.random()*Date.now()|0).toString()+Math.abs(Math.random()*Math.random()*Date.now()|0).toString()},t.exports=new s},{crypto:void 0}],78:[function(e,t,i){for(var s=String.fromCharCode,l=new Array(65536),n=0;n<65536;n++)l[n]=s(n);var p="";function a(e){return function e(t,i){if("number"==typeof t){var s,n,a=0|t;a!==t?(s=(s=100*(t-a))<(n=0)?1<=(n=(s+1|0)-s)&&n<=1.5?0|s:s-1|0:.5<=s-(n=0|s)?s+1|0:n,t<(n=0)&&(a=0-a,s=0-s,n=1),p+=a<65536?0===a?l[13+n]+l[s+128]:l[13+n]+l[s]+l[a]:l[15+n]+l[a>>16&65535]+l[65535&a]+l[s]):(t<=(n=0)?(t=0-t,n=1):t--,p+=t<116?l[17+t+116*n]:t<65536?l[1+n]+l[t]:l[3+n]+l[t>>16&65535]+l[65535&t])}else if("string"==typeof t){var o=t.length;for(p+=l[7];65535<=o;)o-=65535,p+=l[65535];p+=l[o]+t}else if(!0===t)p+=l[5];else if(!1===t)p+=l[6];else if(null===t)p+=l[0];else if(t instanceof Array){p+=l[8];for(var r=0,o=t.length;r<o;r++)e(t[r],!1);i||(p+=l[9])}else if(t instanceof Object){for(var c in p+=l[10],t)p+=l[17+c.length]+c,e(t[c],!1);i||(p+=l[11])}}(e,!(p="")),p}function o(e){for(var t=0,i=e.length,s=[],n=void 0,a=null,o=0,r=-1,c=!1,l=!1,p="",u=null,d=0;t<i;)if(o=e.charCodeAt(t++),a=s[r],c&&l&&16<o)p=e.substring(t,t+o-17),t+=o-17,l=!1;else if(8===o||10===o)u=new(8===o?Array:Object),l=c=10===o,void 0!==n?a instanceof Array?a.push(u):a[p]=u:n=u,s.push(u),r++;else if(11===o||9===o)s.pop(),l=c=!(s[--r]instanceof Array);else if(16<o)o=115<(o-=17)?0-o+116:o+1,a instanceof Array?a.push(o):a[p]=o,l=!0;else if(0<o&&o<5)0==((o-1)/2|0)?(u=e.charCodeAt(t),t++):(u=(e.charCodeAt(t)<<16)+e.charCodeAt(t+1),t+=2),u=o%2?u+1:0-u,a instanceof Array?a.push(u):a[p]=u,l=!0;else if(12<o&&o<17)0==((o-13)/2|0)?127<(d=e.charCodeAt(t))?(u=0,d-=128,t++):(u=e.charCodeAt(t+1),t+=2):(u=(e.charCodeAt(t)<<16)+e.charCodeAt(t+1),d=e.charCodeAt(t+2),t+=3),u=o%2?u+.01*d:0-(u+.01*d),a instanceof Array?a.push(u):a[p]=u,l=!0;else if(4<o&&o<7)a instanceof Array?a.push(5===o):a[p]=5===o,l=!0;else if(0===o)a instanceof Array?a.push(null):a[p]=null,l=!0;else if(7===o){for(u=0;65535===e.charCodeAt(t);)u+=65535,t++;u+=e.charCodeAt(t++),a instanceof Array?a.push(e.substr(t,u)):a[p]=e.substr(t,u),t+=u,l=!0}return n}"undefined"==typeof window?(i.encode=a,i.decode=o):window.BISON={encode:a,decode:o}},{}],79:[function(e,t,i){var b=e("debug")("connect:dispatcher"),n=e("events").EventEmitter,s=e("finalhandler"),a=e("http"),o=e("utils-merge"),x=e("parseurl"),r=(t.exports=function(){function s(e,t,i){s.handle(e,t,i)}return o(s,c),o(s,n.prototype),s.route="/",s.stack=[],s},process.env.NODE_ENV||"development"),c={},w="function"==typeof setImmediate?setImmediate:function(e){process.nextTick(e.bind.apply(e,arguments))};function l(e){"test"!==r&&console.error(e.stack||e.toString())}c.use=function(e,t){var s,i=e;return"string"!=typeof e&&(t=e,i="/"),"function"==typeof t.handle&&((s=t).route=i,t=function(e,t,i){s.handle(e,t,i)}),t instanceof a.Server&&(t=t.listeners("request")[0]),"/"===i[i.length-1]&&(i=i.slice(0,-1)),b("use %s %s",i||"/",t.name||"anonymous"),this.stack.push({route:i,handle:t}),this},c.handle=function(u,d,e){var h=0,m=(e=>{var t;return 0!==e.length&&"/"!==e[0]&&-1!==(t=e.indexOf("://"))&&-1===e.lastIndexOf("?",t)?e.substr(0,e.indexOf("/",3+t)):void 0})(u.url)||"",f="",v=!1,y=this.stack,g=e||s(u,d,{env:r,onerror:l});u.originalUrl=u.originalUrl||u.url,function e(t){v&&(u.url=u.url.substr(1),v=!1),0!==f.length&&(u.url=m+f+u.url.substr(m.length),f="");var i=y[h++];if(i){var s=x(u).pathname||"/",n=i.route;if(s.toLowerCase().substr(0,n.length)!==n.toLowerCase())return e(t);if((s=s.length>n.length&&s[n.length])&&"/"!==s&&"."!==s)return e(t);0!==n.length&&"/"!==n&&(f=n,u.url=m+u.url.substr(m.length+f.length),m||"/"===u.url[0]||(u.url="/"+u.url,v=!0));var s=i.handle,i=n,n=t,a=u,o=d,r=e,c=s.length,l=n,p=Boolean(n);b("%s %s : %s",s.name||"<anonymous>",i,a.originalUrl);try{if(p&&4===c)return void s(n,a,o,r);if(!p&&c<4)return void s(a,o,r)}catch(e){l=e}r(l)}else w(g,t)}()},c.listen=function(){var e=a.createServer(this);return e.listen.apply(e,arguments)}},{debug:82,events:void 0,finalhandler:181,http:void 0,parseurl:209,"utils-merge":315}],80:[function(e,t,n){function i(){var e;try{e=n.storage.debug}catch(e){}return e=!e&&"undefined"!=typeof process&&"env"in process?process.env.DEBUG:e}(n=t.exports=e("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(e){var t,i,s=this.useColors;e[0]=(s?"%c":"")+this.namespace+(s?" %c":" ")+e[0]+(s?"%c ":" ")+"+"+n.humanize(this.diff),s&&(s="color: "+this.color,e.splice(1,0,s,"color: inherit"),e[i=t=0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(t++,"%c"===e)&&(i=t)}),e.splice(i,0,s))},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(e){}},n.load=i,n.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:(()=>{try{return window.localStorage}catch(e){}})(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},n.enable(i())},{"./debug":81}],81:[function(e,t,r){var c;function i(e){function o(){if(o.enabled){for(var s=o,e=+new Date,t=e-(c||e),n=(s.diff=t,s.prev=c,s.curr=e,c=e,new Array(arguments.length)),i=0;i<n.length;i++)n[i]=arguments[i];n[0]=r.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var a=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,function(e,t){var i;return"%%"!==e&&(a++,"function"==typeof(t=r.formatters[t]))&&(i=n[a],e=t.call(s,i),n.splice(a,1),a--),e}),r.formatArgs.call(s,n),(o.log||r.log||console.log.bind(console)).apply(s,n)}}return o.namespace=e,o.enabled=r.enabled(e),o.useColors=r.useColors(),o.color=(e=>{var t,i=0;for(t in e)i=(i<<5)-i+e.charCodeAt(t),i|=0;return r.colors[Math.abs(i)%r.colors.length]})(e),"function"==typeof r.init&&r.init(o),o}(r=t.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){r.enable("")},r.enable=function(e){r.save(e),r.names=[],r.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),i=t.length,s=0;s<i;s++)t[s]&&("-"===(e=t[s].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")))},r.enabled=function(e){var t,i;for(t=0,i=r.skips.length;t<i;t++)if(r.skips[t].test(e))return!1;for(t=0,i=r.names.length;t<i;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=e("ms"),r.names=[],r.skips=[],r.formatters={}},{ms:84}],82:[function(e,t,i){"undefined"!=typeof process&&"renderer"===process.type?t.exports=e("./browser.js"):t.exports=e("./node.js")},{"./browser.js":80,"./node.js":83}],83:[function(s,e,n){var a=s("tty"),t=s("util"),i=((n=e.exports=s("./debug")).init=function(e){e.inspectOpts={};for(var t=Object.keys(n.inspectOpts),i=0;i<t.length;i++)e.inspectOpts[t[i]]=n.inspectOpts[t[i]]},n.log=function(){return o.write(t.format.apply(t,arguments)+"\n")},n.formatArgs=function(e){var t=this.namespace;{var i,s;this.useColors?(i=this.color,s="  [3"+i+";1m"+t+" [0m",e[0]=s+e[0].split("\n").join("\n"+s),e.push("[3"+i+"m+"+n.humanize(this.diff)+"[0m")):e[0]=(new Date).toUTCString()+" "+t+" "+e[0]}},n.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},n.load=r,n.useColors=function(){return"colors"in n.inspectOpts?Boolean(n.inspectOpts.colors):a.isatty(i)},n.colors=[6,2,3,4,5,1],n.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var i=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),t=process.env[t],t=!!/^(yes|on|true|enabled)$/i.test(t)||!/^(no|off|false|disabled)$/i.test(t)&&("null"===t?null:Number(t));return e[i]=t,e},{}),parseInt(process.env.DEBUG_FD,10)||2),o=(1!==i&&2!==i&&t.deprecate(function(){},"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")(),1===i?process.stdout:2===i?process.stderr:(e=>{var t;switch(process.binding("tty_wrap").guessHandleType(e)){case"TTY":(t=new a.WriteStream(e))._type="tty",t._handle&&t._handle.unref&&t._handle.unref();break;case"FILE":var i=s("fs");(t=new i.SyncWriteStream(e,{autoClose:!1}))._type="fs";break;case"PIPE":case"TCP":i=s("net");(t=new i.Socket({fd:e,readable:!1,writable:!0})).readable=!1,t.read=null,t._type="pipe",t._handle&&t._handle.unref&&t._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return t.fd=e,t._isStdio=!0,t})(i));function r(){return process.env.DEBUG}n.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,t.inspect(e,this.inspectOpts).split("\n").map(function(e){return e.trim()}).join(" ")},n.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,t.inspect(e,this.inspectOpts)},n.enable(r())},{"./debug":81,fs:void 0,net:void 0,tty:void 0,util:void 0}],84:[function(e,t,i){function n(e,t,i){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+i:Math.ceil(e/t)+" "+i+"s"}t.exports=function(e,t){t=t||{};var i=typeof e;if(!("string"==i&&0<e.length)){if("number"==i&&!1===isNaN(e))if(t.long)return n(i=e,864e5,"day")||n(i,36e5,"hour")||n(i,6e4,"minute")||n(i,1e3,"second")||i+" ms";else{t=e;return 864e5<=t?Math.round(t/864e5)+"d":36e5<=t?Math.round(t/36e5)+"h":6e4<=t?Math.round(t/6e4)+"m":1e3<=t?Math.round(t/1e3)+"s":t+"ms"}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}i=e;if(!(100<(i=String(i)).length)){i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(i){var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return 864e5*s;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*s;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*s;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}},{}],85:[function(e,t,i){function n(e){return"string"==typeof e||e instanceof String}function d(e,t){var t=t.headers.origin,i=[];return e.origin&&"*"!==e.origin?(n(e.origin)?i.push([{key:"Access-Control-Allow-Origin",value:e.origin}]):(e=function e(t,i){if(Array.isArray(i)){for(var s=0;s<i.length;++s)if(e(t,i[s]))return!0;return!1}return n(i)?t===i:i instanceof RegExp?i.test(t):!!i}(t,e.origin),i.push([{key:"Access-Control-Allow-Origin",value:!!e&&t}])),i.push([{key:"Vary",value:"Origin"}])):i.push([{key:"Access-Control-Allow-Origin",value:"*"}]),i}function h(e){return!0===e.credentials?{key:"Access-Control-Allow-Credentials",value:"true"}:null}function m(e){e=e.exposedHeaders;return(e=e&&(e.join?e.join(","):e))&&e.length?{key:"Access-Control-Expose-Headers",value:e}:null}function f(e,t){for(var i=0,s=e.length;i<s;i++){var n=e[i];n&&(Array.isArray(n)?f(n,t):"Vary"===n.key&&n.value?a(t,n.value):n.value&&t.setHeader(n.key,n.value))}}var s,a,o;s=e("object-assign"),a=e("vary"),o={origin:"*",methods:"GET,HEAD,PUT,PATCH,POST,DELETE",preflightContinue:!1,optionsSuccessStatus:204},t.exports=function(i){var e=null,e="function"==typeof i?i:function(e,t){t(null,i)};return function(l,p,u){e(l,function(e,t){var c;e?u(e):(e=null,(c=s({},o,t)).origin&&"function"==typeof c.origin?e=c.origin:c.origin&&(e=function(e,t){t(null,c.origin)}),e?e(l.headers.origin,function(e,t){var i,s,n,a,o,r;e||!t?u(e):(c.origin=t,e=c,t=p,s=u,r=[],"OPTIONS"===((i=l).method&&i.method.toUpperCase&&i.method.toUpperCase())?(r.push(d(e,i)),r.push(h(e)),r.push({key:"Access-Control-Allow-Methods",value:o=(o=(a=e).methods).join?a.methods.join(","):o}),r.push((a=i,o=(o=e).allowedHeaders||o.headers,n=[],o?o.join&&(o=o.join(",")):(o=a.headers["access-control-request-headers"],n.push([{key:"Vary",value:"Access-Control-Request-Headers"}])),o&&o.length&&n.push([{key:"Access-Control-Allow-Headers",value:o}]),n)),r.push((a=("number"==typeof(a=e).maxAge||a.maxAge)&&a.maxAge.toString())&&a.length?{key:"Access-Control-Max-Age",value:a}:null),r.push(m(e)),f(r,t),e.preflightContinue?s():(t.statusCode=e.optionsSuccessStatus,t.setHeader("Content-Length","0"),t.end())):(r.push(d(e,i)),r.push(h(e)),r.push(m(e)),f(r,t),s()))}):u())})}}},{"object-assign":208,vary:316}],86:[function(e,t,i){var o=e("type/value/is"),a=e("type/plain-function/is"),r=e("es5-ext/object/assign"),c=e("es5-ext/object/normalize-options"),l=e("es5-ext/string/#/contains");(t.exports=function(e,t){var i,s,n,a;return arguments.length<2||"string"!=typeof e?(a=t,t=e,e=null):a=arguments[2],o(e)?(i=l.call(e,"c"),s=l.call(e,"e"),n=l.call(e,"w")):s=!(i=n=!0),e={value:t,configurable:i,enumerable:s,writable:n},a?r(c(a),e):e}).gs=function(e,t,i){var s,n;return"string"!=typeof e?(n=i,i=t,t=e,e=null):n=arguments[3],o(t)?a(t)?o(i)?a(i)||(n=i,i=void 0):i=void 0:(n=t,t=i=void 0):t=void 0,e=o(e)?(s=l.call(e,"c"),l.call(e,"e")):!(s=!0),t={get:t,set:i,configurable:s,enumerable:e},n?r(c(n),t):t}},{"es5-ext/object/assign":146,"es5-ext/object/normalize-options":157,"es5-ext/string/#/contains":164,"type/plain-function/is":304,"type/value/is":309}],87:[function(e,t,i){var l=e("type/plain-function/is"),p=e("type/value/ensure"),u=e("type/value/is"),s=e("es5-ext/object/map"),d=e("es5-ext/string/#/contains"),h=Function.prototype.call,m=Object.defineProperty,f=Object.getOwnPropertyDescriptor,v=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty,g={configurable:!1,enumerable:!1,writable:!1,value:null},n=function(s,n){var a,t,i,o,r,e,c=!1;return n=Object(p(n)),i=n.cacheName,e=n.flat,u(i)||(i=s),delete n.cacheName,a=n.value,r=l(a),delete n.value,(t={configurable:Boolean(n.configurable),enumerable:Boolean(n.enumerable)}).get=s!==i?function(){return y.call(this,i)||(g.value=r?h.call(a,this,n):a,g.writable=c,m(this,i,g),g.value=null,o&&m(this,s,o)),this[i]}:e?function e(){var t,i=this;if(y.call(this,s)){if((t=f(this,s)).hasOwnProperty("value"))return t.value;if("function"==typeof t.get&&t.get!==e)return t.get.call(this)}for(;!y.call(i,s);)i=v(i);return o.value=r?h.call(a,i,n):a,m(i,s,o),o.value=null,i[s]}:function e(){var t;return y.call(this,s)&&(t=f(this,s))?t.hasOwnProperty("value")?t.value:"function"==typeof t.get&&t.get!==e?t.get.call(this):a:(o.value=r?h.call(a,this,n):a,m(this,s,o),o.value=null,this[s])},t.set=function(e){if(y.call(this,s))throw new TypeError("Cannot assign to lazy defined '"+s+"' property of "+this);t.get.call(this),this[i]=e},n.desc?(o={configurable:d.call(n.desc,"c"),enumerable:d.call(n.desc,"e")},i===s?(o.writable=d.call(n.desc,"w"),o.value=null):(c=d.call(n.desc,"w"),o.get=t.get,o.set=t.set),delete n.desc):i===s&&(o={configurable:Boolean(n.configurable),enumerable:Boolean(n.enumerable),writable:Boolean(n.writable),value:null}),delete n.configurable,delete n.enumerable,delete n.writable,t};t.exports=function(e){return s(e,function(e,t){return n(t,e)})}},{"es5-ext/object/map":156,"es5-ext/string/#/contains":164,"type/plain-function/is":304,"type/value/ensure":308,"type/value/is":309}],88:[function(e,t,i){t.exports=function(e,t){if(!Array.isArray(e))throw new TypeError("arg must be an array of [ee, events...] arrays");for(var i=[],s=0;s<e.length;s++){var n=e[s];if(!Array.isArray(n)||n.length<2)throw new TypeError("each array member must be [ee, events...]");for(var a=n[0],o=1;o<n.length;o++){var r=n[o],c=((s,n)=>function(e){for(var t=new Array(arguments.length),e="error"===s?e:null,i=0;i<t.length;i++)t[i]=arguments[i];n(e,this,s,t)})(r,l);a.on(r,c),i.push({ee:a,event:r,fn:c})}}function l(){p(),t.apply(null,arguments)}function p(){for(var e,t=0;t<i.length;t++)(e=i[t]).ee.removeListener(e.event,e.fn)}function u(e){t=e}return u.cancel=p,u}},{}],89:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.hasCORS=void 0;let s=!1;try{s="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}i.hasCORS=s},{}],90:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.encode=function(e){let t="";for(var i in e)e.hasOwnProperty(i)&&(t.length&&(t+="&"),t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t},i.decode=function(e){var i={},s=e.split("&");for(let e=0,t=s.length;e<t;e++){var n=s[e].split("=");i[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return i}},{}],91:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.parse=function(e){if(8e3<e.length)throw"URI too long";var t=e,i=e.indexOf("["),s=e.indexOf("]");-1!=i&&-1!=s&&(e=e.substring(0,i)+e.substring(i,s).replace(/:/g,";")+e.substring(s,e.length));let n=r.exec(e||""),a={},o=14;for(;o--;)a[c[o]]=n[o]||"";-1!=i&&-1!=s&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0);return a.pathNames=(e=>{var t=e.replace(/\/{2,9}/g,"/").split("/");return"/"!=e.slice(0,1)&&0!==e.length||t.splice(0,1),"/"==e.slice(-1)&&t.splice(t.length-1,1),t})(a.path),a.queryKey=(e=>{let s={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,i){t&&(s[t]=i)}),s})(a.query),a};let r=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"]},{}],92:[function(e,t,i){function s(t){var i=t.split("; "),t=i[0].indexOf("=");if(-1!==t){var s=i[0].substring(0,t).trim();if(s.length){let e=i[0].substring(t+1).trim();var n={name:s,value:e=34===e.charCodeAt(0)?e.slice(1,-1):e};for(let e=1;e<i.length;e++){var a=i[e].split("=");if(2===a.length){var o=a[0].trim();let e=a[1].trim();switch(o){case"Expires":n.expires=new Date(e);break;case"Max-Age":var r=new Date;r.setUTCSeconds(r.getUTCSeconds()+parseInt(e,10)),n.expires=r}}}return n}}}Object.defineProperty(i,"__esModule",{value:!0}),i.CookieJar=i.defaultBinaryType=i.globalThisShim=i.nextTick=void 0,i.createCookieJar=function(){return new n},i.parse=s,i.nextTick=process.nextTick,i.globalThisShim=global,i.defaultBinaryType="nodebuffer";class n{constructor(){this._cookies=new Map}parseCookies(e){e&&e.forEach(e=>{e=s(e);e&&this._cookies.set(e.name,e)})}get cookies(){let i=Date.now();return this._cookies.forEach((e,t)=>{(null==(e=e.expires)?void 0:e.getTime())<i&&this._cookies.delete(t)}),this._cookies.entries()}addCookies(e){var t,i,s=[];for([t,i]of this.cookies)s.push(t+"="+i.value);s.length&&(e.setDisableHeaderCheck(!0),e.setRequestHeader("cookie",s.join("; ")))}appendCookies(e){for(var[t,i]of this.cookies)e.append("cookie",t+"="+i.value)}}i.CookieJar=n},{}],93:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.WebTransport=i.WebSocket=i.NodeWebSocket=i.XHR=i.NodeXHR=i.Fetch=i.nextTick=i.parse=i.installTimerFunctions=i.transports=i.TransportError=i.Transport=i.protocol=i.SocketWithUpgrade=i.SocketWithoutUpgrade=i.Socket=void 0;let s=e("./socket.js");Object.defineProperty(i,"Socket",{enumerable:!0,get:function(){return s.Socket}});var n=e("./socket.js"),a=(Object.defineProperty(i,"SocketWithoutUpgrade",{enumerable:!0,get:function(){return n.SocketWithoutUpgrade}}),Object.defineProperty(i,"SocketWithUpgrade",{enumerable:!0,get:function(){return n.SocketWithUpgrade}}),i.protocol=s.Socket.protocol,e("./transport.js")),o=(Object.defineProperty(i,"Transport",{enumerable:!0,get:function(){return a.Transport}}),Object.defineProperty(i,"TransportError",{enumerable:!0,get:function(){return a.TransportError}}),e("./transports/index.js")),r=(Object.defineProperty(i,"transports",{enumerable:!0,get:function(){return o.transports}}),e("./util.js")),c=(Object.defineProperty(i,"installTimerFunctions",{enumerable:!0,get:function(){return r.installTimerFunctions}}),e("./contrib/parseuri.js")),l=(Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return c.parse}}),e("./globals.node.js")),p=(Object.defineProperty(i,"nextTick",{enumerable:!0,get:function(){return l.nextTick}}),e("./transports/polling-fetch.js")),u=(Object.defineProperty(i,"Fetch",{enumerable:!0,get:function(){return p.Fetch}}),e("./transports/polling-xhr.node.js")),d=(Object.defineProperty(i,"NodeXHR",{enumerable:!0,get:function(){return u.XHR}}),e("./transports/polling-xhr.js")),h=(Object.defineProperty(i,"XHR",{enumerable:!0,get:function(){return d.XHR}}),e("./transports/websocket.node.js")),m=(Object.defineProperty(i,"NodeWebSocket",{enumerable:!0,get:function(){return h.WS}}),e("./transports/websocket.js")),f=(Object.defineProperty(i,"WebSocket",{enumerable:!0,get:function(){return m.WS}}),e("./transports/webtransport.js"));Object.defineProperty(i,"WebTransport",{enumerable:!0,get:function(){return f.WT}})},{"./contrib/parseuri.js":91,"./globals.node.js":92,"./socket.js":94,"./transport.js":95,"./transports/index.js":96,"./transports/polling-fetch.js":97,"./transports/polling-xhr.js":98,"./transports/polling-xhr.node.js":99,"./transports/websocket.js":101,"./transports/websocket.node.js":102,"./transports/webtransport.js":103,"./util.js":104}],94:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.Socket=i.SocketWithUpgrade=i.SocketWithoutUpgrade=void 0;let n=e("./transports/index.js"),a=e("./util.js"),o=e("./contrib/parseqs.js"),r=e("./contrib/parseuri.js");var c=e("@socket.io/component-emitter");let l=e("engine.io-parser"),p=e("./globals.node.js"),u=(0,s(e("debug")).default)("engine.io-client:socket"),d="function"==typeof addEventListener&&"function"==typeof removeEventListener,h=[];d&&addEventListener("offline",()=>{u("closing %d connection(s) because the network was lost",h.length),h.forEach(e=>e())},!1);class m extends c.Emitter{constructor(e,t){super(),this.binaryType=p.defaultBinaryType,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(t=e,e=null),e?(e=(0,r.parse)(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=(0,r.parse)(t.host).host),(0,a.installTimerFunctions)(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{var t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=(0,o.decode)(this.opts.query)),d&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname)&&(u("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},h.push(this._offlineEventListener)),this.opts.withCredentials&&(this._cookieJar=(0,p.createCookieJar)()),this._open()}createTransport(e){u('creating transport "%s"',e);var t=Object.assign({},this.opts.query),t=(t.EIO=l.protocol,t.transport=e,this.id&&(t.sid=this.id),Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]));return u("options: %j",t),new this._transportsByName[e](t)}_open(){var e;0===this.transports.length?this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0):(e=this.opts.rememberUpgrade&&m.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0],this.readyState="opening",(e=this.createTransport(e)).open(),this.setTransport(e))}setTransport(e){u("setting transport %s",e.name),this.transport&&(u("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=e).on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){u("socket open"),this.readyState="open",m.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(u('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":var t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}else u('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);var e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),(this._prevBufferLen=0)===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){var e;"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(e=this._getWritablePackets(),u("flushing %d packets in socket",e.length),this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush"))}_getWritablePackets(){if(this._maxPayload&&"polling"===this.transport.name&&1<this.writeBuffer.length){let t=1;for(let e=0;e<this.writeBuffer.length;e++){var i=this.writeBuffer[e].data;if(i&&(t+=(0,a.byteLength)(i)),0<e&&t>this._maxPayload)return u("only send %d out of %d packets",e,this.writeBuffer.length),this.writeBuffer.slice(0,e);t+=2}u("payload size is %d (max: %d)",t,this._maxPayload)}return this.writeBuffer}_hasPingExpired(){var e;return!this._pingTimeoutTime||((e=Date.now()>this._pingTimeoutTime)&&(u("throttled timer detected, scheduling connection close"),(this._pingTimeoutTime=0,p.nextTick)(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e)}write(e,t,i){return this._sendPacket("message",e,t,i),this}send(e,t,i){return this._sendPacket("message",e,t,i),this}_sendPacket(e,t,i,s){"function"==typeof t&&(s=t,t=void 0),"function"==typeof i&&(s=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState&&((i=i||{}).compress=!1!==i.compress,this.emitReserved("packetCreate",e={type:e,data:t,options:i}),this.writeBuffer.push(e),s&&this.once("flush",s),this.flush())}close(){let e=()=>{this._onClose("forced close"),u("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{(this.upgrading?i:e)()}):(this.upgrading?i:e)()),this}_onError(e){if(u("socket error %j",e),m.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&1<this.transports.length&&"opening"===this.readyState)return u("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){var i;"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(u('socket close with reason: "%s"',e),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),d&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)&&-1!==(i=h.indexOf(this._offlineEventListener))&&(u("removing listener for the 'offline' event"),h.splice(i,1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0)}}(i.SocketWithoutUpgrade=m).protocol=l.protocol;class f extends m{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade){u("starting upgrade probes");for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}}_probe(i){u('probing transport "%s"',i);let s=this.createTransport(i),t=!1,e=(m.priorWebsocketSuccess=!1,()=>{t||(u('probe transport "%s" opened',i),s.send([{type:"ping",data:"probe"}]),s.once("packet",e=>{t||("pong"===e.type&&"probe"===e.data?(u('probe transport "%s" pong',i),this.upgrading=!0,this.emitReserved("upgrading",s),s&&(m.priorWebsocketSuccess="websocket"===s.name,u('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{t||"closed"!==this.readyState&&(u("changing transport and sending upgrade packet"),l(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())}))):(u('probe transport "%s" failed',i),(e=new Error("probe error")).transport=s.name,this.emitReserved("upgradeError",e)))}))});function n(){t||(t=!0,l(),s.close(),s=null)}let a=e=>{var t=new Error("probe error: "+e);t.transport=s.name,n(),u('probe transport "%s" failed because of error: %s',i,e),this.emitReserved("upgradeError",t)};function o(){a("transport closed")}function r(){a("socket closed")}function c(e){s&&e.name!==s.name&&(u('"%s" works - aborting "%s"',e.name,s.name),n())}let l=()=>{s.removeListener("open",e),s.removeListener("error",a),s.removeListener("close",o),this.off("close",r),this.off("upgrading",c)};s.once("open",e),s.once("error",a),s.once("close",o),this.once("close",r),this.once("upgrading",c),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==i?this.setTimeoutFn(()=>{t||s.open()},200):s.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(t){var i=[];for(let e=0;e<t.length;e++)~this.transports.indexOf(t[e])&&i.push(t[e]);return i}}i.SocketWithUpgrade=f;class v extends f{constructor(e,t={}){t="object"==typeof e?e:t;t.transports&&(t.transports,"string"!=typeof t.transports[0])||(t.transports=(t.transports||["polling","websocket","webtransport"]).map(e=>n.transports[e]).filter(e=>!!e)),super(e,t)}}i.Socket=v},{"./contrib/parseqs.js":90,"./contrib/parseuri.js":91,"./globals.node.js":92,"./transports/index.js":96,"./util.js":104,"@socket.io/component-emitter":75,debug:107,"engine.io-parser":112}],95:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.Transport=i.TransportError=void 0;let n=e("engine.io-parser");var a=e("@socket.io/component-emitter");let o=e("./util.js"),r=e("./contrib/parseqs.js"),c=(0,s(e("debug")).default)("engine.io-client:transport");class l extends Error{constructor(e,t,i){super(e),this.description=t,this.context=i,this.type="TransportError"}}i.TransportError=l;class p extends a.Emitter{constructor(e){super(),(this.writable=!1,o.installTimerFunctions)(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,i){return super.emitReserved("error",new l(e,t,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):c("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){e=(0,n.decodePacket)(e,this.socket.binaryType);this.onPacket(e)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){var e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){e=(0,r.encode)(e);return e.length?"?"+e:""}}i.Transport=p},{"./contrib/parseqs.js":90,"./util.js":104,"@socket.io/component-emitter":75,debug:107,"engine.io-parser":112}],96:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.transports=void 0;var s=e("./polling-xhr.node.js"),n=e("./websocket.node.js"),e=e("./webtransport.js");i.transports={websocket:n.WS,webtransport:e.WT,polling:s.XHR}},{"./polling-xhr.node.js":99,"./websocket.node.js":102,"./webtransport.js":103}],97:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Fetch=void 0;e=e("./polling.js");class s extends e.Polling{doPoll(){this._fetch().then(e=>{if(!e.ok)return this.onError("fetch read error",e.status,e);e.text().then(e=>this.onData(e))}).catch(e=>{this.onError("fetch read error",e)})}doWrite(e,t){this._fetch(e).then(e=>{if(!e.ok)return this.onError("fetch write error",e.status,e);t()}).catch(e=>{this.onError("fetch write error",e)})}_fetch(e){var t,i=void 0!==e,s=new Headers(this.opts.extraHeaders);return i&&s.set("content-type","text/plain;charset=UTF-8"),null!=(t=this.socket._cookieJar)&&t.appendCookies(s),fetch(this.uri(),{method:i?"POST":"GET",body:i?e:null,headers:s,credentials:this.opts.withCredentials?"include":"omit"}).then(e=>{var t;return null!=(t=this.socket._cookieJar)&&t.parseCookies(e.headers.getSetCookie()),e})}}i.Fetch=s},{"./polling.js":100}],98:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(i,"__esModule",{value:!0}),i.XHR=i.Request=i.BaseXHR=void 0,e("./polling.js")),a=e("@socket.io/component-emitter");let o=e("../util.js"),r=e("../globals.node.js"),c=e("../contrib/has-cors.js"),l=(0,s(e("debug")).default)("engine.io-client:polling");function p(){}class u extends n.Polling{constructor(t){if(super(t),"undefined"!=typeof location){var i="https:"===location.protocol;let e=location.port;e=e||(i?"443":"80"),this.xd=void 0!==location&&t.hostname!==location.hostname||e!==t.port}}doWrite(e,t){e=this.request({method:"POST",data:e});e.on("success",t),e.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){l("xhr poll");var e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}i.BaseXHR=u;class d extends a.Emitter{constructor(e,t,i){super(),this.createRequest=e,(0,o.installTimerFunctions)(this,i),this._opts=i,this._method=i.method||"GET",this._uri=t,this._data=void 0!==i.data?i.data:null,this._create()}_create(){var e,t=(0,o.pick)(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;let i=this._xhr=this.createRequest(t);try{l("xhr open %s: %s",this._method,this._uri),i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(var s in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&i.setRequestHeader(s,this._opts.extraHeaders[s])}catch(e){}if("POST"===this._method)try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{i.setRequestHeader("Accept","*/*")}catch(e){}null!=(e=this._opts.cookieJar)&&e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var e;3===i.readyState&&null!=(e=this._opts.cookieJar)&&e.parseCookies(i.getResponseHeader("set-cookie")),4===i.readyState&&(200===i.status||1223===i.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof i.status?i.status:0)},0))},l("xhr data %s",this._data),i.send(this._data)}catch(e){return void this.setTimeoutFn(()=>{this._onError(e)},0)}"undefined"!=typeof document&&(this._index=d.requestsCount++,d.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(null!=this._xhr){if(this._xhr.onreadystatechange=p,e)try{this._xhr.abort()}catch(e){}"undefined"!=typeof document&&delete d.requests[this._index],this._xhr=null}}_onLoad(){var e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function h(){for(var e in d.requests)d.requests.hasOwnProperty(e)&&d.requests[e].abort()}(i.Request=d).requestsCount=0,d.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",h):"function"==typeof addEventListener&&addEventListener("onpagehide"in r.globalThisShim?"pagehide":"unload",h,!1));let m=(s=v({xdomain:!1}))&&null!==s.responseType;class f extends u{constructor(e){super(e);e=e&&e.forceBase64;this.supportsBinary=m&&!e}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new d(v,this.uri(),e)}}function v(e){e=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||c.hasCORS))return new XMLHttpRequest}catch(e){}if(!e)try{return new r.globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}i.XHR=f},{"../contrib/has-cors.js":89,"../globals.node.js":92,"../util.js":104,"./polling.js":100,"@socket.io/component-emitter":75,debug:107}],99:[function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,n)}:function(e,t,i,s){e[s=void 0===s?i:s]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&s(t,e,i);return n(t,e),t},a=(Object.defineProperty(i,"__esModule",{value:!0}),i.XHR=void 0,a(e("xmlhttprequest-ssl")));let o=e("./polling-xhr.js"),r=a.default||a;class c extends o.BaseXHR{request(e={}){var t;return Object.assign(e,{xd:this.xd,cookieJar:null==(t=this.socket)?void 0:t._cookieJar},this.opts),new o.Request(e=>new r(e),this.uri(),e)}}i.XHR=c},{"./polling-xhr.js":98,"xmlhttprequest-ssl":331}],100:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(i,"__esModule",{value:!0}),i.Polling=void 0,e("../transport.js"));let a=e("../util.js"),o=e("engine.io-parser"),r=(0,s(e("debug")).default)("engine.io-client:polling");class c extends n.Transport{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";let t=()=>{r("paused"),this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(r("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){r("pre-pause polling complete"),--e||t()})),this.writable||(r("we are currently writing - waiting to pause"),e++,this.once("drain",function(){r("pre-pause writing complete"),--e||t()}))}else t()}_poll(){r("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){r("polling got data %s",e);(0,o.decodePayload)(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this._poll():r('ignoring poll - transport state "%s"',this.readyState))}doClose(){var e=()=>{r("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(r("transport open - closing"),e()):(r("transport not open - deferring close"),this.once("open",e))}write(e){(this.writable=!1,o.encodePayload)(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){var e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,a.randomString)()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}i.Polling=c},{"../transport.js":95,"../util.js":104,debug:107,"engine.io-parser":112}],101:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(i,"__esModule",{value:!0}),i.WS=i.BaseWS=void 0,e("../transport.js"));let a=e("../util.js"),o=e("engine.io-parser"),r=e("../globals.node.js"),c=(0,s(e("debug")).default)("engine.io-client:websocket"),l="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class p extends n.Transport{get name(){return"websocket"}doOpen(){var e=this.uri(),t=this.opts.protocols,i=l?{}:(0,a.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,i)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(s){this.writable=!1;for(let e=0;e<s.length;e++){let t=s[e],i=e===s.length-1;(0,o.encodePacket)(t,this.supportsBinary,e=>{try{this.doWrite(t,e)}catch(e){c("websocket closed before onclose event")}i&&(0,r.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){var e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,a.randomString)()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}i.BaseWS=p;let u=r.globalThisShim.WebSocket||r.globalThisShim.MozWebSocket;class d extends p{createSocket(e,t,i){return l?new u(e,t,i):t?new u(e,t):new u(e)}doWrite(e,t){this.ws.send(t)}}i.WS=d},{"../globals.node.js":92,"../transport.js":95,"../util.js":104,debug:107,"engine.io-parser":112}],102:[function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,n)}:function(e,t,i,s){e[s=void 0===s?i:s]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&s(t,e,i);return n(t,e),t};Object.defineProperty(i,"__esModule",{value:!0}),i.WS=void 0;let o=a(e("ws"));a=e("./websocket.js");class r extends a.BaseWS{createSocket(e,t,i){var s;if(null!=(s=this.socket)&&s._cookieJar){i.headers=i.headers||{},i.headers.cookie="string"==typeof i.headers.cookie?[i.headers.cookie]:i.headers.cookie||[];for(var[n,a]of this.socket._cookieJar.cookies)i.headers.cookie.push(n+"="+a.value)}return new o.WebSocket(e,t,i)}doWrite(e,t){var i={};e.options&&(i.compress=e.options.compress),this.opts.perMessageDeflate&&("string"==typeof t?Buffer.byteLength(t):t.length)<this.opts.perMessageDeflate.threshold&&(i.compress=!1),this.ws.send(t,i)}}i.WS=r},{"./websocket.js":101,ws:317}],103:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(i,"__esModule",{value:!0}),i.WT=void 0,e("../transport.js"));let a=e("../globals.node.js"),o=e("engine.io-parser"),r=(0,s(e("debug")).default)("engine.io-client:webtransport");class c extends n.Transport{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{r("transport closed gracefully"),this.onClose()}).catch(e=>{r("transport closed due to %s",e),this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{var t=(0,o.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER,this.socket.binaryType);let i=e.readable.pipeThrough(t).getReader();t=(0,o.createPacketEncoderStream)();t.readable.pipeTo(e.writable),this._writer=t.writable.getWriter();let s=()=>{i.read().then(({done:e,value:t})=>{e?r("session is closed"):(r("received chunk: %o",t),this.onPacket(t),s())}).catch(e=>{r("an error occurred while reading: %s",e)})};s();e={type:"open"};this.query.sid&&(e.data=`{"sid":"${this.query.sid}"}`),this._writer.write(e).then(()=>this.onOpen())})})}write(i){this.writable=!1;for(let t=0;t<i.length;t++){var s=i[t];let e=t===i.length-1;this._writer.write(s).then(()=>{e&&(0,a.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null!=(e=this._transport)&&e.close()}}i.WT=c},{"../globals.node.js":92,"../transport.js":95,debug:107,"engine.io-parser":112}],104:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.pick=function(i,...e){return e.reduce((e,t)=>(i.hasOwnProperty(t)&&(e[t]=i[t]),e),{})},i.installTimerFunctions=function(e,t){t.useNativeTimers?(e.setTimeoutFn=n.bind(s.globalThisShim),e.clearTimeoutFn=a.bind(s.globalThisShim)):(e.setTimeoutFn=s.globalThisShim.setTimeout.bind(s.globalThisShim),e.clearTimeoutFn=s.globalThisShim.clearTimeout.bind(s.globalThisShim))},i.byteLength=function(e){if("string"!=typeof e)return Math.ceil((e.byteLength||e.size)*o);{var n=e;let i=0,s=0;for(let e=0,t=n.length;e<t;e++)(i=n.charCodeAt(e))<128?s+=1:i<2048?s+=2:i<55296||57344<=i?s+=3:(e++,s+=4);return s}},i.randomString=function(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)};let s=e("./globals.node.js");let n=s.globalThisShim.setTimeout,a=s.globalThisShim.clearTimeout;let o=1.33},{"./globals.node.js":92}],105:[function(e,t,i){i.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),this.useColors){var s="color: "+this.color;e.splice(1,0,s,"color: inherit");let t=0,i=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(t++,"%c"===e)&&(i=t)}),e.splice(i,0,s)}},i.save=function(e){try{e?i.storage.setItem("debug",e):i.storage.removeItem("debug")}catch(e){}},i.load=function(){let e;try{e=i.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},i.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&31<=parseInt(e[1],10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},i.storage=(()=>{try{return localStorage}catch(e){}})(),i.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],i.log=console.debug||console.log||(()=>{}),t.exports=e("./common")(i);e=t.exports.formatters;e.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},{"./common":106}],106:[function(e,t,i){t.exports=function(t){function r(e){let i,t=null,s,n;function o(...a){if(o.enabled){let s=o;var e=Number(new Date),t=e-(i||e);s.diff=t,s.prev=i,s.curr=e,i=e,a[0]=r.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");let n=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(e,t)=>{if("%%"===e)return"%";n++;var i,t=r.formatters[t];return"function"==typeof t&&(i=a[n],e=t.call(s,i),a.splice(n,1),n--),e}),r.formatArgs.call(s,a),(s.log||r.log).apply(s,a)}}return o.namespace=e,o.useColors=r.useColors(),o.color=r.selectColor(e),o.extend=a,o.destroy=r.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==t?t:(s!==r.namespaces&&(s=r.namespaces,n=r.enabled(e)),n),set:e=>{t=e}}),"function"==typeof r.init&&r.init(o),o}function a(e,t){t=r(this.namespace+(void 0===t?":":t)+e);return t.log=this.log,t}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return((r.debug=r).default=r).coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},r.disable=function(){var e=[...r.names.map(i),...r.skips.map(i).map(e=>"-"+e)].join(",");return r.enable(""),e},r.enable=function(e){r.save(e),r.namespaces=e,r.names=[],r.skips=[];let t,i=("string"==typeof e?e:"").split(/[\s,]+/),s=i.length;for(t=0;t<s;t++)i[t]&&("-"===(e=i[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.slice(1)+"$")):r.names.push(new RegExp("^"+e+"$")))},r.enabled=function(e){if("*"===e[e.length-1])return!0;let t,i;for(t=0,i=r.skips.length;t<i;t++)if(r.skips[t].test(e))return!1;for(t=0,i=r.names.length;t<i;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=e("ms"),r.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(e=>{r[e]=t[e]}),r.names=[],r.skips=[],r.formatters={},r.selectColor=function(t){let i=0;for(let e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return r.colors[Math.abs(i)%r.colors.length]},r.enable(r.load()),r}},{ms:202}],107:[function(e,t,i){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?t.exports=e("./browser.js"):t.exports=e("./node.js")},{"./browser.js":105,"./node.js":108}],108:[function(e,n,a){let t=e("tty"),i=e("util");a.init=function(t){t.inspectOpts={};var i=Object.keys(a.inspectOpts);for(let e=0;e<i.length;e++)t.inspectOpts[i[e]]=a.inspectOpts[i[e]]},a.log=function(...e){return process.stderr.write(i.formatWithOptions(a.inspectOpts,...e)+"\n")},a.formatArgs=function(e){var{namespace:t,useColors:i}=this;{var s;i?(i=this.color,e[0]=(s=`  ${i="[3"+(i<8?i:"8;5;"+i)};1m${t} [0m`)+e[0].split("\n").join("\n"+s),e.push(i+"m+"+n.exports.humanize(this.diff)+"[0m")):e[0]=(()=>a.inspectOpts.hideDate?"":(new Date).toISOString()+" ")()+t+" "+e[0]}},a.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},a.load=function(){return process.env.DEBUG},a.useColors=function(){return"colors"in a.inspectOpts?Boolean(a.inspectOpts.colors):t.isatty(process.stderr.fd)},a.destroy=i.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),a.colors=[6,2,3,4,5,1];try{var s=e("supports-color");s&&2<=(s.stderr||s).level&&(a.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}a.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{var i=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase());let s=process.env[t];return s=!!/^(yes|on|true|enabled)$/i.test(s)||!/^(no|off|false|disabled)$/i.test(s)&&("null"===s?null:Number(s)),e[i]=s,e},{}),n.exports=e("./common")(a);s=n.exports.formatters;s.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},{"./common":106,"supports-color":297,tty:void 0,util:void 0}],109:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ERROR_PACKET=i.PACKET_TYPES_REVERSE=i.PACKET_TYPES=void 0;let s=Object.create(null),n=((i.PACKET_TYPES=s).open="0",s.close="1",s.ping="2",s.pong="3",s.message="4",s.upgrade="5",s.noop="6",Object.create(null));i.PACKET_TYPES_REVERSE=n,Object.keys(s).forEach(e=>{n[s[e]]=e});i.ERROR_PACKET={type:"error",data:"parser error"}},{}],110:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.decodePacket=void 0;let n=e("./commons.js");i.decodePacket=(e,t)=>{var i,s;return"string"!=typeof e?{type:"message",data:a(e,t)}:"b"===(i=e.charAt(0))?(s=Buffer.from(e.substring(1),"base64"),{type:"message",data:a(s,t)}):n.PACKET_TYPES_REVERSE[i]?1<e.length?{type:n.PACKET_TYPES_REVERSE[i],data:e.substring(1)}:{type:n.PACKET_TYPES_REVERSE[i]}:n.ERROR_PACKET};let a=(e,t)=>"arraybuffer"!==t?Buffer.isBuffer(e)?e:Buffer.from(e):e instanceof ArrayBuffer?e:Buffer.isBuffer(e)?e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):e.buffer},{"./commons.js":109}],111:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.encodePacket=void 0,i.encodePacketToBinary=function(e,t){if(e.data instanceof ArrayBuffer||ArrayBuffer.isView(e.data))return t(a(e.data,!1));(0,i.encodePacket)(e,!0,e=>{s=s||new TextEncoder,t(s.encode(e))})};let n=e("./commons.js");i.encodePacket=({type:e,data:t},i,s)=>t instanceof ArrayBuffer||ArrayBuffer.isView(t)?s(i?t:"b"+a(t,!0).toString("base64")):s(n.PACKET_TYPES[e]+(t||""));let a=(e,t)=>Buffer.isBuffer(e)||e instanceof Uint8Array&&!t?e:e instanceof ArrayBuffer?Buffer.from(e):Buffer.from(e.buffer,e.byteOffset,e.byteLength),s},{"./commons.js":109}],112:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.decodePayload=i.decodePacket=i.encodePayload=i.encodePacket=i.protocol=void 0,i.createPacketEncoderStream=function(){return new TransformStream({transform(n,a){(0,o.encodePacketToBinary)(n,e=>{var t,i=e.length;let s;i<126?(s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,i)):i<65536?(s=new Uint8Array(3),(t=new DataView(s.buffer)).setUint8(0,126),t.setUint16(1,i)):(s=new Uint8Array(9),(t=new DataView(s.buffer)).setUint8(0,127),t.setBigUint64(1,BigInt(i))),n.data&&"string"!=typeof n.data&&(s[0]|=128),a.enqueue(s),a.enqueue(e)})}})},i.createPacketDecoderStream=function(a,o){h=h||new TextDecoder;let r=[],c=0,l=-1,p=!1;return new TransformStream({transform(e,t){for(r.push(e);;){if(0===c){if(m(r)<1)break;var i=f(r,1);p=128==(128&i[0]),l=127&i[0],c=l<126?3:126===l?1:2}else if(1===c){if(m(r)<2)break;i=f(r,2);l=new DataView(i.buffer,i.byteOffset,i.length).getUint16(0),c=3}else if(2===c){if(m(r)<8)break;var s=f(r,8),s=new DataView(s.buffer,s.byteOffset,s.length),n=s.getUint32(0);if(n>Math.pow(2,21)-1){t.enqueue(d.ERROR_PACKET);break}l=n*Math.pow(2,32)+s.getUint32(4),c=3}else{if(m(r)<l)break;n=f(r,l);t.enqueue((0,u.decodePacket)(p?n:h.decode(n),o)),c=0}if(0===l||l>a){t.enqueue(d.ERROR_PACKET);break}}}})};let o=e("./encodePacket.js"),u=(Object.defineProperty(i,"encodePacket",{enumerable:!0,get:function(){return o.encodePacket}}),e("./decodePacket.js")),d=(Object.defineProperty(i,"decodePacket",{enumerable:!0,get:function(){return u.decodePacket}}),e("./commons.js")),r=String.fromCharCode(30);i.encodePayload=(e,i)=>{let s=e.length,n=new Array(s),a=0;e.forEach((e,t)=>{(0,o.encodePacket)(e,!1,e=>{n[t]=e,++a===s&&i(n.join(r))})})};i.decodePayload=(e,t)=>{var i=e.split(r),s=[];for(let e=0;e<i.length;e++){var n=(0,u.decodePacket)(i[e],t);if(s.push(n),"error"===n.type)break}return s};let h;function m(e){return e.reduce((e,t)=>e+t.length,0)}function f(t,i){if(t[0].length===i)return t.shift();var s=new Uint8Array(i);let n=0;for(let e=0;e<i;e++)s[e]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),s}i.protocol=4},{"./commons.js":109,"./decodePacket.js":110,"./encodePacket.js":111}],113:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.protocol=i.Transport=i.Socket=i.uServer=i.parser=i.transports=i.Server=void 0,i.listen=function(e,t,i){"function"==typeof t&&(i=t,t={});var s=(0,n.createServer)(function(e,t){t.writeHead(501),t.end("Not Implemented")}),t=l(s,t);return(t.httpServer=s).listen(e,i),t},i.attach=l;let n=e("http"),s=e("./server");Object.defineProperty(i,"Server",{enumerable:!0,get:function(){return s.Server}});var a=e("./transports/index"),a=(i.transports=a.default,e("engine.io-parser")),o=(i.parser=a,e("./userver")),r=(Object.defineProperty(i,"uServer",{enumerable:!0,get:function(){return o.uServer}}),e("./socket")),c=(Object.defineProperty(i,"Socket",{enumerable:!0,get:function(){return r.Socket}}),e("./transport"));function l(e,t){var i=new s.Server(t);return i.attach(e,t),i}Object.defineProperty(i,"Transport",{enumerable:!0,get:function(){return c.Transport}}),i.protocol=a.protocol},{"./server":116,"./socket":117,"./transport":118,"./transports/index":122,"./userver":127,"engine.io-parser":112,http:void 0}],114:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.packets=n.protocol=void 0,n.encodePacket=c,n.encodeBase64Packet=p,n.decodePacket=d,n.decodeBase64Packet=h,n.encodePayload=function(e,i,s){"function"==typeof i&&(s=i,i=null);if(i&&o(e))return v(e,s);if(!e.length)return s("0:");m(e,function(e,t){c(e,i,!1,function(e){t(null,e.length+":"+e)})},function(e,t){s(t.join(""))})},n.decodePayload=function(e,t,i){if("string"!=typeof e)return g(e,t,i);"function"==typeof t&&(i=t,t=null);if(""===e)return i(u,0,1);for(var s,n="",a=0,o=e.length;a<o;a++){var r=e.charAt(a);if(":"!==r)n+=r;else{if(""===n||n!=(s=Number(n)))return i(u,0,1);if(r=e.slice(a+1,a+1+s),n!=r.length)return i(u,0,1);if(r.length){if(r=d(r,t,!1),u.type===r.type&&u.data===r.data)return i(u,0,1);if(!1===i(r,a+s,o))return}a+=s,n=""}}if(""!==n)return i(u,0,1)},n.encodePayloadAsBinary=v,n.decodePayloadAsBinary=g;var a=e("./utf8");n.protocol=3;let o=e=>{for(var t of e)if(t.data instanceof ArrayBuffer||ArrayBuffer.isView(t.data))return!0;return!1};n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6};var r=Object.keys(n.packets),u={type:"error",data:"parser error"};let s=Buffer.concat([]);function c(e,t,i,s){return"function"==typeof t&&(s=t,t=null),"function"==typeof i&&(s=i,i=null),Buffer.isBuffer(e.data)?l(e,t,s):e.data&&(e.data.buffer||e.data)instanceof ArrayBuffer?l({type:e.type,data:f(e.data)},t,s):(t=n.packets[e.type],void 0!==e.data&&(t+=i?a.encode(String(e.data),{strict:!1}):String(e.data)),s(""+t))}function l(e,t,i){var s;return t?(t=e.data,(s=Buffer.allocUnsafe(1))[0]=n.packets[e.type],i(Buffer.concat([s,t]))):p(e,i)}function p(e,t){var i=Buffer.isBuffer(e.data)?e.data:f(e.data),e="b"+n.packets[e.type];return t(e+=i.toString("base64"))}function d(e,t,i){var s;return void 0===e?u:"string"==typeof e?"b"===(s=e.charAt(0))?h(e.slice(1),t):(!i||!1!==(e=(e=>{try{e=a.decode(e,{strict:!1})}catch(e){return!1}return e})(e)))&&Number(s)==s&&r[s]?1<e.length?{type:r[s],data:e.slice(1)}:{type:r[s]}:u:"arraybuffer"===t?(s=(i=new Uint8Array(e))[0],{type:r[s],data:i.buffer.slice(1)}):(s=(e=e instanceof ArrayBuffer?f(e):e)[0],{type:r[s],data:e.slice(1)})}function h(e,t){var i=r[e.charAt(0)],s=Buffer.from(e.slice(1),"base64");if("arraybuffer"===t){for(var n=new Uint8Array(s.length),a=0;a<n.length;a++)n[a]=s[a];s=n.buffer}return{type:i,data:s}}function m(s,e,n){let a=new Array(s.length),o=0;for(let i=0;i<s.length;i++)e(s[i],(e,t)=>{a[i]=t,++o===s.length&&n(null,a)})}function f(e){var t=e.byteLength||e.length;return Buffer.from(e.buffer||e,e.byteOffset||0,t)}function v(e,i){if(!e.length)return i(s);m(e,y,function(e,t){i(Buffer.concat(t))})}function y(e,n){c(e,!0,!0,function(e){var t=""+e.length;if("string"==typeof e){for(var i,s=(i=Buffer.allocUnsafe(t.length+2))[0]=0;s<t.length;s++)i[s+1]=parseInt(t[s],10);return i[i.length-1]=255,n(null,Buffer.concat([i,(e=>{for(var t=Buffer.allocUnsafe(e.length),i=0,s=e.length;i<s;i++)t.writeUInt8(e.charCodeAt(i),i);return t})(e)]))}for((i=Buffer.allocUnsafe(t.length+2))[0]=1,s=0;s<t.length;s++)i[s+1]=parseInt(t[s],10);i[i.length-1]=255,n(null,Buffer.concat([i,e]))})}function g(e,t,i){"function"==typeof t&&(i=t,t=null);for(var s=e,n=[];0<s.length;){for(var a="",o=0===s[0],r=1;255!==s[r];r++){if(310<a.length)return i(u,0,1);a+=""+s[r]}var s=s.slice(a.length+1),c=parseInt(a,10),l=s.slice(1,c+1);o&&(l=(e=>{for(var t="",i=0,s=e.length;i<s;i++)t+=String.fromCharCode(e[i]);return t})(l)),n.push(l),s=s.slice(c+1)}var p=n.length;for(r=0;r<p;r++)i(d(n[r],t,!0),r,p)}},{"./utf8":115}],115:[function(e,t,i){var p,u,d,h=String.fromCharCode;function m(e){for(var t,i,s=[],n=0,a=e.length;n<a;)55296<=(t=e.charCodeAt(n++))&&t<=56319&&n<a?56320==(64512&(i=e.charCodeAt(n++)))?s.push(((1023&t)<<10)+(1023&i)+65536):(s.push(t),n--):s.push(t);return s}function f(e,t){if(!(55296<=e&&e<=57343))return 1;if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function v(e,t){return h(e>>t&63|128)}function y(){if(u<=d)throw Error("Invalid byte index");var e=255&p[d];if(d++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}t.exports={version:"2.1.2",encode:function(e,t){for(var i,s,n,a=!1!==(t=t||{}).strict,o=m(e),r=o.length,c=-1,l="";++c<r;)i=o[c],l+=(s=a,n=void 0,0==(4294967168&(i=i))?h(i):(n="",0==(4294965248&i)?n=h(i>>6&31|192):0==(4294901760&i)?(f(i,s)||(i=65533),n=h(i>>12&15|224),n+=v(i,6)):0==(4292870144&i)&&(n=h(i>>18&7|240),n=(n+=v(i,12))+v(i,6)),n+h(63&i|128)));return l},decode:function(e,t){for(var i,s=!1!==(t=t||{}).strict,n=(p=m(e),u=p.length,d=0,[]);!1!==(i=(e=>{var t,i;if(u<d)throw Error("Invalid byte index");if(d==u)return!1;if(t=255&p[d],d++,0==(128&t))return t;if(192==(224&t)){if(128<=(i=(31&t)<<6|y()))return i;throw Error("Invalid continuation byte")}if(224==(240&t)){if(2048<=(i=(15&t)<<12|y()<<6|y()))return f(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&65536<=(i=(7&t)<<18|y()<<12|y()<<6|y())&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")})(s));)n.push(i);for(var a,o=n,r=o.length,c=-1,l="";++c<r;)65535<(a=o[c])&&(l+=h((a-=65536)>>>10&1023|55296),a=56320|1023&a),l+=h(a);return l}}},{}],116:[function(t,e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Server=i.BaseServer=void 0;let s=t("querystring"),n=t("url"),o=t("base64id"),r=t("./transports");var a=t("events");let c=t("./socket");var l=t("debug");let p=t("cookie"),u=t("ws"),d=t("./transports/webtransport"),h=t("engine.io-parser"),m=(0,l.default)("engine"),f=Symbol("responseHeaders");class v extends a.EventEmitter{constructor(e={}){super(),this.middlewares=[],this.clients={},this.clientsCount=0,this.opts=Object.assign({wsEngine:u.Server,pingTimeout:2e4,pingInterval:25e3,upgradeTimeout:1e4,maxHttpBufferSize:1e6,transports:["polling","websocket"],allowUpgrades:!0,httpCompression:{threshold:1024},cors:!1,allowEIO3:!1},e),e.cookie&&(this.opts.cookie=Object.assign({name:"io",path:"/",httpOnly:!1!==e.cookie.path,sameSite:"lax"},e.cookie)),this.opts.cors&&this.use(t("cors")(this.opts.cors)),e.perMessageDeflate&&(this.opts.perMessageDeflate=Object.assign({threshold:1024},e.perMessageDeflate)),this.init()}_computePath(e){let t=(e.path||"/engine.io").replace(/\/$/,"");return!1!==e.addTrailingSlash&&(t+="/"),t}upgrades(e){return this.opts.allowUpgrades&&r.default[e].upgradesTo||[]}verify(e,t,i){var s,n,a=e._query.transport;return~this.opts.transports.indexOf(a)&&"webtransport"!==a?(t=>{if(!((t+="").length<1)){if(!w[t.charCodeAt(0)])return m('invalid header, index 0, char "%s"',t.charCodeAt(0)),!0;if(!(t.length<2)){if(!w[t.charCodeAt(1)])return m('invalid header, index 1, char "%s"',t.charCodeAt(1)),!0;if(!(t.length<3)){if(!w[t.charCodeAt(2)])return m('invalid header, index 2, char "%s"',t.charCodeAt(2)),!0;if(!(t.length<4)){if(!w[t.charCodeAt(3)])return m('invalid header, index 3, char "%s"',t.charCodeAt(3)),!0;for(let e=4;e<t.length;++e)if(!w[t.charCodeAt(e)])return m('invalid header, index "%i", char "%s"',e,t.charCodeAt(e)),!0}}}}return!1})(e.headers.origin)?(s=e.headers.origin,e.headers.origin=null,m("origin header invalid"),i(g.errors.BAD_REQUEST,{name:"INVALID_ORIGIN",origin:s})):(s=e._query.sid)?this.clients.hasOwnProperty(s)?(n=this.clients[s].transport.name,t||n===a?void i():(m("bad request: unexpected transport without upgrade"),i(g.errors.BAD_REQUEST,{name:"TRANSPORT_MISMATCH",transport:a,previousTransport:n}))):(m('unknown sid "%s"',s),i(g.errors.UNKNOWN_SID,{sid:s})):"GET"!==e.method?i(g.errors.BAD_HANDSHAKE_METHOD,{method:e.method}):"websocket"!==a||t?this.opts.allowRequest?this.opts.allowRequest(e,(e,t)=>{if(!t)return i(g.errors.FORBIDDEN,{message:e});i()}):i():(m("invalid transport upgrade"),i(g.errors.BAD_REQUEST,{name:"TRANSPORT_HANDSHAKE_ERROR"})):(m('unknown transport "%s"',a),i(g.errors.UNKNOWN_TRANSPORT,{transport:a}))}use(e){this.middlewares.push(e)}_applyMiddlewares(e,i,s){if(0===this.middlewares.length)return m("no middleware to apply, skipping"),s();let n=t=>{m("applying middleware n%d",t+1),this.middlewares[t](e,i,e=>{if(e)return s(e);t+1<this.middlewares.length?n(t+1):s()})};n(0)}close(){for(var e in m("closing all open clients"),this.clients)this.clients.hasOwnProperty(e)&&this.clients[e].close(!0);return this.cleanup(),this}generateId(e){return o.generateId()}async handshake(t,s,n){var e="4"===s._query.EIO?4:3;if(3!=e||this.opts.allowEIO3){let i;try{i=await this.generateId(s)}catch(e){return m("error while generating an id"),this.emit("connection_error",{req:s,code:g.errors.BAD_REQUEST,message:g.errorMessages[g.errors.BAD_REQUEST],context:{name:"ID_GENERATION_ERROR",error:e}}),void n(g.errors.BAD_REQUEST)}m('handshaking client "%s"',i);try{var a=this.createTransport(t,s);"polling"===t?(a.maxHttpBufferSize=this.opts.maxHttpBufferSize,a.httpCompression=this.opts.httpCompression):"websocket"===t&&(a.perMessageDeflate=this.opts.perMessageDeflate)}catch(e){return m('error handshaking to transport "%s"',t),this.emit("connection_error",{req:s,code:g.errors.BAD_REQUEST,message:g.errorMessages[g.errors.BAD_REQUEST],context:{name:"TRANSPORT_HANDSHAKE_ERROR",error:e}}),void n(g.errors.BAD_REQUEST)}t=new c.Socket(i,this,a,s,e);return a.on("headers",(e,t)=>{t._query.sid||(this.opts.cookie&&(e["Set-Cookie"]=[(0,p.serialize)(this.opts.cookie.name,i,this.opts.cookie)]),this.emit("initial_headers",e,t)),this.emit("headers",e,t)}),a.onRequest(s),this.clients[i]=t,this.clientsCount++,t.once("close",()=>{delete this.clients[i],this.clientsCount--}),this.emit("connection",t),a}m("unsupported protocol version"),this.emit("connection_error",{req:s,code:g.errors.UNSUPPORTED_PROTOCOL_VERSION,message:g.errorMessages[g.errors.UNSUPPORTED_PROTOCOL_VERSION],context:{protocol:e}}),n(g.errors.UNSUPPORTED_PROTOCOL_VERSION)}async onWebTransportSession(t){var i=setTimeout(()=>{m("the client failed to establish a bidirectional stream in the given period"),t.close()},this.opts.upgradeTimeout),s=await t.incomingBidirectionalStreams.getReader().read();if(s.done)m("session is closed");else{var s=s.value,n=(0,h.createPacketDecoderStream)(this.opts.maxHttpBufferSize,"nodebuffer"),n=s.readable.pipeThrough(n).getReader(),{value:e,done:a}=await n.read();if(a)m("stream is closed");else{if(clearTimeout(i),"open"!==e.type)return m("invalid WebTransport handshake"),t.close();if(void 0===e.data){a=new d.WebTransport(t,s,n);let e=o.generateId();m('handshaking client "%s" (WebTransport)',e);i=new c.Socket(e,this,a,null,4);this.clients[e]=i,this.clientsCount++,i.once("close",()=>{delete this.clients[e],this.clientsCount--}),void this.emit("connection",i)}else{a=(e=>{try{var t=JSON.parse(e);if("string"==typeof t.sid)return t.sid}catch(e){}})(e.data);if(!a)return m("invalid WebTransport handshake"),t.close();i=this.clients[a];i?i.upgrading?(m("transport has already been trying to upgrade"),t.close()):i.upgraded?(m("transport had already been upgraded"),t.close()):(m("upgrading existing transport"),e=new d.WebTransport(t,s,n),i._maybeUpgrade(e)):(m("upgrade attempt for closed client"),t.close())}}}}}(i.BaseServer=v).errors={UNKNOWN_TRANSPORT:0,UNKNOWN_SID:1,BAD_HANDSHAKE_METHOD:2,BAD_REQUEST:3,FORBIDDEN:4,UNSUPPORTED_PROTOCOL_VERSION:5},v.errorMessages={0:"Transport unknown",1:"Session ID unknown",2:"Bad handshake method",3:"Bad request",4:"Forbidden",5:"Unsupported protocol version"};class y{constructor(e,t){this.req=e,this.socket=t,e[f]={}}setHeader(e,t){this.req[f][e]=t}getHeader(e){return this.req[f][e]}removeHeader(e){delete this.req[f][e]}write(){}writeHead(){}end(){this.socket.destroy()}}class g extends v{init(){~this.opts.transports.indexOf("websocket")&&(this.ws&&this.ws.close(),this.ws=new this.opts.wsEngine({noServer:!0,clientTracking:!1,perMessageDeflate:this.opts.perMessageDeflate,maxPayload:this.opts.maxHttpBufferSize}),"function"==typeof this.ws.on)&&this.ws.on("headers",(t,e)=>{let i=e[f]||{};delete e[f],e._query.sid||this.emit("initial_headers",i,e),this.emit("headers",i,e),m("writing headers: %j",i),Object.keys(i).forEach(e=>{t.push(e+": "+i[e])})})}cleanup(){this.ws&&(m("closing webSocketServer"),this.ws.close())}prepare(e){e._query||(e._query=~e.url.indexOf("?")?s.parse((0,n.parse)(e.url).query):{})}createTransport(e,t){return new r.default[e](t)}handleRequest(i,s){m('handling "%s" http request "%s"',i.method,i.url),this.prepare(i),i.res=s;let t=(e,t)=>{void 0!==e?(this.emit("connection_error",{req:i,code:e,message:g.errorMessages[e],context:t}),b(s,e,t)):i._query.sid?(m("setting new request for existing client"),this.clients[i._query.sid].transport.onRequest(i)):this.handshake(i._query.transport,i,(e,t)=>b(s,e,t))};this._applyMiddlewares(i,s,e=>{e?t(g.errors.BAD_REQUEST,{name:"MIDDLEWARE_FAILURE"}):this.verify(i,!1,t)})}handleUpgrade(i,s,n){this.prepare(i);let a=new y(i,s),t=(e,t)=>{void 0!==e?(this.emit("connection_error",{req:i,code:e,message:g.errorMessages[e],context:t}),x(s,e,t)):(e=Buffer.from(n),n=null,a.writeHead(),this.ws.handleUpgrade(i,s,e,e=>{this.onWebSocket(i,s,e)}))};this._applyMiddlewares(i,a,e=>{e?t(g.errors.BAD_REQUEST,{name:"MIDDLEWARE_FAILURE"}):this.verify(i,!0,t)})}onWebSocket(e,i,t){var s,n;function a(){m("websocket error before upgrade")}t.on("error",a),void 0===r.default[e._query.transport]||r.default[e._query.transport].prototype.handlesUpgrades?(s=e._query.sid,e.websocket=t,s?(s=this.clients[s])?s.upgrading?(m("transport has already been trying to upgrade"),t.close()):s.upgraded?(m("transport had already been upgraded"),t.close()):(m("upgrading existing transport"),t.removeListener("error",a),(n=this.createTransport(e._query.transport,e)).perMessageDeflate=this.opts.perMessageDeflate,s._maybeUpgrade(n)):(m("upgrade attempt for closed client"),t.close()):this.handshake(e._query.transport,e,(e,t)=>x(i,e,t))):(m("transport doesnt handle upgraded requests"),t.close())}attach(n,s={}){let a=this._computePath(s),o=s.destroyUpgradeTimeout||1e3;function r(e){return a===e.url.slice(0,a.length)}let c=n.listeners("request").slice(0);n.removeAllListeners("request"),n.on("close",this.close.bind(this)),n.on("listening",this.init.bind(this)),n.on("request",(t,i)=>{if(r(t))m('intercepting request for path "%s"',a),this.handleRequest(t,i);else{let e=0;for(var s=c.length;e<s;e++)c[e].call(n,t,i)}}),~this.opts.transports.indexOf("websocket")&&n.on("upgrade",(e,t,i)=>{r(e)?this.handleUpgrade(e,t,i):!1!==s.destroyUpgrade&&setTimeout(function(){if(t.writable&&t.bytesWritten<=0)return t.on("error",e=>{m("error while destroying upgrade: %s",e.message)}),t.end()},o)})}}function b(e,t,i){var s=t===g.errors.FORBIDDEN?403:400,i=i&&i.message?i.message:g.errorMessages[t];e.writeHead(s,{"Content-Type":"application/json"}),e.end(JSON.stringify({code:t,message:i}))}function x(e,t,i={}){e.on("error",()=>{m("ignoring error from closed connection")}),e.writable&&(i=i.message||g.errorMessages[t],t=Buffer.byteLength(i),e.write("HTTP/1.1 400 Bad Request\r\nConnection: close\r\nContent-type: text/html\r\nContent-Length: "+t+"\r\n\r\n"+i)),e.destroy()}i.Server=g;let w=[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},{"./socket":117,"./transports":122,"./transports/webtransport":126,base64id:77,cookie:128,cors:85,debug:131,"engine.io-parser":112,events:void 0,querystring:void 0,url:void 0,ws:317}],117:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Socket=void 0;var s=e("events"),n=e("debug");let l=e("timers"),p=(0,n.default)("engine:socket");class a extends s.EventEmitter{get readyState(){return this._readyState}set readyState(e){p("readyState updated from %s to %s",this._readyState,e),this._readyState=e}constructor(e,t,i,s,n){super(),this._readyState="opening",this.upgrading=!1,this.upgraded=!1,this.writeBuffer=[],this.packetsFn=[],this.sentCallbackFn=[],this.cleanupFn=[],this.id=e,this.server=t,this.request=s,this.protocol=n,s&&(s.websocket&&s.websocket._socket?this.remoteAddress=s.websocket._socket.remoteAddress:this.remoteAddress=s.connection.remoteAddress),this.pingTimeoutTimer=null,this.pingIntervalTimer=null,this.setTransport(i),this.onOpen()}onOpen(){this.readyState="open",this.transport.sid=this.id,this.sendPacket("open",JSON.stringify({sid:this.id,upgrades:this.getAvailableUpgrades(),pingInterval:this.server.opts.pingInterval,pingTimeout:this.server.opts.pingTimeout,maxPayload:this.server.opts.maxHttpBufferSize})),this.server.opts.initialPacket&&this.sendPacket("message",this.server.opts.initialPacket),this.emit("open"),3===this.protocol?this.resetPingTimeout():this.schedulePing()}onPacket(e){if("open"!==this.readyState)return p("packet received with closed socket");switch(p("received packet "+e.type),this.emit("packet",e),e.type){case"ping":3!==this.transport.protocol?this.onError(new Error("invalid heartbeat direction")):(p("got ping"),this.pingTimeoutTimer.refresh(),this.sendPacket("pong"),this.emit("heartbeat"));break;case"pong":3===this.transport.protocol?this.onError(new Error("invalid heartbeat direction")):(p("got pong"),(0,l.clearTimeout)(this.pingTimeoutTimer),this.pingIntervalTimer.refresh(),this.emit("heartbeat"));break;case"error":this.onClose("parse error");break;case"message":this.emit("data",e.data),this.emit("message",e.data)}}onError(e){p("transport error"),this.onClose("transport error",e)}schedulePing(){this.pingIntervalTimer=(0,l.setTimeout)(()=>{p("writing ping packet - expecting pong within %sms",this.server.opts.pingTimeout),this.sendPacket("ping"),this.resetPingTimeout()},this.server.opts.pingInterval)}resetPingTimeout(){(0,l.clearTimeout)(this.pingTimeoutTimer),this.pingTimeoutTimer=(0,l.setTimeout)(()=>{"closed"!==this.readyState&&this.onClose("ping timeout")},3===this.protocol?this.server.opts.pingInterval+this.server.opts.pingTimeout:this.server.opts.pingTimeout)}setTransport(e){let t=this.onError.bind(this),i=()=>this.flush(),s=this.onPacket.bind(this),n=this.onDrain.bind(this),a=this.onClose.bind(this,"transport close");this.transport=e,this.transport.once("error",t),this.transport.on("ready",i),this.transport.on("packet",s),this.transport.on("drain",n),this.transport.once("close",a),this.cleanupFn.push(function(){e.removeListener("error",t),e.removeListener("ready",i),e.removeListener("packet",s),e.removeListener("drain",n),e.removeListener("close",a)})}onDrain(){if(0<this.sentCallbackFn.length){p("executing batch send callback");var t=this.sentCallbackFn.shift();if(t)for(let e=0;e<t.length;e++)t[e](this.transport)}}_maybeUpgrade(t){p('might upgrade socket transport from "%s" to "%s"',this.transport.name,t.name),this.upgrading=!0;let e=(0,l.setTimeout)(()=>{p("client did not complete upgrade - closing transport"),a(),"open"===t.readyState&&t.close()},this.server.opts.upgradeTimeout),i,s=e=>{"ping"===e.type&&"probe"===e.data?(p("got probe ping packet, sending pong"),t.send([{type:"pong",data:"probe"}]),this.emit("upgrading",t),clearInterval(i),i=setInterval(n,100)):"upgrade"===e.type&&"closed"!==this.readyState?(p("got upgrade packet - upgrading"),a(),this.transport.discard(),this.upgraded=!0,this.clearTransport(),this.setTransport(t),this.emit("upgrade",t),this.flush(),"closing"===this.readyState&&t.close(()=>{this.onClose("forced close")})):(a(),t.close())},n=()=>{"polling"===this.transport.name&&this.transport.writable&&(p("writing a noop packet to polling for fast upgrade"),this.transport.send([{type:"noop"}]))},a=()=>{this.upgrading=!1,clearInterval(i),(0,l.clearTimeout)(e),t.removeListener("packet",s),t.removeListener("close",r),t.removeListener("error",o),this.removeListener("close",c)},o=e=>{p("client did not complete upgrade - %s",e),a(),t.close(),t=null},r=()=>{o("transport closed")},c=()=>{o("socket closed")};t.on("packet",s),t.once("close",r),t.once("error",o),this.once("close",c)}clearTransport(){var t=this.cleanupFn.length;for(let e=0;e<t;e++)this.cleanupFn.shift()();this.transport.on("error",function(){p("error triggered by discarded transport")}),this.transport.close(),(0,l.clearTimeout)(this.pingTimeoutTimer)}onClose(e,t){"closed"!==this.readyState&&(this.readyState="closed",(0,l.clearTimeout)(this.pingIntervalTimer),(0,l.clearTimeout)(this.pingTimeoutTimer),process.nextTick(()=>{this.writeBuffer=[]}),this.packetsFn=[],this.sentCallbackFn=[],this.clearTransport(),this.emit("close",e,t))}send(e,t,i){return this.sendPacket("message",e,t,i),this}write(e,t,i){return this.sendPacket("message",e,t,i),this}sendPacket(e,t,i={},s){"function"==typeof i&&(s=i,i={}),"closing"!==this.readyState&&"closed"!==this.readyState&&(p('sending packet "%s" (%s)',e,t),i.compress=!1!==i.compress,e={type:e,options:i},t&&(e.data=t),this.emit("packetCreate",e),this.writeBuffer.push(e),"function"==typeof s&&this.packetsFn.push(s),this.flush())}flush(){var e;"closed"!==this.readyState&&this.transport.writable&&this.writeBuffer.length&&(p("flushing buffer to transport"),this.emit("flush",this.writeBuffer),this.server.emit("flush",this,this.writeBuffer),e=this.writeBuffer,this.writeBuffer=[],this.packetsFn.length?(this.sentCallbackFn.push(this.packetsFn),this.packetsFn=[]):this.sentCallbackFn.push(null),this.transport.send(e),this.emit("drain"),this.server.emit("drain",this))}getAvailableUpgrades(){var t=[],i=this.server.upgrades(this.transport.name);for(let e=0;e<i.length;++e){var s=i[e];-1!==this.server.opts.transports.indexOf(s)&&t.push(s)}return t}close(e){if(e&&("open"===this.readyState||"closing"===this.readyState))return this.closeTransport(e);"open"===this.readyState&&(this.readyState="closing",this.writeBuffer.length?(p("there are %d remaining packets in the buffer, waiting for the 'drain' event",this.writeBuffer.length),this.once("drain",()=>{p("all packets have been sent, closing the transport"),this.closeTransport(e)})):(p("the buffer is empty, closing the transport right away"),this.closeTransport(e)))}closeTransport(e){p("closing the transport (discard? %s)",!!e),e&&this.transport.discard(),this.transport.close(this.onClose.bind(this,"forced close"))}}i.Socket=a},{debug:131,events:void 0,timers:void 0}],118:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Transport=void 0;var s=e("events");let n=e("engine.io-parser"),a=e("./parser-v3/index"),o=(0,e("debug").default)("engine:transport");function r(){}class c extends s.EventEmitter{get readyState(){return this._readyState}set readyState(e){o("readyState updated from %s to %s (%s)",this._readyState,e,this.name),this._readyState=e}constructor(e){super(),this.writable=!1,this._readyState="open",this.discarded=!1,this.protocol="4"===e._query.EIO?4:3,this.parser=4===this.protocol?n:a,this.supportsBinary=!(e._query&&e._query.b64)}discard(){this.discarded=!0}onRequest(e){}close(e){"closed"!==this.readyState&&"closing"!==this.readyState&&(this.readyState="closing",this.doClose(e||r))}onError(e,t){var i;this.listeners("error").length?((i=new Error(e)).type="TransportError",i.description=t,this.emit("error",i)):o("ignored transport error %s (%s)",e,t)}onPacket(e){this.emit("packet",e)}onData(e){this.onPacket(this.parser.decodePacket(e))}onClose(){this.readyState="closed",this.emit("close")}}i.Transport=c},{"./parser-v3/index":114,debug:131,"engine.io-parser":112,events:void 0}],119:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var s=e("./polling"),e=e("./websocket");i.default={polling:s.Polling,websocket:e.WebSocket}},{"./polling":120,"./websocket":121}],120:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Polling=void 0;var s=e("../transport"),n=e("zlib");let o=e("accepts"),a=(0,e("debug").default)("engine:polling"),r={gzip:n.createGzip,deflate:n.createDeflate};class c extends s.Transport{constructor(e){super(e),this.closeTimeout=3e4}get name(){return"polling"}onRequest(e){var t=e.res;e.res=null,"get"===e.getMethod()?this.onPollRequest(e,t):"post"===e.getMethod()?this.onDataRequest(e,t):(t.writeStatus("500 Internal Server Error"),t.end())}onPollRequest(e,t){this.req?(a("request overlap"),this.onError("overlap from client"),t.writeStatus("500 Internal Server Error"),t.end()):(a("setting request"),this.req=e,this.res=t,e.cleanup=()=>{this.req=this.res=null},t.onAborted(()=>{this.writable=!1,this.onError("poll connection closed prematurely")}),this.writable=!0,this.emit("ready"),this.writable&&this.shouldClose&&(a("triggering empty send to append close packet"),this.send([{type:"noop"}])))}onDataRequest(e,r){if(this.dataReq)this.onError("data request overlap from client"),r.writeStatus("500 Internal Server Error"),r.end();else{let o=Number(e.headers["content-length"]);if(o)if(o>this.maxHttpBufferSize)this.onError("payload too large"),r.writeStatus("413 Payload Too Large").end();else{if("application/octet-stream"===e.headers["content-type"]&&4===this.protocol)return this.onError("invalid content");this.dataReq=e,this.dataRes=r;let s,n=0;var t,i={"Content-Type":"text/html"};for(t in this.headers(e,i),i)r.writeHeader(t,String(i[t]));let a=e=>{this.onData(e.toString()),this.onDataRequestCleanup(),r.cork(()=>{r.end("ok")})};r.onAborted(()=>{this.onDataRequestCleanup(),this.onError("data request connection closed prematurely")}),r.onData((e,t)=>{var i=n+e.byteLength;if(i>o)this.onError("content-length mismatch"),r.close();else{if(!s){if(t)return void a(Buffer.from(e));s=Buffer.allocUnsafe(o)}if(Buffer.from(e).copy(s,n),t)return i!=o?(this.onError("content-length mismatch"),r.writeStatus("400 Content-Length Mismatch").end(),void this.onDataRequestCleanup()):void a(s);n=i}})}else this.onError("content-length header required"),r.writeStatus("411 Length Required").end()}}onDataRequestCleanup(){this.dataReq=this.dataRes=null}onData(e){a('received "%s"',e);var t=e=>{if("close"===e.type)return a("got xhr close packet"),this.onClose(),!1;this.onPacket(e)};3===this.protocol?this.parser.decodePayload(e,t):this.parser.decodePayload(e).forEach(t)}onClose(){this.writable&&this.send([{type:"noop"}]),super.onClose()}send(i){this.writable=!1,this.shouldClose&&(a("appending close packet to payload"),i.push({type:"close"}),this.shouldClose(),this.shouldClose=null);var e=e=>{var t=i.some(e=>e.options&&e.options.compress);this.write(e,{compress:t})};3===this.protocol?this.parser.encodePayload(i,this.supportsBinary,e):this.parser.encodePayload(i,e)}write(e,t){a('writing "%s"',e),this.doWrite(e,t,()=>{this.req.cleanup(),this.emit("drain")})}doWrite(e,t,s){var i="string"==typeof e;let n={"Content-Type":i?"text/plain; charset=UTF-8":"application/octet-stream"},a=e=>{this.headers(this.req,n),this.res.cork(()=>{Object.keys(n).forEach(e=>{this.res.writeHeader(e,String(n[e]))}),this.res.end(e)}),s()};if(this.httpCompression&&t.compress)if((i?Buffer.byteLength(e):e.length)<this.httpCompression.threshold)a(e);else{let i=o(this.req).encodings(["gzip","deflate"]);i?this.compress(e,i,(e,t)=>{e?(this.res.writeStatus("500 Internal Server Error"),this.res.end(),s(e)):(n["Content-Encoding"]=i,a(t))}):a(e)}else a(e)}compress(e,t,i){a("compressing");let s=[],n=0;r[t](this.httpCompression).on("error",i).on("data",function(e){s.push(e),n+=e.length}).on("end",function(){i(null,Buffer.concat(s,n))}).end(e)}doClose(e){a("closing");let t;var i=()=>{clearTimeout(t),e(),this.onClose()};this.writable?(a("transport writable - closing right away"),this.send([{type:"close"}]),i()):this.discarded?(a("transport discarded - closing right away"),i()):(a("transport not writable - buffering orderly close"),this.shouldClose=i,t=setTimeout(i,this.closeTimeout))}headers(e,t){t=t||{};var i=e.headers["user-agent"];return i&&(~i.indexOf(";MSIE")||~i.indexOf("Trident/"))&&(t["X-XSS-Protection"]="0"),t["cache-control"]="no-store",this.emit("headers",t,e),t}}i.Polling=c},{"../transport":118,accepts:76,debug:131,zlib:void 0}],121:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.WebSocket=void 0;var s=e("../transport");let a=(0,e("debug").default)("engine:ws");class n extends s.Transport{constructor(e){super(e),this.writable=!1,this.perMessageDeflate=null}get name(){return"websocket"}get handlesUpgrades(){return!0}send(t){this.writable=!1;for(let e=0;e<t.length;e++){var i=t[e];let s=e+1===t.length;var n=e=>{var t="string"!=typeof e,i=this.perMessageDeflate&&Buffer.byteLength(e)>this.perMessageDeflate.threshold;a('writing "%s"',e),this.socket.send(e,t,i),s&&(this.emit("drain"),this.writable=!0,this.emit("ready"))};i.options&&"string"==typeof i.options.wsPreEncoded?n(i.options.wsPreEncoded):this.parser.encodePacket(i,this.supportsBinary,n)}}doClose(e){a("closing"),e&&e(),this.socket.end()}}i.WebSocket=n},{"../transport":118,debug:131}],122:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let s=e("./polling"),n=e("./polling-jsonp");var a=e("./websocket"),e=e("./webtransport");function o(e){return new("string"==typeof e._query.j?n.JSONP:s.Polling)(e)}i.default={polling:o,websocket:a.WebSocket,webtransport:e.WebTransport},o.upgradesTo=["websocket","webtransport"]},{"./polling":124,"./polling-jsonp":123,"./websocket":125,"./webtransport":126}],123:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.JSONP=void 0;var s=e("./polling");let n=e("querystring"),a=/\\\\n/g,o=/(\\)?\\n/g;class r extends s.Polling{constructor(e){super(e),this.head="___eio["+(e._query.j||"").replace(/[^0-9]/g,"")+"](",this.foot=");"}onData(e){"string"==typeof(e=n.parse(e).d)&&(e=e.replace(o,function(e,t){return t?e:"\n"}),super.onData(e.replace(a,"\\n")))}doWrite(e,t,i){var s=JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029");e=this.head+s+this.foot,super.doWrite(e,t,i)}}i.JSONP=r},{"./polling":124,querystring:void 0}],124:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Polling=void 0;var s=e("../transport"),n=e("zlib");let o=e("accepts"),a=(0,e("debug").default)("engine:polling"),r={gzip:n.createGzip,deflate:n.createDeflate};class c extends s.Transport{constructor(e){super(e),this.closeTimeout=3e4}get name(){return"polling"}onRequest(e){var t=e.res;e.res=null,"GET"===e.method?this.onPollRequest(e,t):"POST"===e.method?this.onDataRequest(e,t):(t.writeHead(500),t.end())}onPollRequest(t,i){if(this.req)a("request overlap"),this.onError("overlap from client"),i.writeHead(400),i.end();else{a("setting request"),this.req=t,this.res=i;let e=()=>{this.onError("poll connection closed prematurely")};t.cleanup=()=>{t.removeListener("close",e),this.req=this.res=null},t.on("close",e),this.writable=!0,this.emit("ready"),this.writable&&this.shouldClose&&(a("triggering empty send to append close packet"),this.send([{type:"noop"}]))}}onDataRequest(e,i){if(this.dataReq)return this.onError("data request overlap from client"),i.writeHead(400),void i.end();let s="application/octet-stream"===e.headers["content-type"];if(s&&4===this.protocol)return this.onError("invalid content");this.dataReq=e,this.dataRes=i;let n=s?Buffer.concat([]):"",a=()=>{e.removeListener("data",o),e.removeListener("end",r),e.removeListener("close",t),this.dataReq=this.dataRes=n=null},t=()=>{a(),this.onError("data request connection closed prematurely")},o=e=>{let t;(t=s?(n=Buffer.concat([n,e])).length:(n+=e,Buffer.byteLength(n)))>this.maxHttpBufferSize&&(i.writeHead(413).end(),a())},r=()=>{this.onData(n);i.writeHead(200,this.headers(e,{"Content-Type":"text/html","Content-Length":"2"})),i.end("ok"),a()};e.on("close",t),s||e.setEncoding("utf8"),e.on("data",o),e.on("end",r)}onData(e){a('received "%s"',e);var t=e=>{if("close"===e.type)return a("got xhr close packet"),this.onClose(),!1;this.onPacket(e)};3===this.protocol?this.parser.decodePayload(e,t):this.parser.decodePayload(e).forEach(t)}onClose(){this.writable&&this.send([{type:"noop"}]),super.onClose()}send(i){this.writable=!1,this.shouldClose&&(a("appending close packet to payload"),i.push({type:"close"}),this.shouldClose(),this.shouldClose=null);var e=e=>{var t=i.some(e=>e.options&&e.options.compress);this.write(e,{compress:t})};3===this.protocol?this.parser.encodePayload(i,this.supportsBinary,e):this.parser.encodePayload(i,e)}write(e,t){a('writing "%s"',e),this.doWrite(e,t,()=>{this.req.cleanup(),this.emit("drain")})}doWrite(e,t,s){var i="string"==typeof e;let n={"Content-Type":i?"text/plain; charset=UTF-8":"application/octet-stream"},a=e=>{n["Content-Length"]="string"==typeof e?Buffer.byteLength(e):e.length,this.res.writeHead(200,this.headers(this.req,n)),this.res.end(e),s()};if(this.httpCompression&&t.compress)if((i?Buffer.byteLength(e):e.length)<this.httpCompression.threshold)a(e);else{let i=o(this.req).encodings(["gzip","deflate"]);i?this.compress(e,i,(e,t)=>{e?(this.res.writeHead(500),this.res.end(),s(e)):(n["Content-Encoding"]=i,a(t))}):a(e)}else a(e)}compress(e,t,i){a("compressing");let s=[],n=0;r[t](this.httpCompression).on("error",i).on("data",function(e){s.push(e),n+=e.length}).on("end",function(){i(null,Buffer.concat(s,n))}).end(e)}doClose(e){a("closing");let t;this.dataReq&&(a("aborting ongoing data request"),this.dataReq.destroy());var i=()=>{clearTimeout(t),e(),this.onClose()};this.writable?(a("transport writable - closing right away"),this.send([{type:"close"}]),i()):this.discarded?(a("transport discarded - closing right away"),i()):(a("transport not writable - buffering orderly close"),this.shouldClose=i,t=setTimeout(i,this.closeTimeout))}headers(e,t={}){var i=e.headers["user-agent"];return i&&(~i.indexOf(";MSIE")||~i.indexOf("Trident/"))&&(t["X-XSS-Protection"]="0"),t["cache-control"]="no-store",this.emit("headers",t,e),t}}i.Polling=c},{"../transport":118,accepts:76,debug:131,zlib:void 0}],125:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.WebSocket=void 0;var s=e("../transport");let n=(0,e("debug").default)("engine:ws");class a extends s.Transport{constructor(e){super(e),this._doSend=e=>{this.socket.send(e,this._onSent)},this._doSendLast=e=>{this.socket.send(e,this._onSentLast)},this._onSent=e=>{e&&this.onError("write error",e.stack)},this._onSentLast=e=>{e?this.onError("write error",e.stack):(this.emit("drain"),this.writable=!0,this.emit("ready"))},this.socket=e.websocket,this.socket.on("message",(e,t)=>{t=t?e:e.toString();n('received "%s"',t),super.onData(t)}),this.socket.once("close",this.onClose.bind(this)),this.socket.on("error",this.onError.bind(this)),this.writable=!0,this.perMessageDeflate=null}get name(){return"websocket"}get handlesUpgrades(){return!0}send(t){this.writable=!1;for(let e=0;e<t.length;e++){var i=t[e],s=e+1===t.length;this._canSendPreEncodedFrame(i)?this.socket._sender.sendFrame(i.options.wsPreEncodedFrame,s?this._onSentLast:this._onSent):this.parser.encodePacket(i,this.supportsBinary,s?this._doSendLast:this._doSend)}}_canSendPreEncodedFrame(e){var t;return!this.perMessageDeflate&&"function"==typeof(null==(t=null==(t=this.socket)?void 0:t._sender)?void 0:t.sendFrame)&&void 0!==(null==(t=e.options)?void 0:t.wsPreEncodedFrame)}doClose(e){n("closing"),this.socket.close(),e&&e()}}i.WebSocket=a},{"../transport":118,debug:131}],126:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.WebTransport=void 0;var s=e("../transport"),n=e("debug");let a=e("engine.io-parser"),o=(0,n.default)("engine:webtransport");class r extends s.Transport{constructor(e,t,i){super({_query:{EIO:"4"}}),this.session=e;var s=(0,a.createPacketEncoderStream)();s.readable.pipeTo(t.writable).catch(()=>{o("the stream was closed")}),this.writer=s.writable.getWriter(),(async()=>{try{for(;;){var{value:e,done:t}=await i.read();if(t){o("session is closed");break}o("received chunk: %o",e),this.onPacket(e)}}catch(e){o("error while reading: %s",e.message)}})(),e.closed.then(()=>this.onClose()),this.writable=!0}get name(){return"webtransport"}async send(t){this.writable=!1;try{for(let e=0;e<t.length;e++){var i=t[e];await this.writer.write(i)}}catch(e){o("error while writing: %s",e.message)}this.emit("drain"),this.writable=!0,this.emit("ready")}doClose(e){o("closing WebTransport session"),this.session.close(),e&&e()}}i.WebTransport=r},{"../transport":118,debug:131,"engine.io-parser":112}],127:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.uServer=void 0;var s=e("debug");let o=e("./server"),n=e("./transports-uws"),r=(0,s.default)("engine:uws");class a extends o.BaseServer{init(){}cleanup(){}prepare(i,e){i.method=i.getMethod().toUpperCase(),i.url=i.getUrl();var t=new URLSearchParams(i.getQuery());i._query=Object.fromEntries(t.entries()),i.headers={},i.forEach((e,t)=>{i.headers[e]=t}),i.connection={remoteAddress:Buffer.from(e.getRemoteAddressAsText()).toString()},e.onAborted(()=>{r("response has been aborted")})}createTransport(e,t){return new n.default[e](t)}attach(e,t={}){var i=this._computePath(t);e.any(i,this.handleRequest.bind(this)).ws(i,{compression:t.compression,idleTimeout:t.idleTimeout,maxBackpressure:t.maxBackpressure,maxPayloadLength:this.opts.maxHttpBufferSize,upgrade:this.handleUpgrade.bind(this),open:e=>{var t=e.getUserData().transport;t.socket=e,t.writable=!0,t.emit("ready")},message:(e,t,i)=>{e.getUserData().transport.onData(i?t:Buffer.from(t).toString())},close:(e,t,i)=>{e.getUserData().transport.onClose(t,i)}})}_applyMiddlewares(t,e,i){if(0===this.middlewares.length)return i();t.res=new c(e),super._applyMiddlewares(t,t.res,e=>{t.res.writeHead(),i(e)})}handleRequest(i,s){r('handling "%s" http request "%s"',s.getMethod(),s.getUrl()),this.prepare(s,i),s.res=i;let t=(e,t)=>{void 0!==e?(this.emit("connection_error",{req:s,code:e,message:o.Server.errorMessages[e],context:t}),this.abortRequest(s.res,e,t)):s._query.sid?(r("setting new request for existing client"),this.clients[s._query.sid].transport.onRequest(s)):this.handshake(s._query.transport,s,(e,t)=>this.abortRequest(i,e,t))};this._applyMiddlewares(s,i,e=>{e?t(o.Server.errors.BAD_REQUEST,{name:"MIDDLEWARE_FAILURE"}):this.verify(s,!1,t)})}handleUpgrade(s,n,a){r("on upgrade"),this.prepare(n,s),n.res=s;let t=async(t,i)=>{if(void 0!==t)this.emit("connection_error",{req:n,code:t,message:o.Server.errorMessages[t],context:i}),this.abortRequest(s,t,i);else{t=n._query.sid;let e;if(t){i=this.clients[t];if(!i)return r("upgrade attempt for closed client"),s.close();if(i.upgrading)return r("transport has already been trying to upgrade"),s.close();if(i.upgraded)return r("transport had already been upgraded"),s.close();r("upgrading existing transport"),e=this.createTransport(n._query.transport,n),i._maybeUpgrade(e)}else if(!(e=await this.handshake(n._query.transport,n,(e,t)=>this.abortRequest(s,e,t))))return;n.res.writeStatus("101 Switching Protocols"),s.upgrade({transport:e},n.getHeader("sec-websocket-key"),n.getHeader("sec-websocket-protocol"),n.getHeader("sec-websocket-extensions"),a)}};this._applyMiddlewares(n,s,e=>{e?t(o.Server.errors.BAD_REQUEST,{name:"MIDDLEWARE_FAILURE"}):this.verify(n,!0,t)})}abortRequest(e,t,i){var s=t===o.Server.errors.FORBIDDEN?"403 Forbidden":"400 Bad Request",i=i&&i.message?i.message:o.Server.errorMessages[t];e.writeStatus(s),e.writeHeader("Content-Type","application/json"),e.end(JSON.stringify({code:t,message:i}))}}i.uServer=a;class c{constructor(e){this.res=e,this.statusWritten=!1,this.headers=[],this.isAborted=!1}set statusCode(e){e&&this.writeStatus(200===e?"200 OK":"204 No Content")}writeHead(e){this.statusCode=e}setHeader(t,e){Array.isArray(e)?e.forEach(e=>{this.writeHeader(t,e)}):this.writeHeader(t,e)}removeHeader(){}getHeader(){}writeStatus(e){if(!this.isAborted)return this.res.writeStatus(e),this.statusWritten=!0,this.writeBufferedHeaders(),this}writeHeader(e,t){this.isAborted||"Content-Length"!==e&&(this.statusWritten?this.res.writeHeader(e,t):this.headers.push([e,t]))}writeBufferedHeaders(){this.headers.forEach(([e,t])=>{this.res.writeHeader(e,t)})}end(e){this.isAborted||this.res.cork(()=>{this.statusWritten||this.writeBufferedHeaders(),this.res.end(e)})}onData(e){this.isAborted||this.res.onData(e)}onAborted(e){this.isAborted||this.res.onAborted(()=>{this.isAborted=!0,e()})}cork(e){this.isAborted||this.res.cork(e)}}},{"./server":116,"./transports-uws":119,debug:131}],128:[function(e,t,i){i.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");var i={},s=e.length;if(!(s<2)){var n=t&&t.decode||m,a=0,o=0,r=0;do{if(-1===(o=e.indexOf("=",a)))break;if(-1===(r=e.indexOf(";",a)))r=s;else if(r<o){a=e.lastIndexOf(";",o-1)+1;continue}var c,l=d(e,a,o),p=h(e,o,l),l=e.slice(l,p);u.call(i,l)||(p=d(e,o+1,r),c=h(e,r,p),34===e.charCodeAt(p)&&34===e.charCodeAt(c-1)&&(p++,c--),p=e.slice(p,c),i[l]=((t,e)=>{try{return e(t)}catch(e){return t}})(p,n)),a=r+1}while(a<s)}return i},i.serialize=function(e,t,i){var s=i&&i.encode||encodeURIComponent;if("function"!=typeof s)throw new TypeError("option encode is invalid");if(!o.test(e))throw new TypeError("argument name is invalid");s=s(t);if(!r.test(s))throw new TypeError("argument val is invalid");var n=e+"="+s;if(i){if(null!=i.maxAge){t=Math.floor(i.maxAge);if(!isFinite(t))throw new TypeError("option maxAge is invalid");n+="; Max-Age="+t}if(i.domain){if(!c.test(i.domain))throw new TypeError("option domain is invalid");n+="; Domain="+i.domain}if(i.path){if(!l.test(i.path))throw new TypeError("option path is invalid");n+="; Path="+i.path}if(i.expires){e=i.expires;if(!(e=>"[object Date]"===a.call(e))(e)||isNaN(e.valueOf()))throw new TypeError("option expires is invalid");n+="; Expires="+e.toUTCString()}if(i.httpOnly&&(n+="; HttpOnly"),i.secure&&(n+="; Secure"),i.partitioned&&(n+="; Partitioned"),i.priority)switch("string"==typeof i.priority?i.priority.toLowerCase():i.priority){case"low":n+="; Priority=Low";break;case"medium":n+="; Priority=Medium";break;case"high":n+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(i.sameSite)switch("string"==typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"strict":n+="; SameSite=Strict";break;case"none":n+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return n};var a=Object.prototype.toString,u=Object.prototype.hasOwnProperty,o=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,r=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,c=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,l=/^[\u0020-\u003A\u003D-\u007E]*$/;function d(e,t,i){do{var s=e.charCodeAt(t);if(32!==s&&9!==s)return t}while(++t<i);return i}function h(e,t,i){for(;i<t;){var s=e.charCodeAt(--t);if(32!==s&&9!==s)return t+1}return i}function m(e){return-1!==e.indexOf("%")?decodeURIComponent(e):e}},{}],129:[function(e,t,i){arguments[4][105][0].apply(i,arguments)},{"./common":130,dup:105}],130:[function(e,t,i){arguments[4][106][0].apply(i,arguments)},{dup:106,ms:202}],131:[function(e,t,i){arguments[4][107][0].apply(i,arguments)},{"./browser.js":129,"./node.js":132,dup:107}],132:[function(e,t,i){arguments[4][108][0].apply(i,arguments)},{"./common":130,dup:108,"supports-color":297,tty:void 0,util:void 0}],133:[function(e,t,i){t.exports=e("./is-implemented")()?Array.from:e("./shim")},{"./is-implemented":134,"./shim":135}],134:[function(e,t,i){t.exports=function(){var e,t=Array.from;return"function"==typeof t&&(e=t(t=["raz","dwa"]),Boolean(e&&e!==t&&"dwa"===e[1]))}},{}],135:[function(e,t,i){var h=e("es6-symbol").iterator,m=e("../../function/is-arguments"),f=e("../../function/is-function"),v=e("../../number/to-pos-integer"),y=e("../../object/valid-callable"),g=e("../../object/valid-value"),b=e("../../object/is-value"),x=e("../../string/is-string"),w=Array.isArray,E=Function.prototype.call,_={configurable:!0,enumerable:!0,writable:!0,value:null},k=Object.defineProperty;t.exports=function(e){var t,i,s,n,a,o,r,c,l,p,u=arguments[1],d=arguments[2];if(e=Object(g(e)),b(u)&&y(u),this&&this!==Array&&f(this))t=this;else{if(!u){if(m(e))return 1!==(a=e.length)?Array.apply(null,e):((n=new Array(1))[0]=e[0],n);if(w(e)){for(n=new Array(a=e.length),i=0;i<a;++i)n[i]=e[i];return n}}n=[]}if(!w(e))if(void 0!==(l=e[h])){for(r=y(l).call(e),t&&(n=new t),c=r.next(),i=0;!c.done;)p=u?E.call(u,d,c.value,i):c.value,t?(_.value=p,k(n,i,_)):n[i]=p,c=r.next(),++i;a=i}else if(x(e)){for(a=e.length,t&&(n=new t),s=i=0;i<a;++i)p=e[i],i+1<a&&55296<=(o=p.charCodeAt(0))&&o<=56319&&(p+=e[++i]),p=u?E.call(u,d,p,s):p,t?(_.value=p,k(n,s,_)):n[s]=p,++s;a=s}if(void 0===a)for(a=v(e.length),t&&(n=new t(a)),i=0;i<a;++i)p=u?E.call(u,d,e[i],i):e[i],t?(_.value=p,k(n,i,_)):n[i]=p;return t&&(_.value=null,n.length=a),n}},{"../../function/is-arguments":137,"../../function/is-function":138,"../../number/to-pos-integer":144,"../../object/is-value":152,"../../object/valid-callable":162,"../../object/valid-value":163,"../../string/is-string":167,"es6-symbol":168}],136:[function(e,t,i){t.exports=function(e){return e}},{}],137:[function(e,t,i){var s=Object.prototype.toString,n=s.call(function(){return arguments}());t.exports=function(e){return s.call(e)===n}},{}],138:[function(e,t,i){var s=Object.prototype.toString,n=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);t.exports=function(e){return"function"==typeof e&&n(s.call(e))}},{}],139:[function(e,t,i){t.exports=function(){}},{}],140:[function(e,t,i){t.exports=e("./is-implemented")()?Math.sign:e("./shim")},{"./is-implemented":141,"./shim":142}],141:[function(e,t,i){t.exports=function(){var e=Math.sign;return"function"==typeof e&&1===e(10)&&-1===e(-20)}},{}],142:[function(e,t,i){t.exports=function(e){return e=Number(e),isNaN(e)||0===e?e:0<e?1:-1}},{}],143:[function(e,t,i){var s=e("../math/sign"),n=Math.abs,a=Math.floor;t.exports=function(e){return isNaN(e)?0:0!==(e=Number(e))&&isFinite(e)?s(e)*a(n(e)):e}},{"../math/sign":140}],144:[function(e,t,i){var s=e("./to-integer"),n=Math.max;t.exports=function(e){return n(0,s(e))}},{"./to-integer":143}],145:[function(e,t,i){var r=e("./valid-callable"),c=e("./valid-value"),l=Function.prototype.bind,p=Function.prototype.call,u=Object.keys,d=Object.prototype.propertyIsEnumerable;t.exports=function(a,o){return function(i,s){var e,n=arguments[2],t=arguments[3];return i=Object(c(i)),r(s),e=u(i),t&&e.sort("function"==typeof t?l.call(t,i):void 0),"function"!=typeof a&&(a=e[a]),p.call(a,e,function(e,t){return d.call(i,e)?p.call(s,n,i[e],e,i,t):o})}}},{"./valid-callable":162,"./valid-value":163}],146:[function(e,t,i){t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":147,"./shim":148}],147:[function(e,t,i){t.exports=function(){var e=Object.assign;return"function"==typeof e&&(e(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},{}],148:[function(e,t,i){var o=e("../keys"),r=e("../valid-value"),c=Math.max;t.exports=function(t,i){var s,e,n,a=c(arguments.length,2);for(t=Object(r(t)),n=function(e){try{t[e]=i[e]}catch(e){s=s||e}},e=1;e<a;++e)o(i=arguments[e]).forEach(n);if(void 0!==s)throw s;return t}},{"../keys":153,"../valid-value":163}],149:[function(e,t,i){var s,n,a,o,r=Object.create;e("./set-prototype-of/is-implemented")()||(s=e("./set-prototype-of/shim")),t.exports=!s||1!==s.level?r:(o={configurable:!(a={}),enumerable:!(n={}),writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){a[e]="__proto__"===e?{configurable:!0,enumerable:!1,writable:!0,value:void 0}:o}),Object.defineProperties(n,a),Object.defineProperty(s,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:n}),function(e,t){return r(null===e?n:e,t)})},{"./set-prototype-of/is-implemented":159,"./set-prototype-of/shim":160}],150:[function(e,t,i){t.exports=e("./_iterate")("forEach")},{"./_iterate":145}],151:[function(e,t,i){var s=e("./is-value"),n={function:!0,object:!0};t.exports=function(e){return s(e)&&n[typeof e]||!1}},{"./is-value":152}],152:[function(e,t,i){var s=e("../function/noop")();t.exports=function(e){return e!==s&&null!==e}},{"../function/noop":139}],153:[function(e,t,i){t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":154,"./shim":155}],154:[function(e,t,i){t.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],155:[function(e,t,i){var s=e("../is-value"),n=Object.keys;t.exports=function(e){return n(s(e)?Object(e):e)}},{"../is-value":152}],156:[function(e,t,i){var s=e("./valid-callable"),r=e("./for-each"),c=Function.prototype.call;t.exports=function(e,n){var a={},o=arguments[2];return s(n),r(e,function(e,t,i,s){a[t]=c.call(n,o,e,t,i,s)}),a}},{"./for-each":150,"./valid-callable":162}],157:[function(e,t,i){var a=e("./is-value"),s=Array.prototype.forEach,o=Object.create;t.exports=function(e){var n=o(null);return s.call(arguments,function(e){if(a(e)){var t,i=Object(e),s=n;for(t in i)s[t]=i[t]}}),n}},{"./is-value":152}],158:[function(e,t,i){t.exports=e("./is-implemented")()?Object.setPrototypeOf:e("./shim")},{"./is-implemented":159,"./shim":160}],159:[function(e,t,i){var s=Object.create,n=Object.getPrototypeOf,a={};t.exports=function(){var e=Object.setPrototypeOf;return"function"==typeof e&&n(e((arguments[0]||s)(null),a))===a}},{}],160:[function(e,t,i){var s,n,a=e("../is-object"),o=e("../valid-value"),r=Object.prototype.isPrototypeOf,c=Object.defineProperty,l={configurable:!0,enumerable:!1,writable:!0,value:void 0},p=function(e,t){if(o(e),null===t||a(t))return e;throw new TypeError("Prototype must be null or an object")};t.exports=(t=(()=>{var e,t=Object.create(null),i={},s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(s){try{(e=s.set).call(t,i)}catch(e){}if(Object.getPrototypeOf(t)===i)return{set:e,level:2}}return t.__proto__=i,Object.getPrototypeOf(t)===i?{level:2}:((t={}).__proto__=i,Object.getPrototypeOf(t)===i&&{level:1})})())?(s=2===t.level?t.set?(n=t.set,function(e,t){return n.call(p(e,t),t),e}):function(e,t){return p(e,t).__proto__=t,e}:function e(t,i){var s;return p(t,i),(s=r.call(e.nullPolyfill,t))&&delete e.nullPolyfill.__proto__,t.__proto__=i=null===i?e.nullPolyfill:i,s&&c(e.nullPolyfill,"__proto__",l),t},Object.defineProperty(s,"level",{configurable:!1,enumerable:!1,writable:!1,value:t.level})):null,e("../create")},{"../create":149,"../is-object":151,"../valid-value":163}],161:[function(e,t,i){function s(e,t){return[t,e]}var r=e("./valid-callable"),c=e("./is-value"),l=e("./for-each"),p=Function.prototype.call;t.exports=function(e){var n=[],a=arguments[1],o=arguments[2],a=c(a)?r(a):s;return l(e,function(e,t,i,s){n.push(p.call(a,o,e,t,this,s))},e,arguments[3]),n}},{"./for-each":150,"./is-value":152,"./valid-callable":162}],162:[function(e,t,i){t.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},{}],163:[function(e,t,i){var s=e("./is-value");t.exports=function(e){if(s(e))return e;throw new TypeError("Cannot use null or undefined")}},{"./is-value":152}],164:[function(e,t,i){t.exports=e("./is-implemented")()?String.prototype.contains:e("./shim")},{"./is-implemented":165,"./shim":166}],165:[function(e,t,i){var s="razdwatrzy";t.exports=function(){return"function"==typeof s.contains&&!0===s.contains("dwa")&&!1===s.contains("foo")}},{}],166:[function(e,t,i){var s=String.prototype.indexOf;t.exports=function(e){return-1<s.call(this,e,arguments[1])}},{}],167:[function(e,t,i){var s=Object.prototype.toString,n=s.call("");t.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||s.call(e)===n)||!1}},{}],168:[function(e,t,i){t.exports=e("./is-implemented")()?e("ext/global-this").Symbol:e("./polyfill")},{"./is-implemented":169,"./polyfill":174,"ext/global-this":179}],169:[function(e,t,i){var s=e("ext/global-this"),n={object:!0,symbol:!0};t.exports=function(){var e,t=s.Symbol;if("function"!=typeof t)return!1;e=t("test symbol");try{String(e)}catch(e){return!1}return!!n[typeof t.iterator]&&!!n[typeof t.toPrimitive]&&!!n[typeof t.toStringTag]}},{"ext/global-this":179}],170:[function(e,t,i){t.exports=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&"Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag])}},{}],171:[function(e,t,i){var n=e("d"),e=Object.create,a=Object.defineProperty,o=Object.prototype,r=e(null);t.exports=function(e){for(var t,i,s=0;r[e+(s||"")];)++s;return r[e+=s||""]=!0,a(o,t="@@"+e,n.gs(null,function(e){i||(i=!0,a(this,t,n(e)),i=!1)})),t}},{d:86}],172:[function(e,t,i){var s=e("d"),n=e("ext/global-this").Symbol;t.exports=function(e){return Object.defineProperties(e,{hasInstance:s("",n&&n.hasInstance||e("hasInstance")),isConcatSpreadable:s("",n&&n.isConcatSpreadable||e("isConcatSpreadable")),iterator:s("",n&&n.iterator||e("iterator")),match:s("",n&&n.match||e("match")),replace:s("",n&&n.replace||e("replace")),search:s("",n&&n.search||e("search")),species:s("",n&&n.species||e("species")),split:s("",n&&n.split||e("split")),toPrimitive:s("",n&&n.toPrimitive||e("toPrimitive")),toStringTag:s("",n&&n.toStringTag||e("toStringTag")),unscopables:s("",n&&n.unscopables||e("unscopables"))})}},{d:86,"ext/global-this":179}],173:[function(e,t,i){var s=e("d"),n=e("../../../validate-symbol"),a=Object.create(null);t.exports=function(t){return Object.defineProperties(t,{for:s(function(e){return a[e]||(a[e]=t(String(e)))}),keyFor:s(function(e){for(var t in n(e),a)if(a[t]===e)return t})})}},{"../../../validate-symbol":175,d:86}],174:[function(e,t,i){var s,n,a,o=e("d"),r=e("./validate-symbol"),c=e("ext/global-this").Symbol,l=e("./lib/private/generate-name"),p=e("./lib/private/setup/standard-symbols"),e=e("./lib/private/setup/symbol-registry"),u=Object.create,d=Object.defineProperties,h=Object.defineProperty;if("function"==typeof c)try{String(c()),a=!0}catch(e){}else c=null;n=function(e){if(this instanceof n)throw new TypeError("Symbol is not a constructor");return s(e)},t.exports=s=function e(t){var i;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return a?c(t):(i=u(n.prototype),t=void 0===t?"":String(t),d(i,{__description__:o("",t),__name__:o("",l(t))}))},p(s),e(s),d(n.prototype,{constructor:o(s),toString:o("",function(){return this.__name__})}),d(s.prototype,{toString:o(function(){return"Symbol ("+r(this).__description__+")"}),valueOf:o(function(){return r(this)})}),h(s.prototype,s.toPrimitive,o("",function(){var e=r(this);return"symbol"==typeof e?e:e.toString()})),h(s.prototype,s.toStringTag,o("c","Symbol")),h(n.prototype,s.toStringTag,o("c",s.prototype[s.toStringTag])),h(n.prototype,s.toPrimitive,o("c",s.prototype[s.toPrimitive]))},{"./lib/private/generate-name":171,"./lib/private/setup/standard-symbols":172,"./lib/private/setup/symbol-registry":173,"./validate-symbol":175,d:86,"ext/global-this":179}],175:[function(e,t,i){var s=e("./is-symbol");t.exports=function(e){if(s(e))return e;throw new TypeError(e+" is not a symbol")}},{"./is-symbol":170}],176:[function(e,t,i){var o=/["'&<>]/;t.exports=function(e){var t,i=""+e,e=o.exec(i);if(!e)return i;var s="",n=0,a=0;for(n=e.index;n<i.length;n++){switch(i.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}a!==n&&(s+=i.substring(a,n)),a=n+1,s+=t}return a!==n?s+i.substring(a,n):s}},{}],177:[function(e,t,i){var s=e("d"),o=e("es5-ext/object/valid-callable"),r=Function.prototype.apply,c=Function.prototype.call,n=Object.create,a=Object.defineProperty,l=Object.defineProperties,p=Object.prototype.hasOwnProperty,u={configurable:!0,enumerable:!1,writable:!0},d=function(e,t){var i;return o(t),p.call(this,"__ee__")?i=this.__ee__:(i=u.value=n(null),a(this,"__ee__",u),u.value=null),i[e]?"object"==typeof i[e]?i[e].push(t):i[e]=[i[e],t]:i[e]=t,this},e=function(e,t){var i,s;return o(t),s=this,d.call(this,e,i=function(){h.call(s,e,i),r.call(t,this,arguments)}),i.__eeOnceListener__=t,this},h=function(e,t){var i,s,n,a;if(o(t),p.call(this,"__ee__")&&(i=this.__ee__)[e])if("object"==typeof(s=i[e]))for(a=0;n=s[a];++a)n!==t&&n.__eeOnceListener__!==t||(2===s.length?i[e]=s[a?0:1]:s.splice(a,1));else s!==t&&s.__eeOnceListener__!==t||delete i[e];return this},m=function(e){var t,i,s,n,a;if(p.call(this,"__ee__")&&(n=this.__ee__[e]))if("object"==typeof n){for(i=arguments.length,a=new Array(i-1),t=1;t<i;++t)a[t-1]=arguments[t];for(n=n.slice(),t=0;s=n[t];++t)r.call(s,this,a)}else switch(arguments.length){case 1:c.call(n,this);break;case 2:c.call(n,this,arguments[1]);break;case 3:c.call(n,this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),t=1;t<i;++t)a[t-1]=arguments[t];r.call(n,this,a)}},f={on:d,once:e,off:h,emit:m},v={on:s(d),once:s(e),off:s(h),emit:s(m)},y=l({},v);t.exports=i=function(e){return null==e?n(y):l(Object(e),v)},i.methods=f},{d:86,"es5-ext/object/valid-callable":162}],178:[function(e,t,i){function s(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")}t.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return s()}try{return __global__?__global__:s()}finally{delete Object.prototype.__global__}}()},{}],179:[function(e,t,i){t.exports=e("./is-implemented")()?globalThis:e("./implementation")},{"./implementation":178,"./is-implemented":180}],180:[function(e,t,i){t.exports=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}},{}],181:[function(e,t,i){var m=e("debug")("finalhandler"),f=e("encodeurl"),v=e("escape-html"),y=e("on-finished"),g=e("parseurl"),b=e("statuses"),x=e("unpipe"),w=/\x20{2}/g,E=/\n/g,_="function"==typeof setImmediate?setImmediate:function(e){process.nextTick(e.bind.apply(e,arguments))},k=y.isFinished;function T(e){return"boolean"!=typeof e.headersSent?Boolean(e._header):e.headersSent}t.exports=function(a,u,e){var e=e||{},d=e.env||process.env.NODE_ENV||"development",h=e.onerror;return function(e){var t,i,o,r,c,l,p,s;function n(){var e='<!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="utf-8">\n<title>Error</title>\n</head>\n<body>\n<pre>'+v(p).replace(E,"<br>").replace(w," &nbsp;")+"</pre>\n</body>\n</html>\n",t=(r.statusCode=c,r.statusMessage=b[c],r),i=l;if(i)for(var s=Object.keys(i),n=0;n<s.length;n++){var a=s[n];t.setHeader(a,i[a])}r.setHeader("Content-Security-Policy","default-src 'none'"),r.setHeader("X-Content-Type-Options","nosniff"),r.setHeader("Content-Type","text/html; charset=utf-8"),r.setHeader("Content-Length",Buffer.byteLength(e,"utf8")),"HEAD"===o.method?r.end():r.end(e,"utf8")}!e&&T(u)?m("cannot 404 after headers sent"):(s=e?(void 0===(i=(e=>"number"==typeof e.status&&400<=e.status&&e.status<600?e.status:"number"==typeof e.statusCode&&400<=e.statusCode&&e.statusCode<600?e.statusCode:void 0)(e))?i=(e=>e="number"!=typeof(e=e.statusCode)||e<400||599<e?500:e)(u):t=(e=>{if(e.headers&&"object"==typeof e.headers){for(var t=Object.create(null),i=Object.keys(e.headers),s=0;s<i.length;s++){var n=i[s];t[n]=e.headers[n]}return t}})(e),((e,t,i)=>{var s;return(s="production"===i||(s=e.stack)||"function"!=typeof e.toString?s:e.toString())||b[t]})(e,i,d)):(i=404,"Cannot "+a.method+" "+f((e=>{try{return g.original(e).pathname}catch(e){return"resource"}})(a))),m("default %s",i),e&&h&&_(h,e,a,u),T(u)?(m("cannot %d after headers sent",i),a.socket.destroy()):(r=u,c=i,l=t,p=s,k(o=a)?n():(x(o),y(o,n),o.resume())))}}},{debug:184,encodeurl:186,"escape-html":176,"on-finished":188,parseurl:209,statuses:190,unpipe:314}],182:[function(e,t,i){arguments[4][80][0].apply(i,arguments)},{"./debug":183,dup:80}],183:[function(e,t,i){arguments[4][81][0].apply(i,arguments)},{dup:81,ms:187}],184:[function(e,t,i){arguments[4][82][0].apply(i,arguments)},{"./browser.js":182,"./node.js":185,dup:82}],185:[function(e,t,i){arguments[4][83][0].apply(i,arguments)},{"./debug":183,dup:83,fs:void 0,net:void 0,tty:void 0,util:void 0}],186:[function(e,t,i){t.exports=function(e){return String(e).replace(n,a).replace(s,encodeURI)};var s=/(?:[^\x21\x25\x26-\x3B\x3D\x3F-\x5B\x5D\x5F\x61-\x7A\x7E]|%(?:[^0-9A-Fa-f]|[0-9A-Fa-f][^0-9A-Fa-f]|$))+/g,n=/(^|[^\uD800-\uDBFF])[\uDC00-\uDFFF]|[\uD800-\uDBFF]([^\uDC00-\uDFFF]|$)/g,a="$1$2"},{}],187:[function(e,t,i){arguments[4][84][0].apply(i,arguments)},{dup:84}],188:[function(e,t,i){t.exports=function(e,t){{function i(e){c.cancel(),l.cancel(),d=!0,r(e)}function s(e){o.removeListener("socket",s),d||c===l&&(l=h([[e,"error","close"]],i))}var n,a,o,r,c,l,p,u,d;!1!==f(e)?m(t,null,e):(t=t,(a=(n=e).__onFinished)&&a.queue||(a=n.__onFinished=(s=>{function n(e){if(s.__onFinished===n&&(s.__onFinished=null),n.queue){var t=n.queue;n.queue=null;for(var i=0;i<t.length;i++)t[i](e,s)}}return n.queue=[],n})(n),r=a,d=!1,c=l=h([[o=n,"end","finish"]],i),o.socket?s(o.socket):(o.on("socket",s),void 0===o.socket&&(p=s,"function"==typeof(u=(n=o).assignSocket))&&(n.assignSocket=function(e){u.call(this,e),p(e)}))),a.queue.push(t))}return e},t.exports.isFinished=f;var h=e("ee-first"),m="function"==typeof setImmediate?setImmediate:function(e){process.nextTick(e.bind.apply(e,arguments))};function f(e){var t=e.socket;return"boolean"==typeof e.finished?Boolean(e.finished||t&&!t.writable):"boolean"==typeof e.complete?Boolean(e.upgrade||!t||!t.readable||e.complete&&!e.readable):void 0}},{"ee-first":88}],189:[function(e,t,i){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],190:[function(e,t,i){var s,n,a,e=e("./codes.json");function o(e){if("number"==typeof e){if(o[e])return e;throw new Error("invalid status code: "+e)}if("string"!=typeof e)throw new TypeError("code must be a number or string");var t=parseInt(e,10);if(!isNaN(t)){if(o[t])return t;throw new Error("invalid status code: "+t)}if(t=o[e.toLowerCase()])return t;throw new Error('invalid status message: "'+e+'"')}(t.exports=o).STATUS_CODES=e,o.codes=(s=o,n=e,a=[],Object.keys(n).forEach(function(e){var t=n[e],e=Number(e);s[e]=t,s[t]=e,s[t.toLowerCase()]=e,a.push(e)}),a),o.redirect={300:!0,301:!0,302:!0,303:!0,305:!0,307:!0,308:!0},o.empty={204:!0,205:!0,304:!0},o.retry={502:!0,503:!0,504:!0}},{"./codes.json":189}],191:[function(e,t,i){t.exports=(e,t=process.argv)=>{var i=e.startsWith("-")?"":1===e.length?"-":"--",i=t.indexOf(i+e),e=t.indexOf("--");return-1!==i&&(-1===e||i<e)}},{}],192:[function(e,t,i){e=e("./lib/private/logger-prototype");t.exports=e._createLevel("info")},{"./lib/private/logger-prototype":197}],193:[function(e,t,i){t.exports=["error","warning","notice","info","debug"]},{}],194:[function(e,t,i){var s=e("uni-global")("medikoo/log/202110");s.emitter?t.exports=s.emitter:(e=e("event-emitter"),t.exports=s.emitter=e())},{"event-emitter":177,"uni-global":311}],195:[function(e,t,i){t.exports=RegExp.prototype.test.bind(/^[a-z0-9-]+$/)},{}],196:[function(e,t,i){var s=e("es5-ext/function/noop"),n=e("es5-ext/object/for-each"),e=e("d");t.exports={isEnabled:e("ew",!0),enable:e(function(){return this._setEnabledState(!0)}),disable:e(function(){return this._setEnabledState(!1)}),_setEnabledState:e(function(t){var e=[],i=(this._setEnabledStateRecursively(t,e),{restore:function(){e.forEach(function(e){e.hasDirectSetting?e.logger.isEnabled=!t:delete e.logger.isEnabled}),i.restore=s}});return i}),_setEnabledStateRecursively:e(function(t,i){this.isEnabled!==t&&(i.push({logger:this,hasDirectSetting:hasOwnProperty.call(this,"isEnabled")}),this.isEnabled=t),n(this._childNamespaceLoggers,function(e){e._setEnabledStateRecursively(t,i)})})}},{d:86,"es5-ext/function/noop":139,"es5-ext/object/for-each":150}],197:[function(e,t,i){var s=e("type/string/ensure"),n=e("es5-ext/array/from"),a=e("es5-ext/object/assign"),o=e("es5-ext/object/set-prototype-of"),r=e("d"),c=e("d/lazy"),l=e("../../../levels"),p=e("../../emitter"),u=e("./enable-disable-props"),e=e("./namespace-props"),d=Object.create(null),h=Object.create(Function.prototype,a({isLevelInitialized:r("e",function(e){return e=s(e),this.level===e||!!(e=d[e])&&(!this.namespace||e.isNamespaceInitialized(this.namespace))}),getAllInitializedLevels:r("e",function(){return Object.keys(d).filter(function(e){return this.isLevelInitialized(e)},this).map(function(e){return this._getLevelLogger(e)},this)}),_createLogger:r(function(){return o(function e(t){p.emit("log",{logger:e,messageTokens:n(arguments)})},this)}),_createLevel:r(function(e){var t;return d[e]||(t=h._createLogger(),Object.defineProperties(t,{level:r("e",e),levelIndex:r("e",l.indexOf(e)),levelRoot:r("e",t)}),d[e]=t,p.emit("init",{logger:t}),t)}),_getLevelLogger:r(function(e){return this.level===e?this:(e=this._createLevel(e),this.namespaceTokens.reduce(function(e,t){return e._createNamespace(t)},e))})},c(a(l.reduce(function(e,t){return e[t]=r("e",function(){return this._getLevelLogger(t)},{cacheName:"_"+t}),e},{}),{warn:r(function(){return this._getLevelLogger("warning")},{cacheName:"_warning"})})),e,u));t.exports=h},{"../../../levels":193,"../../emitter":194,"./enable-disable-props":196,"./namespace-props":198,d:86,"d/lazy":87,"es5-ext/array/from":133,"es5-ext/object/assign":146,"es5-ext/object/set-prototype-of":158,"type/string/ensure":307}],198:[function(e,t,i){var s=e("type/string/ensure"),n=e("type/lib/to-short-string"),a=e("es5-ext/function/identity"),o=e("es5-ext/object/assign"),r=e("es5-ext/object/to-array"),c=e("d"),l=e("d/lazy"),p=e("../../emitter"),u=e("../is-namespace-token");t.exports=o({get:c(function(t){var e=(t=s(t)).split(":");return e.forEach(function(e){if(!u(e))throw new TypeError(n(t)+" is not a valid namespace string (only 'a-z0-9-' chars are allowed and ':' as delimiter)")}),e.reduce(function(e,t){return e._createNamespace(t)},this)}),isNamespaceInitialized:c("e",function(e){var e=s(e).split(":"),t=this;return e.every(function(e){return t=t._childNamespaceLoggers[e]})}),getAllInitializedNamespaces:c("e",function(){return r(this._childNamespaceLoggers,a)}),_createNamespace:c(function(e){var t;return this._childNamespaceLoggers[e]||(t=Object.defineProperties(this._createLogger(),{_namespaceToken:c("",e)}),this._childNamespaceLoggers[e]=t,p.emit("init",{logger:t}),t)}),_namespaceToken:c("",null)},l({namespace:c("e",function(){return this.namespaceTokens.join(":")||null},{cacheName:"_namespace"}),namespaceTokens:c("e",function(){return this._namespaceToken?Object.getPrototypeOf(this).namespaceTokens.concat(this._namespaceToken):[]},{cacheName:"_namespaceTokens"}),_childNamespaceLoggers:c("",function(){return Object.create(null)},{cacheName:"__childNamespaceLoggers"})}))},{"../../emitter":194,"../is-namespace-token":195,d:86,"d/lazy":87,"es5-ext/function/identity":136,"es5-ext/object/assign":146,"es5-ext/object/to-array":161,"type/lib/to-short-string":302,"type/string/ensure":307}],199:[function(e,t,i){t.exports={"application/1d-interleaved-parityfec":{source:"iana"},"application/3gpdash-qoe-report+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/3gpp-ims+xml":{source:"iana",compressible:!0},"application/3gpphal+json":{source:"iana",compressible:!0},"application/3gpphalforms+json":{source:"iana",compressible:!0},"application/a2l":{source:"iana"},"application/ace+cbor":{source:"iana"},"application/activemessage":{source:"iana"},"application/activity+json":{source:"iana",compressible:!0},"application/alto-costmap+json":{source:"iana",compressible:!0},"application/alto-costmapfilter+json":{source:"iana",compressible:!0},"application/alto-directory+json":{source:"iana",compressible:!0},"application/alto-endpointcost+json":{source:"iana",compressible:!0},"application/alto-endpointcostparams+json":{source:"iana",compressible:!0},"application/alto-endpointprop+json":{source:"iana",compressible:!0},"application/alto-endpointpropparams+json":{source:"iana",compressible:!0},"application/alto-error+json":{source:"iana",compressible:!0},"application/alto-networkmap+json":{source:"iana",compressible:!0},"application/alto-networkmapfilter+json":{source:"iana",compressible:!0},"application/alto-updatestreamcontrol+json":{source:"iana",compressible:!0},"application/alto-updatestreamparams+json":{source:"iana",compressible:!0},"application/aml":{source:"iana"},"application/andrew-inset":{source:"iana",extensions:["ez"]},"application/applefile":{source:"iana"},"application/applixware":{source:"apache",extensions:["aw"]},"application/at+jwt":{source:"iana"},"application/atf":{source:"iana"},"application/atfx":{source:"iana"},"application/atom+xml":{source:"iana",compressible:!0,extensions:["atom"]},"application/atomcat+xml":{source:"iana",compressible:!0,extensions:["atomcat"]},"application/atomdeleted+xml":{source:"iana",compressible:!0,extensions:["atomdeleted"]},"application/atomicmail":{source:"iana"},"application/atomsvc+xml":{source:"iana",compressible:!0,extensions:["atomsvc"]},"application/atsc-dwd+xml":{source:"iana",compressible:!0,extensions:["dwd"]},"application/atsc-dynamic-event-message":{source:"iana"},"application/atsc-held+xml":{source:"iana",compressible:!0,extensions:["held"]},"application/atsc-rdt+json":{source:"iana",compressible:!0},"application/atsc-rsat+xml":{source:"iana",compressible:!0,extensions:["rsat"]},"application/atxml":{source:"iana"},"application/auth-policy+xml":{source:"iana",compressible:!0},"application/bacnet-xdd+zip":{source:"iana",compressible:!1},"application/batch-smtp":{source:"iana"},"application/bdoc":{compressible:!1,extensions:["bdoc"]},"application/beep+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/calendar+json":{source:"iana",compressible:!0},"application/calendar+xml":{source:"iana",compressible:!0,extensions:["xcs"]},"application/call-completion":{source:"iana"},"application/cals-1840":{source:"iana"},"application/captive+json":{source:"iana",compressible:!0},"application/cbor":{source:"iana"},"application/cbor-seq":{source:"iana"},"application/cccex":{source:"iana"},"application/ccmp+xml":{source:"iana",compressible:!0},"application/ccxml+xml":{source:"iana",compressible:!0,extensions:["ccxml"]},"application/cdfx+xml":{source:"iana",compressible:!0,extensions:["cdfx"]},"application/cdmi-capability":{source:"iana",extensions:["cdmia"]},"application/cdmi-container":{source:"iana",extensions:["cdmic"]},"application/cdmi-domain":{source:"iana",extensions:["cdmid"]},"application/cdmi-object":{source:"iana",extensions:["cdmio"]},"application/cdmi-queue":{source:"iana",extensions:["cdmiq"]},"application/cdni":{source:"iana"},"application/cea":{source:"iana"},"application/cea-2018+xml":{source:"iana",compressible:!0},"application/cellml+xml":{source:"iana",compressible:!0},"application/cfw":{source:"iana"},"application/city+json":{source:"iana",compressible:!0},"application/clr":{source:"iana"},"application/clue+xml":{source:"iana",compressible:!0},"application/clue_info+xml":{source:"iana",compressible:!0},"application/cms":{source:"iana"},"application/cnrp+xml":{source:"iana",compressible:!0},"application/coap-group+json":{source:"iana",compressible:!0},"application/coap-payload":{source:"iana"},"application/commonground":{source:"iana"},"application/conference-info+xml":{source:"iana",compressible:!0},"application/cose":{source:"iana"},"application/cose-key":{source:"iana"},"application/cose-key-set":{source:"iana"},"application/cpl+xml":{source:"iana",compressible:!0,extensions:["cpl"]},"application/csrattrs":{source:"iana"},"application/csta+xml":{source:"iana",compressible:!0},"application/cstadata+xml":{source:"iana",compressible:!0},"application/csvm+json":{source:"iana",compressible:!0},"application/cu-seeme":{source:"apache",extensions:["cu"]},"application/cwt":{source:"iana"},"application/cybercash":{source:"iana"},"application/dart":{compressible:!0},"application/dash+xml":{source:"iana",compressible:!0,extensions:["mpd"]},"application/dash-patch+xml":{source:"iana",compressible:!0,extensions:["mpp"]},"application/dashdelta":{source:"iana"},"application/davmount+xml":{source:"iana",compressible:!0,extensions:["davmount"]},"application/dca-rft":{source:"iana"},"application/dcd":{source:"iana"},"application/dec-dx":{source:"iana"},"application/dialog-info+xml":{source:"iana",compressible:!0},"application/dicom":{source:"iana"},"application/dicom+json":{source:"iana",compressible:!0},"application/dicom+xml":{source:"iana",compressible:!0},"application/dii":{source:"iana"},"application/dit":{source:"iana"},"application/dns":{source:"iana"},"application/dns+json":{source:"iana",compressible:!0},"application/dns-message":{source:"iana"},"application/docbook+xml":{source:"apache",compressible:!0,extensions:["dbk"]},"application/dots+cbor":{source:"iana"},"application/dskpp+xml":{source:"iana",compressible:!0},"application/dssc+der":{source:"iana",extensions:["dssc"]},"application/dssc+xml":{source:"iana",compressible:!0,extensions:["xdssc"]},"application/dvcs":{source:"iana"},"application/ecmascript":{source:"iana",compressible:!0,extensions:["es","ecma"]},"application/edi-consent":{source:"iana"},"application/edi-x12":{source:"iana",compressible:!1},"application/edifact":{source:"iana",compressible:!1},"application/efi":{source:"iana"},"application/elm+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/elm+xml":{source:"iana",compressible:!0},"application/emergencycalldata.cap+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/emergencycalldata.comment+xml":{source:"iana",compressible:!0},"application/emergencycalldata.control+xml":{source:"iana",compressible:!0},"application/emergencycalldata.deviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.ecall.msd":{source:"iana"},"application/emergencycalldata.providerinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.serviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.subscriberinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.veds+xml":{source:"iana",compressible:!0},"application/emma+xml":{source:"iana",compressible:!0,extensions:["emma"]},"application/emotionml+xml":{source:"iana",compressible:!0,extensions:["emotionml"]},"application/encaprtp":{source:"iana"},"application/epp+xml":{source:"iana",compressible:!0},"application/epub+zip":{source:"iana",compressible:!1,extensions:["epub"]},"application/eshop":{source:"iana"},"application/exi":{source:"iana",extensions:["exi"]},"application/expect-ct-report+json":{source:"iana",compressible:!0},"application/express":{source:"iana",extensions:["exp"]},"application/fastinfoset":{source:"iana"},"application/fastsoap":{source:"iana"},"application/fdt+xml":{source:"iana",compressible:!0,extensions:["fdt"]},"application/fhir+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/fhir+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/fido.trusted-apps+json":{compressible:!0},"application/fits":{source:"iana"},"application/flexfec":{source:"iana"},"application/font-sfnt":{source:"iana"},"application/font-tdpfr":{source:"iana",extensions:["pfr"]},"application/font-woff":{source:"iana",compressible:!1},"application/framework-attributes+xml":{source:"iana",compressible:!0},"application/geo+json":{source:"iana",compressible:!0,extensions:["geojson"]},"application/geo+json-seq":{source:"iana"},"application/geopackage+sqlite3":{source:"iana"},"application/geoxacml+xml":{source:"iana",compressible:!0},"application/gltf-buffer":{source:"iana"},"application/gml+xml":{source:"iana",compressible:!0,extensions:["gml"]},"application/gpx+xml":{source:"apache",compressible:!0,extensions:["gpx"]},"application/gxf":{source:"apache",extensions:["gxf"]},"application/gzip":{source:"iana",compressible:!1,extensions:["gz"]},"application/h224":{source:"iana"},"application/held+xml":{source:"iana",compressible:!0},"application/hjson":{extensions:["hjson"]},"application/http":{source:"iana"},"application/hyperstudio":{source:"iana",extensions:["stk"]},"application/ibe-key-request+xml":{source:"iana",compressible:!0},"application/ibe-pkg-reply+xml":{source:"iana",compressible:!0},"application/ibe-pp-data":{source:"iana"},"application/iges":{source:"iana"},"application/im-iscomposing+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/index":{source:"iana"},"application/index.cmd":{source:"iana"},"application/index.obj":{source:"iana"},"application/index.response":{source:"iana"},"application/index.vnd":{source:"iana"},"application/inkml+xml":{source:"iana",compressible:!0,extensions:["ink","inkml"]},"application/iotp":{source:"iana"},"application/ipfix":{source:"iana",extensions:["ipfix"]},"application/ipp":{source:"iana"},"application/isup":{source:"iana"},"application/its+xml":{source:"iana",compressible:!0,extensions:["its"]},"application/java-archive":{source:"apache",compressible:!1,extensions:["jar","war","ear"]},"application/java-serialized-object":{source:"apache",compressible:!1,extensions:["ser"]},"application/java-vm":{source:"apache",compressible:!1,extensions:["class"]},"application/javascript":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["js","mjs"]},"application/jf2feed+json":{source:"iana",compressible:!0},"application/jose":{source:"iana"},"application/jose+json":{source:"iana",compressible:!0},"application/jrd+json":{source:"iana",compressible:!0},"application/jscalendar+json":{source:"iana",compressible:!0},"application/json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["json","map"]},"application/json-patch+json":{source:"iana",compressible:!0},"application/json-seq":{source:"iana"},"application/json5":{extensions:["json5"]},"application/jsonml+json":{source:"apache",compressible:!0,extensions:["jsonml"]},"application/jwk+json":{source:"iana",compressible:!0},"application/jwk-set+json":{source:"iana",compressible:!0},"application/jwt":{source:"iana"},"application/kpml-request+xml":{source:"iana",compressible:!0},"application/kpml-response+xml":{source:"iana",compressible:!0},"application/ld+json":{source:"iana",compressible:!0,extensions:["jsonld"]},"application/lgr+xml":{source:"iana",compressible:!0,extensions:["lgr"]},"application/link-format":{source:"iana"},"application/load-control+xml":{source:"iana",compressible:!0},"application/lost+xml":{source:"iana",compressible:!0,extensions:["lostxml"]},"application/lostsync+xml":{source:"iana",compressible:!0},"application/lpf+zip":{source:"iana",compressible:!1},"application/lxf":{source:"iana"},"application/mac-binhex40":{source:"iana",extensions:["hqx"]},"application/mac-compactpro":{source:"apache",extensions:["cpt"]},"application/macwriteii":{source:"iana"},"application/mads+xml":{source:"iana",compressible:!0,extensions:["mads"]},"application/manifest+json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["webmanifest"]},"application/marc":{source:"iana",extensions:["mrc"]},"application/marcxml+xml":{source:"iana",compressible:!0,extensions:["mrcx"]},"application/mathematica":{source:"iana",extensions:["ma","nb","mb"]},"application/mathml+xml":{source:"iana",compressible:!0,extensions:["mathml"]},"application/mathml-content+xml":{source:"iana",compressible:!0},"application/mathml-presentation+xml":{source:"iana",compressible:!0},"application/mbms-associated-procedure-description+xml":{source:"iana",compressible:!0},"application/mbms-deregister+xml":{source:"iana",compressible:!0},"application/mbms-envelope+xml":{source:"iana",compressible:!0},"application/mbms-msk+xml":{source:"iana",compressible:!0},"application/mbms-msk-response+xml":{source:"iana",compressible:!0},"application/mbms-protection-description+xml":{source:"iana",compressible:!0},"application/mbms-reception-report+xml":{source:"iana",compressible:!0},"application/mbms-register+xml":{source:"iana",compressible:!0},"application/mbms-register-response+xml":{source:"iana",compressible:!0},"application/mbms-schedule+xml":{source:"iana",compressible:!0},"application/mbms-user-service-description+xml":{source:"iana",compressible:!0},"application/mbox":{source:"iana",extensions:["mbox"]},"application/media-policy-dataset+xml":{source:"iana",compressible:!0,extensions:["mpf"]},"application/media_control+xml":{source:"iana",compressible:!0},"application/mediaservercontrol+xml":{source:"iana",compressible:!0,extensions:["mscml"]},"application/merge-patch+json":{source:"iana",compressible:!0},"application/metalink+xml":{source:"apache",compressible:!0,extensions:["metalink"]},"application/metalink4+xml":{source:"iana",compressible:!0,extensions:["meta4"]},"application/mets+xml":{source:"iana",compressible:!0,extensions:["mets"]},"application/mf4":{source:"iana"},"application/mikey":{source:"iana"},"application/mipc":{source:"iana"},"application/missing-blocks+cbor-seq":{source:"iana"},"application/mmt-aei+xml":{source:"iana",compressible:!0,extensions:["maei"]},"application/mmt-usd+xml":{source:"iana",compressible:!0,extensions:["musd"]},"application/mods+xml":{source:"iana",compressible:!0,extensions:["mods"]},"application/moss-keys":{source:"iana"},"application/moss-signature":{source:"iana"},"application/mosskey-data":{source:"iana"},"application/mosskey-request":{source:"iana"},"application/mp21":{source:"iana",extensions:["m21","mp21"]},"application/mp4":{source:"iana",extensions:["mp4s","m4p"]},"application/mpeg4-generic":{source:"iana"},"application/mpeg4-iod":{source:"iana"},"application/mpeg4-iod-xmt":{source:"iana"},"application/mrb-consumer+xml":{source:"iana",compressible:!0},"application/mrb-publish+xml":{source:"iana",compressible:!0},"application/msc-ivr+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msc-mixer+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msword":{source:"iana",compressible:!1,extensions:["doc","dot"]},"application/mud+json":{source:"iana",compressible:!0},"application/multipart-core":{source:"iana"},"application/mxf":{source:"iana",extensions:["mxf"]},"application/n-quads":{source:"iana",extensions:["nq"]},"application/n-triples":{source:"iana",extensions:["nt"]},"application/nasdata":{source:"iana"},"application/news-checkgroups":{source:"iana",charset:"US-ASCII"},"application/news-groupinfo":{source:"iana",charset:"US-ASCII"},"application/news-transmission":{source:"iana"},"application/nlsml+xml":{source:"iana",compressible:!0},"application/node":{source:"iana",extensions:["cjs"]},"application/nss":{source:"iana"},"application/oauth-authz-req+jwt":{source:"iana"},"application/oblivious-dns-message":{source:"iana"},"application/ocsp-request":{source:"iana"},"application/ocsp-response":{source:"iana"},"application/octet-stream":{source:"iana",compressible:!1,extensions:["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{source:"iana",extensions:["oda"]},"application/odm+xml":{source:"iana",compressible:!0},"application/odx":{source:"iana"},"application/oebps-package+xml":{source:"iana",compressible:!0,extensions:["opf"]},"application/ogg":{source:"iana",compressible:!1,extensions:["ogx"]},"application/omdoc+xml":{source:"apache",compressible:!0,extensions:["omdoc"]},"application/onenote":{source:"apache",extensions:["onetoc","onetoc2","onetmp","onepkg"]},"application/opc-nodeset+xml":{source:"iana",compressible:!0},"application/oscore":{source:"iana"},"application/oxps":{source:"iana",extensions:["oxps"]},"application/p21":{source:"iana"},"application/p21+zip":{source:"iana",compressible:!1},"application/p2p-overlay+xml":{source:"iana",compressible:!0,extensions:["relo"]},"application/parityfec":{source:"iana"},"application/passport":{source:"iana"},"application/patch-ops-error+xml":{source:"iana",compressible:!0,extensions:["xer"]},"application/pdf":{source:"iana",compressible:!1,extensions:["pdf"]},"application/pdx":{source:"iana"},"application/pem-certificate-chain":{source:"iana"},"application/pgp-encrypted":{source:"iana",compressible:!1,extensions:["pgp"]},"application/pgp-keys":{source:"iana",extensions:["asc"]},"application/pgp-signature":{source:"iana",extensions:["asc","sig"]},"application/pics-rules":{source:"apache",extensions:["prf"]},"application/pidf+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pidf-diff+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pkcs10":{source:"iana",extensions:["p10"]},"application/pkcs12":{source:"iana"},"application/pkcs7-mime":{source:"iana",extensions:["p7m","p7c"]},"application/pkcs7-signature":{source:"iana",extensions:["p7s"]},"application/pkcs8":{source:"iana",extensions:["p8"]},"application/pkcs8-encrypted":{source:"iana"},"application/pkix-attr-cert":{source:"iana",extensions:["ac"]},"application/pkix-cert":{source:"iana",extensions:["cer"]},"application/pkix-crl":{source:"iana",extensions:["crl"]},"application/pkix-pkipath":{source:"iana",extensions:["pkipath"]},"application/pkixcmp":{source:"iana",extensions:["pki"]},"application/pls+xml":{source:"iana",compressible:!0,extensions:["pls"]},"application/poc-settings+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/postscript":{source:"iana",compressible:!0,extensions:["ai","eps","ps"]},"application/ppsp-tracker+json":{source:"iana",compressible:!0},"application/problem+json":{source:"iana",compressible:!0},"application/problem+xml":{source:"iana",compressible:!0},"application/provenance+xml":{source:"iana",compressible:!0,extensions:["provx"]},"application/prs.alvestrand.titrax-sheet":{source:"iana"},"application/prs.cww":{source:"iana",extensions:["cww"]},"application/prs.cyn":{source:"iana",charset:"7-BIT"},"application/prs.hpub+zip":{source:"iana",compressible:!1},"application/prs.nprend":{source:"iana"},"application/prs.plucker":{source:"iana"},"application/prs.rdf-xml-crypt":{source:"iana"},"application/prs.xsf+xml":{source:"iana",compressible:!0},"application/pskc+xml":{source:"iana",compressible:!0,extensions:["pskcxml"]},"application/pvd+json":{source:"iana",compressible:!0},"application/qsig":{source:"iana"},"application/raml+yaml":{compressible:!0,extensions:["raml"]},"application/raptorfec":{source:"iana"},"application/rdap+json":{source:"iana",compressible:!0},"application/rdf+xml":{source:"iana",compressible:!0,extensions:["rdf","owl"]},"application/reginfo+xml":{source:"iana",compressible:!0,extensions:["rif"]},"application/relax-ng-compact-syntax":{source:"iana",extensions:["rnc"]},"application/remote-printing":{source:"iana"},"application/reputon+json":{source:"iana",compressible:!0},"application/resource-lists+xml":{source:"iana",compressible:!0,extensions:["rl"]},"application/resource-lists-diff+xml":{source:"iana",compressible:!0,extensions:["rld"]},"application/rfc+xml":{source:"iana",compressible:!0},"application/riscos":{source:"iana"},"application/rlmi+xml":{source:"iana",compressible:!0},"application/rls-services+xml":{source:"iana",compressible:!0,extensions:["rs"]},"application/route-apd+xml":{source:"iana",compressible:!0,extensions:["rapd"]},"application/route-s-tsid+xml":{source:"iana",compressible:!0,extensions:["sls"]},"application/route-usd+xml":{source:"iana",compressible:!0,extensions:["rusd"]},"application/rpki-ghostbusters":{source:"iana",extensions:["gbr"]},"application/rpki-manifest":{source:"iana",extensions:["mft"]},"application/rpki-publication":{source:"iana"},"application/rpki-roa":{source:"iana",extensions:["roa"]},"application/rpki-updown":{source:"iana"},"application/rsd+xml":{source:"apache",compressible:!0,extensions:["rsd"]},"application/rss+xml":{source:"apache",compressible:!0,extensions:["rss"]},"application/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"application/rtploopback":{source:"iana"},"application/rtx":{source:"iana"},"application/samlassertion+xml":{source:"iana",compressible:!0},"application/samlmetadata+xml":{source:"iana",compressible:!0},"application/sarif+json":{source:"iana",compressible:!0},"application/sarif-external-properties+json":{source:"iana",compressible:!0},"application/sbe":{source:"iana"},"application/sbml+xml":{source:"iana",compressible:!0,extensions:["sbml"]},"application/scaip+xml":{source:"iana",compressible:!0},"application/scim+json":{source:"iana",compressible:!0},"application/scvp-cv-request":{source:"iana",extensions:["scq"]},"application/scvp-cv-response":{source:"iana",extensions:["scs"]},"application/scvp-vp-request":{source:"iana",extensions:["spq"]},"application/scvp-vp-response":{source:"iana",extensions:["spp"]},"application/sdp":{source:"iana",extensions:["sdp"]},"application/secevent+jwt":{source:"iana"},"application/senml+cbor":{source:"iana"},"application/senml+json":{source:"iana",compressible:!0},"application/senml+xml":{source:"iana",compressible:!0,extensions:["senmlx"]},"application/senml-etch+cbor":{source:"iana"},"application/senml-etch+json":{source:"iana",compressible:!0},"application/senml-exi":{source:"iana"},"application/sensml+cbor":{source:"iana"},"application/sensml+json":{source:"iana",compressible:!0},"application/sensml+xml":{source:"iana",compressible:!0,extensions:["sensmlx"]},"application/sensml-exi":{source:"iana"},"application/sep+xml":{source:"iana",compressible:!0},"application/sep-exi":{source:"iana"},"application/session-info":{source:"iana"},"application/set-payment":{source:"iana"},"application/set-payment-initiation":{source:"iana",extensions:["setpay"]},"application/set-registration":{source:"iana"},"application/set-registration-initiation":{source:"iana",extensions:["setreg"]},"application/sgml":{source:"iana"},"application/sgml-open-catalog":{source:"iana"},"application/shf+xml":{source:"iana",compressible:!0,extensions:["shf"]},"application/sieve":{source:"iana",extensions:["siv","sieve"]},"application/simple-filter+xml":{source:"iana",compressible:!0},"application/simple-message-summary":{source:"iana"},"application/simplesymbolcontainer":{source:"iana"},"application/sipc":{source:"iana"},"application/slate":{source:"iana"},"application/smil":{source:"iana"},"application/smil+xml":{source:"iana",compressible:!0,extensions:["smi","smil"]},"application/smpte336m":{source:"iana"},"application/soap+fastinfoset":{source:"iana"},"application/soap+xml":{source:"iana",compressible:!0},"application/sparql-query":{source:"iana",extensions:["rq"]},"application/sparql-results+xml":{source:"iana",compressible:!0,extensions:["srx"]},"application/spdx+json":{source:"iana",compressible:!0},"application/spirits-event+xml":{source:"iana",compressible:!0},"application/sql":{source:"iana"},"application/srgs":{source:"iana",extensions:["gram"]},"application/srgs+xml":{source:"iana",compressible:!0,extensions:["grxml"]},"application/sru+xml":{source:"iana",compressible:!0,extensions:["sru"]},"application/ssdl+xml":{source:"apache",compressible:!0,extensions:["ssdl"]},"application/ssml+xml":{source:"iana",compressible:!0,extensions:["ssml"]},"application/stix+json":{source:"iana",compressible:!0},"application/swid+xml":{source:"iana",compressible:!0,extensions:["swidtag"]},"application/tamp-apex-update":{source:"iana"},"application/tamp-apex-update-confirm":{source:"iana"},"application/tamp-community-update":{source:"iana"},"application/tamp-community-update-confirm":{source:"iana"},"application/tamp-error":{source:"iana"},"application/tamp-sequence-adjust":{source:"iana"},"application/tamp-sequence-adjust-confirm":{source:"iana"},"application/tamp-status-query":{source:"iana"},"application/tamp-status-response":{source:"iana"},"application/tamp-update":{source:"iana"},"application/tamp-update-confirm":{source:"iana"},"application/tar":{compressible:!0},"application/taxii+json":{source:"iana",compressible:!0},"application/td+json":{source:"iana",compressible:!0},"application/tei+xml":{source:"iana",compressible:!0,extensions:["tei","teicorpus"]},"application/tetra_isi":{source:"iana"},"application/thraud+xml":{source:"iana",compressible:!0,extensions:["tfi"]},"application/timestamp-query":{source:"iana"},"application/timestamp-reply":{source:"iana"},"application/timestamped-data":{source:"iana",extensions:["tsd"]},"application/tlsrpt+gzip":{source:"iana"},"application/tlsrpt+json":{source:"iana",compressible:!0},"application/tnauthlist":{source:"iana"},"application/token-introspection+jwt":{source:"iana"},"application/toml":{compressible:!0,extensions:["toml"]},"application/trickle-ice-sdpfrag":{source:"iana"},"application/trig":{source:"iana",extensions:["trig"]},"application/ttml+xml":{source:"iana",compressible:!0,extensions:["ttml"]},"application/tve-trigger":{source:"iana"},"application/tzif":{source:"iana"},"application/tzif-leap":{source:"iana"},"application/ubjson":{compressible:!1,extensions:["ubj"]},"application/ulpfec":{source:"iana"},"application/urc-grpsheet+xml":{source:"iana",compressible:!0},"application/urc-ressheet+xml":{source:"iana",compressible:!0,extensions:["rsheet"]},"application/urc-targetdesc+xml":{source:"iana",compressible:!0,extensions:["td"]},"application/urc-uisocketdesc+xml":{source:"iana",compressible:!0},"application/vcard+json":{source:"iana",compressible:!0},"application/vcard+xml":{source:"iana",compressible:!0},"application/vemmi":{source:"iana"},"application/vividence.scriptfile":{source:"apache"},"application/vnd.1000minds.decision-model+xml":{source:"iana",compressible:!0,extensions:["1km"]},"application/vnd.3gpp-prose+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-prose-pc3ch+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-v2x-local-service-information":{source:"iana"},"application/vnd.3gpp.5gnas":{source:"iana"},"application/vnd.3gpp.access-transfer-events+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.bsf+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gmop+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gtpc":{source:"iana"},"application/vnd.3gpp.interworking-data":{source:"iana"},"application/vnd.3gpp.lpp":{source:"iana"},"application/vnd.3gpp.mc-signalling-ear":{source:"iana"},"application/vnd.3gpp.mcdata-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-payload":{source:"iana"},"application/vnd.3gpp.mcdata-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-signalling":{source:"iana"},"application/vnd.3gpp.mcdata-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-floor-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-signed+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-init-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-transmission-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mid-call+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ngap":{source:"iana"},"application/vnd.3gpp.pfcp":{source:"iana"},"application/vnd.3gpp.pic-bw-large":{source:"iana",extensions:["plb"]},"application/vnd.3gpp.pic-bw-small":{source:"iana",extensions:["psb"]},"application/vnd.3gpp.pic-bw-var":{source:"iana",extensions:["pvb"]},"application/vnd.3gpp.s1ap":{source:"iana"},"application/vnd.3gpp.sms":{source:"iana"},"application/vnd.3gpp.sms+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-ext+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.state-and-event-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ussd+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.bcmcsinfo+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.sms":{source:"iana"},"application/vnd.3gpp2.tcap":{source:"iana",extensions:["tcap"]},"application/vnd.3lightssoftware.imagescal":{source:"iana"},"application/vnd.3m.post-it-notes":{source:"iana",extensions:["pwn"]},"application/vnd.accpac.simply.aso":{source:"iana",extensions:["aso"]},"application/vnd.accpac.simply.imp":{source:"iana",extensions:["imp"]},"application/vnd.acucobol":{source:"iana",extensions:["acu"]},"application/vnd.acucorp":{source:"iana",extensions:["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{source:"apache",compressible:!1,extensions:["air"]},"application/vnd.adobe.flash.movie":{source:"iana"},"application/vnd.adobe.formscentral.fcdt":{source:"iana",extensions:["fcdt"]},"application/vnd.adobe.fxp":{source:"iana",extensions:["fxp","fxpl"]},"application/vnd.adobe.partial-upload":{source:"iana"},"application/vnd.adobe.xdp+xml":{source:"iana",compressible:!0,extensions:["xdp"]},"application/vnd.adobe.xfdf":{source:"iana",extensions:["xfdf"]},"application/vnd.aether.imp":{source:"iana"},"application/vnd.afpc.afplinedata":{source:"iana"},"application/vnd.afpc.afplinedata-pagedef":{source:"iana"},"application/vnd.afpc.cmoca-cmresource":{source:"iana"},"application/vnd.afpc.foca-charset":{source:"iana"},"application/vnd.afpc.foca-codedfont":{source:"iana"},"application/vnd.afpc.foca-codepage":{source:"iana"},"application/vnd.afpc.modca":{source:"iana"},"application/vnd.afpc.modca-cmtable":{source:"iana"},"application/vnd.afpc.modca-formdef":{source:"iana"},"application/vnd.afpc.modca-mediummap":{source:"iana"},"application/vnd.afpc.modca-objectcontainer":{source:"iana"},"application/vnd.afpc.modca-overlay":{source:"iana"},"application/vnd.afpc.modca-pagesegment":{source:"iana"},"application/vnd.age":{source:"iana",extensions:["age"]},"application/vnd.ah-barcode":{source:"iana"},"application/vnd.ahead.space":{source:"iana",extensions:["ahead"]},"application/vnd.airzip.filesecure.azf":{source:"iana",extensions:["azf"]},"application/vnd.airzip.filesecure.azs":{source:"iana",extensions:["azs"]},"application/vnd.amadeus+json":{source:"iana",compressible:!0},"application/vnd.amazon.ebook":{source:"apache",extensions:["azw"]},"application/vnd.amazon.mobi8-ebook":{source:"iana"},"application/vnd.americandynamics.acc":{source:"iana",extensions:["acc"]},"application/vnd.amiga.ami":{source:"iana",extensions:["ami"]},"application/vnd.amundsen.maze+xml":{source:"iana",compressible:!0},"application/vnd.android.ota":{source:"iana"},"application/vnd.android.package-archive":{source:"apache",compressible:!1,extensions:["apk"]},"application/vnd.anki":{source:"iana"},"application/vnd.anser-web-certificate-issue-initiation":{source:"iana",extensions:["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{source:"apache",extensions:["fti"]},"application/vnd.antix.game-component":{source:"iana",extensions:["atx"]},"application/vnd.apache.arrow.file":{source:"iana"},"application/vnd.apache.arrow.stream":{source:"iana"},"application/vnd.apache.thrift.binary":{source:"iana"},"application/vnd.apache.thrift.compact":{source:"iana"},"application/vnd.apache.thrift.json":{source:"iana"},"application/vnd.api+json":{source:"iana",compressible:!0},"application/vnd.aplextor.warrp+json":{source:"iana",compressible:!0},"application/vnd.apothekende.reservation+json":{source:"iana",compressible:!0},"application/vnd.apple.installer+xml":{source:"iana",compressible:!0,extensions:["mpkg"]},"application/vnd.apple.keynote":{source:"iana",extensions:["key"]},"application/vnd.apple.mpegurl":{source:"iana",extensions:["m3u8"]},"application/vnd.apple.numbers":{source:"iana",extensions:["numbers"]},"application/vnd.apple.pages":{source:"iana",extensions:["pages"]},"application/vnd.apple.pkpass":{compressible:!1,extensions:["pkpass"]},"application/vnd.arastra.swi":{source:"iana"},"application/vnd.aristanetworks.swi":{source:"iana",extensions:["swi"]},"application/vnd.artisan+json":{source:"iana",compressible:!0},"application/vnd.artsquare":{source:"iana"},"application/vnd.astraea-software.iota":{source:"iana",extensions:["iota"]},"application/vnd.audiograph":{source:"iana",extensions:["aep"]},"application/vnd.autopackage":{source:"iana"},"application/vnd.avalon+json":{source:"iana",compressible:!0},"application/vnd.avistar+xml":{source:"iana",compressible:!0},"application/vnd.balsamiq.bmml+xml":{source:"iana",compressible:!0,extensions:["bmml"]},"application/vnd.balsamiq.bmpr":{source:"iana"},"application/vnd.banana-accounting":{source:"iana"},"application/vnd.bbf.usp.error":{source:"iana"},"application/vnd.bbf.usp.msg":{source:"iana"},"application/vnd.bbf.usp.msg+json":{source:"iana",compressible:!0},"application/vnd.bekitzur-stech+json":{source:"iana",compressible:!0},"application/vnd.bint.med-content":{source:"iana"},"application/vnd.biopax.rdf+xml":{source:"iana",compressible:!0},"application/vnd.blink-idb-value-wrapper":{source:"iana"},"application/vnd.blueice.multipass":{source:"iana",extensions:["mpm"]},"application/vnd.bluetooth.ep.oob":{source:"iana"},"application/vnd.bluetooth.le.oob":{source:"iana"},"application/vnd.bmi":{source:"iana",extensions:["bmi"]},"application/vnd.bpf":{source:"iana"},"application/vnd.bpf3":{source:"iana"},"application/vnd.businessobjects":{source:"iana",extensions:["rep"]},"application/vnd.byu.uapi+json":{source:"iana",compressible:!0},"application/vnd.cab-jscript":{source:"iana"},"application/vnd.canon-cpdl":{source:"iana"},"application/vnd.canon-lips":{source:"iana"},"application/vnd.capasystems-pg+json":{source:"iana",compressible:!0},"application/vnd.cendio.thinlinc.clientconf":{source:"iana"},"application/vnd.century-systems.tcp_stream":{source:"iana"},"application/vnd.chemdraw+xml":{source:"iana",compressible:!0,extensions:["cdxml"]},"application/vnd.chess-pgn":{source:"iana"},"application/vnd.chipnuts.karaoke-mmd":{source:"iana",extensions:["mmd"]},"application/vnd.ciedi":{source:"iana"},"application/vnd.cinderella":{source:"iana",extensions:["cdy"]},"application/vnd.cirpack.isdn-ext":{source:"iana"},"application/vnd.citationstyles.style+xml":{source:"iana",compressible:!0,extensions:["csl"]},"application/vnd.claymore":{source:"iana",extensions:["cla"]},"application/vnd.cloanto.rp9":{source:"iana",extensions:["rp9"]},"application/vnd.clonk.c4group":{source:"iana",extensions:["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{source:"iana",extensions:["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{source:"iana",extensions:["c11amz"]},"application/vnd.coffeescript":{source:"iana"},"application/vnd.collabio.xodocuments.document":{source:"iana"},"application/vnd.collabio.xodocuments.document-template":{source:"iana"},"application/vnd.collabio.xodocuments.presentation":{source:"iana"},"application/vnd.collabio.xodocuments.presentation-template":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet-template":{source:"iana"},"application/vnd.collection+json":{source:"iana",compressible:!0},"application/vnd.collection.doc+json":{source:"iana",compressible:!0},"application/vnd.collection.next+json":{source:"iana",compressible:!0},"application/vnd.comicbook+zip":{source:"iana",compressible:!1},"application/vnd.comicbook-rar":{source:"iana"},"application/vnd.commerce-battelle":{source:"iana"},"application/vnd.commonspace":{source:"iana",extensions:["csp"]},"application/vnd.contact.cmsg":{source:"iana",extensions:["cdbcmsg"]},"application/vnd.coreos.ignition+json":{source:"iana",compressible:!0},"application/vnd.cosmocaller":{source:"iana",extensions:["cmc"]},"application/vnd.crick.clicker":{source:"iana",extensions:["clkx"]},"application/vnd.crick.clicker.keyboard":{source:"iana",extensions:["clkk"]},"application/vnd.crick.clicker.palette":{source:"iana",extensions:["clkp"]},"application/vnd.crick.clicker.template":{source:"iana",extensions:["clkt"]},"application/vnd.crick.clicker.wordbank":{source:"iana",extensions:["clkw"]},"application/vnd.criticaltools.wbs+xml":{source:"iana",compressible:!0,extensions:["wbs"]},"application/vnd.cryptii.pipe+json":{source:"iana",compressible:!0},"application/vnd.crypto-shade-file":{source:"iana"},"application/vnd.cryptomator.encrypted":{source:"iana"},"application/vnd.cryptomator.vault":{source:"iana"},"application/vnd.ctc-posml":{source:"iana",extensions:["pml"]},"application/vnd.ctct.ws+xml":{source:"iana",compressible:!0},"application/vnd.cups-pdf":{source:"iana"},"application/vnd.cups-postscript":{source:"iana"},"application/vnd.cups-ppd":{source:"iana",extensions:["ppd"]},"application/vnd.cups-raster":{source:"iana"},"application/vnd.cups-raw":{source:"iana"},"application/vnd.curl":{source:"iana"},"application/vnd.curl.car":{source:"apache",extensions:["car"]},"application/vnd.curl.pcurl":{source:"apache",extensions:["pcurl"]},"application/vnd.cyan.dean.root+xml":{source:"iana",compressible:!0},"application/vnd.cybank":{source:"iana"},"application/vnd.cyclonedx+json":{source:"iana",compressible:!0},"application/vnd.cyclonedx+xml":{source:"iana",compressible:!0},"application/vnd.d2l.coursepackage1p0+zip":{source:"iana",compressible:!1},"application/vnd.d3m-dataset":{source:"iana"},"application/vnd.d3m-problem":{source:"iana"},"application/vnd.dart":{source:"iana",compressible:!0,extensions:["dart"]},"application/vnd.data-vision.rdz":{source:"iana",extensions:["rdz"]},"application/vnd.datapackage+json":{source:"iana",compressible:!0},"application/vnd.dataresource+json":{source:"iana",compressible:!0},"application/vnd.dbf":{source:"iana",extensions:["dbf"]},"application/vnd.debian.binary-package":{source:"iana"},"application/vnd.dece.data":{source:"iana",extensions:["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{source:"iana",compressible:!0,extensions:["uvt","uvvt"]},"application/vnd.dece.unspecified":{source:"iana",extensions:["uvx","uvvx"]},"application/vnd.dece.zip":{source:"iana",extensions:["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{source:"iana",extensions:["fe_launch"]},"application/vnd.desmume.movie":{source:"iana"},"application/vnd.dir-bi.plate-dl-nosuffix":{source:"iana"},"application/vnd.dm.delegation+xml":{source:"iana",compressible:!0},"application/vnd.dna":{source:"iana",extensions:["dna"]},"application/vnd.document+json":{source:"iana",compressible:!0},"application/vnd.dolby.mlp":{source:"apache",extensions:["mlp"]},"application/vnd.dolby.mobile.1":{source:"iana"},"application/vnd.dolby.mobile.2":{source:"iana"},"application/vnd.doremir.scorecloud-binary-document":{source:"iana"},"application/vnd.dpgraph":{source:"iana",extensions:["dpg"]},"application/vnd.dreamfactory":{source:"iana",extensions:["dfac"]},"application/vnd.drive+json":{source:"iana",compressible:!0},"application/vnd.ds-keypoint":{source:"apache",extensions:["kpxx"]},"application/vnd.dtg.local":{source:"iana"},"application/vnd.dtg.local.flash":{source:"iana"},"application/vnd.dtg.local.html":{source:"iana"},"application/vnd.dvb.ait":{source:"iana",extensions:["ait"]},"application/vnd.dvb.dvbisl+xml":{source:"iana",compressible:!0},"application/vnd.dvb.dvbj":{source:"iana"},"application/vnd.dvb.esgcontainer":{source:"iana"},"application/vnd.dvb.ipdcdftnotifaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess2":{source:"iana"},"application/vnd.dvb.ipdcesgpdd":{source:"iana"},"application/vnd.dvb.ipdcroaming":{source:"iana"},"application/vnd.dvb.iptv.alfec-base":{source:"iana"},"application/vnd.dvb.iptv.alfec-enhancement":{source:"iana"},"application/vnd.dvb.notif-aggregate-root+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-container+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-generic+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-msglist+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-request+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-response+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-init+xml":{source:"iana",compressible:!0},"application/vnd.dvb.pfr":{source:"iana"},"application/vnd.dvb.service":{source:"iana",extensions:["svc"]},"application/vnd.dxr":{source:"iana"},"application/vnd.dynageo":{source:"iana",extensions:["geo"]},"application/vnd.dzr":{source:"iana"},"application/vnd.easykaraoke.cdgdownload":{source:"iana"},"application/vnd.ecdis-update":{source:"iana"},"application/vnd.ecip.rlp":{source:"iana"},"application/vnd.eclipse.ditto+json":{source:"iana",compressible:!0},"application/vnd.ecowin.chart":{source:"iana",extensions:["mag"]},"application/vnd.ecowin.filerequest":{source:"iana"},"application/vnd.ecowin.fileupdate":{source:"iana"},"application/vnd.ecowin.series":{source:"iana"},"application/vnd.ecowin.seriesrequest":{source:"iana"},"application/vnd.ecowin.seriesupdate":{source:"iana"},"application/vnd.efi.img":{source:"iana"},"application/vnd.efi.iso":{source:"iana"},"application/vnd.emclient.accessrequest+xml":{source:"iana",compressible:!0},"application/vnd.enliven":{source:"iana",extensions:["nml"]},"application/vnd.enphase.envoy":{source:"iana"},"application/vnd.eprints.data+xml":{source:"iana",compressible:!0},"application/vnd.epson.esf":{source:"iana",extensions:["esf"]},"application/vnd.epson.msf":{source:"iana",extensions:["msf"]},"application/vnd.epson.quickanime":{source:"iana",extensions:["qam"]},"application/vnd.epson.salt":{source:"iana",extensions:["slt"]},"application/vnd.epson.ssf":{source:"iana",extensions:["ssf"]},"application/vnd.ericsson.quickcall":{source:"iana"},"application/vnd.espass-espass+zip":{source:"iana",compressible:!1},"application/vnd.eszigno3+xml":{source:"iana",compressible:!0,extensions:["es3","et3"]},"application/vnd.etsi.aoc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.asic-e+zip":{source:"iana",compressible:!1},"application/vnd.etsi.asic-s+zip":{source:"iana",compressible:!1},"application/vnd.etsi.cug+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvcommand+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-bc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-cod+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-npvr+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvservice+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsync+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvueprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mcid+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mheg5":{source:"iana"},"application/vnd.etsi.overload-control-policy-dataset+xml":{source:"iana",compressible:!0},"application/vnd.etsi.pstn+xml":{source:"iana",compressible:!0},"application/vnd.etsi.sci+xml":{source:"iana",compressible:!0},"application/vnd.etsi.simservs+xml":{source:"iana",compressible:!0},"application/vnd.etsi.timestamp-token":{source:"iana"},"application/vnd.etsi.tsl+xml":{source:"iana",compressible:!0},"application/vnd.etsi.tsl.der":{source:"iana"},"application/vnd.eu.kasparian.car+json":{source:"iana",compressible:!0},"application/vnd.eudora.data":{source:"iana"},"application/vnd.evolv.ecig.profile":{source:"iana"},"application/vnd.evolv.ecig.settings":{source:"iana"},"application/vnd.evolv.ecig.theme":{source:"iana"},"application/vnd.exstream-empower+zip":{source:"iana",compressible:!1},"application/vnd.exstream-package":{source:"iana"},"application/vnd.ezpix-album":{source:"iana",extensions:["ez2"]},"application/vnd.ezpix-package":{source:"iana",extensions:["ez3"]},"application/vnd.f-secure.mobile":{source:"iana"},"application/vnd.familysearch.gedcom+zip":{source:"iana",compressible:!1},"application/vnd.fastcopy-disk-image":{source:"iana"},"application/vnd.fdf":{source:"iana",extensions:["fdf"]},"application/vnd.fdsn.mseed":{source:"iana",extensions:["mseed"]},"application/vnd.fdsn.seed":{source:"iana",extensions:["seed","dataless"]},"application/vnd.ffsns":{source:"iana"},"application/vnd.ficlab.flb+zip":{source:"iana",compressible:!1},"application/vnd.filmit.zfc":{source:"iana"},"application/vnd.fints":{source:"iana"},"application/vnd.firemonkeys.cloudcell":{source:"iana"},"application/vnd.flographit":{source:"iana",extensions:["gph"]},"application/vnd.fluxtime.clip":{source:"iana",extensions:["ftc"]},"application/vnd.font-fontforge-sfd":{source:"iana"},"application/vnd.framemaker":{source:"iana",extensions:["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{source:"iana",extensions:["fnc"]},"application/vnd.frogans.ltf":{source:"iana",extensions:["ltf"]},"application/vnd.fsc.weblaunch":{source:"iana",extensions:["fsc"]},"application/vnd.fujifilm.fb.docuworks":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.binder":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.container":{source:"iana"},"application/vnd.fujifilm.fb.jfi+xml":{source:"iana",compressible:!0},"application/vnd.fujitsu.oasys":{source:"iana",extensions:["oas"]},"application/vnd.fujitsu.oasys2":{source:"iana",extensions:["oa2"]},"application/vnd.fujitsu.oasys3":{source:"iana",extensions:["oa3"]},"application/vnd.fujitsu.oasysgp":{source:"iana",extensions:["fg5"]},"application/vnd.fujitsu.oasysprs":{source:"iana",extensions:["bh2"]},"application/vnd.fujixerox.art-ex":{source:"iana"},"application/vnd.fujixerox.art4":{source:"iana"},"application/vnd.fujixerox.ddd":{source:"iana",extensions:["ddd"]},"application/vnd.fujixerox.docuworks":{source:"iana",extensions:["xdw"]},"application/vnd.fujixerox.docuworks.binder":{source:"iana",extensions:["xbd"]},"application/vnd.fujixerox.docuworks.container":{source:"iana"},"application/vnd.fujixerox.hbpl":{source:"iana"},"application/vnd.fut-misnet":{source:"iana"},"application/vnd.futoin+cbor":{source:"iana"},"application/vnd.futoin+json":{source:"iana",compressible:!0},"application/vnd.fuzzysheet":{source:"iana",extensions:["fzs"]},"application/vnd.genomatix.tuxedo":{source:"iana",extensions:["txd"]},"application/vnd.gentics.grd+json":{source:"iana",compressible:!0},"application/vnd.geo+json":{source:"iana",compressible:!0},"application/vnd.geocube+xml":{source:"iana",compressible:!0},"application/vnd.geogebra.file":{source:"iana",extensions:["ggb"]},"application/vnd.geogebra.slides":{source:"iana"},"application/vnd.geogebra.tool":{source:"iana",extensions:["ggt"]},"application/vnd.geometry-explorer":{source:"iana",extensions:["gex","gre"]},"application/vnd.geonext":{source:"iana",extensions:["gxt"]},"application/vnd.geoplan":{source:"iana",extensions:["g2w"]},"application/vnd.geospace":{source:"iana",extensions:["g3w"]},"application/vnd.gerber":{source:"iana"},"application/vnd.globalplatform.card-content-mgt":{source:"iana"},"application/vnd.globalplatform.card-content-mgt-response":{source:"iana"},"application/vnd.gmx":{source:"iana",extensions:["gmx"]},"application/vnd.google-apps.document":{compressible:!1,extensions:["gdoc"]},"application/vnd.google-apps.presentation":{compressible:!1,extensions:["gslides"]},"application/vnd.google-apps.spreadsheet":{compressible:!1,extensions:["gsheet"]},"application/vnd.google-earth.kml+xml":{source:"iana",compressible:!0,extensions:["kml"]},"application/vnd.google-earth.kmz":{source:"iana",compressible:!1,extensions:["kmz"]},"application/vnd.gov.sk.e-form+xml":{source:"iana",compressible:!0},"application/vnd.gov.sk.e-form+zip":{source:"iana",compressible:!1},"application/vnd.gov.sk.xmldatacontainer+xml":{source:"iana",compressible:!0},"application/vnd.grafeq":{source:"iana",extensions:["gqf","gqs"]},"application/vnd.gridmp":{source:"iana"},"application/vnd.groove-account":{source:"iana",extensions:["gac"]},"application/vnd.groove-help":{source:"iana",extensions:["ghf"]},"application/vnd.groove-identity-message":{source:"iana",extensions:["gim"]},"application/vnd.groove-injector":{source:"iana",extensions:["grv"]},"application/vnd.groove-tool-message":{source:"iana",extensions:["gtm"]},"application/vnd.groove-tool-template":{source:"iana",extensions:["tpl"]},"application/vnd.groove-vcard":{source:"iana",extensions:["vcg"]},"application/vnd.hal+json":{source:"iana",compressible:!0},"application/vnd.hal+xml":{source:"iana",compressible:!0,extensions:["hal"]},"application/vnd.handheld-entertainment+xml":{source:"iana",compressible:!0,extensions:["zmm"]},"application/vnd.hbci":{source:"iana",extensions:["hbci"]},"application/vnd.hc+json":{source:"iana",compressible:!0},"application/vnd.hcl-bireports":{source:"iana"},"application/vnd.hdt":{source:"iana"},"application/vnd.heroku+json":{source:"iana",compressible:!0},"application/vnd.hhe.lesson-player":{source:"iana",extensions:["les"]},"application/vnd.hl7cda+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hl7v2+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hp-hpgl":{source:"iana",extensions:["hpgl"]},"application/vnd.hp-hpid":{source:"iana",extensions:["hpid"]},"application/vnd.hp-hps":{source:"iana",extensions:["hps"]},"application/vnd.hp-jlyt":{source:"iana",extensions:["jlt"]},"application/vnd.hp-pcl":{source:"iana",extensions:["pcl"]},"application/vnd.hp-pclxl":{source:"iana",extensions:["pclxl"]},"application/vnd.httphone":{source:"iana"},"application/vnd.hydrostatix.sof-data":{source:"iana",extensions:["sfd-hdstx"]},"application/vnd.hyper+json":{source:"iana",compressible:!0},"application/vnd.hyper-item+json":{source:"iana",compressible:!0},"application/vnd.hyperdrive+json":{source:"iana",compressible:!0},"application/vnd.hzn-3d-crossword":{source:"iana"},"application/vnd.ibm.afplinedata":{source:"iana"},"application/vnd.ibm.electronic-media":{source:"iana"},"application/vnd.ibm.minipay":{source:"iana",extensions:["mpy"]},"application/vnd.ibm.modcap":{source:"iana",extensions:["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{source:"iana",extensions:["irm"]},"application/vnd.ibm.secure-container":{source:"iana",extensions:["sc"]},"application/vnd.iccprofile":{source:"iana",extensions:["icc","icm"]},"application/vnd.ieee.1905":{source:"iana"},"application/vnd.igloader":{source:"iana",extensions:["igl"]},"application/vnd.imagemeter.folder+zip":{source:"iana",compressible:!1},"application/vnd.imagemeter.image+zip":{source:"iana",compressible:!1},"application/vnd.immervision-ivp":{source:"iana",extensions:["ivp"]},"application/vnd.immervision-ivu":{source:"iana",extensions:["ivu"]},"application/vnd.ims.imsccv1p1":{source:"iana"},"application/vnd.ims.imsccv1p2":{source:"iana"},"application/vnd.ims.imsccv1p3":{source:"iana"},"application/vnd.ims.lis.v2.result+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolconsumerprofile+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy.id+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings.simple+json":{source:"iana",compressible:!0},"application/vnd.informedcontrol.rms+xml":{source:"iana",compressible:!0},"application/vnd.informix-visionary":{source:"iana"},"application/vnd.infotech.project":{source:"iana"},"application/vnd.infotech.project+xml":{source:"iana",compressible:!0},"application/vnd.innopath.wamp.notification":{source:"iana"},"application/vnd.insors.igm":{source:"iana",extensions:["igm"]},"application/vnd.intercon.formnet":{source:"iana",extensions:["xpw","xpx"]},"application/vnd.intergeo":{source:"iana",extensions:["i2g"]},"application/vnd.intertrust.digibox":{source:"iana"},"application/vnd.intertrust.nncp":{source:"iana"},"application/vnd.intu.qbo":{source:"iana",extensions:["qbo"]},"application/vnd.intu.qfx":{source:"iana",extensions:["qfx"]},"application/vnd.iptc.g2.catalogitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.conceptitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.knowledgeitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsmessage+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.packageitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.planningitem+xml":{source:"iana",compressible:!0},"application/vnd.ipunplugged.rcprofile":{source:"iana",extensions:["rcprofile"]},"application/vnd.irepository.package+xml":{source:"iana",compressible:!0,extensions:["irp"]},"application/vnd.is-xpr":{source:"iana",extensions:["xpr"]},"application/vnd.isac.fcs":{source:"iana",extensions:["fcs"]},"application/vnd.iso11783-10+zip":{source:"iana",compressible:!1},"application/vnd.jam":{source:"iana",extensions:["jam"]},"application/vnd.japannet-directory-service":{source:"iana"},"application/vnd.japannet-jpnstore-wakeup":{source:"iana"},"application/vnd.japannet-payment-wakeup":{source:"iana"},"application/vnd.japannet-registration":{source:"iana"},"application/vnd.japannet-registration-wakeup":{source:"iana"},"application/vnd.japannet-setstore-wakeup":{source:"iana"},"application/vnd.japannet-verification":{source:"iana"},"application/vnd.japannet-verification-wakeup":{source:"iana"},"application/vnd.jcp.javame.midlet-rms":{source:"iana",extensions:["rms"]},"application/vnd.jisp":{source:"iana",extensions:["jisp"]},"application/vnd.joost.joda-archive":{source:"iana",extensions:["joda"]},"application/vnd.jsk.isdn-ngn":{source:"iana"},"application/vnd.kahootz":{source:"iana",extensions:["ktz","ktr"]},"application/vnd.kde.karbon":{source:"iana",extensions:["karbon"]},"application/vnd.kde.kchart":{source:"iana",extensions:["chrt"]},"application/vnd.kde.kformula":{source:"iana",extensions:["kfo"]},"application/vnd.kde.kivio":{source:"iana",extensions:["flw"]},"application/vnd.kde.kontour":{source:"iana",extensions:["kon"]},"application/vnd.kde.kpresenter":{source:"iana",extensions:["kpr","kpt"]},"application/vnd.kde.kspread":{source:"iana",extensions:["ksp"]},"application/vnd.kde.kword":{source:"iana",extensions:["kwd","kwt"]},"application/vnd.kenameaapp":{source:"iana",extensions:["htke"]},"application/vnd.kidspiration":{source:"iana",extensions:["kia"]},"application/vnd.kinar":{source:"iana",extensions:["kne","knp"]},"application/vnd.koan":{source:"iana",extensions:["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{source:"iana",extensions:["sse"]},"application/vnd.las":{source:"iana"},"application/vnd.las.las+json":{source:"iana",compressible:!0},"application/vnd.las.las+xml":{source:"iana",compressible:!0,extensions:["lasxml"]},"application/vnd.laszip":{source:"iana"},"application/vnd.leap+json":{source:"iana",compressible:!0},"application/vnd.liberty-request+xml":{source:"iana",compressible:!0},"application/vnd.llamagraphics.life-balance.desktop":{source:"iana",extensions:["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{source:"iana",compressible:!0,extensions:["lbe"]},"application/vnd.logipipe.circuit+zip":{source:"iana",compressible:!1},"application/vnd.loom":{source:"iana"},"application/vnd.lotus-1-2-3":{source:"iana",extensions:["123"]},"application/vnd.lotus-approach":{source:"iana",extensions:["apr"]},"application/vnd.lotus-freelance":{source:"iana",extensions:["pre"]},"application/vnd.lotus-notes":{source:"iana",extensions:["nsf"]},"application/vnd.lotus-organizer":{source:"iana",extensions:["org"]},"application/vnd.lotus-screencam":{source:"iana",extensions:["scm"]},"application/vnd.lotus-wordpro":{source:"iana",extensions:["lwp"]},"application/vnd.macports.portpkg":{source:"iana",extensions:["portpkg"]},"application/vnd.mapbox-vector-tile":{source:"iana",extensions:["mvt"]},"application/vnd.marlin.drm.actiontoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.conftoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.license+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.mdcf":{source:"iana"},"application/vnd.mason+json":{source:"iana",compressible:!0},"application/vnd.maxar.archive.3tz+zip":{source:"iana",compressible:!1},"application/vnd.maxmind.maxmind-db":{source:"iana"},"application/vnd.mcd":{source:"iana",extensions:["mcd"]},"application/vnd.medcalcdata":{source:"iana",extensions:["mc1"]},"application/vnd.mediastation.cdkey":{source:"iana",extensions:["cdkey"]},"application/vnd.meridian-slingshot":{source:"iana"},"application/vnd.mfer":{source:"iana",extensions:["mwf"]},"application/vnd.mfmp":{source:"iana",extensions:["mfm"]},"application/vnd.micro+json":{source:"iana",compressible:!0},"application/vnd.micrografx.flo":{source:"iana",extensions:["flo"]},"application/vnd.micrografx.igx":{source:"iana",extensions:["igx"]},"application/vnd.microsoft.portable-executable":{source:"iana"},"application/vnd.microsoft.windows.thumbnail-cache":{source:"iana"},"application/vnd.miele+json":{source:"iana",compressible:!0},"application/vnd.mif":{source:"iana",extensions:["mif"]},"application/vnd.minisoft-hp3000-save":{source:"iana"},"application/vnd.mitsubishi.misty-guard.trustweb":{source:"iana"},"application/vnd.mobius.daf":{source:"iana",extensions:["daf"]},"application/vnd.mobius.dis":{source:"iana",extensions:["dis"]},"application/vnd.mobius.mbk":{source:"iana",extensions:["mbk"]},"application/vnd.mobius.mqy":{source:"iana",extensions:["mqy"]},"application/vnd.mobius.msl":{source:"iana",extensions:["msl"]},"application/vnd.mobius.plc":{source:"iana",extensions:["plc"]},"application/vnd.mobius.txf":{source:"iana",extensions:["txf"]},"application/vnd.mophun.application":{source:"iana",extensions:["mpn"]},"application/vnd.mophun.certificate":{source:"iana",extensions:["mpc"]},"application/vnd.motorola.flexsuite":{source:"iana"},"application/vnd.motorola.flexsuite.adsi":{source:"iana"},"application/vnd.motorola.flexsuite.fis":{source:"iana"},"application/vnd.motorola.flexsuite.gotap":{source:"iana"},"application/vnd.motorola.flexsuite.kmr":{source:"iana"},"application/vnd.motorola.flexsuite.ttc":{source:"iana"},"application/vnd.motorola.flexsuite.wem":{source:"iana"},"application/vnd.motorola.iprm":{source:"iana"},"application/vnd.mozilla.xul+xml":{source:"iana",compressible:!0,extensions:["xul"]},"application/vnd.ms-3mfdocument":{source:"iana"},"application/vnd.ms-artgalry":{source:"iana",extensions:["cil"]},"application/vnd.ms-asf":{source:"iana"},"application/vnd.ms-cab-compressed":{source:"iana",extensions:["cab"]},"application/vnd.ms-color.iccprofile":{source:"apache"},"application/vnd.ms-excel":{source:"iana",compressible:!1,extensions:["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{source:"iana",extensions:["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{source:"iana",extensions:["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{source:"iana",extensions:["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{source:"iana",extensions:["xltm"]},"application/vnd.ms-fontobject":{source:"iana",compressible:!0,extensions:["eot"]},"application/vnd.ms-htmlhelp":{source:"iana",extensions:["chm"]},"application/vnd.ms-ims":{source:"iana",extensions:["ims"]},"application/vnd.ms-lrm":{source:"iana",extensions:["lrm"]},"application/vnd.ms-office.activex+xml":{source:"iana",compressible:!0},"application/vnd.ms-officetheme":{source:"iana",extensions:["thmx"]},"application/vnd.ms-opentype":{source:"apache",compressible:!0},"application/vnd.ms-outlook":{compressible:!1,extensions:["msg"]},"application/vnd.ms-package.obfuscated-opentype":{source:"apache"},"application/vnd.ms-pki.seccat":{source:"apache",extensions:["cat"]},"application/vnd.ms-pki.stl":{source:"apache",extensions:["stl"]},"application/vnd.ms-playready.initiator+xml":{source:"iana",compressible:!0},"application/vnd.ms-powerpoint":{source:"iana",compressible:!1,extensions:["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{source:"iana",extensions:["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{source:"iana",extensions:["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{source:"iana",extensions:["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{source:"iana",extensions:["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{source:"iana",extensions:["potm"]},"application/vnd.ms-printdevicecapabilities+xml":{source:"iana",compressible:!0},"application/vnd.ms-printing.printticket+xml":{source:"apache",compressible:!0},"application/vnd.ms-printschematicket+xml":{source:"iana",compressible:!0},"application/vnd.ms-project":{source:"iana",extensions:["mpp","mpt"]},"application/vnd.ms-tnef":{source:"iana"},"application/vnd.ms-windows.devicepairing":{source:"iana"},"application/vnd.ms-windows.nwprinting.oob":{source:"iana"},"application/vnd.ms-windows.printerpairing":{source:"iana"},"application/vnd.ms-windows.wsd.oob":{source:"iana"},"application/vnd.ms-wmdrm.lic-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.lic-resp":{source:"iana"},"application/vnd.ms-wmdrm.meter-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.meter-resp":{source:"iana"},"application/vnd.ms-word.document.macroenabled.12":{source:"iana",extensions:["docm"]},"application/vnd.ms-word.template.macroenabled.12":{source:"iana",extensions:["dotm"]},"application/vnd.ms-works":{source:"iana",extensions:["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{source:"iana",extensions:["wpl"]},"application/vnd.ms-xpsdocument":{source:"iana",compressible:!1,extensions:["xps"]},"application/vnd.msa-disk-image":{source:"iana"},"application/vnd.mseq":{source:"iana",extensions:["mseq"]},"application/vnd.msign":{source:"iana"},"application/vnd.multiad.creator":{source:"iana"},"application/vnd.multiad.creator.cif":{source:"iana"},"application/vnd.music-niff":{source:"iana"},"application/vnd.musician":{source:"iana",extensions:["mus"]},"application/vnd.muvee.style":{source:"iana",extensions:["msty"]},"application/vnd.mynfc":{source:"iana",extensions:["taglet"]},"application/vnd.nacamar.ybrid+json":{source:"iana",compressible:!0},"application/vnd.ncd.control":{source:"iana"},"application/vnd.ncd.reference":{source:"iana"},"application/vnd.nearst.inv+json":{source:"iana",compressible:!0},"application/vnd.nebumind.line":{source:"iana"},"application/vnd.nervana":{source:"iana"},"application/vnd.netfpx":{source:"iana"},"application/vnd.neurolanguage.nlu":{source:"iana",extensions:["nlu"]},"application/vnd.nimn":{source:"iana"},"application/vnd.nintendo.nitro.rom":{source:"iana"},"application/vnd.nintendo.snes.rom":{source:"iana"},"application/vnd.nitf":{source:"iana",extensions:["ntf","nitf"]},"application/vnd.noblenet-directory":{source:"iana",extensions:["nnd"]},"application/vnd.noblenet-sealer":{source:"iana",extensions:["nns"]},"application/vnd.noblenet-web":{source:"iana",extensions:["nnw"]},"application/vnd.nokia.catalogs":{source:"iana"},"application/vnd.nokia.conml+wbxml":{source:"iana"},"application/vnd.nokia.conml+xml":{source:"iana",compressible:!0},"application/vnd.nokia.iptv.config+xml":{source:"iana",compressible:!0},"application/vnd.nokia.isds-radio-presets":{source:"iana"},"application/vnd.nokia.landmark+wbxml":{source:"iana"},"application/vnd.nokia.landmark+xml":{source:"iana",compressible:!0},"application/vnd.nokia.landmarkcollection+xml":{source:"iana",compressible:!0},"application/vnd.nokia.n-gage.ac+xml":{source:"iana",compressible:!0,extensions:["ac"]},"application/vnd.nokia.n-gage.data":{source:"iana",extensions:["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{source:"iana",extensions:["n-gage"]},"application/vnd.nokia.ncd":{source:"iana"},"application/vnd.nokia.pcd+wbxml":{source:"iana"},"application/vnd.nokia.pcd+xml":{source:"iana",compressible:!0},"application/vnd.nokia.radio-preset":{source:"iana",extensions:["rpst"]},"application/vnd.nokia.radio-presets":{source:"iana",extensions:["rpss"]},"application/vnd.novadigm.edm":{source:"iana",extensions:["edm"]},"application/vnd.novadigm.edx":{source:"iana",extensions:["edx"]},"application/vnd.novadigm.ext":{source:"iana",extensions:["ext"]},"application/vnd.ntt-local.content-share":{source:"iana"},"application/vnd.ntt-local.file-transfer":{source:"iana"},"application/vnd.ntt-local.ogw_remote-access":{source:"iana"},"application/vnd.ntt-local.sip-ta_remote":{source:"iana"},"application/vnd.ntt-local.sip-ta_tcp_stream":{source:"iana"},"application/vnd.oasis.opendocument.chart":{source:"iana",extensions:["odc"]},"application/vnd.oasis.opendocument.chart-template":{source:"iana",extensions:["otc"]},"application/vnd.oasis.opendocument.database":{source:"iana",extensions:["odb"]},"application/vnd.oasis.opendocument.formula":{source:"iana",extensions:["odf"]},"application/vnd.oasis.opendocument.formula-template":{source:"iana",extensions:["odft"]},"application/vnd.oasis.opendocument.graphics":{source:"iana",compressible:!1,extensions:["odg"]},"application/vnd.oasis.opendocument.graphics-template":{source:"iana",extensions:["otg"]},"application/vnd.oasis.opendocument.image":{source:"iana",extensions:["odi"]},"application/vnd.oasis.opendocument.image-template":{source:"iana",extensions:["oti"]},"application/vnd.oasis.opendocument.presentation":{source:"iana",compressible:!1,extensions:["odp"]},"application/vnd.oasis.opendocument.presentation-template":{source:"iana",extensions:["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{source:"iana",compressible:!1,extensions:["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{source:"iana",extensions:["ots"]},"application/vnd.oasis.opendocument.text":{source:"iana",compressible:!1,extensions:["odt"]},"application/vnd.oasis.opendocument.text-master":{source:"iana",extensions:["odm"]},"application/vnd.oasis.opendocument.text-template":{source:"iana",extensions:["ott"]},"application/vnd.oasis.opendocument.text-web":{source:"iana",extensions:["oth"]},"application/vnd.obn":{source:"iana"},"application/vnd.ocf+cbor":{source:"iana"},"application/vnd.oci.image.manifest.v1+json":{source:"iana",compressible:!0},"application/vnd.oftn.l10n+json":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessdownload+xml":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessstreaming+xml":{source:"iana",compressible:!0},"application/vnd.oipf.cspg-hexbinary":{source:"iana"},"application/vnd.oipf.dae.svg+xml":{source:"iana",compressible:!0},"application/vnd.oipf.dae.xhtml+xml":{source:"iana",compressible:!0},"application/vnd.oipf.mippvcontrolmessage+xml":{source:"iana",compressible:!0},"application/vnd.oipf.pae.gem":{source:"iana"},"application/vnd.oipf.spdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.oipf.spdlist+xml":{source:"iana",compressible:!0},"application/vnd.oipf.ueprofile+xml":{source:"iana",compressible:!0},"application/vnd.oipf.userprofile+xml":{source:"iana",compressible:!0},"application/vnd.olpc-sugar":{source:"iana",extensions:["xo"]},"application/vnd.oma-scws-config":{source:"iana"},"application/vnd.oma-scws-http-request":{source:"iana"},"application/vnd.oma-scws-http-response":{source:"iana"},"application/vnd.oma.bcast.associated-procedure-parameter+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.drm-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.imd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.ltkm":{source:"iana"},"application/vnd.oma.bcast.notification+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.provisioningtrigger":{source:"iana"},"application/vnd.oma.bcast.sgboot":{source:"iana"},"application/vnd.oma.bcast.sgdd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sgdu":{source:"iana"},"application/vnd.oma.bcast.simple-symbol-container":{source:"iana"},"application/vnd.oma.bcast.smartcard-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sprov+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.stkm":{source:"iana"},"application/vnd.oma.cab-address-book+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-feature-handler+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-pcc+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-subs-invite+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-user-prefs+xml":{source:"iana",compressible:!0},"application/vnd.oma.dcd":{source:"iana"},"application/vnd.oma.dcdc":{source:"iana"},"application/vnd.oma.dd2+xml":{source:"iana",compressible:!0,extensions:["dd2"]},"application/vnd.oma.drm.risd+xml":{source:"iana",compressible:!0},"application/vnd.oma.group-usage-list+xml":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+cbor":{source:"iana"},"application/vnd.oma.lwm2m+json":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+tlv":{source:"iana"},"application/vnd.oma.pal+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.detailed-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.final-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.groups+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.invocation-descriptor+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.optimized-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.push":{source:"iana"},"application/vnd.oma.scidm.messages+xml":{source:"iana",compressible:!0},"application/vnd.oma.xcap-directory+xml":{source:"iana",compressible:!0},"application/vnd.omads-email+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-file+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-folder+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omaloc-supl-init":{source:"iana"},"application/vnd.onepager":{source:"iana"},"application/vnd.onepagertamp":{source:"iana"},"application/vnd.onepagertamx":{source:"iana"},"application/vnd.onepagertat":{source:"iana"},"application/vnd.onepagertatp":{source:"iana"},"application/vnd.onepagertatx":{source:"iana"},"application/vnd.openblox.game+xml":{source:"iana",compressible:!0,extensions:["obgx"]},"application/vnd.openblox.game-binary":{source:"iana"},"application/vnd.openeye.oeb":{source:"iana"},"application/vnd.openofficeorg.extension":{source:"apache",extensions:["oxt"]},"application/vnd.openstreetmap.data+xml":{source:"iana",compressible:!0,extensions:["osm"]},"application/vnd.opentimestamps.ots":{source:"iana"},"application/vnd.openxmlformats-officedocument.custom-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.customxmlproperties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawing+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chart+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramcolors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramdata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramlayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramstyle+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.extended-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.commentauthors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.handoutmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesslide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{source:"iana",compressible:!1,extensions:["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slide":{source:"iana",extensions:["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidelayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidemaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{source:"iana",extensions:["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideupdateinfo+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tablestyles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tags+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.template":{source:"iana",extensions:["potx"]},"application/vnd.openxmlformats-officedocument.presentationml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.viewprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.calcchain+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.externallink+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcachedefinition+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcacherecords+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivottable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.querytable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionheaders+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionlog+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedstrings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{source:"iana",compressible:!1,extensions:["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetmetadata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.tablesinglecells+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{source:"iana",extensions:["xltx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.usernames+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.volatiledependencies+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.theme+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.themeoverride+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.vmldrawing":{source:"iana"},"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{source:"iana",compressible:!1,extensions:["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.fonttable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{source:"iana",extensions:["dotx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.websettings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.core-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.digital-signature-xmlsignature+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.relationships+xml":{source:"iana",compressible:!0},"application/vnd.oracle.resource+json":{source:"iana",compressible:!0},"application/vnd.orange.indata":{source:"iana"},"application/vnd.osa.netdeploy":{source:"iana"},"application/vnd.osgeo.mapguide.package":{source:"iana",extensions:["mgp"]},"application/vnd.osgi.bundle":{source:"iana"},"application/vnd.osgi.dp":{source:"iana",extensions:["dp"]},"application/vnd.osgi.subsystem":{source:"iana",extensions:["esa"]},"application/vnd.otps.ct-kip+xml":{source:"iana",compressible:!0},"application/vnd.oxli.countgraph":{source:"iana"},"application/vnd.pagerduty+json":{source:"iana",compressible:!0},"application/vnd.palm":{source:"iana",extensions:["pdb","pqa","oprc"]},"application/vnd.panoply":{source:"iana"},"application/vnd.paos.xml":{source:"iana"},"application/vnd.patentdive":{source:"iana"},"application/vnd.patientecommsdoc":{source:"iana"},"application/vnd.pawaafile":{source:"iana",extensions:["paw"]},"application/vnd.pcos":{source:"iana"},"application/vnd.pg.format":{source:"iana",extensions:["str"]},"application/vnd.pg.osasli":{source:"iana",extensions:["ei6"]},"application/vnd.piaccess.application-licence":{source:"iana"},"application/vnd.picsel":{source:"iana",extensions:["efif"]},"application/vnd.pmi.widget":{source:"iana",extensions:["wg"]},"application/vnd.poc.group-advertisement+xml":{source:"iana",compressible:!0},"application/vnd.pocketlearn":{source:"iana",extensions:["plf"]},"application/vnd.powerbuilder6":{source:"iana",extensions:["pbd"]},"application/vnd.powerbuilder6-s":{source:"iana"},"application/vnd.powerbuilder7":{source:"iana"},"application/vnd.powerbuilder7-s":{source:"iana"},"application/vnd.powerbuilder75":{source:"iana"},"application/vnd.powerbuilder75-s":{source:"iana"},"application/vnd.preminet":{source:"iana"},"application/vnd.previewsystems.box":{source:"iana",extensions:["box"]},"application/vnd.proteus.magazine":{source:"iana",extensions:["mgz"]},"application/vnd.psfs":{source:"iana"},"application/vnd.publishare-delta-tree":{source:"iana",extensions:["qps"]},"application/vnd.pvi.ptid1":{source:"iana",extensions:["ptid"]},"application/vnd.pwg-multiplexed":{source:"iana"},"application/vnd.pwg-xhtml-print+xml":{source:"iana",compressible:!0},"application/vnd.qualcomm.brew-app-res":{source:"iana"},"application/vnd.quarantainenet":{source:"iana"},"application/vnd.quark.quarkxpress":{source:"iana",extensions:["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.quobject-quoxdocument":{source:"iana"},"application/vnd.radisys.moml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conn+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-stream+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-base+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-detect+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-sendrecv+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-group+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-speech+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-transform+xml":{source:"iana",compressible:!0},"application/vnd.rainstor.data":{source:"iana"},"application/vnd.rapid":{source:"iana"},"application/vnd.rar":{source:"iana",extensions:["rar"]},"application/vnd.realvnc.bed":{source:"iana",extensions:["bed"]},"application/vnd.recordare.musicxml":{source:"iana",extensions:["mxl"]},"application/vnd.recordare.musicxml+xml":{source:"iana",compressible:!0,extensions:["musicxml"]},"application/vnd.renlearn.rlprint":{source:"iana"},"application/vnd.resilient.logic":{source:"iana"},"application/vnd.restful+json":{source:"iana",compressible:!0},"application/vnd.rig.cryptonote":{source:"iana",extensions:["cryptonote"]},"application/vnd.rim.cod":{source:"apache",extensions:["cod"]},"application/vnd.rn-realmedia":{source:"apache",extensions:["rm"]},"application/vnd.rn-realmedia-vbr":{source:"apache",extensions:["rmvb"]},"application/vnd.route66.link66+xml":{source:"iana",compressible:!0,extensions:["link66"]},"application/vnd.rs-274x":{source:"iana"},"application/vnd.ruckus.download":{source:"iana"},"application/vnd.s3sms":{source:"iana"},"application/vnd.sailingtracker.track":{source:"iana",extensions:["st"]},"application/vnd.sar":{source:"iana"},"application/vnd.sbm.cid":{source:"iana"},"application/vnd.sbm.mid2":{source:"iana"},"application/vnd.scribus":{source:"iana"},"application/vnd.sealed.3df":{source:"iana"},"application/vnd.sealed.csf":{source:"iana"},"application/vnd.sealed.doc":{source:"iana"},"application/vnd.sealed.eml":{source:"iana"},"application/vnd.sealed.mht":{source:"iana"},"application/vnd.sealed.net":{source:"iana"},"application/vnd.sealed.ppt":{source:"iana"},"application/vnd.sealed.tiff":{source:"iana"},"application/vnd.sealed.xls":{source:"iana"},"application/vnd.sealedmedia.softseal.html":{source:"iana"},"application/vnd.sealedmedia.softseal.pdf":{source:"iana"},"application/vnd.seemail":{source:"iana",extensions:["see"]},"application/vnd.seis+json":{source:"iana",compressible:!0},"application/vnd.sema":{source:"iana",extensions:["sema"]},"application/vnd.semd":{source:"iana",extensions:["semd"]},"application/vnd.semf":{source:"iana",extensions:["semf"]},"application/vnd.shade-save-file":{source:"iana"},"application/vnd.shana.informed.formdata":{source:"iana",extensions:["ifm"]},"application/vnd.shana.informed.formtemplate":{source:"iana",extensions:["itp"]},"application/vnd.shana.informed.interchange":{source:"iana",extensions:["iif"]},"application/vnd.shana.informed.package":{source:"iana",extensions:["ipk"]},"application/vnd.shootproof+json":{source:"iana",compressible:!0},"application/vnd.shopkick+json":{source:"iana",compressible:!0},"application/vnd.shp":{source:"iana"},"application/vnd.shx":{source:"iana"},"application/vnd.sigrok.session":{source:"iana"},"application/vnd.simtech-mindmapper":{source:"iana",extensions:["twd","twds"]},"application/vnd.siren+json":{source:"iana",compressible:!0},"application/vnd.smaf":{source:"iana",extensions:["mmf"]},"application/vnd.smart.notebook":{source:"iana"},"application/vnd.smart.teacher":{source:"iana",extensions:["teacher"]},"application/vnd.snesdev-page-table":{source:"iana"},"application/vnd.software602.filler.form+xml":{source:"iana",compressible:!0,extensions:["fo"]},"application/vnd.software602.filler.form-xml-zip":{source:"iana"},"application/vnd.solent.sdkm+xml":{source:"iana",compressible:!0,extensions:["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{source:"iana",extensions:["dxp"]},"application/vnd.spotfire.sfs":{source:"iana",extensions:["sfs"]},"application/vnd.sqlite3":{source:"iana"},"application/vnd.sss-cod":{source:"iana"},"application/vnd.sss-dtf":{source:"iana"},"application/vnd.sss-ntf":{source:"iana"},"application/vnd.stardivision.calc":{source:"apache",extensions:["sdc"]},"application/vnd.stardivision.draw":{source:"apache",extensions:["sda"]},"application/vnd.stardivision.impress":{source:"apache",extensions:["sdd"]},"application/vnd.stardivision.math":{source:"apache",extensions:["smf"]},"application/vnd.stardivision.writer":{source:"apache",extensions:["sdw","vor"]},"application/vnd.stardivision.writer-global":{source:"apache",extensions:["sgl"]},"application/vnd.stepmania.package":{source:"iana",extensions:["smzip"]},"application/vnd.stepmania.stepchart":{source:"iana",extensions:["sm"]},"application/vnd.street-stream":{source:"iana"},"application/vnd.sun.wadl+xml":{source:"iana",compressible:!0,extensions:["wadl"]},"application/vnd.sun.xml.calc":{source:"apache",extensions:["sxc"]},"application/vnd.sun.xml.calc.template":{source:"apache",extensions:["stc"]},"application/vnd.sun.xml.draw":{source:"apache",extensions:["sxd"]},"application/vnd.sun.xml.draw.template":{source:"apache",extensions:["std"]},"application/vnd.sun.xml.impress":{source:"apache",extensions:["sxi"]},"application/vnd.sun.xml.impress.template":{source:"apache",extensions:["sti"]},"application/vnd.sun.xml.math":{source:"apache",extensions:["sxm"]},"application/vnd.sun.xml.writer":{source:"apache",extensions:["sxw"]},"application/vnd.sun.xml.writer.global":{source:"apache",extensions:["sxg"]},"application/vnd.sun.xml.writer.template":{source:"apache",extensions:["stw"]},"application/vnd.sus-calendar":{source:"iana",extensions:["sus","susp"]},"application/vnd.svd":{source:"iana",extensions:["svd"]},"application/vnd.swiftview-ics":{source:"iana"},"application/vnd.sycle+xml":{source:"iana",compressible:!0},"application/vnd.syft+json":{source:"iana",compressible:!0},"application/vnd.symbian.install":{source:"apache",extensions:["sis","sisx"]},"application/vnd.syncml+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xsm"]},"application/vnd.syncml.dm+wbxml":{source:"iana",charset:"UTF-8",extensions:["bdm"]},"application/vnd.syncml.dm+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xdm"]},"application/vnd.syncml.dm.notification":{source:"iana"},"application/vnd.syncml.dmddf+wbxml":{source:"iana"},"application/vnd.syncml.dmddf+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["ddf"]},"application/vnd.syncml.dmtnds+wbxml":{source:"iana"},"application/vnd.syncml.dmtnds+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.syncml.ds.notification":{source:"iana"},"application/vnd.tableschema+json":{source:"iana",compressible:!0},"application/vnd.tao.intent-module-archive":{source:"iana",extensions:["tao"]},"application/vnd.tcpdump.pcap":{source:"iana",extensions:["pcap","cap","dmp"]},"application/vnd.think-cell.ppttc+json":{source:"iana",compressible:!0},"application/vnd.tmd.mediaflex.api+xml":{source:"iana",compressible:!0},"application/vnd.tml":{source:"iana"},"application/vnd.tmobile-livetv":{source:"iana",extensions:["tmo"]},"application/vnd.tri.onesource":{source:"iana"},"application/vnd.trid.tpt":{source:"iana",extensions:["tpt"]},"application/vnd.triscape.mxs":{source:"iana",extensions:["mxs"]},"application/vnd.trueapp":{source:"iana",extensions:["tra"]},"application/vnd.truedoc":{source:"iana"},"application/vnd.ubisoft.webplayer":{source:"iana"},"application/vnd.ufdl":{source:"iana",extensions:["ufd","ufdl"]},"application/vnd.uiq.theme":{source:"iana",extensions:["utz"]},"application/vnd.umajin":{source:"iana",extensions:["umj"]},"application/vnd.unity":{source:"iana",extensions:["unityweb"]},"application/vnd.uoml+xml":{source:"iana",compressible:!0,extensions:["uoml"]},"application/vnd.uplanet.alert":{source:"iana"},"application/vnd.uplanet.alert-wbxml":{source:"iana"},"application/vnd.uplanet.bearer-choice":{source:"iana"},"application/vnd.uplanet.bearer-choice-wbxml":{source:"iana"},"application/vnd.uplanet.cacheop":{source:"iana"},"application/vnd.uplanet.cacheop-wbxml":{source:"iana"},"application/vnd.uplanet.channel":{source:"iana"},"application/vnd.uplanet.channel-wbxml":{source:"iana"},"application/vnd.uplanet.list":{source:"iana"},"application/vnd.uplanet.list-wbxml":{source:"iana"},"application/vnd.uplanet.listcmd":{source:"iana"},"application/vnd.uplanet.listcmd-wbxml":{source:"iana"},"application/vnd.uplanet.signal":{source:"iana"},"application/vnd.uri-map":{source:"iana"},"application/vnd.valve.source.material":{source:"iana"},"application/vnd.vcx":{source:"iana",extensions:["vcx"]},"application/vnd.vd-study":{source:"iana"},"application/vnd.vectorworks":{source:"iana"},"application/vnd.vel+json":{source:"iana",compressible:!0},"application/vnd.verimatrix.vcas":{source:"iana"},"application/vnd.veritone.aion+json":{source:"iana",compressible:!0},"application/vnd.veryant.thin":{source:"iana"},"application/vnd.ves.encrypted":{source:"iana"},"application/vnd.vidsoft.vidconference":{source:"iana"},"application/vnd.visio":{source:"iana",extensions:["vsd","vst","vss","vsw"]},"application/vnd.visionary":{source:"iana",extensions:["vis"]},"application/vnd.vividence.scriptfile":{source:"iana"},"application/vnd.vsf":{source:"iana",extensions:["vsf"]},"application/vnd.wap.sic":{source:"iana"},"application/vnd.wap.slc":{source:"iana"},"application/vnd.wap.wbxml":{source:"iana",charset:"UTF-8",extensions:["wbxml"]},"application/vnd.wap.wmlc":{source:"iana",extensions:["wmlc"]},"application/vnd.wap.wmlscriptc":{source:"iana",extensions:["wmlsc"]},"application/vnd.webturbo":{source:"iana",extensions:["wtb"]},"application/vnd.wfa.dpp":{source:"iana"},"application/vnd.wfa.p2p":{source:"iana"},"application/vnd.wfa.wsc":{source:"iana"},"application/vnd.windows.devicepairing":{source:"iana"},"application/vnd.wmc":{source:"iana"},"application/vnd.wmf.bootstrap":{source:"iana"},"application/vnd.wolfram.mathematica":{source:"iana"},"application/vnd.wolfram.mathematica.package":{source:"iana"},"application/vnd.wolfram.player":{source:"iana",extensions:["nbp"]},"application/vnd.wordperfect":{source:"iana",extensions:["wpd"]},"application/vnd.wqd":{source:"iana",extensions:["wqd"]},"application/vnd.wrq-hp3000-labelled":{source:"iana"},"application/vnd.wt.stf":{source:"iana",extensions:["stf"]},"application/vnd.wv.csp+wbxml":{source:"iana"},"application/vnd.wv.csp+xml":{source:"iana",compressible:!0},"application/vnd.wv.ssp+xml":{source:"iana",compressible:!0},"application/vnd.xacml+json":{source:"iana",compressible:!0},"application/vnd.xara":{source:"iana",extensions:["xar"]},"application/vnd.xfdl":{source:"iana",extensions:["xfdl"]},"application/vnd.xfdl.webform":{source:"iana"},"application/vnd.xmi+xml":{source:"iana",compressible:!0},"application/vnd.xmpie.cpkg":{source:"iana"},"application/vnd.xmpie.dpkg":{source:"iana"},"application/vnd.xmpie.plan":{source:"iana"},"application/vnd.xmpie.ppkg":{source:"iana"},"application/vnd.xmpie.xlim":{source:"iana"},"application/vnd.yamaha.hv-dic":{source:"iana",extensions:["hvd"]},"application/vnd.yamaha.hv-script":{source:"iana",extensions:["hvs"]},"application/vnd.yamaha.hv-voice":{source:"iana",extensions:["hvp"]},"application/vnd.yamaha.openscoreformat":{source:"iana",extensions:["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{source:"iana",compressible:!0,extensions:["osfpvg"]},"application/vnd.yamaha.remote-setup":{source:"iana"},"application/vnd.yamaha.smaf-audio":{source:"iana",extensions:["saf"]},"application/vnd.yamaha.smaf-phrase":{source:"iana",extensions:["spf"]},"application/vnd.yamaha.through-ngn":{source:"iana"},"application/vnd.yamaha.tunnel-udpencap":{source:"iana"},"application/vnd.yaoweme":{source:"iana"},"application/vnd.yellowriver-custom-menu":{source:"iana",extensions:["cmp"]},"application/vnd.youtube.yt":{source:"iana"},"application/vnd.zul":{source:"iana",extensions:["zir","zirz"]},"application/vnd.zzazz.deck+xml":{source:"iana",compressible:!0,extensions:["zaz"]},"application/voicexml+xml":{source:"iana",compressible:!0,extensions:["vxml"]},"application/voucher-cms+json":{source:"iana",compressible:!0},"application/vq-rtcpxr":{source:"iana"},"application/wasm":{source:"iana",compressible:!0,extensions:["wasm"]},"application/watcherinfo+xml":{source:"iana",compressible:!0,extensions:["wif"]},"application/webpush-options+json":{source:"iana",compressible:!0},"application/whoispp-query":{source:"iana"},"application/whoispp-response":{source:"iana"},"application/widget":{source:"iana",extensions:["wgt"]},"application/winhlp":{source:"apache",extensions:["hlp"]},"application/wita":{source:"iana"},"application/wordperfect5.1":{source:"iana"},"application/wsdl+xml":{source:"iana",compressible:!0,extensions:["wsdl"]},"application/wspolicy+xml":{source:"iana",compressible:!0,extensions:["wspolicy"]},"application/x-7z-compressed":{source:"apache",compressible:!1,extensions:["7z"]},"application/x-abiword":{source:"apache",extensions:["abw"]},"application/x-ace-compressed":{source:"apache",extensions:["ace"]},"application/x-amf":{source:"apache"},"application/x-apple-diskimage":{source:"apache",extensions:["dmg"]},"application/x-arj":{compressible:!1,extensions:["arj"]},"application/x-authorware-bin":{source:"apache",extensions:["aab","x32","u32","vox"]},"application/x-authorware-map":{source:"apache",extensions:["aam"]},"application/x-authorware-seg":{source:"apache",extensions:["aas"]},"application/x-bcpio":{source:"apache",extensions:["bcpio"]},"application/x-bdoc":{compressible:!1,extensions:["bdoc"]},"application/x-bittorrent":{source:"apache",extensions:["torrent"]},"application/x-blorb":{source:"apache",extensions:["blb","blorb"]},"application/x-bzip":{source:"apache",compressible:!1,extensions:["bz"]},"application/x-bzip2":{source:"apache",compressible:!1,extensions:["bz2","boz"]},"application/x-cbr":{source:"apache",extensions:["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{source:"apache",extensions:["vcd"]},"application/x-cfs-compressed":{source:"apache",extensions:["cfs"]},"application/x-chat":{source:"apache",extensions:["chat"]},"application/x-chess-pgn":{source:"apache",extensions:["pgn"]},"application/x-chrome-extension":{extensions:["crx"]},"application/x-cocoa":{source:"nginx",extensions:["cco"]},"application/x-compress":{source:"apache"},"application/x-conference":{source:"apache",extensions:["nsc"]},"application/x-cpio":{source:"apache",extensions:["cpio"]},"application/x-csh":{source:"apache",extensions:["csh"]},"application/x-deb":{compressible:!1},"application/x-debian-package":{source:"apache",extensions:["deb","udeb"]},"application/x-dgc-compressed":{source:"apache",extensions:["dgc"]},"application/x-director":{source:"apache",extensions:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{source:"apache",extensions:["wad"]},"application/x-dtbncx+xml":{source:"apache",compressible:!0,extensions:["ncx"]},"application/x-dtbook+xml":{source:"apache",compressible:!0,extensions:["dtb"]},"application/x-dtbresource+xml":{source:"apache",compressible:!0,extensions:["res"]},"application/x-dvi":{source:"apache",compressible:!1,extensions:["dvi"]},"application/x-envoy":{source:"apache",extensions:["evy"]},"application/x-eva":{source:"apache",extensions:["eva"]},"application/x-font-bdf":{source:"apache",extensions:["bdf"]},"application/x-font-dos":{source:"apache"},"application/x-font-framemaker":{source:"apache"},"application/x-font-ghostscript":{source:"apache",extensions:["gsf"]},"application/x-font-libgrx":{source:"apache"},"application/x-font-linux-psf":{source:"apache",extensions:["psf"]},"application/x-font-pcf":{source:"apache",extensions:["pcf"]},"application/x-font-snf":{source:"apache",extensions:["snf"]},"application/x-font-speedo":{source:"apache"},"application/x-font-sunos-news":{source:"apache"},"application/x-font-type1":{source:"apache",extensions:["pfa","pfb","pfm","afm"]},"application/x-font-vfont":{source:"apache"},"application/x-freearc":{source:"apache",extensions:["arc"]},"application/x-futuresplash":{source:"apache",extensions:["spl"]},"application/x-gca-compressed":{source:"apache",extensions:["gca"]},"application/x-glulx":{source:"apache",extensions:["ulx"]},"application/x-gnumeric":{source:"apache",extensions:["gnumeric"]},"application/x-gramps-xml":{source:"apache",extensions:["gramps"]},"application/x-gtar":{source:"apache",extensions:["gtar"]},"application/x-gzip":{source:"apache"},"application/x-hdf":{source:"apache",extensions:["hdf"]},"application/x-httpd-php":{compressible:!0,extensions:["php"]},"application/x-install-instructions":{source:"apache",extensions:["install"]},"application/x-iso9660-image":{source:"apache",extensions:["iso"]},"application/x-iwork-keynote-sffkey":{extensions:["key"]},"application/x-iwork-numbers-sffnumbers":{extensions:["numbers"]},"application/x-iwork-pages-sffpages":{extensions:["pages"]},"application/x-java-archive-diff":{source:"nginx",extensions:["jardiff"]},"application/x-java-jnlp-file":{source:"apache",compressible:!1,extensions:["jnlp"]},"application/x-javascript":{compressible:!0},"application/x-keepass2":{extensions:["kdbx"]},"application/x-latex":{source:"apache",compressible:!1,extensions:["latex"]},"application/x-lua-bytecode":{extensions:["luac"]},"application/x-lzh-compressed":{source:"apache",extensions:["lzh","lha"]},"application/x-makeself":{source:"nginx",extensions:["run"]},"application/x-mie":{source:"apache",extensions:["mie"]},"application/x-mobipocket-ebook":{source:"apache",extensions:["prc","mobi"]},"application/x-mpegurl":{compressible:!1},"application/x-ms-application":{source:"apache",extensions:["application"]},"application/x-ms-shortcut":{source:"apache",extensions:["lnk"]},"application/x-ms-wmd":{source:"apache",extensions:["wmd"]},"application/x-ms-wmz":{source:"apache",extensions:["wmz"]},"application/x-ms-xbap":{source:"apache",extensions:["xbap"]},"application/x-msaccess":{source:"apache",extensions:["mdb"]},"application/x-msbinder":{source:"apache",extensions:["obd"]},"application/x-mscardfile":{source:"apache",extensions:["crd"]},"application/x-msclip":{source:"apache",extensions:["clp"]},"application/x-msdos-program":{extensions:["exe"]},"application/x-msdownload":{source:"apache",extensions:["exe","dll","com","bat","msi"]},"application/x-msmediaview":{source:"apache",extensions:["mvb","m13","m14"]},"application/x-msmetafile":{source:"apache",extensions:["wmf","wmz","emf","emz"]},"application/x-msmoney":{source:"apache",extensions:["mny"]},"application/x-mspublisher":{source:"apache",extensions:["pub"]},"application/x-msschedule":{source:"apache",extensions:["scd"]},"application/x-msterminal":{source:"apache",extensions:["trm"]},"application/x-mswrite":{source:"apache",extensions:["wri"]},"application/x-netcdf":{source:"apache",extensions:["nc","cdf"]},"application/x-ns-proxy-autoconfig":{compressible:!0,extensions:["pac"]},"application/x-nzb":{source:"apache",extensions:["nzb"]},"application/x-perl":{source:"nginx",extensions:["pl","pm"]},"application/x-pilot":{source:"nginx",extensions:["prc","pdb"]},"application/x-pkcs12":{source:"apache",compressible:!1,extensions:["p12","pfx"]},"application/x-pkcs7-certificates":{source:"apache",extensions:["p7b","spc"]},"application/x-pkcs7-certreqresp":{source:"apache",extensions:["p7r"]},"application/x-pki-message":{source:"iana"},"application/x-rar-compressed":{source:"apache",compressible:!1,extensions:["rar"]},"application/x-redhat-package-manager":{source:"nginx",extensions:["rpm"]},"application/x-research-info-systems":{source:"apache",extensions:["ris"]},"application/x-sea":{source:"nginx",extensions:["sea"]},"application/x-sh":{source:"apache",compressible:!0,extensions:["sh"]},"application/x-shar":{source:"apache",extensions:["shar"]},"application/x-shockwave-flash":{source:"apache",compressible:!1,extensions:["swf"]},"application/x-silverlight-app":{source:"apache",extensions:["xap"]},"application/x-sql":{source:"apache",extensions:["sql"]},"application/x-stuffit":{source:"apache",compressible:!1,extensions:["sit"]},"application/x-stuffitx":{source:"apache",extensions:["sitx"]},"application/x-subrip":{source:"apache",extensions:["srt"]},"application/x-sv4cpio":{source:"apache",extensions:["sv4cpio"]},"application/x-sv4crc":{source:"apache",extensions:["sv4crc"]},"application/x-t3vm-image":{source:"apache",extensions:["t3"]},"application/x-tads":{source:"apache",extensions:["gam"]},"application/x-tar":{source:"apache",compressible:!0,extensions:["tar"]},"application/x-tcl":{source:"apache",extensions:["tcl","tk"]},"application/x-tex":{source:"apache",extensions:["tex"]},"application/x-tex-tfm":{source:"apache",extensions:["tfm"]},"application/x-texinfo":{source:"apache",extensions:["texinfo","texi"]},"application/x-tgif":{source:"apache",extensions:["obj"]},"application/x-ustar":{source:"apache",extensions:["ustar"]},"application/x-virtualbox-hdd":{compressible:!0,extensions:["hdd"]},"application/x-virtualbox-ova":{compressible:!0,extensions:["ova"]},"application/x-virtualbox-ovf":{compressible:!0,extensions:["ovf"]},"application/x-virtualbox-vbox":{compressible:!0,extensions:["vbox"]},"application/x-virtualbox-vbox-extpack":{compressible:!1,extensions:["vbox-extpack"]},"application/x-virtualbox-vdi":{compressible:!0,extensions:["vdi"]},"application/x-virtualbox-vhd":{compressible:!0,extensions:["vhd"]},"application/x-virtualbox-vmdk":{compressible:!0,extensions:["vmdk"]},"application/x-wais-source":{source:"apache",extensions:["src"]},"application/x-web-app-manifest+json":{compressible:!0,extensions:["webapp"]},"application/x-www-form-urlencoded":{source:"iana",compressible:!0},"application/x-x509-ca-cert":{source:"iana",extensions:["der","crt","pem"]},"application/x-x509-ca-ra-cert":{source:"iana"},"application/x-x509-next-ca-cert":{source:"iana"},"application/x-xfig":{source:"apache",extensions:["fig"]},"application/x-xliff+xml":{source:"apache",compressible:!0,extensions:["xlf"]},"application/x-xpinstall":{source:"apache",compressible:!1,extensions:["xpi"]},"application/x-xz":{source:"apache",extensions:["xz"]},"application/x-zmachine":{source:"apache",extensions:["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/x400-bp":{source:"iana"},"application/xacml+xml":{source:"iana",compressible:!0},"application/xaml+xml":{source:"apache",compressible:!0,extensions:["xaml"]},"application/xcap-att+xml":{source:"iana",compressible:!0,extensions:["xav"]},"application/xcap-caps+xml":{source:"iana",compressible:!0,extensions:["xca"]},"application/xcap-diff+xml":{source:"iana",compressible:!0,extensions:["xdf"]},"application/xcap-el+xml":{source:"iana",compressible:!0,extensions:["xel"]},"application/xcap-error+xml":{source:"iana",compressible:!0},"application/xcap-ns+xml":{source:"iana",compressible:!0,extensions:["xns"]},"application/xcon-conference-info+xml":{source:"iana",compressible:!0},"application/xcon-conference-info-diff+xml":{source:"iana",compressible:!0},"application/xenc+xml":{source:"iana",compressible:!0,extensions:["xenc"]},"application/xhtml+xml":{source:"iana",compressible:!0,extensions:["xhtml","xht"]},"application/xhtml-voice+xml":{source:"apache",compressible:!0},"application/xliff+xml":{source:"iana",compressible:!0,extensions:["xlf"]},"application/xml":{source:"iana",compressible:!0,extensions:["xml","xsl","xsd","rng"]},"application/xml-dtd":{source:"iana",compressible:!0,extensions:["dtd"]},"application/xml-external-parsed-entity":{source:"iana"},"application/xml-patch+xml":{source:"iana",compressible:!0},"application/xmpp+xml":{source:"iana",compressible:!0},"application/xop+xml":{source:"iana",compressible:!0,extensions:["xop"]},"application/xproc+xml":{source:"apache",compressible:!0,extensions:["xpl"]},"application/xslt+xml":{source:"iana",compressible:!0,extensions:["xsl","xslt"]},"application/xspf+xml":{source:"apache",compressible:!0,extensions:["xspf"]},"application/xv+xml":{source:"iana",compressible:!0,extensions:["mxml","xhvml","xvml","xvm"]},"application/yang":{source:"iana",extensions:["yang"]},"application/yang-data+json":{source:"iana",compressible:!0},"application/yang-data+xml":{source:"iana",compressible:!0},"application/yang-patch+json":{source:"iana",compressible:!0},"application/yang-patch+xml":{source:"iana",compressible:!0},"application/yin+xml":{source:"iana",compressible:!0,extensions:["yin"]},"application/zip":{source:"iana",compressible:!1,extensions:["zip"]},"application/zlib":{source:"iana"},"application/zstd":{source:"iana"},"audio/1d-interleaved-parityfec":{source:"iana"},"audio/32kadpcm":{source:"iana"},"audio/3gpp":{source:"iana",compressible:!1,extensions:["3gpp"]},"audio/3gpp2":{source:"iana"},"audio/aac":{source:"iana"},"audio/ac3":{source:"iana"},"audio/adpcm":{source:"apache",extensions:["adp"]},"audio/amr":{source:"iana",extensions:["amr"]},"audio/amr-wb":{source:"iana"},"audio/amr-wb+":{source:"iana"},"audio/aptx":{source:"iana"},"audio/asc":{source:"iana"},"audio/atrac-advanced-lossless":{source:"iana"},"audio/atrac-x":{source:"iana"},"audio/atrac3":{source:"iana"},"audio/basic":{source:"iana",compressible:!1,extensions:["au","snd"]},"audio/bv16":{source:"iana"},"audio/bv32":{source:"iana"},"audio/clearmode":{source:"iana"},"audio/cn":{source:"iana"},"audio/dat12":{source:"iana"},"audio/dls":{source:"iana"},"audio/dsr-es201108":{source:"iana"},"audio/dsr-es202050":{source:"iana"},"audio/dsr-es202211":{source:"iana"},"audio/dsr-es202212":{source:"iana"},"audio/dv":{source:"iana"},"audio/dvi4":{source:"iana"},"audio/eac3":{source:"iana"},"audio/encaprtp":{source:"iana"},"audio/evrc":{source:"iana"},"audio/evrc-qcp":{source:"iana"},"audio/evrc0":{source:"iana"},"audio/evrc1":{source:"iana"},"audio/evrcb":{source:"iana"},"audio/evrcb0":{source:"iana"},"audio/evrcb1":{source:"iana"},"audio/evrcnw":{source:"iana"},"audio/evrcnw0":{source:"iana"},"audio/evrcnw1":{source:"iana"},"audio/evrcwb":{source:"iana"},"audio/evrcwb0":{source:"iana"},"audio/evrcwb1":{source:"iana"},"audio/evs":{source:"iana"},"audio/flexfec":{source:"iana"},"audio/fwdred":{source:"iana"},"audio/g711-0":{source:"iana"},"audio/g719":{source:"iana"},"audio/g722":{source:"iana"},"audio/g7221":{source:"iana"},"audio/g723":{source:"iana"},"audio/g726-16":{source:"iana"},"audio/g726-24":{source:"iana"},"audio/g726-32":{source:"iana"},"audio/g726-40":{source:"iana"},"audio/g728":{source:"iana"},"audio/g729":{source:"iana"},"audio/g7291":{source:"iana"},"audio/g729d":{source:"iana"},"audio/g729e":{source:"iana"},"audio/gsm":{source:"iana"},"audio/gsm-efr":{source:"iana"},"audio/gsm-hr-08":{source:"iana"},"audio/ilbc":{source:"iana"},"audio/ip-mr_v2.5":{source:"iana"},"audio/isac":{source:"apache"},"audio/l16":{source:"iana"},"audio/l20":{source:"iana"},"audio/l24":{source:"iana",compressible:!1},"audio/l8":{source:"iana"},"audio/lpc":{source:"iana"},"audio/melp":{source:"iana"},"audio/melp1200":{source:"iana"},"audio/melp2400":{source:"iana"},"audio/melp600":{source:"iana"},"audio/mhas":{source:"iana"},"audio/midi":{source:"apache",extensions:["mid","midi","kar","rmi"]},"audio/mobile-xmf":{source:"iana",extensions:["mxmf"]},"audio/mp3":{compressible:!1,extensions:["mp3"]},"audio/mp4":{source:"iana",compressible:!1,extensions:["m4a","mp4a"]},"audio/mp4a-latm":{source:"iana"},"audio/mpa":{source:"iana"},"audio/mpa-robust":{source:"iana"},"audio/mpeg":{source:"iana",compressible:!1,extensions:["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/mpeg4-generic":{source:"iana"},"audio/musepack":{source:"apache"},"audio/ogg":{source:"iana",compressible:!1,extensions:["oga","ogg","spx","opus"]},"audio/opus":{source:"iana"},"audio/parityfec":{source:"iana"},"audio/pcma":{source:"iana"},"audio/pcma-wb":{source:"iana"},"audio/pcmu":{source:"iana"},"audio/pcmu-wb":{source:"iana"},"audio/prs.sid":{source:"iana"},"audio/qcelp":{source:"iana"},"audio/raptorfec":{source:"iana"},"audio/red":{source:"iana"},"audio/rtp-enc-aescm128":{source:"iana"},"audio/rtp-midi":{source:"iana"},"audio/rtploopback":{source:"iana"},"audio/rtx":{source:"iana"},"audio/s3m":{source:"apache",extensions:["s3m"]},"audio/scip":{source:"iana"},"audio/silk":{source:"apache",extensions:["sil"]},"audio/smv":{source:"iana"},"audio/smv-qcp":{source:"iana"},"audio/smv0":{source:"iana"},"audio/sofa":{source:"iana"},"audio/sp-midi":{source:"iana"},"audio/speex":{source:"iana"},"audio/t140c":{source:"iana"},"audio/t38":{source:"iana"},"audio/telephone-event":{source:"iana"},"audio/tetra_acelp":{source:"iana"},"audio/tetra_acelp_bb":{source:"iana"},"audio/tone":{source:"iana"},"audio/tsvcis":{source:"iana"},"audio/uemclip":{source:"iana"},"audio/ulpfec":{source:"iana"},"audio/usac":{source:"iana"},"audio/vdvi":{source:"iana"},"audio/vmr-wb":{source:"iana"},"audio/vnd.3gpp.iufp":{source:"iana"},"audio/vnd.4sb":{source:"iana"},"audio/vnd.audiokoz":{source:"iana"},"audio/vnd.celp":{source:"iana"},"audio/vnd.cisco.nse":{source:"iana"},"audio/vnd.cmles.radio-events":{source:"iana"},"audio/vnd.cns.anp1":{source:"iana"},"audio/vnd.cns.inf1":{source:"iana"},"audio/vnd.dece.audio":{source:"iana",extensions:["uva","uvva"]},"audio/vnd.digital-winds":{source:"iana",extensions:["eol"]},"audio/vnd.dlna.adts":{source:"iana"},"audio/vnd.dolby.heaac.1":{source:"iana"},"audio/vnd.dolby.heaac.2":{source:"iana"},"audio/vnd.dolby.mlp":{source:"iana"},"audio/vnd.dolby.mps":{source:"iana"},"audio/vnd.dolby.pl2":{source:"iana"},"audio/vnd.dolby.pl2x":{source:"iana"},"audio/vnd.dolby.pl2z":{source:"iana"},"audio/vnd.dolby.pulse.1":{source:"iana"},"audio/vnd.dra":{source:"iana",extensions:["dra"]},"audio/vnd.dts":{source:"iana",extensions:["dts"]},"audio/vnd.dts.hd":{source:"iana",extensions:["dtshd"]},"audio/vnd.dts.uhd":{source:"iana"},"audio/vnd.dvb.file":{source:"iana"},"audio/vnd.everad.plj":{source:"iana"},"audio/vnd.hns.audio":{source:"iana"},"audio/vnd.lucent.voice":{source:"iana",extensions:["lvp"]},"audio/vnd.ms-playready.media.pya":{source:"iana",extensions:["pya"]},"audio/vnd.nokia.mobile-xmf":{source:"iana"},"audio/vnd.nortel.vbk":{source:"iana"},"audio/vnd.nuera.ecelp4800":{source:"iana",extensions:["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{source:"iana",extensions:["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{source:"iana",extensions:["ecelp9600"]},"audio/vnd.octel.sbc":{source:"iana"},"audio/vnd.presonus.multitrack":{source:"iana"},"audio/vnd.qcelp":{source:"iana"},"audio/vnd.rhetorex.32kadpcm":{source:"iana"},"audio/vnd.rip":{source:"iana",extensions:["rip"]},"audio/vnd.rn-realaudio":{compressible:!1},"audio/vnd.sealedmedia.softseal.mpeg":{source:"iana"},"audio/vnd.vmx.cvsd":{source:"iana"},"audio/vnd.wave":{compressible:!1},"audio/vorbis":{source:"iana",compressible:!1},"audio/vorbis-config":{source:"iana"},"audio/wav":{compressible:!1,extensions:["wav"]},"audio/wave":{compressible:!1,extensions:["wav"]},"audio/webm":{source:"apache",compressible:!1,extensions:["weba"]},"audio/x-aac":{source:"apache",compressible:!1,extensions:["aac"]},"audio/x-aiff":{source:"apache",extensions:["aif","aiff","aifc"]},"audio/x-caf":{source:"apache",compressible:!1,extensions:["caf"]},"audio/x-flac":{source:"apache",extensions:["flac"]},"audio/x-m4a":{source:"nginx",extensions:["m4a"]},"audio/x-matroska":{source:"apache",extensions:["mka"]},"audio/x-mpegurl":{source:"apache",extensions:["m3u"]},"audio/x-ms-wax":{source:"apache",extensions:["wax"]},"audio/x-ms-wma":{source:"apache",extensions:["wma"]},"audio/x-pn-realaudio":{source:"apache",extensions:["ram","ra"]},"audio/x-pn-realaudio-plugin":{source:"apache",extensions:["rmp"]},"audio/x-realaudio":{source:"nginx",extensions:["ra"]},"audio/x-tta":{source:"apache"},"audio/x-wav":{source:"apache",extensions:["wav"]},"audio/xm":{source:"apache",extensions:["xm"]},"chemical/x-cdx":{source:"apache",extensions:["cdx"]},"chemical/x-cif":{source:"apache",extensions:["cif"]},"chemical/x-cmdf":{source:"apache",extensions:["cmdf"]},"chemical/x-cml":{source:"apache",extensions:["cml"]},"chemical/x-csml":{source:"apache",extensions:["csml"]},"chemical/x-pdb":{source:"apache"},"chemical/x-xyz":{source:"apache",extensions:["xyz"]},"font/collection":{source:"iana",extensions:["ttc"]},"font/otf":{source:"iana",compressible:!0,extensions:["otf"]},"font/sfnt":{source:"iana"},"font/ttf":{source:"iana",compressible:!0,extensions:["ttf"]},"font/woff":{source:"iana",extensions:["woff"]},"font/woff2":{source:"iana",extensions:["woff2"]},"image/aces":{source:"iana",extensions:["exr"]},"image/apng":{compressible:!1,extensions:["apng"]},"image/avci":{source:"iana",extensions:["avci"]},"image/avcs":{source:"iana",extensions:["avcs"]},"image/avif":{source:"iana",compressible:!1,extensions:["avif"]},"image/bmp":{source:"iana",compressible:!0,extensions:["bmp"]},"image/cgm":{source:"iana",extensions:["cgm"]},"image/dicom-rle":{source:"iana",extensions:["drle"]},"image/emf":{source:"iana",extensions:["emf"]},"image/fits":{source:"iana",extensions:["fits"]},"image/g3fax":{source:"iana",extensions:["g3"]},"image/gif":{source:"iana",compressible:!1,extensions:["gif"]},"image/heic":{source:"iana",extensions:["heic"]},"image/heic-sequence":{source:"iana",extensions:["heics"]},"image/heif":{source:"iana",extensions:["heif"]},"image/heif-sequence":{source:"iana",extensions:["heifs"]},"image/hej2k":{source:"iana",extensions:["hej2"]},"image/hsj2":{source:"iana",extensions:["hsj2"]},"image/ief":{source:"iana",extensions:["ief"]},"image/jls":{source:"iana",extensions:["jls"]},"image/jp2":{source:"iana",compressible:!1,extensions:["jp2","jpg2"]},"image/jpeg":{source:"iana",compressible:!1,extensions:["jpeg","jpg","jpe"]},"image/jph":{source:"iana",extensions:["jph"]},"image/jphc":{source:"iana",extensions:["jhc"]},"image/jpm":{source:"iana",compressible:!1,extensions:["jpm"]},"image/jpx":{source:"iana",compressible:!1,extensions:["jpx","jpf"]},"image/jxr":{source:"iana",extensions:["jxr"]},"image/jxra":{source:"iana",extensions:["jxra"]},"image/jxrs":{source:"iana",extensions:["jxrs"]},"image/jxs":{source:"iana",extensions:["jxs"]},"image/jxsc":{source:"iana",extensions:["jxsc"]},"image/jxsi":{source:"iana",extensions:["jxsi"]},"image/jxss":{source:"iana",extensions:["jxss"]},"image/ktx":{source:"iana",extensions:["ktx"]},"image/ktx2":{source:"iana",extensions:["ktx2"]},"image/naplps":{source:"iana"},"image/pjpeg":{compressible:!1},"image/png":{source:"iana",compressible:!1,extensions:["png"]},"image/prs.btif":{source:"iana",extensions:["btif"]},"image/prs.pti":{source:"iana",extensions:["pti"]},"image/pwg-raster":{source:"iana"},"image/sgi":{source:"apache",extensions:["sgi"]},"image/svg+xml":{source:"iana",compressible:!0,extensions:["svg","svgz"]},"image/t38":{source:"iana",extensions:["t38"]},"image/tiff":{source:"iana",compressible:!1,extensions:["tif","tiff"]},"image/tiff-fx":{source:"iana",extensions:["tfx"]},"image/vnd.adobe.photoshop":{source:"iana",compressible:!0,extensions:["psd"]},"image/vnd.airzip.accelerator.azv":{source:"iana",extensions:["azv"]},"image/vnd.cns.inf2":{source:"iana"},"image/vnd.dece.graphic":{source:"iana",extensions:["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{source:"iana",extensions:["djvu","djv"]},"image/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"image/vnd.dwg":{source:"iana",extensions:["dwg"]},"image/vnd.dxf":{source:"iana",extensions:["dxf"]},"image/vnd.fastbidsheet":{source:"iana",extensions:["fbs"]},"image/vnd.fpx":{source:"iana",extensions:["fpx"]},"image/vnd.fst":{source:"iana",extensions:["fst"]},"image/vnd.fujixerox.edmics-mmr":{source:"iana",extensions:["mmr"]},"image/vnd.fujixerox.edmics-rlc":{source:"iana",extensions:["rlc"]},"image/vnd.globalgraphics.pgb":{source:"iana"},"image/vnd.microsoft.icon":{source:"iana",compressible:!0,extensions:["ico"]},"image/vnd.mix":{source:"iana"},"image/vnd.mozilla.apng":{source:"iana"},"image/vnd.ms-dds":{compressible:!0,extensions:["dds"]},"image/vnd.ms-modi":{source:"iana",extensions:["mdi"]},"image/vnd.ms-photo":{source:"apache",extensions:["wdp"]},"image/vnd.net-fpx":{source:"iana",extensions:["npx"]},"image/vnd.pco.b16":{source:"iana",extensions:["b16"]},"image/vnd.radiance":{source:"iana"},"image/vnd.sealed.png":{source:"iana"},"image/vnd.sealedmedia.softseal.gif":{source:"iana"},"image/vnd.sealedmedia.softseal.jpg":{source:"iana"},"image/vnd.svf":{source:"iana"},"image/vnd.tencent.tap":{source:"iana",extensions:["tap"]},"image/vnd.valve.source.texture":{source:"iana",extensions:["vtf"]},"image/vnd.wap.wbmp":{source:"iana",extensions:["wbmp"]},"image/vnd.xiff":{source:"iana",extensions:["xif"]},"image/vnd.zbrush.pcx":{source:"iana",extensions:["pcx"]},"image/webp":{source:"apache",extensions:["webp"]},"image/wmf":{source:"iana",extensions:["wmf"]},"image/x-3ds":{source:"apache",extensions:["3ds"]},"image/x-cmu-raster":{source:"apache",extensions:["ras"]},"image/x-cmx":{source:"apache",extensions:["cmx"]},"image/x-freehand":{source:"apache",extensions:["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{source:"apache",compressible:!0,extensions:["ico"]},"image/x-jng":{source:"nginx",extensions:["jng"]},"image/x-mrsid-image":{source:"apache",extensions:["sid"]},"image/x-ms-bmp":{source:"nginx",compressible:!0,extensions:["bmp"]},"image/x-pcx":{source:"apache",extensions:["pcx"]},"image/x-pict":{source:"apache",extensions:["pic","pct"]},"image/x-portable-anymap":{source:"apache",extensions:["pnm"]},"image/x-portable-bitmap":{source:"apache",extensions:["pbm"]},"image/x-portable-graymap":{source:"apache",extensions:["pgm"]},"image/x-portable-pixmap":{source:"apache",extensions:["ppm"]},"image/x-rgb":{source:"apache",extensions:["rgb"]},"image/x-tga":{source:"apache",extensions:["tga"]},"image/x-xbitmap":{source:"apache",extensions:["xbm"]},"image/x-xcf":{compressible:!1},"image/x-xpixmap":{source:"apache",extensions:["xpm"]},"image/x-xwindowdump":{source:"apache",extensions:["xwd"]},"message/cpim":{source:"iana"},"message/delivery-status":{source:"iana"},"message/disposition-notification":{source:"iana",extensions:["disposition-notification"]},"message/external-body":{source:"iana"},"message/feedback-report":{source:"iana"},"message/global":{source:"iana",extensions:["u8msg"]},"message/global-delivery-status":{source:"iana",extensions:["u8dsn"]},"message/global-disposition-notification":{source:"iana",extensions:["u8mdn"]},"message/global-headers":{source:"iana",extensions:["u8hdr"]},"message/http":{source:"iana",compressible:!1},"message/imdn+xml":{source:"iana",compressible:!0},"message/news":{source:"iana"},"message/partial":{source:"iana",compressible:!1},"message/rfc822":{source:"iana",compressible:!0,extensions:["eml","mime"]},"message/s-http":{source:"iana"},"message/sip":{source:"iana"},"message/sipfrag":{source:"iana"},"message/tracking-status":{source:"iana"},"message/vnd.si.simp":{source:"iana"},"message/vnd.wfa.wsc":{source:"iana",extensions:["wsc"]},"model/3mf":{source:"iana",extensions:["3mf"]},"model/e57":{source:"iana"},"model/gltf+json":{source:"iana",compressible:!0,extensions:["gltf"]},"model/gltf-binary":{source:"iana",compressible:!0,extensions:["glb"]},"model/iges":{source:"iana",compressible:!1,extensions:["igs","iges"]},"model/mesh":{source:"iana",compressible:!1,extensions:["msh","mesh","silo"]},"model/mtl":{source:"iana",extensions:["mtl"]},"model/obj":{source:"iana",extensions:["obj"]},"model/step":{source:"iana"},"model/step+xml":{source:"iana",compressible:!0,extensions:["stpx"]},"model/step+zip":{source:"iana",compressible:!1,extensions:["stpz"]},"model/step-xml+zip":{source:"iana",compressible:!1,extensions:["stpxz"]},"model/stl":{source:"iana",extensions:["stl"]},"model/vnd.collada+xml":{source:"iana",compressible:!0,extensions:["dae"]},"model/vnd.dwf":{source:"iana",extensions:["dwf"]},"model/vnd.flatland.3dml":{source:"iana"},"model/vnd.gdl":{source:"iana",extensions:["gdl"]},"model/vnd.gs-gdl":{source:"apache"},"model/vnd.gs.gdl":{source:"iana"},"model/vnd.gtw":{source:"iana",extensions:["gtw"]},"model/vnd.moml+xml":{source:"iana",compressible:!0},"model/vnd.mts":{source:"iana",extensions:["mts"]},"model/vnd.opengex":{source:"iana",extensions:["ogex"]},"model/vnd.parasolid.transmit.binary":{source:"iana",extensions:["x_b"]},"model/vnd.parasolid.transmit.text":{source:"iana",extensions:["x_t"]},"model/vnd.pytha.pyox":{source:"iana"},"model/vnd.rosette.annotated-data-model":{source:"iana"},"model/vnd.sap.vds":{source:"iana",extensions:["vds"]},"model/vnd.usdz+zip":{source:"iana",compressible:!1,extensions:["usdz"]},"model/vnd.valve.source.compiled-map":{source:"iana",extensions:["bsp"]},"model/vnd.vtu":{source:"iana",extensions:["vtu"]},"model/vrml":{source:"iana",compressible:!1,extensions:["wrl","vrml"]},"model/x3d+binary":{source:"apache",compressible:!1,extensions:["x3db","x3dbz"]},"model/x3d+fastinfoset":{source:"iana",extensions:["x3db"]},"model/x3d+vrml":{source:"apache",compressible:!1,extensions:["x3dv","x3dvz"]},"model/x3d+xml":{source:"iana",compressible:!0,extensions:["x3d","x3dz"]},"model/x3d-vrml":{source:"iana",extensions:["x3dv"]},"multipart/alternative":{source:"iana",compressible:!1},"multipart/appledouble":{source:"iana"},"multipart/byteranges":{source:"iana"},"multipart/digest":{source:"iana"},"multipart/encrypted":{source:"iana",compressible:!1},"multipart/form-data":{source:"iana",compressible:!1},"multipart/header-set":{source:"iana"},"multipart/mixed":{source:"iana"},"multipart/multilingual":{source:"iana"},"multipart/parallel":{source:"iana"},"multipart/related":{source:"iana",compressible:!1},"multipart/report":{source:"iana"},"multipart/signed":{source:"iana",compressible:!1},"multipart/vnd.bint.med-plus":{source:"iana"},"multipart/voice-message":{source:"iana"},"multipart/x-mixed-replace":{source:"iana"},"text/1d-interleaved-parityfec":{source:"iana"},"text/cache-manifest":{source:"iana",compressible:!0,extensions:["appcache","manifest"]},"text/calendar":{source:"iana",extensions:["ics","ifb"]},"text/calender":{compressible:!0},"text/cmd":{compressible:!0},"text/coffeescript":{extensions:["coffee","litcoffee"]},"text/cql":{source:"iana"},"text/cql-expression":{source:"iana"},"text/cql-identifier":{source:"iana"},"text/css":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["css"]},"text/csv":{source:"iana",compressible:!0,extensions:["csv"]},"text/csv-schema":{source:"iana"},"text/directory":{source:"iana"},"text/dns":{source:"iana"},"text/ecmascript":{source:"iana"},"text/encaprtp":{source:"iana"},"text/enriched":{source:"iana"},"text/fhirpath":{source:"iana"},"text/flexfec":{source:"iana"},"text/fwdred":{source:"iana"},"text/gff3":{source:"iana"},"text/grammar-ref-list":{source:"iana"},"text/html":{source:"iana",compressible:!0,extensions:["html","htm","shtml"]},"text/jade":{extensions:["jade"]},"text/javascript":{source:"iana",compressible:!0},"text/jcr-cnd":{source:"iana"},"text/jsx":{compressible:!0,extensions:["jsx"]},"text/less":{compressible:!0,extensions:["less"]},"text/markdown":{source:"iana",compressible:!0,extensions:["markdown","md"]},"text/mathml":{source:"nginx",extensions:["mml"]},"text/mdx":{compressible:!0,extensions:["mdx"]},"text/mizar":{source:"iana"},"text/n3":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["n3"]},"text/parameters":{source:"iana",charset:"UTF-8"},"text/parityfec":{source:"iana"},"text/plain":{source:"iana",compressible:!0,extensions:["txt","text","conf","def","list","log","in","ini"]},"text/provenance-notation":{source:"iana",charset:"UTF-8"},"text/prs.fallenstein.rst":{source:"iana"},"text/prs.lines.tag":{source:"iana",extensions:["dsc"]},"text/prs.prop.logic":{source:"iana"},"text/raptorfec":{source:"iana"},"text/red":{source:"iana"},"text/rfc822-headers":{source:"iana"},"text/richtext":{source:"iana",compressible:!0,extensions:["rtx"]},"text/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"text/rtp-enc-aescm128":{source:"iana"},"text/rtploopback":{source:"iana"},"text/rtx":{source:"iana"},"text/sgml":{source:"iana",extensions:["sgml","sgm"]},"text/shaclc":{source:"iana"},"text/shex":{source:"iana",extensions:["shex"]},"text/slim":{extensions:["slim","slm"]},"text/spdx":{source:"iana",extensions:["spdx"]},"text/strings":{source:"iana"},"text/stylus":{extensions:["stylus","styl"]},"text/t140":{source:"iana"},"text/tab-separated-values":{source:"iana",compressible:!0,extensions:["tsv"]},"text/troff":{source:"iana",extensions:["t","tr","roff","man","me","ms"]},"text/turtle":{source:"iana",charset:"UTF-8",extensions:["ttl"]},"text/ulpfec":{source:"iana"},"text/uri-list":{source:"iana",compressible:!0,extensions:["uri","uris","urls"]},"text/vcard":{source:"iana",compressible:!0,extensions:["vcard"]},"text/vnd.a":{source:"iana"},"text/vnd.abc":{source:"iana"},"text/vnd.ascii-art":{source:"iana"},"text/vnd.curl":{source:"iana",extensions:["curl"]},"text/vnd.curl.dcurl":{source:"apache",extensions:["dcurl"]},"text/vnd.curl.mcurl":{source:"apache",extensions:["mcurl"]},"text/vnd.curl.scurl":{source:"apache",extensions:["scurl"]},"text/vnd.debian.copyright":{source:"iana",charset:"UTF-8"},"text/vnd.dmclientscript":{source:"iana"},"text/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"text/vnd.esmertec.theme-descriptor":{source:"iana",charset:"UTF-8"},"text/vnd.familysearch.gedcom":{source:"iana",extensions:["ged"]},"text/vnd.ficlab.flt":{source:"iana"},"text/vnd.fly":{source:"iana",extensions:["fly"]},"text/vnd.fmi.flexstor":{source:"iana",extensions:["flx"]},"text/vnd.gml":{source:"iana"},"text/vnd.graphviz":{source:"iana",extensions:["gv"]},"text/vnd.hans":{source:"iana"},"text/vnd.hgl":{source:"iana"},"text/vnd.in3d.3dml":{source:"iana",extensions:["3dml"]},"text/vnd.in3d.spot":{source:"iana",extensions:["spot"]},"text/vnd.iptc.newsml":{source:"iana"},"text/vnd.iptc.nitf":{source:"iana"},"text/vnd.latex-z":{source:"iana"},"text/vnd.motorola.reflex":{source:"iana"},"text/vnd.ms-mediapackage":{source:"iana"},"text/vnd.net2phone.commcenter.command":{source:"iana"},"text/vnd.radisys.msml-basic-layout":{source:"iana"},"text/vnd.senx.warpscript":{source:"iana"},"text/vnd.si.uricatalogue":{source:"iana"},"text/vnd.sosi":{source:"iana"},"text/vnd.sun.j2me.app-descriptor":{source:"iana",charset:"UTF-8",extensions:["jad"]},"text/vnd.trolltech.linguist":{source:"iana",charset:"UTF-8"},"text/vnd.wap.si":{source:"iana"},"text/vnd.wap.sl":{source:"iana"},"text/vnd.wap.wml":{source:"iana",extensions:["wml"]},"text/vnd.wap.wmlscript":{source:"iana",extensions:["wmls"]},"text/vtt":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["vtt"]},"text/x-asm":{source:"apache",extensions:["s","asm"]},"text/x-c":{source:"apache",extensions:["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{source:"nginx",extensions:["htc"]},"text/x-fortran":{source:"apache",extensions:["f","for","f77","f90"]},"text/x-gwt-rpc":{compressible:!0},"text/x-handlebars-template":{extensions:["hbs"]},"text/x-java-source":{source:"apache",extensions:["java"]},"text/x-jquery-tmpl":{compressible:!0},"text/x-lua":{extensions:["lua"]},"text/x-markdown":{compressible:!0,extensions:["mkd"]},"text/x-nfo":{source:"apache",extensions:["nfo"]},"text/x-opml":{source:"apache",extensions:["opml"]},"text/x-org":{compressible:!0,extensions:["org"]},"text/x-pascal":{source:"apache",extensions:["p","pas"]},"text/x-processing":{compressible:!0,extensions:["pde"]},"text/x-sass":{extensions:["sass"]},"text/x-scss":{extensions:["scss"]},"text/x-setext":{source:"apache",extensions:["etx"]},"text/x-sfv":{source:"apache",extensions:["sfv"]},"text/x-suse-ymp":{compressible:!0,extensions:["ymp"]},"text/x-uuencode":{source:"apache",extensions:["uu"]},"text/x-vcalendar":{source:"apache",extensions:["vcs"]},"text/x-vcard":{source:"apache",extensions:["vcf"]},"text/xml":{source:"iana",compressible:!0,extensions:["xml"]},"text/xml-external-parsed-entity":{source:"iana"},"text/yaml":{compressible:!0,extensions:["yaml","yml"]},"video/1d-interleaved-parityfec":{source:"iana"},"video/3gpp":{source:"iana",extensions:["3gp","3gpp"]},"video/3gpp-tt":{source:"iana"},"video/3gpp2":{source:"iana",extensions:["3g2"]},"video/av1":{source:"iana"},"video/bmpeg":{source:"iana"},"video/bt656":{source:"iana"},"video/celb":{source:"iana"},"video/dv":{source:"iana"},"video/encaprtp":{source:"iana"},"video/ffv1":{source:"iana"},"video/flexfec":{source:"iana"},"video/h261":{source:"iana",extensions:["h261"]},"video/h263":{source:"iana",extensions:["h263"]},"video/h263-1998":{source:"iana"},"video/h263-2000":{source:"iana"},"video/h264":{source:"iana",extensions:["h264"]},"video/h264-rcdo":{source:"iana"},"video/h264-svc":{source:"iana"},"video/h265":{source:"iana"},"video/iso.segment":{source:"iana",extensions:["m4s"]},"video/jpeg":{source:"iana",extensions:["jpgv"]},"video/jpeg2000":{source:"iana"},"video/jpm":{source:"apache",extensions:["jpm","jpgm"]},"video/jxsv":{source:"iana"},"video/mj2":{source:"iana",extensions:["mj2","mjp2"]},"video/mp1s":{source:"iana"},"video/mp2p":{source:"iana"},"video/mp2t":{source:"iana",extensions:["ts"]},"video/mp4":{source:"iana",compressible:!1,extensions:["mp4","mp4v","mpg4"]},"video/mp4v-es":{source:"iana"},"video/mpeg":{source:"iana",compressible:!1,extensions:["mpeg","mpg","mpe","m1v","m2v"]},"video/mpeg4-generic":{source:"iana"},"video/mpv":{source:"iana"},"video/nv":{source:"iana"},"video/ogg":{source:"iana",compressible:!1,extensions:["ogv"]},"video/parityfec":{source:"iana"},"video/pointer":{source:"iana"},"video/quicktime":{source:"iana",compressible:!1,extensions:["qt","mov"]},"video/raptorfec":{source:"iana"},"video/raw":{source:"iana"},"video/rtp-enc-aescm128":{source:"iana"},"video/rtploopback":{source:"iana"},"video/rtx":{source:"iana"},"video/scip":{source:"iana"},"video/smpte291":{source:"iana"},"video/smpte292m":{source:"iana"},"video/ulpfec":{source:"iana"},"video/vc1":{source:"iana"},"video/vc2":{source:"iana"},"video/vnd.cctv":{source:"iana"},"video/vnd.dece.hd":{source:"iana",extensions:["uvh","uvvh"]},"video/vnd.dece.mobile":{source:"iana",extensions:["uvm","uvvm"]},"video/vnd.dece.mp4":{source:"iana"},"video/vnd.dece.pd":{source:"iana",extensions:["uvp","uvvp"]},"video/vnd.dece.sd":{source:"iana",extensions:["uvs","uvvs"]},"video/vnd.dece.video":{source:"iana",extensions:["uvv","uvvv"]},"video/vnd.directv.mpeg":{source:"iana"},"video/vnd.directv.mpeg-tts":{source:"iana"},"video/vnd.dlna.mpeg-tts":{source:"iana"},"video/vnd.dvb.file":{source:"iana",extensions:["dvb"]},"video/vnd.fvt":{source:"iana",extensions:["fvt"]},"video/vnd.hns.video":{source:"iana"},"video/vnd.iptvforum.1dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.1dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.2dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.2dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.ttsavc":{source:"iana"},"video/vnd.iptvforum.ttsmpeg2":{source:"iana"},"video/vnd.motorola.video":{source:"iana"},"video/vnd.motorola.videop":{source:"iana"},"video/vnd.mpegurl":{source:"iana",extensions:["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{source:"iana",extensions:["pyv"]},"video/vnd.nokia.interleaved-multimedia":{source:"iana"},"video/vnd.nokia.mp4vr":{source:"iana"},"video/vnd.nokia.videovoip":{source:"iana"},"video/vnd.objectvideo":{source:"iana"},"video/vnd.radgamettools.bink":{source:"iana"},"video/vnd.radgamettools.smacker":{source:"iana"},"video/vnd.sealed.mpeg1":{source:"iana"},"video/vnd.sealed.mpeg4":{source:"iana"},"video/vnd.sealed.swf":{source:"iana"},"video/vnd.sealedmedia.softseal.mov":{source:"iana"},"video/vnd.uvvu.mp4":{source:"iana",extensions:["uvu","uvvu"]},"video/vnd.vivo":{source:"iana",extensions:["viv"]},"video/vnd.youtube.yt":{source:"iana"},"video/vp8":{source:"iana"},"video/vp9":{source:"iana"},"video/webm":{source:"apache",compressible:!1,extensions:["webm"]},"video/x-f4v":{source:"apache",extensions:["f4v"]},"video/x-fli":{source:"apache",extensions:["fli"]},"video/x-flv":{source:"apache",compressible:!1,extensions:["flv"]},"video/x-m4v":{source:"apache",extensions:["m4v"]},"video/x-matroska":{source:"apache",compressible:!1,extensions:["mkv","mk3d","mks"]},"video/x-mng":{source:"apache",extensions:["mng"]},"video/x-ms-asf":{source:"apache",extensions:["asf","asx"]},"video/x-ms-vob":{source:"apache",extensions:["vob"]},"video/x-ms-wm":{source:"apache",extensions:["wm"]},"video/x-ms-wmv":{source:"apache",compressible:!1,extensions:["wmv"]},"video/x-ms-wmx":{source:"apache",extensions:["wmx"]},"video/x-ms-wvx":{source:"apache",extensions:["wvx"]},"video/x-msvideo":{source:"apache",extensions:["avi"]},"video/x-sgi-movie":{source:"apache",extensions:["movie"]},"video/x-smv":{source:"apache",extensions:["smv"]},"x-conference/x-cooltalk":{source:"apache",extensions:["ice"]},"x-shader/x-fragment":{compressible:!0},"x-shader/x-vertex":{compressible:!0}}},{}],200:[function(e,t,i){t.exports=e("./db.json")},{"./db.json":199}],201:[function(e,t,i){var r,c,l,p=e("mime-db"),s=e("path").extname,n=/^\s*([^;\s]*)(?:;|\s|$)/,a=/^text\//i;function o(e){var t;return!(!e||"string"!=typeof e)&&((t=(e=n.exec(e))&&p[e[1].toLowerCase()])&&t.charset?t.charset:!(!e||!a.test(e[1]))&&"UTF-8")}i.charset=o,i.charsets={lookup:o},i.contentType=function(e){if(!e||"string"!=typeof e)return!1;e=-1===e.indexOf("/")?i.lookup(e):e;if(!e)return!1;{var t;-1===e.indexOf("charset")&&(t=i.charset(e))&&(e+="; charset="+t.toLowerCase())}return e},i.extension=function(e){var t;return!(!e||"string"!=typeof e||(e=n.exec(e),!(t=e&&i.extensions[e[1].toLowerCase()]))||!t.length)&&t[0]},i.extensions=Object.create(null),i.lookup=function(e){return e&&"string"==typeof e&&(e=s("x."+e).toLowerCase().substr(1))&&i.types[e]||!1},i.types=Object.create(null),r=i.extensions,c=i.types,l=["nginx","apache",void 0,"iana"],Object.keys(p).forEach(function(e){var t=p[e],i=t.extensions;if(i&&i.length){r[e]=i;for(var s=0;s<i.length;s++){var n=i[s];if(c[n]){var a=l.indexOf(p[c[n]].source),o=l.indexOf(t.source);if("application/octet-stream"!==c[n]&&(o<a||a===o&&"application/"===c[n].substr(0,12)))continue}c[n]=e}}})},{"mime-db":200,path:void 0}],202:[function(e,t,i){var n=864e5;function a(e,t,i,s){t=1.5*i<=t;return Math.round(e/i)+" "+s+(t?"s":"")}t.exports=function(e,t){t=t||{};var i=typeof e;if(!("string"==i&&0<e.length)){if("number"==i&&isFinite(e))return(t.long?e=>{var t=Math.abs(e);return n<=t?a(e,t,n,"day"):36e5<=t?a(e,t,36e5,"hour"):6e4<=t?a(e,t,6e4,"minute"):1e3<=t?a(e,t,1e3,"second"):e+" ms"}:e=>{var t=Math.abs(e);return n<=t?Math.round(e/n)+"d":36e5<=t?Math.round(e/36e5)+"h":6e4<=t?Math.round(e/6e4)+"m":1e3<=t?Math.round(e/1e3)+"s":e+"ms"})(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}i=e;if(!(100<(i=String(i)).length)){i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(i){var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*n;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*s;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*s;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}},{}],203:[function(e,t,i){var s=e("./lib/charset"),n=e("./lib/encoding"),a=e("./lib/language"),o=e("./lib/mediaType");function r(e){if(!(this instanceof r))return new r(e);this.request=e}t.exports=r,(t.exports.Negotiator=r).prototype.charset=function(e){e=this.charsets(e);return e&&e[0]},r.prototype.charsets=function(e){return s(this.request.headers["accept-charset"],e)},r.prototype.encoding=function(e){e=this.encodings(e);return e&&e[0]},r.prototype.encodings=function(e){return n(this.request.headers["accept-encoding"],e)},r.prototype.language=function(e){e=this.languages(e);return e&&e[0]},r.prototype.languages=function(e){return a(this.request.headers["accept-language"],e)},r.prototype.mediaType=function(e){e=this.mediaTypes(e);return e&&e[0]},r.prototype.mediaTypes=function(e){return o(this.request.headers.accept,e)},r.prototype.preferredCharset=r.prototype.charset,r.prototype.preferredCharsets=r.prototype.charsets,r.prototype.preferredEncoding=r.prototype.encoding,r.prototype.preferredEncodings=r.prototype.encodings,r.prototype.preferredLanguage=r.prototype.language,r.prototype.preferredLanguages=r.prototype.languages,r.prototype.preferredMediaType=r.prototype.mediaType,r.prototype.preferredMediaTypes=r.prototype.mediaTypes},{"./lib/charset":204,"./lib/encoding":205,"./lib/language":206,"./lib/mediaType":207}],204:[function(e,t,i){t.exports=s,t.exports.preferredCharsets=s;var r=/^\s*([^\s;]+)\s*(?:;(.*))?$/;function n(e){for(var t=e.split(","),i=0,s=0;i<t.length;i++){var n=((e,t)=>{if(!(e=r.exec(e)))return null;var i=e[1],s=1;if(e[2])for(var n=e[2].split(";"),a=0;a<n.length;a++){var o=n[a].trim().split("=");if("q"===o[0]){s=parseFloat(o[1]);break}}return{charset:i,q:s,i:t}})(t[i].trim(),i);n&&(t[s++]=n)}return t.length=s,t}function a(e,t,i){for(var s={o:-1,q:0,s:0},n=0;n<t.length;n++){var a=((e,t,i)=>{var s=0;if(t.charset.toLowerCase()===e.toLowerCase())s|=1;else if("*"!==t.charset)return null;return{i:i,o:t.i,q:t.q,s:s}})(e,t[n],i);a&&(s.s-a.s||s.q-a.q||s.o-a.o)<0&&(s=a)}return s}function s(e,t){var i,s=n(void 0===e?"*":e||"");return t?(i=t.map(function(e,t){return a(e,s,t)})).filter(l).sort(o).map(function(e){return t[i.indexOf(e)]}):s.filter(l).sort(o).map(c)}function o(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function c(e){return e.charset}function l(e){return 0<e.q}},{}],205:[function(e,t,i){t.exports=n,t.exports.preferredEncodings=n;var r=/^\s*([^\s;]+)\s*(?:;(.*))?$/;function s(e){for(var t=e.split(","),i=!1,s=1,n=0,a=0;n<t.length;n++){var o=((e,t)=>{if(!(e=r.exec(e)))return null;var i=e[1],s=1;if(e[2])for(var n=e[2].split(";"),a=0;a<n.length;a++){var o=n[a].trim().split("=");if("q"===o[0]){s=parseFloat(o[1]);break}}return{encoding:i,q:s,i:t}})(t[n].trim(),n);o&&(t[a++]=o,i=i||l("identity",o),s=Math.min(s,o.q||1))}return i||(t[a++]={encoding:"identity",q:s,i:n}),t.length=a,t}function l(e,t,i){var s=0;if(t.encoding.toLowerCase()===e.toLowerCase())s|=1;else if("*"!==t.encoding)return null;return{i:i,o:t.i,q:t.q,s:s}}function n(e,t){var i,c=s(e||"");return t?(i=t.map(function(e,t){for(var i=e,s=c,n=t,a={o:-1,q:0,s:0},o=0;o<s.length;o++){var r=l(i,s[o],n);r&&(a.s-r.s||a.q-r.q||a.o-r.o)<0&&(a=r)}return a})).filter(p).sort(a).map(function(e){return t[i.indexOf(e)]}):c.filter(p).sort(a).map(o)}function a(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function o(e){return e.encoding}function p(e){return 0<e.q}},{}],206:[function(e,t,i){t.exports=s,t.exports.preferredLanguages=s;var l=/^\s*([^\s\-;]+)(?:-([^\s;]+))?\s*(?:;(.*))?$/;function o(e,t){e=l.exec(e);if(!e)return null;var i=e[1],s=e[2],n=i,a=(s&&(n+="-"+s),1);if(e[3])for(var o=e[3].split(";"),r=0;r<o.length;r++){var c=o[r].split("=");"q"===c[0]&&(a=parseFloat(c[1]))}return{prefix:i,suffix:s,q:a,i:t,full:n}}function n(e,t,i){for(var s={o:-1,q:0,s:0},n=0;n<t.length;n++){var a=((e,t,i)=>{if(!(e=o(e)))return null;var s=0;if(t.full.toLowerCase()===e.full.toLowerCase())s|=4;else if(t.prefix.toLowerCase()===e.full.toLowerCase())s|=2;else if(t.full.toLowerCase()===e.prefix.toLowerCase())s|=1;else if("*"!==t.full)return null;return{i:i,o:t.i,q:t.q,s:s}})(e,t[n],i);a&&(s.s-a.s||s.q-a.q||s.o-a.o)<0&&(s=a)}return s}function s(e,t){var i,s=(e=>{for(var t=e.split(","),i=0,s=0;i<t.length;i++){var n=o(t[i].trim(),i);n&&(t[s++]=n)}return t.length=s,t})(void 0===e?"*":e||"");return t?(i=t.map(function(e,t){return n(e,s,t)})).filter(c).sort(a).map(function(e){return t[i.indexOf(e)]}):s.filter(c).sort(a).map(r)}function a(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function r(e){return e.full}function c(e){return 0<e.q}},{}],207:[function(e,t,i){t.exports=s,t.exports.preferredMediaTypes=s;var p=/^\s*([^\s\/;]+)\/([^;\s]+)\s*(?:;(.*))?$/;function n(e){for(var t=(e=>{for(var t=e.split(","),i=1,s=0;i<t.length;i++)u(t[s])%2==0?t[++s]=t[i]:t[s]+=","+t[i];return t.length=s+1,t})(e),i=0,s=0;i<t.length;i++){var n=o(t[i].trim(),i);n&&(t[s++]=n)}return t.length=s,t}function o(e,t){e=p.exec(e);if(!e)return null;var i=Object.create(null),s=1,n=e[2],a=e[1];if(e[3])for(var o=(e=>{for(var t=e.split(";"),i=1,s=0;i<t.length;i++)u(t[s])%2==0?t[++s]=t[i]:t[s]+=";"+t[i];for(t.length=s+1,i=0;i<t.length;i++)t[i]=t[i].trim();return t})(e[3]).map(d),r=0;r<o.length;r++){var c=o[r],l=c[0].toLowerCase(),c=c[1],c=c&&'"'===c[0]&&'"'===c[c.length-1]?c.substr(1,c.length-2):c;if("q"===l){s=parseFloat(c);break}i[l]=c}return{type:a,subtype:n,params:i,q:s,i:t}}function a(e,t,i){for(var s={o:-1,q:0,s:0},n=0;n<t.length;n++){var a=((e,t,i)=>{var s=o(e),e=0;if(!s)return null;if(t.type.toLowerCase()==s.type.toLowerCase())e|=4;else if("*"!=t.type)return null;if(t.subtype.toLowerCase()==s.subtype.toLowerCase())e|=2;else if("*"!=t.subtype)return null;var n=Object.keys(t.params);if(0<n.length){if(!n.every(function(e){return"*"==t.params[e]||(t.params[e]||"").toLowerCase()==(s.params[e]||"").toLowerCase()}))return null;e|=1}return{i:i,o:t.i,q:t.q,s:e}})(e,t[n],i);a&&(s.s-a.s||s.q-a.q||s.o-a.o)<0&&(s=a)}return s}function s(e,t){var i,s=n(void 0===e?"*/*":e||"");return t?(i=t.map(function(e,t){return a(e,s,t)})).filter(l).sort(r).map(function(e){return t[i.indexOf(e)]}):s.filter(l).sort(r).map(c)}function r(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function c(e){return e.type+"/"+e.subtype}function l(e){return 0<e.q}function u(e){for(var t=0,i=0;-1!==(i=e.indexOf('"',i));)t++,i++;return t}function d(e){var t,i,s=e.indexOf("=");return-1===s?t=e:(t=e.substr(0,s),i=e.substr(s+1)),[t,i]}},{}],208:[function(e,t,i){var c=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;t.exports=(()=>{try{if(Object.assign){var e=new String("abc");if(e[5]="de","5"!==Object.getOwnPropertyNames(e)[0]){for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;var s,n=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"===n.join(""))return s={},"abcdefghijklmnopqrst".split("").forEach(function(e){s[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},s)).join("")?1:void 0}}}catch(e){}})()?Object.assign:function(e,t){for(var i,s=(e=>{if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)})(e),n=1;n<arguments.length;n++){for(var a in i=Object(arguments[n]))l.call(i,a)&&(s[a]=i[a]);if(c)for(var o=c(i),r=0;r<o.length;r++)p.call(i,o[r])&&(s[o[r]]=i[o[r]])}return s}},{}],209:[function(e,t,i){var e=e("url"),o=e.parse,r=e.Url;function s(e){var t,i=e.url;if(void 0!==i)return a(i,t=e._parsedUrl)?t:((t=n(i))._raw=i,e._parsedUrl=t)}function n(e){if("string"!=typeof e||47!==e.charCodeAt(0))return o(e);for(var t=e,i=null,s=null,n=1;n<e.length;n++)switch(e.charCodeAt(n)){case 63:null===s&&(t=e.substring(0,n),i=e.substring(n+1),s=e.substring(n));break;case 9:case 10:case 12:case 13:case 32:case 35:case 160:case 65279:return o(e)}var a=void 0!==r?new r:{};return a.path=e,a.href=e,a.pathname=t,null!==s&&(a.query=i,a.search=s),a}function a(e,t){return"object"==typeof t&&null!==t&&(void 0===r||t instanceof r)&&t._raw===e}t.exports=s,t.exports.original=function(e){var t=e.originalUrl;if("string"!=typeof t)return s(e);var i=e._parsedOriginalUrl;if(a(t,i))return i;return(i=n(t))._raw=t,e._parsedOriginalUrl=i}},{url:void 0}],210:[function(e,t,i){var s={atype:{NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10},ATTRIBS:{"*::class":9,"*::dir":0,"*::id":4,"*::lang":0,"*::onclick":2,"*::ondblclick":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::style":3,"*::title":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::rel":0,"a::rev":0,"a::shape":0,"a::tabindex":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::tabindex":0,"area::target":10,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::tabindex":0,"button::type":0,"button::value":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"del::cite":1,"del::datetime":0,"dir::compact":0,"div::align":0,"dl::compact":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::ismap":0,"input::maxlength":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::readonly":0,"input::size":0,"input::src":1,"input::tabindex":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"ol::compact":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"p::align":0,"pre::width":0,"q::cite":1,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::size":0,"select::tabindex":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::cols":0,"textarea::disabled":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::readonly":0,"textarea::rows":0,"textarea::tabindex":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"ul::compact":0,"ul::type":0},eflags:{OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128},ELEMENTS:{a:0,abbr:0,acronym:0,address:0,applet:16,area:2,b:0,base:18,basefont:18,bdo:0,big:0,blockquote:0,body:49,br:2,button:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,dd:1,del:0,dfn:0,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,font:0,form:0,frame:18,frameset:16,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:49,hr:2,html:49,i:0,iframe:4,img:2,input:2,ins:0,isindex:18,kbd:0,label:0,legend:0,li:1,link:18,map:0,menu:0,meta:18,noframes:20,noscript:20,object:16,ol:0,optgroup:0,option:1,p:1,param:18,pre:0,q:0,s:0,samp:0,script:84,select:0,small:0,span:0,strike:0,strong:0,style:148,sub:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,title:24,tr:1,tt:0,u:0,ul:0,var:0},URIEFFECTS:{},LOADERTYPES:{}};void 0!==i?(i=void 0!==t&&t.exports?t.exports=s:i).URI=s:"undefined"!=typeof window&&(window.html4=s)},{}],211:[function(e,t,i){a=new RegExp("(/|^)(?:[^./][^/]*|\\.{2,}(?:[^./][^/]*)|\\.{3,}[^/]*)/\\.\\.(?:/|$)"),n=new RegExp(a),r=/^(?:\.\.\/)*(?:\.\.$)?/,f.prototype.toString=function(){var e=[];return null!==this.scheme_&&e.push(this.scheme_,":"),null!==this.domain_&&(e.push("//"),null!==this.credentials_&&e.push(this.credentials_,"@"),e.push(this.domain_),null!==this.port_)&&e.push(":",this.port_.toString()),null!==this.path_&&e.push(this.path_),null!==this.query_&&e.push("?",this.query_),null!==this.fragment_&&e.push("#",this.fragment_),e.join("")},f.prototype.clone=function(){return new f(this.scheme_,this.credentials_,this.domain_,this.port_,this.path_,this.query_,this.fragment_)},f.prototype.getScheme=function(){return this.scheme_&&decodeURIComponent(this.scheme_).toLowerCase()},f.prototype.getRawScheme=function(){return this.scheme_},f.prototype.setScheme=function(e){return this.scheme_=u(e,c),this},f.prototype.setRawScheme=function(e){return this.scheme_=e||null,this},f.prototype.hasScheme=function(){return null!==this.scheme_},f.prototype.getCredentials=function(){return this.credentials_&&decodeURIComponent(this.credentials_)},f.prototype.getRawCredentials=function(){return this.credentials_},f.prototype.setCredentials=function(e){return this.credentials_=u(e,c),this},f.prototype.setRawCredentials=function(e){return this.credentials_=e||null,this},f.prototype.hasCredentials=function(){return null!==this.credentials_},f.prototype.getDomain=function(){return this.domain_&&decodeURIComponent(this.domain_)},f.prototype.getRawDomain=function(){return this.domain_},f.prototype.setDomain=function(e){return this.setRawDomain(e&&encodeURIComponent(e))},f.prototype.setRawDomain=function(e){return this.domain_=e||null,this.setRawPath(this.path_)},f.prototype.hasDomain=function(){return null!==this.domain_},f.prototype.getPort=function(){return this.port_&&decodeURIComponent(this.port_)},f.prototype.setPort=function(e){if(e){if((e=Number(e))!==(65535&e))throw new Error("Bad port number "+e);this.port_=""+e}else this.port_=null;return this},f.prototype.hasPort=function(){return null!==this.port_},f.prototype.getPath=function(){return this.path_&&decodeURIComponent(this.path_)},f.prototype.getRawPath=function(){return this.path_},f.prototype.setPath=function(e){return this.setRawPath(u(e,l))},f.prototype.setRawPath=function(e){return e?(e=String(e),this.path_=!this.domain_||/^\//.test(e)?e:"/"+e):this.path_=null,this},f.prototype.hasPath=function(){return null!==this.path_},f.prototype.getQuery=function(){return this.query_&&decodeURIComponent(this.query_).replace(/\+/g," ")},f.prototype.getRawQuery=function(){return this.query_},f.prototype.setQuery=function(e){return this.paramCache_=null,this.query_=p(e),this},f.prototype.setRawQuery=function(e){return this.paramCache_=null,this.query_=e||null,this},f.prototype.hasQuery=function(){return null!==this.query_},f.prototype.setAllParameters=function(e){if("object"==typeof e&&!(e instanceof Array)&&(e instanceof Object||"[object Array]"!==Object.prototype.toString.call(e))){var t=[],i=-1;for(o in e)"string"==typeof(r=e[o])&&(t[++i]=o,t[++i]=r);e=t}this.paramCache_=null;for(var s=[],n="",a=0;a<e.length;){var o=e[a++],r=e[a++];s.push(n,encodeURIComponent(o.toString())),n="&",r&&s.push("=",encodeURIComponent(r.toString()))}return this.query_=s.join(""),this},f.prototype.checkParameterCache_=function(){if(!this.paramCache_){var e=this.query_;if(e){for(var t=e.split(/[&\?]/),i=[],s=-1,n=0;n<t.length;++n){var a=t[n].match(/^([^=]*)(?:=(.*))?$/);i[++s]=decodeURIComponent(a[1]).replace(/\+/g," "),i[++s]=decodeURIComponent(a[2]||"").replace(/\+/g," ")}this.paramCache_=i}else this.paramCache_=[]}},f.prototype.setParameterValues=function(e,t){"string"==typeof t&&(t=[t]),this.checkParameterCache_();for(var i=0,s=this.paramCache_,n=[],a=0;a<s.length;a+=2)e===s[a]?i<t.length&&n.push(e,t[i++]):n.push(s[a],s[a+1]);for(;i<t.length;)n.push(e,t[i++]);return this.setAllParameters(n),this},f.prototype.removeParameter=function(e){return this.setParameterValues(e,[])},f.prototype.getAllParameters=function(){return this.checkParameterCache_(),this.paramCache_.slice(0,this.paramCache_.length)},f.prototype.getParameterValues=function(e){this.checkParameterCache_();for(var t=[],i=0;i<this.paramCache_.length;i+=2)e===this.paramCache_[i]&&t.push(this.paramCache_[i+1]);return t},f.prototype.getParameterMap=function(e){this.checkParameterCache_();for(var t={},i=0;i<this.paramCache_.length;i+=2){var s=this.paramCache_[i++],n=this.paramCache_[i++];s in t?t[s].push(n):t[s]=[n]}return t},f.prototype.getParameterValue=function(e){this.checkParameterCache_();for(var t=0;t<this.paramCache_.length;t+=2)if(e===this.paramCache_[t])return this.paramCache_[t+1];return null},f.prototype.getFragment=function(){return this.fragment_&&decodeURIComponent(this.fragment_)},f.prototype.getRawFragment=function(){return this.fragment_},f.prototype.setFragment=function(e){return this.fragment_=e?encodeURIComponent(e):null,this},f.prototype.setRawFragment=function(e){return this.fragment_=e||null,this},f.prototype.hasFragment=function(){return null!==this.fragment_},s=new RegExp("^(?:([^:/?#]+):)?(?://(?:([^/?#]*)@)?([^/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),c=/[#\/\?@]/g,l=/[\#\?]/g,f.parse=o,f.create=function(e,t,i,s,n,a,o){return e=new f(u(e,c),u(t,c),p(i),0<s?s.toString():null,u(n,l),null,p(o)),a&&("string"==typeof a?e.setRawQuery(a.replace(/[^?&=0-9A-Za-z_\-~.%]/g,d)):e.setAllParameters(a)),e},f.resolve=m,f.collapse_dots=h,f.utils={mimeTypeOf:function(e){e=o(e);return/\.html$/.test(e.getPath())?"text/html":"application/javascript"},resolve:function(e,t){return e?m(o(e),o(t)).toString():""+t}};var n,r,s,c,l,a=f;function o(e){e=(""+e).match(s);return e?new f(v(e[1]),v(e[2]),v(e[3]),v(e[4]),v(e[5]),v(e[6]),v(e[7])):null}function p(e){return"string"==typeof e?encodeURIComponent(e):null}function u(e,t){return"string"==typeof e?encodeURI(e).replace(t,d):null}function d(e){e=e.charCodeAt(0);return"%"+"0123456789ABCDEF".charAt(e>>4&15)+"0123456789ABCDEF".charAt(15&e)}function h(e){if(null===e)return null;for(var t,i=e.replace(/(^|\/)\.(?:\/|$)/g,"$1").replace(/\/{2,}/g,"/"),s=n;(t=i.replace(s,"$1"))!=i;i=t);return i}function m(e,t){var i,s,e=e.clone(),n=t.hasScheme(),a=(n?e.setRawScheme(t.getRawScheme()):n=t.hasCredentials(),n?e.setRawCredentials(t.getRawCredentials()):n=t.hasDomain(),n?e.setRawDomain(t.getRawDomain()):n=t.hasPort(),t.getRawPath()),o=h(a);return n?(e.setPort(t.getPort()),o=o&&o.replace(r,"")):(n=!!a)?47!==o.charCodeAt(0)&&(i=h(e.getRawPath()||"").replace(r,""),o=h(((s=i.lastIndexOf("/")+1)?i.substring(0,s):"")+h(a)).replace(r,"")):(o=o&&o.replace(r,""))!==a&&e.setRawPath(o),n?e.setRawPath(o):n=t.hasQuery(),n?e.setRawQuery(t.getRawQuery()):n=t.hasFragment(),n&&e.setRawFragment(t.getRawFragment()),e}function f(e,t,i,s,n,a,o){this.scheme_=e,this.credentials_=t,this.domain_=i,this.port_=s,this.path_=n,this.query_=a,this.fragment_=o,this.paramCache_=null}function v(e){return"string"==typeof e&&0<e.length?e:null}void 0!==i?(i=void 0!==t&&t.exports?t.exports=a:i).URI=a:"undefined"!=typeof window&&(window.URI=a)},{}],212:[function(e,t,i){var s=e("./lib/html4.js"),j=e("./lib/uri.js");if("i"!=="I".toLowerCase())throw"I/i problem";m=s,"undefined"!=typeof window&&(d=window.parseCssDeclarations,h=window.sanitizeCssProperty),n={lt:"<",LT:"<",gt:">",GT:">",amp:"&",AMP:"&",quot:'"',apos:"'",nbsp:""},a=/^#(\d+)$/,o=/^#x([0-9A-Fa-f]+)$/,r=/^[A-Za-z][A-za-z0-9]+$/,c="undefined"!=typeof window&&window.document?window.document.createElement("textarea"):null,f=/\0/g,l=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,v=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/,p=/&/g,u=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,y=/[<]/g,g=/>/g,b=/\"/g,x=new RegExp("^\\s*([-.:\\w]+)(?:\\s*(=)\\s*((\")[^\"]*(\"|$)|(')[^']*('|$)|(?=[a-z][-\\w]*\\s*=)|[^\"'\\s]*))?","i"),w=3==="a,b".split(/(,)/).length,E=m.eflags.CDATA|m.eflags.RCDATA,_={},k={},T=/^(?:https?|mailto)$/i,(e={}).escapeAttrib=e.escapeAttrib=O,e.makeHtmlSanitizer=e.makeHtmlSanitizer=B,e.makeSaxParser=e.makeSaxParser=I,e.makeTagPolicy=e.makeTagPolicy=H,e.normalizeRCData=e.normalizeRCData=C,e.sanitize=e.sanitize=function(e,t,i,s){return W(e,H(t,i,s))},e.sanitizeAttribs=e.sanitizeAttribs=F,e.sanitizeWithPolicy=e.sanitizeWithPolicy=W,e.unescapeEntities=e.unescapeEntities=A;var m,d,h,n,a,o,r,c,f,l,v,p,u,y,g,b,x,w,E,_,k,T,S=e;function D(e,t){return t=t,n.hasOwnProperty(t)?n[t]:(i=t.match(a))?String.fromCharCode(parseInt(i[1],10)):(i=t.match(o))?String.fromCharCode(parseInt(i[1],16)):c&&r.test(t)?(c.innerHTML="&"+t+";",i=c.textContent,n[t]=i):"&"+t+";";var i}function A(e){return e&&e.replace(l,D)}function O(e){return e&&(""+e).replace(p,"&amp;").replace(y,"&lt;").replace(g,"&gt;").replace(b,"&#34;")}function C(e){return e&&e.replace(u,"&amp;$1").replace(y,"&lt;").replace(g,"&gt;")}function I(e){var n={cdata:e.cdata,comment:e.comment,endDoc:e.endDoc,endTag:e.endTag,pcdata:e.pcdata,rcdata:e.rcdata,startDoc:e.startDoc,startTag:e.startTag};return function(e,t){var i=e,s=n;i=(e=>{var t,i=/(<\/|<\!--|<[!?]|[&<>])/g;if(e+="",w)return e.split(i);for(var s=[],n=0;null!==(t=i.exec(e));)s.push(e.substring(n,t.index)),s.push(t[0]),n=t.index+t[0].length;return s.push(e.substring(n)),s})(e),R(s,i,0,{noMoreGT:!1,noMoreEndComments:!1},t)}}function P(e,t,i,s,n){return function(){R(e,t,i,s,n)}}function R(e,t,i,s,n){try{var a,o,r;e.startDoc&&0==i&&e.startDoc(n);for(var c=i,l=t.length;c<l;){var p,u,d=t[c++],h=t[c];switch(d){case"&":v.test(h)?(e.pcdata&&e.pcdata("&"+h,n,_,P(e,t,c,s,n)),c++):e.pcdata&&e.pcdata("&amp;",n,_,P(e,t,c,s,n));break;case"</":(a=/^([-\w:]+)[^\'\"]*/.exec(h))?a[0].length===h.length&&">"===t[c+1]?(c+=2,r=a[1].toLowerCase(),e.endTag&&e.endTag(r,n,_,P(e,t,c,s,n))):c=((e,t,i,s,n,a)=>{var o=M(e,t);return o?(i.endTag&&i.endTag(o.name,s,n,P(i,e,t,a,s)),o.next):e.length})(t,c,e,n,_,s):e.pcdata&&e.pcdata("&lt;/",n,_,P(e,t,c,s,n));break;case"<":(a=/^([-\w:]+)\s*\/?/.exec(h))?a[0].length===h.length&&">"===t[c+1]?(c+=2,r=a[1].toLowerCase(),e.startTag&&e.startTag(r,[],n,_,P(e,t,c,s,n)),(p=m.ELEMENTS[r])&E&&(c=N(t,{name:r,next:c,eflags:p},e,n,_,s))):c=((e,t,i,s,n,a)=>(t=M(e,t))?(i.startTag&&i.startTag(t.name,t.attrs,s,n,P(i,e,t.next,a,s)),t.eflags&E?N(e,t,i,s,n,a):t.next):e.length)(t,c,e,n,_,s):e.pcdata&&e.pcdata("&lt;",n,_,P(e,t,c,s,n));break;case"\x3c!--":if(!s.noMoreEndComments){for(o=c+1;o<l&&(">"!==t[o]||!/--$/.test(t[o-1]));o++);o<l?(e.comment&&(u=t.slice(c,o).join(""),e.comment(u.substr(0,u.length-2),n,_,P(e,t,o+1,s,n))),c=o+1):s.noMoreEndComments=!0}s.noMoreEndComments&&e.pcdata&&e.pcdata("&lt;!--",n,_,P(e,t,c,s,n));break;case"<!":if(/^\w/.test(h)){if(!s.noMoreGT){for(o=c+1;o<l&&">"!==t[o];o++);o<l?c=o+1:s.noMoreGT=!0}s.noMoreGT&&e.pcdata&&e.pcdata("&lt;!",n,_,P(e,t,c,s,n))}else e.pcdata&&e.pcdata("&lt;!",n,_,P(e,t,c,s,n));break;case"<?":if(!s.noMoreGT){for(o=c+1;o<l&&">"!==t[o];o++);o<l?c=o+1:s.noMoreGT=!0}s.noMoreGT&&e.pcdata&&e.pcdata("&lt;?",n,_,P(e,t,c,s,n));break;case">":e.pcdata&&e.pcdata("&gt;",n,_,P(e,t,c,s,n));break;case"":break;default:e.pcdata&&e.pcdata(d,n,_,P(e,t,c,s,n))}}e.endDoc&&e.endDoc(n)}catch(e){if(e!==_)throw e}}function N(e,t,i,s,n,a){for(var o=e.length,r=(k.hasOwnProperty(t.name)||(k[t.name]=new RegExp("^"+t.name+"(?:[\\s\\/]|$)","i")),k[t.name]),c=t.next,l=t.next+1;l<o&&("</"!==e[l-1]||!r.test(e[l]));l++);l<o&&--l;c=e.slice(c,l).join("");if(t.eflags&m.eflags.CDATA)i.cdata&&i.cdata(c,s,n,P(i,e,l,a,s));else{if(!(t.eflags&m.eflags.RCDATA))throw new Error("bug");i.rcdata&&i.rcdata(C(c),s,n,P(i,e,l,a,s))}return l}function M(e,t){for(var i=/^([-\w:]+)/.exec(e[t]),s={},n=(s.name=i[1].toLowerCase(),s.eflags=m.ELEMENTS[s.name],e[t].substr(i[0].length)),a=t+1,o=e.length;a<o&&">"!==e[a];a++)n+=e[a];if(!(o<=a)){for(var r=[];""!==n;)if(i=x.exec(n))if(i[4]&&!i[5]||i[6]&&!i[7]){for(var c=i[4]||i[6],l=!1,p=[n,e[a++]];a<o;a++){if(l){if(">"===e[a])break}else 0<=e[a].indexOf(c)&&(l=!0);p.push(e[a])}if(o<=a)break;n=p.join("")}else{var u=i[1].toLowerCase(),d=i[2]?(e=>{var t=e.charCodeAt(0);return A((e=>e.replace(f,""))(e=34!==t&&39!==t?e:e.substr(1,e.length-2)))})(i[3]):"";r.push(u,d),n=n.substr(i[0].length)}else n=n.replace(/^[\s\S][^a-z\s]*/,"");return s.attrs=r,s.next=a+1,s}}function B(u){function e(e,t){h||t.push(e)}var d,h;return I({startDoc:function(e){h=!(d=[])},startTag:function(e,t,i){if(!h&&m.ELEMENTS.hasOwnProperty(e)){var s=m.ELEMENTS[e];if(!(s&m.eflags.FOLDABLE)){var n,a,o=u(e,t);if(o){if("object"!=typeof o)throw new Error("tagPolicy did not return object (old API?)");if(!("attribs"in o))throw new Error("tagPolicy gave no attribs");t=o.attribs,o="tagName"in o?(n=o.tagName,m.ELEMENTS[n]):(n=e,s),s&m.eflags.OPTIONAL_ENDTAG&&(!(a=d[d.length-1])||a.orig!==e||a.rep===n&&e===n||i.push("</",a.rep,">")),s&m.eflags.EMPTY||d.push({orig:e,rep:n}),i.push("<",n);for(var r=0,c=t.length;r<c;r+=2){var l=t[r],p=t[r+1];null!=p&&i.push(" ",l,'="',O(p),'"')}i.push(">"),s&m.eflags.EMPTY&&!(o&m.eflags.EMPTY)&&i.push("</",n,">")}else h=!(s&m.eflags.EMPTY)}}},endTag:function(e,t){if(h)h=!1;else if(m.ELEMENTS.hasOwnProperty(e)){var i,s=m.ELEMENTS[e];if(!(s&(m.eflags.EMPTY|m.eflags.FOLDABLE))){if(s&m.eflags.OPTIONAL_ENDTAG)for(i=d.length;0<=--i;){var n=d[i].orig;if(n===e)break;if(!(m.ELEMENTS[n]&m.eflags.OPTIONAL_ENDTAG))return}else for(i=d.length;0<=--i&&d[i].orig!==e;);if(!(i<0)){for(var a=d.length;--a>i;){var o=d[a].rep;m.ELEMENTS[o]&m.eflags.OPTIONAL_ENDTAG||t.push("</",o,">")}i<d.length&&(e=d[i].rep),d.length=i,t.push("</",e,">")}}}},pcdata:e,rcdata:e,cdata:e,endDoc:function(e){for(;d.length;d.length--)e.push("</",d[d.length-1].rep,">")}})}function U(e,t,i,s,n){if(n)try{var a,o=j.parse(""+e);if(o)if(!o.hasScheme()||T.test(o.getScheme()))return(a=n(o,t,i,s))?a.toString():null}catch(e){}return null}function L(e,t,i,s,n){var a;i||e(t+" removed",{change:"removed",tagName:t}),s!==n&&(a="changed",s&&!n?a="removed":!s&&n&&(a="added"),e(t+"."+i+" "+a,{change:a,tagName:t,attribName:i,oldValue:s,newValue:n}))}function q(e,t,i){t=t+"::"+i;return e.hasOwnProperty(t)||e.hasOwnProperty(t="*::"+i)?e[t]:void 0}function F(e,t,s,i,n){for(var a=0;a<t.length;a+=2){var o,r,c=t[a],l=t[a+1],p=l,u=null;if(null!==(u=m.ATTRIBS.hasOwnProperty(o=e+"::"+c)||m.ATTRIBS.hasOwnProperty(o="*::"+c)?m.ATTRIBS[o]:u))switch(u){case m.atype.NONE:break;case m.atype.SCRIPT:l=null,n&&L(n,e,c,p,l);break;case m.atype.STYLE:void 0===d?(l=null,n&&L(n,e,c,p,l)):(r=[],d(l,{declaration:function(e,t){var i=e.toLowerCase();h(i,t,s?function(e){return U(e,m.ueffects.SAME_DOCUMENT,m.ltypes.SANDBOXED,{TYPE:"CSS",CSS_PROP:i},s)}:null),t.length&&r.push(i+": "+t.join(" "))}}),l=0<r.length?r.join(" ; "):null,n&&L(n,e,c,p,l));break;case m.atype.ID:case m.atype.IDREF:case m.atype.IDREFS:case m.atype.GLOBAL_NAME:case m.atype.LOCAL_NAME:case m.atype.CLASSES:l=i?i(l):l,n&&L(n,e,c,p,l);break;case m.atype.URI:l=U(l,q(m.URIEFFECTS,e,c),q(m.LOADERTYPES,e,c),{TYPE:"MARKUP",XML_ATTR:c,XML_TAG:e},s),n&&L(n,e,c,p,l);break;case m.atype.URI_FRAGMENT:l&&"#"===l.charAt(0)?(l=l.substring(1),null!=(l=i?i(l):l)&&(l="#"+l)):l=null,n&&L(n,e,c,p,l);break;default:l=null,n&&L(n,e,c,p,l)}else l=null,n&&L(n,e,c,p,l);t[a+1]=l}return t}function H(i,s,n){return function(e,t){if(!(m.ELEMENTS[e]&m.eflags.UNSAFE))return{attribs:F(e,t,i,s,n)};n&&L(n,e,void 0,void 0,void 0)}}function W(e,t){var i=[];return B(t)(e,i),i.join("")}s=S.sanitize,"undefined"!=typeof window&&(window.html=S,window.html_sanitize=s),e={};e.escapeAttrib=S.escapeAttrib,e.makeHtmlSanitizer=S.makeHtmlSanitizer,e.makeSaxParser=S.makeSaxParser,e.makeTagPolicy=S.makeTagPolicy,e.normalizeRCData=S.normalizeRCData,e.sanitizeAttribs=S.sanitizeAttribs,e.sanitizeWithPolicy=S.sanitizeWithPolicy,e.unescapeEntities=S.unescapeEntities,e.escape=S.escapeAttrib,e.sanitize=function(e,t,i,s){return(e="string"==typeof e?e.replace(/<([a-zA-Z]+)([^>]*)\/>/g,"<$1$2></$1>"):e)&&S.sanitize(e,t,i,s)},void 0!==i?(i=void 0!==t&&t.exports?t.exports=e:i).Sanitizer=e:this.Sanitizer=e},{"./lib/html4.js":210,"./lib/uri.js":211}],213:[function(e,t,i){let s=Symbol("SemVer ANY");t.exports=class u{static get ANY(){return s}constructor(e,t){if(t=n(t),e instanceof u){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===s?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){var t=this.options.loose?a[o.COMPARATORLOOSE]:a[o.COMPARATOR];if(!(t=e.match(t)))throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==t[1]?t[1]:"","="===this.operator&&(this.operator=""),this.semver=t[2]?new l(t[2],this.options.loose):s}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===s||e===s)return!0;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}return r(e,this.operator,this.semver,this.options)}intersects(e,t){if(e instanceof u)return""===this.operator?""===this.value||new p(e.value,t).test(this.value):""===e.operator?""===e.value||new p(this.value,t).test(e.semver):(!(t=n(t)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&!(!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&!(this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||r(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||r(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")));throw new TypeError("a Comparator is required")}};let n=e("../internal/parse-options"),{safeRe:a,t:o}=e("../internal/re"),r=e("../functions/cmp"),c=e("../internal/debug"),l=e("./semver"),p=e("./range")},{"../functions/cmp":217,"../internal/debug":242,"../internal/parse-options":245,"../internal/re":246,"./range":214,"./semver":215}],214:[function(e,t,i){let s=/\s+/g;t.exports=class P{constructor(e,t){if(t=n(t),e instanceof P)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new P(e.raw,t);if(e instanceof c)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(s," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);if(1<this.set.length)if(t=this.set[0],this.set=this.set.filter(e=>!y(e[0])),0===this.set.length)this.set=[t];else if(1<this.set.length)for(var i of this.set)if(1===i.length&&o(i[0])){this.set=[i];break}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){0<e&&(this.formatted+="||");var t=this.set[e];for(let e=0;e<t.length;e++)0<e&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){var t=((this.options.includePrerelease&&f)|(this.options.loose&&v))+":"+e,i=r.get(t);if(i)return i;var s=(i=this.options.loose)?d[h.HYPHENRANGELOOSE]:d[h.HYPHENRANGE];e=e.replace(s,C(this.options.includePrerelease)),u("hyphen replace",e),e=e.replace(d[h.COMPARATORTRIM],l),u("comparator trim",e),e=e.replace(d[h.TILDETRIM],p),u("tilde trim",e),e=e.replace(d[h.CARETTRIM],m),u("caret trim",e);let n=e.split(" ").map(e=>b(e,this.options)).join(" ").split(/\s+/).map(e=>O(e,this.options));i&&(n=n.filter(e=>(u("loose invalid filter",e,this.options),!!e.match(d[h.COMPARATORLOOSE])))),u("range list",n);var a,o=new Map;for(a of n.map(e=>new c(e,this.options))){if(y(a))return[a];o.set(a.value,a)}return 1<o.size&&o.has("")&&o.delete(""),s=[...o.values()],r.set(t,s),s}intersects(e,i){if(e instanceof P)return this.set.some(t=>g(t,i)&&e.set.some(e=>g(e,i)&&t.every(t=>e.every(e=>t.intersects(e,i)))));throw new TypeError("a Range is required")}test(t){if(t){if("string"==typeof t)try{t=new a(t,this.options)}catch(e){return!1}for(let e=0;e<this.set.length;e++)if(I(this.set[e],t,this.options))return!0}return!1}};let r=new(e("../internal/lrucache")),n=e("../internal/parse-options"),c=e("./comparator"),u=e("../internal/debug"),a=e("./semver"),{safeRe:d,t:h,comparatorTrimReplace:l,tildeTrimReplace:p,caretTrimReplace:m}=e("../internal/re"),{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:v}=e("../internal/constants"),y=e=>"<0.0.0-0"===e.value,o=e=>""===e.value,g=(e,t)=>{let i=!0;var s=e.slice();let n=s.pop();for(;i&&s.length;)i=s.every(e=>n.intersects(e,t)),n=s.pop();return i},b=(e,t)=>(u("comp",e,t),e=_(e,t),u("caret",e),e=w(e,t),u("tildes",e),e=T(e,t),u("xrange",e),e=A(e,t),u("stars",e),e),x=e=>!e||"x"===e.toLowerCase()||"*"===e,w=(e,t)=>e.trim().split(/\s+/).map(e=>E(e,t)).join(" "),E=(o,e)=>{e=e.loose?d[h.TILDELOOSE]:d[h.TILDE];return o.replace(e,(e,t,i,s,n)=>{u("tilde",o,e,t,i,s,n);let a;return a=x(t)?"":x(i)?`>=${t}.0.0 <${+t+1}.0.0-0`:x(s)?`>=${t}.${i}.0 <${t}.${+i+1}.0-0`:n?(u("replaceTilde pr",n),`>=${t}.${i}.${s}-${n} <${t}.${+i+1}.0-0`):`>=${t}.${i}.${s} <${t}.${+i+1}.0-0`,u("tilde return",a),a})},_=(e,t)=>e.trim().split(/\s+/).map(e=>k(e,t)).join(" "),k=(o,e)=>{u("caret",o,e);var t=e.loose?d[h.CARETLOOSE]:d[h.CARET];let r=e.includePrerelease?"-0":"";return o.replace(t,(e,t,i,s,n)=>{u("caret",o,e,t,i,s,n);let a;return a=x(t)?"":x(i)?`>=${t}.0.0${r} <${+t+1}.0.0-0`:x(s)?"0"===t?`>=${t}.${i}.0${r} <${t}.${+i+1}.0-0`:`>=${t}.${i}.0${r} <${+t+1}.0.0-0`:n?(u("replaceCaret pr",n),"0"===t?"0"===i?`>=${t}.${i}.${s}-${n} <${t}.${i}.${+s+1}-0`:`>=${t}.${i}.${s}-${n} <${t}.${+i+1}.0-0`:`>=${t}.${i}.${s}-${n} <${+t+1}.0.0-0`):(u("no pr"),"0"===t?"0"===i?`>=${t}.${i}.${s}${r} <${t}.${i}.${+s+1}-0`:`>=${t}.${i}.${s}${r} <${t}.${+i+1}.0-0`:`>=${t}.${i}.${s} <${+t+1}.0.0-0`),u("caret return",a),a})},T=(e,t)=>(u("replaceXRanges",e,t),e.split(/\s+/).map(e=>S(e,t)).join(" ")),S=(l,p)=>{l=l.trim();var e=p.loose?d[h.XRANGELOOSE]:d[h.XRANGE];return l.replace(e,(e,t,i,s,n,a)=>{u("xRange",l,e,t,i,s,n,a);var o=x(i),r=o||x(s),c=r||x(n);return"="===t&&c&&(t=""),a=p.includePrerelease?"-0":"",o?e=">"===t||"<"===t?"<0.0.0-0":"*":t&&c?(r&&(s=0),n=0,">"===t?(t=">=",n=r?(i=+i+1,s=0):(s=+s+1,0)):"<="===t&&(t="<",r?i=+i+1:s=+s+1),e=t+i+`.${s}.`+n+(a="<"===t?"-0":a)):r?e=`>=${i}.0.0${a} <${+i+1}.0.0-0`:c&&(e=`>=${i}.${s}.0${a} <${i}.${+s+1}.0-0`),u("xRange return",e),e})},A=(e,t)=>(u("replaceStars",e,t),e.trim().replace(d[h.STAR],"")),O=(e,t)=>(u("replaceGTE0",e,t),e.trim().replace(d[t.includePrerelease?h.GTE0PRE:h.GTE0],"")),C=d=>(e,t,i,s,n,a,o,r,c,l,p,u)=>((t=x(i)?"":x(s)?`>=${i}.0.0`+(d?"-0":""):x(n)?`>=${i}.${s}.0`+(d?"-0":""):a?">="+t:">="+t+(d?"-0":""))+" "+(r=x(c)?"":x(l)?`<${+c+1}.0.0-0`:x(p)?`<${c}.${+l+1}.0-0`:u?`<=${c}.${l}.${p}-`+u:d?`<${c}.${l}.${+p+1}-0`:"<="+r)).trim(),I=(t,i,e)=>{for(let e=0;e<t.length;e++)if(!t[e].test(i))return!1;if(!i.prerelease.length||e.includePrerelease)return!0;for(let e=0;e<t.length;e++)if(u(t[e].semver),t[e].semver!==c.ANY&&0<t[e].semver.prerelease.length){var s=t[e].semver;if(s.major===i.major&&s.minor===i.minor&&s.patch===i.patch)return!0}return!1}},{"../internal/constants":241,"../internal/debug":242,"../internal/lrucache":244,"../internal/parse-options":245,"../internal/re":246,"./comparator":213,"./semver":215}],215:[function(e,t,i){let n=e("../internal/debug"),{MAX_LENGTH:s,MAX_SAFE_INTEGER:a}=e("../internal/constants"),{safeRe:o,t:r}=e("../internal/re"),c=e("../internal/parse-options"),l=e("../internal/identifiers").compareIdentifiers;t.exports=class p{constructor(e,t){if(t=c(t),e instanceof p){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>s)throw new TypeError(`version is longer than ${s} characters`);if(n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,!(t=e.trim().match(t.loose?o[r.LOOSE]:o[r.FULL])))throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=t[4]?t[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){var t=+e;if(0<=t&&t<a)return t}return e}):[],this.build=t[5]?t[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.`+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof p)){if("string"==typeof e&&e===this.version)return 0;e=new p(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof p||(e=new p(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof p||(e=new p(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{var i=this.prerelease[t],s=e.prerelease[t];if(n("prerelease compare",t,i,s),void 0===i&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===i)return-1;if(i!==s)return l(i,s)}while(++t)}compareBuild(e){e instanceof p||(e=new p(e,this.options));let t=0;do{var i=this.build[t],s=e.build[t];if(n("build compare",t,i,s),void 0===i&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===i)return-1;if(i!==s)return l(i,s)}while(++t)}inc(e,t,i){if(e.startsWith("pre")){if(!t&&!1===i)throw new Error("invalid increment argument: identifier is empty");if(t){var s=("-"+t).match(this.options.loose?o[r.PRERELEASELOOSE]:o[r.PRERELEASE]);if(!s||s[1]!==t)throw new Error("invalid identifier: "+t)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,i),this.inc("pre",t,i);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,i),this.inc("pre",t,i);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":var n=Number(i)?1:0;if(0===this.prerelease.length)this.prerelease=[n];else{let e=this.prerelease.length;for(;0<=--e;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);if(-1===e){if(t===this.prerelease.join(".")&&!1===i)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(t){let e=!1===i?[t]:[t,n];0===l(this.prerelease[0],t)&&!isNaN(this.prerelease[1])||(this.prerelease=e)}break;default:throw new Error("invalid increment argument: "+e)}return this.raw=this.format(),this.build.length&&(this.raw+="+"+this.build.join(".")),this}}},{"../internal/constants":241,"../internal/debug":242,"../internal/identifiers":243,"../internal/parse-options":245,"../internal/re":246}],216:[function(e,t,i){let s=e("./parse");t.exports=(e,t)=>{e=s(e.trim().replace(/^[=v]+/,""),t);return e?e.version:null}},{"./parse":232}],217:[function(e,t,i){let n=e("./eq"),a=e("./neq"),o=e("./gt"),r=e("./gte"),c=e("./lt"),l=e("./lte");t.exports=(e,t,i,s)=>{switch(t){case"===":return(e="object"==typeof e?e.version:e)===(i="object"==typeof i?i.version:i);case"!==":return(e="object"==typeof e?e.version:e)!==(i="object"==typeof i?i.version:i);case"":case"=":case"==":return n(e,i,s);case"!=":return a(e,i,s);case">":return o(e,i,s);case">=":return r(e,i,s);case"<":return c(e,i,s);case"<=":return l(e,i,s);default:throw new TypeError("Invalid operator: "+t)}}},{"./eq":223,"./gt":224,"./gte":225,"./lt":227,"./lte":228,"./neq":231}],218:[function(e,t,i){let p=e("../classes/semver"),u=e("./parse"),{safeRe:d,t:h}=e("../internal/re");t.exports=(e,t)=>{if(e instanceof p)return e;if("string"!=typeof(e="number"==typeof e?String(e):e))return null;let i=null;if((t=t||{}).rtl){for(var s,n=t.includePrerelease?d[h.COERCERTLFULL]:d[h.COERCERTL];(s=n.exec(e))&&(!i||i.index+i[0].length!==e.length);)i&&s.index+s[0].length===i.index+i[0].length||(i=s),n.lastIndex=s.index+s[1].length+s[2].length;n.lastIndex=-1}else i=e.match(t.includePrerelease?d[h.COERCEFULL]:d[h.COERCE]);var a,o,r,c,l;return null===i?null:(a=i[2],o=i[3]||"0",r=i[4]||"0",c=t.includePrerelease&&i[5]?"-"+i[5]:"",l=t.includePrerelease&&i[6]?"+"+i[6]:"",u(a+`.${o}.`+r+c+l,t))}},{"../classes/semver":215,"../internal/re":246,"./parse":232}],219:[function(e,t,i){let s=e("../classes/semver");t.exports=(e,t,i)=>{e=new s(e,i),t=new s(t,i);return e.compare(t)||e.compareBuild(t)}},{"../classes/semver":215}],220:[function(e,t,i){let s=e("./compare");t.exports=(e,t)=>s(e,t,!0)},{"./compare":221}],221:[function(e,t,i){let s=e("../classes/semver");t.exports=(e,t,i)=>new s(e,i).compare(new s(t,i))},{"../classes/semver":215}],222:[function(e,t,i){let a=e("./parse.js");t.exports=(e,t)=>{var e=a(e,null,!0),t=a(t,null,!0),i=e.compare(t);if(0===i)return null;var i=0<i,s=i?e:t,i=i?t:e,n=!!s.prerelease.length;if(!!i.prerelease.length&&!n){if(!i.patch&&!i.minor)return"major";if(0===i.compareMain(s))return i.minor&&!i.patch?"minor":"patch"}s=n?"pre":"";return e.major!==t.major?s+"major":e.minor!==t.minor?s+"minor":e.patch!==t.patch?s+"patch":"prerelease"}},{"./parse.js":232}],223:[function(e,t,i){let s=e("./compare");t.exports=(e,t,i)=>0===s(e,t,i)},{"./compare":221}],224:[function(e,t,i){let s=e("./compare");t.exports=(e,t,i)=>0<s(e,t,i)},{"./compare":221}],225:[function(e,t,i){let s=e("./compare");t.exports=(e,t,i)=>0<=s(e,t,i)},{"./compare":221}],226:[function(e,t,i){let a=e("../classes/semver");t.exports=(e,t,i,s,n)=>{"string"==typeof i&&(n=s,s=i,i=void 0);try{return new a(e instanceof a?e.version:e,i).inc(t,s,n).version}catch(e){return null}}},{"../classes/semver":215}],227:[function(e,t,i){let s=e("./compare");t.exports=(e,t,i)=>s(e,t,i)<0},{"./compare":221}],228:[function(e,t,i){let s=e("./compare");t.exports=(e,t,i)=>s(e,t,i)<=0},{"./compare":221}],229:[function(e,t,i){let s=e("../classes/semver");t.exports=(e,t)=>new s(e,t).major},{"../classes/semver":215}],230:[function(e,t,i){let s=e("../classes/semver");t.exports=(e,t)=>new s(e,t).minor},{"../classes/semver":215}],231:[function(e,t,i){let s=e("./compare");t.exports=(e,t,i)=>0!==s(e,t,i)},{"./compare":221}],232:[function(e,t,i){let s=e("../classes/semver");t.exports=(e,t,i=!1)=>{if(e instanceof s)return e;try{return new s(e,t)}catch(e){if(i)throw e;return null}}},{"../classes/semver":215}],233:[function(e,t,i){let s=e("../classes/semver");t.exports=(e,t)=>new s(e,t).patch},{"../classes/semver":215}],234:[function(e,t,i){let s=e("./parse");t.exports=(e,t)=>{e=s(e,t);return e&&e.prerelease.length?e.prerelease:null}},{"./parse":232}],235:[function(e,t,i){let s=e("./compare");t.exports=(e,t,i)=>s(t,e,i)},{"./compare":221}],236:[function(e,t,i){let s=e("./compare-build");t.exports=(e,i)=>e.sort((e,t)=>s(t,e,i))},{"./compare-build":219}],237:[function(e,t,i){let s=e("../classes/range");t.exports=(e,t,i)=>{try{t=new s(t,i)}catch(e){return!1}return t.test(e)}},{"../classes/range":214}],238:[function(e,t,i){let s=e("./compare-build");t.exports=(e,i)=>e.sort((e,t)=>s(e,t,i))},{"./compare-build":219}],239:[function(e,t,i){let s=e("./parse");t.exports=(e,t)=>{e=s(e,t);return e?e.version:null}},{"./parse":232}],240:[function(e,t,j){var i=e("./internal/re"),s=e("./internal/constants"),n=e("./classes/semver"),a=e("./internal/identifiers"),o=e("./functions/parse"),r=e("./functions/valid"),c=e("./functions/clean"),l=e("./functions/inc"),p=e("./functions/diff"),u=e("./functions/major"),d=e("./functions/minor"),h=e("./functions/patch"),m=e("./functions/prerelease"),f=e("./functions/compare"),v=e("./functions/rcompare"),y=e("./functions/compare-loose"),g=e("./functions/compare-build"),b=e("./functions/sort"),x=e("./functions/rsort"),w=e("./functions/gt"),E=e("./functions/lt"),_=e("./functions/eq"),k=e("./functions/neq"),T=e("./functions/gte"),S=e("./functions/lte"),A=e("./functions/cmp"),O=e("./functions/coerce"),C=e("./classes/comparator"),I=e("./classes/range"),P=e("./functions/satisfies"),R=e("./ranges/to-comparators"),N=e("./ranges/max-satisfying"),M=e("./ranges/min-satisfying"),L=e("./ranges/min-version"),D=e("./ranges/valid"),B=e("./ranges/outside"),U=e("./ranges/gtr"),q=e("./ranges/ltr"),F=e("./ranges/intersects"),H=e("./ranges/simplify"),e=e("./ranges/subset");t.exports={parse:o,valid:r,clean:c,inc:l,diff:p,major:u,minor:d,patch:h,prerelease:m,compare:f,rcompare:v,compareLoose:y,compareBuild:g,sort:b,rsort:x,gt:w,lt:E,eq:_,neq:k,gte:T,lte:S,cmp:A,coerce:O,Comparator:C,Range:I,satisfies:P,toComparators:R,maxSatisfying:N,minSatisfying:M,minVersion:L,validRange:D,outside:B,gtr:U,ltr:q,intersects:F,simplifyRange:H,subset:e,SemVer:n,re:i.re,src:i.src,tokens:i.t,SEMVER_SPEC_VERSION:s.SEMVER_SPEC_VERSION,RELEASE_TYPES:s.RELEASE_TYPES,compareIdentifiers:a.compareIdentifiers,rcompareIdentifiers:a.rcompareIdentifiers}},{"./classes/comparator":213,"./classes/range":214,"./classes/semver":215,"./functions/clean":216,"./functions/cmp":217,"./functions/coerce":218,"./functions/compare":221,"./functions/compare-build":219,"./functions/compare-loose":220,"./functions/diff":222,"./functions/eq":223,"./functions/gt":224,"./functions/gte":225,"./functions/inc":226,"./functions/lt":227,"./functions/lte":228,"./functions/major":229,"./functions/minor":230,"./functions/neq":231,"./functions/parse":232,"./functions/patch":233,"./functions/prerelease":234,"./functions/rcompare":235,"./functions/rsort":236,"./functions/satisfies":237,"./functions/sort":238,"./functions/valid":239,"./internal/constants":241,"./internal/identifiers":243,"./internal/re":246,"./ranges/gtr":247,"./ranges/intersects":248,"./ranges/ltr":249,"./ranges/max-satisfying":250,"./ranges/min-satisfying":251,"./ranges/min-version":252,"./ranges/outside":253,"./ranges/simplify":254,"./ranges/subset":255,"./ranges/to-comparators":256,"./ranges/valid":257}],241:[function(e,t,i){var s=Number.MAX_SAFE_INTEGER||9007199254740991;t.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:s,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},{}],242:[function(e,t,i){var s="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};t.exports=s},{}],243:[function(e,t,i){let n=/^[0-9]+$/,s=(e,t)=>{var i=n.test(e),s=n.test(t);return i&&s&&(e=+e,t=+t),e===t?0:i&&!s||(!s||i)&&e<t?-1:1};t.exports={compareIdentifiers:s,rcompareIdentifiers:(e,t)=>s(t,e)}},{}],244:[function(e,t,i){t.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){var t=this.map.get(e);if(void 0!==t)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){var i;return this.delete(e)||void 0===t||(this.map.size>=this.max&&(i=this.map.keys().next().value,this.delete(i)),this.map.set(e,t)),this}}},{}],245:[function(e,t,i){let s=Object.freeze({loose:!0}),n=Object.freeze({});t.exports=e=>e?"object"!=typeof e?s:e:n},{}],246:[function(e,t,i){var{MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:a}=e("./constants");let o=e("./debug"),r=(i=t.exports={}).re=[],c=i.safeRe=[],l=i.src=[],p=i.t={},u=0;e="[a-zA-Z0-9-]";let d=[["\\s",1],["\\d",a],[e,n]];t=(e,t,i)=>{var s=(e=>{for(var[t,i]of d)e=e.split(t+"*").join(`${t}{0,${i}}`).split(t+"+").join(`${t}{1,${i}}`);return e})(t),n=u++;o(e,n,t),p[e]=n,l[n]=t,r[n]=new RegExp(t,i?"g":void 0),c[n]=new RegExp(s,i?"g":void 0)};t("NUMERICIDENTIFIER","0|[1-9]\\d*"),t("NUMERICIDENTIFIERLOOSE","\\d+"),t("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${e}*`),t("MAINVERSION",`(${l[p.NUMERICIDENTIFIER]})\\.`+`(${l[p.NUMERICIDENTIFIER]})\\.`+`(${l[p.NUMERICIDENTIFIER]})`),t("MAINVERSIONLOOSE",`(${l[p.NUMERICIDENTIFIERLOOSE]})\\.`+`(${l[p.NUMERICIDENTIFIERLOOSE]})\\.`+`(${l[p.NUMERICIDENTIFIERLOOSE]})`),t("PRERELEASEIDENTIFIER",`(?:${l[p.NUMERICIDENTIFIER]}|${l[p.NONNUMERICIDENTIFIER]})`),t("PRERELEASEIDENTIFIERLOOSE",`(?:${l[p.NUMERICIDENTIFIERLOOSE]}|${l[p.NONNUMERICIDENTIFIER]})`),t("PRERELEASE",`(?:-(${l[p.PRERELEASEIDENTIFIER]}(?:\\.${l[p.PRERELEASEIDENTIFIER]})*))`),t("PRERELEASELOOSE",`(?:-?(${l[p.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[p.PRERELEASEIDENTIFIERLOOSE]})*))`),t("BUILDIDENTIFIER",e+"+"),t("BUILD",`(?:\\+(${l[p.BUILDIDENTIFIER]}(?:\\.${l[p.BUILDIDENTIFIER]})*))`),t("FULLPLAIN",`v?${l[p.MAINVERSION]}${l[p.PRERELEASE]}?${l[p.BUILD]}?`),t("FULL",`^${l[p.FULLPLAIN]}$`),t("LOOSEPLAIN",`[v=\\s]*${l[p.MAINVERSIONLOOSE]}${l[p.PRERELEASELOOSE]}?${l[p.BUILD]}?`),t("LOOSE",`^${l[p.LOOSEPLAIN]}$`),t("GTLT","((?:<|>)?=?)"),t("XRANGEIDENTIFIERLOOSE",l[p.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),t("XRANGEIDENTIFIER",l[p.NUMERICIDENTIFIER]+"|x|X|\\*"),t("XRANGEPLAIN",`[v=\\s]*(${l[p.XRANGEIDENTIFIER]})`+`(?:\\.(${l[p.XRANGEIDENTIFIER]})`+`(?:\\.(${l[p.XRANGEIDENTIFIER]})`+`(?:${l[p.PRERELEASE]})?${l[p.BUILD]}?`+")?)?"),t("XRANGEPLAINLOOSE",`[v=\\s]*(${l[p.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${l[p.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${l[p.XRANGEIDENTIFIERLOOSE]})`+`(?:${l[p.PRERELEASELOOSE]})?${l[p.BUILD]}?`+")?)?"),t("XRANGE",`^${l[p.GTLT]}\\s*${l[p.XRANGEPLAIN]}$`),t("XRANGELOOSE",`^${l[p.GTLT]}\\s*${l[p.XRANGEPLAINLOOSE]}$`),t("COERCEPLAIN",`(^|[^\\d])(\\d{1,${s}})`+`(?:\\.(\\d{1,${s}}))?`+`(?:\\.(\\d{1,${s}}))?`),t("COERCE",l[p.COERCEPLAIN]+"(?:$|[^\\d])"),t("COERCEFULL",l[p.COERCEPLAIN]+`(?:${l[p.PRERELEASE]})?`+`(?:${l[p.BUILD]})?`+"(?:$|[^\\d])"),t("COERCERTL",l[p.COERCE],!0),t("COERCERTLFULL",l[p.COERCEFULL],!0),t("LONETILDE","(?:~>?)"),t("TILDETRIM",`(\\s*)${l[p.LONETILDE]}\\s+`,!0),i.tildeTrimReplace="$1~",t("TILDE",`^${l[p.LONETILDE]}${l[p.XRANGEPLAIN]}$`),t("TILDELOOSE",`^${l[p.LONETILDE]}${l[p.XRANGEPLAINLOOSE]}$`),t("LONECARET","(?:\\^)"),t("CARETTRIM",`(\\s*)${l[p.LONECARET]}\\s+`,!0),i.caretTrimReplace="$1^",t("CARET",`^${l[p.LONECARET]}${l[p.XRANGEPLAIN]}$`),t("CARETLOOSE",`^${l[p.LONECARET]}${l[p.XRANGEPLAINLOOSE]}$`),t("COMPARATORLOOSE",`^${l[p.GTLT]}\\s*(${l[p.LOOSEPLAIN]})$|^$`),t("COMPARATOR",`^${l[p.GTLT]}\\s*(${l[p.FULLPLAIN]})$|^$`),t("COMPARATORTRIM",`(\\s*)${l[p.GTLT]}\\s*(${l[p.LOOSEPLAIN]}|${l[p.XRANGEPLAIN]})`,!0),i.comparatorTrimReplace="$1$2$3",t("HYPHENRANGE",`^\\s*(${l[p.XRANGEPLAIN]})`+"\\s+-\\s+"+`(${l[p.XRANGEPLAIN]})`+"\\s*$"),t("HYPHENRANGELOOSE",`^\\s*(${l[p.XRANGEPLAINLOOSE]})`+"\\s+-\\s+"+`(${l[p.XRANGEPLAINLOOSE]})`+"\\s*$"),t("STAR","(<|>)?=?\\s*\\*"),t("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),t("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},{"./constants":241,"./debug":242}],247:[function(e,t,i){let s=e("./outside");t.exports=(e,t,i)=>s(e,t,">",i)},{"./outside":253}],248:[function(e,t,i){let s=e("../classes/range");t.exports=(e,t,i)=>(e=new s(e,i),t=new s(t,i),e.intersects(t,i))},{"../classes/range":214}],249:[function(e,t,i){let s=e("./outside");t.exports=(e,t,i)=>s(e,t,"<",i)},{"./outside":253}],250:[function(e,t,i){let o=e("../classes/semver"),r=e("../classes/range");t.exports=(e,t,i)=>{let s=null,n=null,a=null;try{a=new r(t,i)}catch(e){return null}return e.forEach(e=>{!a.test(e)||s&&-1!==n.compare(e)||(s=e,n=new o(s,i))}),s}},{"../classes/range":214,"../classes/semver":215}],251:[function(e,t,i){let o=e("../classes/semver"),r=e("../classes/range");t.exports=(e,t,i)=>{let s=null,n=null,a=null;try{a=new r(t,i)}catch(e){return null}return e.forEach(e=>{!a.test(e)||s&&1!==n.compare(e)||(s=e,n=new o(s,i))}),s}},{"../classes/range":214,"../classes/semver":215}],252:[function(e,t,i){let a=e("../classes/semver"),o=e("../classes/range"),r=e("../functions/gt");t.exports=(t,e)=>{t=new o(t,e);let s=new a("0.0.0");if(t.test(s))return s;if(s=new a("0.0.0-0"),t.test(s))return s;s=null;for(let e=0;e<t.set.length;++e){var n=t.set[e];let i=null;n.forEach(e=>{var t=new a(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":i&&!r(t,i)||(i=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}),!i||s&&!r(s,i)||(s=i)}return s&&t.test(s)?s:null}},{"../classes/range":214,"../classes/semver":215,"../functions/gt":224}],253:[function(e,t,i){let d=e("../classes/semver"),h=e("../classes/comparator"),m=h.ANY,f=e("../classes/range"),v=e("../functions/satisfies"),y=e("../functions/gt"),g=e("../functions/lt"),b=e("../functions/lte"),x=e("../functions/gte");t.exports=(s,n,e,a)=>{s=new d(s,a),n=new f(n,a);let o,r,c,l,p;switch(e){case">":o=y,r=b,c=g,l=">",p=">=";break;case"<":o=g,r=x,c=y,l="<",p="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(v(s,n,a))return!1;for(let e=0;e<n.set.length;++e){var u=n.set[e];let t=null,i=null;if(u.forEach(e=>{e.semver===m&&(e=new h(">=0.0.0")),t=t||e,i=i||e,o(e.semver,t.semver,a)?t=e:c(e.semver,i.semver,a)&&(i=e)}),t.operator===l||t.operator===p)return!1;if((!i.operator||i.operator===l)&&r(s,i.semver))return!1;if(i.operator===p&&c(s,i.semver))return!1}return!0}},{"../classes/comparator":213,"../classes/range":214,"../classes/semver":215,"../functions/gt":224,"../functions/gte":225,"../functions/lt":227,"../functions/lte":228,"../functions/satisfies":237}],254:[function(e,t,i){let h=e("../functions/satisfies.js"),m=e("../functions/compare.js");t.exports=(e,t,i)=>{var s=[];let n=null,a=null;var o,r=e.sort((e,t)=>m(e,t,i));for(o of r){var c=h(o,t,i);n=c?(a=o,n||o):(a&&s.push([n,a]),a=null)}n&&s.push([n,null]);var l,p,u=[];for([l,p]of s)l===p?u.push(l):p||l!==r[0]?p?l===r[0]?u.push("<="+p):u.push(l+" - "+p):u.push(">="+l):u.push("*");var e=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return e.length<d.length?e:t}},{"../functions/compare.js":221,"../functions/satisfies.js":237}],255:[function(e,t,i){let o=e("../classes/range.js");var s=e("../classes/comparator.js");let y=s.ANY,g=e("../functions/satisfies.js"),b=e("../functions/compare.js");let x=[new s(">=0.0.0-0")],w=[new s(">=0.0.0")],E=(e,t,i)=>!e||!(0<(i=b(e.semver,t.semver,i)))&&(i<0||">"===t.operator&&">="===e.operator)?t:e,_=(e,t,i)=>!e||!((i=b(e.semver,t.semver,i))<0)&&(0<i||"<"===t.operator&&"<="===e.operator)?t:e;t.exports=(t,i,s={})=>{if(t!==i){t=new o(t,s),i=new o(i,s);let e=!1;e:for(var n of t.set){for(var a of i.set){a=((r,c,l)=>{if(r!==c){if(1===r.length&&r[0].semver===y){if(1===c.length&&c[0].semver===y)return!0;r=l.includePrerelease?x:w}if(1===c.length&&c[0].semver===y){if(l.includePrerelease)return!0;c=w}var p=new Set,u,d,h,m,f;let e,t;for(u of r)">"===u.operator||">="===u.operator?e=E(e,u,l):"<"===u.operator||"<="===u.operator?t=_(t,u,l):p.add(u.semver);if(1<p.size)return null;let i;if(e&&t){if(0<(i=b(e.semver,t.semver,l)))return null;if(0===i&&(">="!==e.operator||"<="!==t.operator))return null}for(d of p){if(e&&!g(d,String(e),l))return null;if(t&&!g(d,String(t),l))return null;for(var v of c)if(!g(d,String(v),l))return!1;return!0}let s,n,a=!(!t||l.includePrerelease||!t.semver.prerelease.length)&&t.semver,o=!(!e||l.includePrerelease||!e.semver.prerelease.length)&&e.semver;a&&1===a.prerelease.length&&"<"===t.operator&&0===a.prerelease[0]&&(a=!1);for(f of c){if(n=n||">"===f.operator||">="===f.operator,s=s||"<"===f.operator||"<="===f.operator,e)if(o&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===o.major&&f.semver.minor===o.minor&&f.semver.patch===o.patch&&(o=!1),">"===f.operator||">="===f.operator){if((h=E(e,f,l))===f&&h!==e)return!1}else if(">="===e.operator&&!g(e.semver,String(f),l))return!1;if(t)if(a&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===a.major&&f.semver.minor===a.minor&&f.semver.patch===a.patch&&(a=!1),"<"===f.operator||"<="===f.operator){if((m=_(t,f,l))===f&&m!==t)return!1}else if("<="===t.operator&&!g(t.semver,String(f),l))return!1;if(!f.operator&&(t||e)&&0!==i)return!1}if(e&&s&&!t&&0!==i)return!1;if(t&&n&&!e&&0!==i)return!1;if(o||a)return!1}return true})(n,a,s);if(e=e||null!==a,a)continue e}if(e)return!1}}return!0}},{"../classes/comparator.js":213,"../classes/range.js":214,"../functions/compare.js":221,"../functions/satisfies.js":237}],256:[function(e,t,i){let s=e("../classes/range");t.exports=(e,t)=>new s(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},{"../classes/range":214}],257:[function(e,t,i){let s=e("../classes/range");t.exports=(e,t)=>{try{return new s(e,t).range||"*"}catch(e){return null}}},{"../classes/range":214}],258:[function(e,t,i){var r,n=this&&this.__rest||function(e,t){var i={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]]);return i},s=(Object.defineProperty(i,"__esModule",{value:!0}),i.ClusterAdapterWithHeartbeat=i.ClusterAdapter=i.MessageType=void 0,e("./in-memory-adapter")),a=e("debug");let o=e("crypto"),c=(0,a.debug)("socket.io-adapter");function l(){return(0,o.randomBytes)(8).toString("hex")}function p(e){return{rooms:[...e.rooms],except:[...e.except],flags:e.flags}}function u(e){return{rooms:new Set(e.rooms),except:new Set(e.except),flags:e.flags}}(e=r=i.MessageType||(i.MessageType={}))[e.INITIAL_HEARTBEAT=1]="INITIAL_HEARTBEAT",e[e.HEARTBEAT=2]="HEARTBEAT",e[e.BROADCAST=3]="BROADCAST",e[e.SOCKETS_JOIN=4]="SOCKETS_JOIN",e[e.SOCKETS_LEAVE=5]="SOCKETS_LEAVE",e[e.DISCONNECT_SOCKETS=6]="DISCONNECT_SOCKETS",e[e.FETCH_SOCKETS=7]="FETCH_SOCKETS",e[e.FETCH_SOCKETS_RESPONSE=8]="FETCH_SOCKETS_RESPONSE",e[e.SERVER_SIDE_EMIT=9]="SERVER_SIDE_EMIT",e[e.SERVER_SIDE_EMIT_RESPONSE=10]="SERVER_SIDE_EMIT_RESPONSE",e[e.BROADCAST_CLIENT_COUNT=11]="BROADCAST_CLIENT_COUNT",e[e.BROADCAST_ACK=12]="BROADCAST_ACK",e[e.ADAPTER_CLOSE=13]="ADAPTER_CLOSE";class d extends s.Adapter{constructor(e){super(e),this.requests=new Map,this.ackRequests=new Map,this.uid=l()}onMessage(i,e){if(i.uid===this.uid)return c("[%s] ignore message from self",this.uid);switch(c("[%s] new event of type %d from %s",this.uid,i.type,i.uid),i.type){case r.BROADCAST:var t;void 0!==i.data.requestId?super.broadcastWithAck(i.data.packet,u(i.data.opts),e=>{c("[%s] waiting for %d client acknowledgements",this.uid,e),this.publishResponse(i.uid,{type:r.BROADCAST_CLIENT_COUNT,data:{requestId:i.data.requestId,clientCount:e}})},e=>{c("[%s] received acknowledgement with value %j",this.uid,e),this.publishResponse(i.uid,{type:r.BROADCAST_ACK,data:{requestId:i.data.requestId,packet:e}})}):(s=i.data.packet,t=u(i.data.opts),this.addOffsetIfNecessary(s,t,e),super.broadcast(s,t));break;case r.SOCKETS_JOIN:super.addSockets(u(i.data.opts),i.data.rooms);break;case r.SOCKETS_LEAVE:super.delSockets(u(i.data.opts),i.data.rooms);break;case r.DISCONNECT_SOCKETS:super.disconnectSockets(u(i.data.opts),i.data.close);break;case r.FETCH_SOCKETS:c("[%s] calling fetchSockets with opts %j",this.uid,i.data.opts),super.fetchSockets(u(i.data.opts)).then(e=>{this.publishResponse(i.uid,{type:r.FETCH_SOCKETS_RESPONSE,data:{requestId:i.data.requestId,sockets:e.map(e=>{var t=e.handshake,{}=t,t=n(t,["sessionStore"]);return{id:e.id,handshake:t,rooms:[...e.rooms],data:e.data}})}})});break;case r.SERVER_SIDE_EMIT:{var s=i.data.packet;if(!(void 0!==i.data.requestId))return void this.nsp._onServerSideEmit(s);let t=!1;this.nsp._onServerSideEmit([...s,e=>{t||(t=!0,c("[%s] calling acknowledgement with %j",this.uid,e),this.publishResponse(i.uid,{type:r.SERVER_SIDE_EMIT_RESPONSE,data:{requestId:i.data.requestId,packet:e}}))}]);break}case r.BROADCAST_CLIENT_COUNT:case r.BROADCAST_ACK:case r.FETCH_SOCKETS_RESPONSE:case r.SERVER_SIDE_EMIT_RESPONSE:this.onResponse(i);break;default:c("[%s] unknown message type: %s",this.uid,i.type)}}onResponse(e){var i=e.data.requestId;switch(c("[%s] received response %s to request %s",this.uid,e.type,i),e.type){case r.BROADCAST_CLIENT_COUNT:null!=(t=this.ackRequests.get(i))&&t.clientCountCallback(e.data.clientCount);break;case r.BROADCAST_ACK:null!=(t=this.ackRequests.get(i))&&t.ack(e.data.packet);break;case r.FETCH_SOCKETS_RESPONSE:{let t=this.requests.get(i);if(!t)return;t.current++,e.data.sockets.forEach(e=>t.responses.push(e)),t.current===t.expected&&(clearTimeout(t.timeout),t.resolve(t.responses),this.requests.delete(i));break}case r.SERVER_SIDE_EMIT_RESPONSE:var t=this.requests.get(i);if(!t)return;t.current++,t.responses.push(e.data.packet),t.current===t.expected&&(clearTimeout(t.timeout),t.resolve(null,t.responses),this.requests.delete(i));break;default:c("[%s] unknown response type: %s",this.uid,e.type)}}async broadcast(e,t){var i;if(!(null==(i=t.flags)?void 0:i.local))try{var s=await this.publishAndReturnOffset({type:r.BROADCAST,data:{packet:e,opts:p(t)}});this.addOffsetIfNecessary(e,t,s)}catch(e){return c("[%s] error while broadcasting message: %s",this.uid,e.message)}super.broadcast(e,t)}addOffsetIfNecessary(e,t,i){var s;this.nsp.server.opts.connectionStateRecovery&&(s=2===e.type,t=void 0===(null==(t=t.flags)?void 0:t.volatile),s)&&void 0===e.id&&t&&e.data.push(i)}broadcastWithAck(t,i,s,n){var e;if(!(null==(e=null==i?void 0:i.flags)?void 0:e.local)){let e=l();this.ackRequests.set(e,{clientCountCallback:s,ack:n}),this.publish({type:r.BROADCAST,data:{packet:t,requestId:e,opts:p(i)}}),setTimeout(()=>{this.ackRequests.delete(e)},i.flags.timeout)}super.broadcastWithAck(t,i,s,n)}async addSockets(e,t){var i;if(!(null==(i=e.flags)?void 0:i.local))try{await this.publishAndReturnOffset({type:r.SOCKETS_JOIN,data:{opts:p(e),rooms:t}})}catch(e){c("[%s] error while publishing message: %s",this.uid,e.message)}super.addSockets(e,t)}async delSockets(e,t){var i;if(!(null==(i=e.flags)?void 0:i.local))try{await this.publishAndReturnOffset({type:r.SOCKETS_LEAVE,data:{opts:p(e),rooms:t}})}catch(e){c("[%s] error while publishing message: %s",this.uid,e.message)}super.delSockets(e,t)}async disconnectSockets(e,t){var i;if(!(null==(i=e.flags)?void 0:i.local))try{await this.publishAndReturnOffset({type:r.DISCONNECT_SOCKETS,data:{opts:p(e),close:t}})}catch(e){c("[%s] error while publishing message: %s",this.uid,e.message)}super.disconnectSockets(e,t)}async fetchSockets(s){let e,[n,t]=await Promise.all([super.fetchSockets(s),this.serverCount()]),a=t-1;if(null!=(e=s.flags)&&e.local||a<=0)return n;let o=l();return new Promise((e,t)=>{var i=setTimeout(()=>{var e=this.requests.get(o);e&&(t(new Error(`timeout reached: only ${e.current} responses received out of `+e.expected)),this.requests.delete(o))},s.flags.timeout||5e3),e={type:r.FETCH_SOCKETS,resolve:e,timeout:i,current:0,expected:a,responses:n};this.requests.set(o,e),this.publish({type:r.FETCH_SOCKETS,data:{opts:p(s),requestId:o}})})}async serverSideEmit(e){if(!("function"==typeof e[e.length-1]))return this.publish({type:r.SERVER_SIDE_EMIT,data:{packet:e}});let t=e.pop();var i=await this.serverCount()-1;if(c('[%s] waiting for %d responses to "serverSideEmit" request',this.uid,i),i<=0)return t(null,[]);let s=l();var n=setTimeout(()=>{var e=this.requests.get(s);e&&(t(new Error(`timeout reached: only ${e.current} responses received out of `+e.expected),e.responses),this.requests.delete(s))},5e3),n={type:r.SERVER_SIDE_EMIT,resolve:t,timeout:n,current:0,expected:i,responses:[]};this.requests.set(s,n),this.publish({type:r.SERVER_SIDE_EMIT,data:{requestId:s,packet:e}})}publish(e){this.publishAndReturnOffset(e).catch(e=>{c("[%s] error while publishing message: %s",this.uid,e)})}publishAndReturnOffset(e){return e.uid=this.uid,e.nsp=this.nsp.name,this.doPublish(e)}publishResponse(e,t){t.uid=this.uid,t.nsp=this.nsp.name,this.doPublishResponse(e,t).catch(e=>{c("[%s] error while publishing response: %s",this.uid,e)})}}i.ClusterAdapter=d;class h extends d{constructor(e,t){super(e),this.nodesMap=new Map,this.customRequests=new Map,this._opts=Object.assign({heartbeatInterval:5e3,heartbeatTimeout:1e4},t),this.cleanupTimer=setInterval(()=>{let i=Date.now();this.nodesMap.forEach((e,t)=>{i-e>this._opts.heartbeatTimeout&&(c("[%s] node %s seems down",this.uid,t),this.removeNode(t))})},1e3)}init(){this.publish({type:r.INITIAL_HEARTBEAT})}scheduleHeartbeat(){this.heartbeatTimer?this.heartbeatTimer.refresh():this.heartbeatTimer=setTimeout(()=>{this.publish({type:r.HEARTBEAT})},this._opts.heartbeatInterval)}close(){this.publish({type:r.ADAPTER_CLOSE}),clearTimeout(this.heartbeatTimer),this.cleanupTimer&&clearInterval(this.cleanupTimer)}onMessage(e,t){if(e.uid===this.uid)return c("[%s] ignore message from self",this.uid);switch(e.uid&&"emitter"!==e.uid&&this.nodesMap.set(e.uid,Date.now()),c("[%s] new event of type %d from %s",this.uid,e.type,e.uid),e.type){case r.INITIAL_HEARTBEAT:this.publish({type:r.HEARTBEAT});break;case r.HEARTBEAT:break;case r.ADAPTER_CLOSE:this.removeNode(e.uid);break;default:super.onMessage(e,t)}}serverCount(){return Promise.resolve(1+this.nodesMap.size)}publish(e){return this.scheduleHeartbeat(),super.publish(e)}async serverSideEmit(e){if(!("function"==typeof e[e.length-1]))return this.publish({type:r.SERVER_SIDE_EMIT,data:{packet:e}});let t=e.pop();var i=this.nodesMap.size;if(c('[%s] waiting for %d responses to "serverSideEmit" request',this.uid,i),i<=0)return t(null,[]);let s=l();i=setTimeout(()=>{var e=this.customRequests.get(s);e&&(t(new Error(`timeout reached: missing ${e.missingUids.size} responses`),e.responses),this.customRequests.delete(s))},5e3),i={type:r.SERVER_SIDE_EMIT,resolve:t,timeout:i,missingUids:new Set([...this.nodesMap.keys()]),responses:[]};this.customRequests.set(s,i),this.publish({type:r.SERVER_SIDE_EMIT,data:{requestId:s,packet:e}})}async fetchSockets(s){let e,[n,t]=await Promise.all([super.fetchSockets({rooms:s.rooms,except:s.except,flags:{local:!0}}),this.serverCount()]);if(null!=(e=s.flags)&&e.local||t-1<=0)return n;let a=l();return new Promise((e,t)=>{var i=setTimeout(()=>{var e=this.customRequests.get(a);e&&(t(new Error(`timeout reached: missing ${e.missingUids.size} responses`)),this.customRequests.delete(a))},s.flags.timeout||5e3),e={type:r.FETCH_SOCKETS,resolve:e,timeout:i,missingUids:new Set([...this.nodesMap.keys()]),responses:n};this.customRequests.set(a,e),this.publish({type:r.FETCH_SOCKETS,data:{opts:p(s),requestId:a}})})}onResponse(e){var i=e.data.requestId;switch(c("[%s] received response %s to request %s",this.uid,e.type,i),e.type){case r.FETCH_SOCKETS_RESPONSE:{let t=this.customRequests.get(i);if(!t)return;e.data.sockets.forEach(e=>t.responses.push(e)),t.missingUids.delete(e.uid),0===t.missingUids.size&&(clearTimeout(t.timeout),t.resolve(t.responses),this.customRequests.delete(i));break}case r.SERVER_SIDE_EMIT_RESPONSE:var t=this.customRequests.get(i);if(!t)return;t.responses.push(e.data.packet),t.missingUids.delete(e.uid),0===t.missingUids.size&&(clearTimeout(t.timeout),t.resolve(null,t.responses),this.customRequests.delete(i));break;default:super.onResponse(e)}}removeNode(i){this.customRequests.forEach((e,t)=>{e.missingUids.delete(i),0===e.missingUids.size&&(clearTimeout(e.timeout),e.type===r.FETCH_SOCKETS?e.resolve(e.responses):e.type===r.SERVER_SIDE_EMIT&&e.resolve(null,e.responses),this.customRequests.delete(t))}),this.nodesMap.delete(i)}}i.ClusterAdapterWithHeartbeat=h},{"./in-memory-adapter":260,crypto:void 0,debug:264}],259:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.yeast=i.decode=i.encode=void 0;let s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),n={},a=0,o=0,r;function c(e){let t="";for(;t=s[e%64]+t,0<(e=Math.floor(e/64)););return t}for(i.encode=c,i.decode=function(e){let t=0;for(o=0;o<e.length;o++)t=64*t+n[e.charAt(o)];return t},i.yeast=function(){var e=c(+new Date);return e!==r?(a=0,r=e):e+"."+c(a++)};o<64;o++)n[s[o]]=o},{}],260:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.SessionAwareAdapter=i.Adapter=void 0;var s=e("events");let n=e("./contrib/yeast"),a=e("ws"),o="function"==typeof(null==(e=null==a?void 0:a.Sender)?void 0:e.frame);class r extends s.EventEmitter{constructor(e){super(),this.nsp=e,this.rooms=new Map,this.sids=new Map,this.encoder=e.server.encoder}init(){}close(){}serverCount(){return Promise.resolve(1)}addAll(e,t){this.sids.has(e)||this.sids.set(e,new Set);for(var i of t)this.sids.get(e).add(i),this.rooms.has(i)||(this.rooms.set(i,new Set),this.emit("create-room",i)),this.rooms.get(i).has(e)||(this.rooms.get(i).add(e),this.emit("join-room",i,e))}del(e,t){this.sids.has(e)&&this.sids.get(e).delete(t),this._del(t,e)}_del(e,t){var i=this.rooms.get(e);null!=i&&(i.delete(t)&&this.emit("leave-room",e,t),0===i.size)&&this.rooms.delete(e)&&this.emit("delete-room",e)}delAll(e){if(this.sids.has(e)){for(var t of this.sids.get(e))this._del(t,e);this.sids.delete(e)}}broadcast(t,e){var i=e.flags||{};let s={preEncoded:!0,volatile:i.volatile,compress:i.compress},n=(t.nsp=this.nsp.name,this._encode(t,s));this.apply(e,e=>{"function"==typeof e.notifyOutgoingListeners&&e.notifyOutgoingListeners(t),e.client.writeToEngine(n,s)})}broadcastWithAck(t,e,i,s){var n=e.flags||{};let a={preEncoded:!0,volatile:n.volatile,compress:n.compress},o=(t.nsp=this.nsp.name,t.id=this.nsp._ids++,this._encode(t,a)),r=0;this.apply(e,e=>{r++,e.acks.set(t.id,s),"function"==typeof e.notifyOutgoingListeners&&e.notifyOutgoingListeners(t),e.client.writeToEngine(o,a)}),i(r)}_encode(e,t){var i,e=this.encoder.encode(e);return o&&1===e.length&&"string"==typeof e[0]&&(i=Buffer.from("4"+e[0]),t.wsPreEncodedFrame=a.Sender.frame(i,{readOnly:!1,mask:!1,rsv1:!1,opcode:1,fin:!0})),e}sockets(e){let t=new Set;return this.apply({rooms:e},e=>{t.add(e.id)}),Promise.resolve(t)}socketRooms(e){return this.sids.get(e)}fetchSockets(e){let t=[];return this.apply(e,e=>{t.push(e)}),Promise.resolve(t)}addSockets(e,t){this.apply(e,e=>{e.join(t)})}delSockets(e,i){this.apply(e,t=>{i.forEach(e=>t.leave(e))})}disconnectSockets(e,t){this.apply(e,e=>{e.disconnect(t)})}apply(e,t){var i=e.rooms,s=this.computeExceptSids(e.except);if(i.size){var n,a,o=new Set;for(n of i)if(this.rooms.has(n))for(var r of this.rooms.get(n))o.has(r)||s.has(r)||(a=this.nsp.sockets.get(r))&&(t(a),o.add(r))}else for(var[c]of this.sids)s.has(c)||(c=this.nsp.sockets.get(c))&&t(c)}computeExceptSids(e){let t=new Set;if(e&&0<e.size)for(var i of e)this.rooms.has(i)&&this.rooms.get(i).forEach(e=>t.add(e));return t}serverSideEmit(e){console.warn("this adapter does not support the serverSideEmit() functionality")}persistSession(e){}restoreSession(e,t){return null}}i.Adapter=r;class c extends r{constructor(e){super(e),this.nsp=e,this.sessions=new Map,this.packets=[],this.maxDisconnectionDuration=e.server.opts.connectionStateRecovery.maxDisconnectionDuration,setInterval(()=>{let i=Date.now()-this.maxDisconnectionDuration;this.sessions.forEach((e,t)=>{e.disconnectedAt<i&&this.sessions.delete(t)});for(let e=this.packets.length-1;0<=e;e--)if(this.packets[e].emittedAt<i){this.packets.splice(0,e+1);break}},6e4).unref()}persistSession(e){e.disconnectedAt=Date.now(),this.sessions.set(e.pid,e)}restoreSession(t,i){var s=this.sessions.get(t);if(!s)return null;if(s.disconnectedAt+this.maxDisconnectionDuration<Date.now())return this.sessions.delete(t),null;t=this.packets.findIndex(e=>e.id===i);if(-1===t)return null;var n=[];for(let e=t+1;e<this.packets.length;e++){var a=this.packets[e];((e,t)=>{var i=0===t.rooms.size||e.some(e=>t.rooms.has(e)),e=e.every(e=>!t.except.has(e));return i&&e})(s.rooms,a.opts)&&n.push(a.data)}return Promise.resolve(Object.assign(Object.assign({},s),{missedPackets:n}))}broadcast(e,t){var i=2===e.type,s=void 0===(null==(s=t.flags)?void 0:s.volatile);i&&void 0===e.id&&s&&(i=(0,n.yeast)(),e.data.push(i),this.packets.push({id:i,opts:t,data:e.data,emittedAt:Date.now()})),super.broadcast(e,t)}}i.SessionAwareAdapter=c},{"./contrib/yeast":259,events:void 0,ws:317}],261:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MessageType=i.ClusterAdapterWithHeartbeat=i.ClusterAdapter=i.SessionAwareAdapter=i.Adapter=void 0;var s=e("./in-memory-adapter"),n=(Object.defineProperty(i,"Adapter",{enumerable:!0,get:function(){return s.Adapter}}),Object.defineProperty(i,"SessionAwareAdapter",{enumerable:!0,get:function(){return s.SessionAwareAdapter}}),e("./cluster-adapter"));Object.defineProperty(i,"ClusterAdapter",{enumerable:!0,get:function(){return n.ClusterAdapter}}),Object.defineProperty(i,"ClusterAdapterWithHeartbeat",{enumerable:!0,get:function(){return n.ClusterAdapterWithHeartbeat}}),Object.defineProperty(i,"MessageType",{enumerable:!0,get:function(){return n.MessageType}})},{"./cluster-adapter":258,"./in-memory-adapter":260}],262:[function(e,t,i){arguments[4][105][0].apply(i,arguments)},{"./common":263,dup:105}],263:[function(e,t,i){arguments[4][106][0].apply(i,arguments)},{dup:106,ms:202}],264:[function(e,t,i){arguments[4][107][0].apply(i,arguments)},{"./browser.js":262,"./node.js":265,dup:107}],265:[function(e,t,i){arguments[4][108][0].apply(i,arguments)},{"./common":263,dup:108,"supports-color":297,tty:void 0,util:void 0}],266:[function(e,t,i){function s(e){this.ms=(e=e||{}).min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}Object.defineProperty(i,"__esModule",{value:!0}),(i.Backoff=s).prototype.duration=function(){var e,t,i=this.ms*Math.pow(this.factor,this.attempts++);return this.jitter&&(e=Math.random(),t=Math.floor(e*this.jitter*i),i=0==(1&Math.floor(10*e))?i-t:i+t),0|Math.min(i,this.max)},s.prototype.reset=function(){this.attempts=0},s.prototype.setMin=function(e){this.ms=e},s.prototype.setMax=function(e){this.max=e},s.prototype.setJitter=function(e){this.jitter=e}},{}],267:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.WebTransport=i.WebSocket=i.NodeWebSocket=i.XHR=i.NodeXHR=i.Fetch=i.Socket=i.Manager=i.protocol=void 0,i.io=a,i.connect=a,i.default=a;let o=e("./url.js"),r=e("./manager.js"),n=(Object.defineProperty(i,"Manager",{enumerable:!0,get:function(){return r.Manager}}),e("./socket.js")),c=(Object.defineProperty(i,"Socket",{enumerable:!0,get:function(){return n.Socket}}),(0,s(e("debug")).default)("socket.io-client")),l={};function a(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var e=(0,o.url)(e,t.path||"/socket.io"),i=e.source,s=e.id,n=e.path,n=l[s]&&n in l[s].nsps,n=t.forceNew||t["force new connection"]||!1===t.multiplex||n;let a;return a=n?(c("ignoring socket cache for %s",i),new r.Manager(i,t)):(l[s]||(c("new io instance for %s",i),l[s]=new r.Manager(i,t)),l[s]),e.query&&!t.query&&(t.query=e.queryKey),a.socket(e.path,t)}Object.assign(a,{Manager:r.Manager,Socket:n.Socket,io:a,connect:a});var p=e("socket.io-parser"),u=(Object.defineProperty(i,"protocol",{enumerable:!0,get:function(){return p.protocol}}),e("engine.io-client"));Object.defineProperty(i,"Fetch",{enumerable:!0,get:function(){return u.Fetch}}),Object.defineProperty(i,"NodeXHR",{enumerable:!0,get:function(){return u.NodeXHR}}),Object.defineProperty(i,"XHR",{enumerable:!0,get:function(){return u.XHR}}),Object.defineProperty(i,"NodeWebSocket",{enumerable:!0,get:function(){return u.NodeWebSocket}}),Object.defineProperty(i,"WebSocket",{enumerable:!0,get:function(){return u.WebSocket}}),Object.defineProperty(i,"WebTransport",{enumerable:!0,get:function(){return u.WebTransport}}),t.exports=a},{"./manager.js":268,"./socket.js":270,"./url.js":271,debug:274,"engine.io-client":93,"socket.io-parser":277}],268:[function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,n)}:function(e,t,i,s){e[s=void 0===s?i:s]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&s(t,e,i);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.Manager=void 0;let r=e("engine.io-client"),c=e("./socket.js"),l=a(e("socket.io-parser")),p=e("./on.js"),u=e("./contrib/backo2.js");a=e("@socket.io/component-emitter");let d=(0,o(e("debug")).default)("socket.io-client:manager");class h extends a.Emitter{constructor(e,t){super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,(0,r.installTimerFunctions)(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!=(i=t.randomizationFactor)?i:.5),this.backoff=new u.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;var i=t.parser||l;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null!=(t=this.backoff)&&t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null!=(t=this.backoff)&&t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null!=(t=this.backoff)&&t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(d("readyState %s",this._readyState),!~this._readyState.indexOf("open")){d("opening %s",this.uri),this.engine=new r.Socket(this.uri,this.opts);let i=this.engine,e=this,s=(this._readyState="opening",(this.skipReconnect=!1,p.on)(i,"open",function(){e.onopen(),t&&t()})),n=e=>{d("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",e),t?t(e):this.maybeReconnectOnOpen()};var a=(0,p.on)(i,"error",n);if(!1!==this._timeout){let e=this._timeout,t=(d("connect attempt will timeout after %d",e),this.setTimeoutFn(()=>{d("connect attempt timed out after %d",e),s(),n(new Error("timeout")),i.close()},e));this.opts.autoUnref&&t.unref(),this.subs.push(()=>{this.clearTimeoutFn(t)})}this.subs.push(s),this.subs.push(a)}return this}connect(e){return this.open(e)}onopen(){d("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push((0,p.on)(e,"ping",this.onping.bind(this)),(0,p.on)(e,"data",this.ondata.bind(this)),(0,p.on)(e,"error",this.onerror.bind(this)),(0,p.on)(e,"close",this.onclose.bind(this)),(0,p.on)(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){(0,r.nextTick)(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){d("error",e),this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new c.Socket(this,e,t),this.nsps[e]=i),i}_destroy(e){var t;for(t of Object.keys(this.nsps)){let e=this.nsps[t];if(e.active)return void d("socket %s is still active, skipping close",t)}this._close()}_packet(t){d("writing packet %j",t);var i=this.encoder.encode(t);for(let e=0;e<i.length;e++)this.engine.write(i[e],t.options)}cleanup(){d("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){d("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var i;d("closed due to %s",e),this.cleanup(),null!=(i=this.engine)&&i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)d("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var i=this.backoff.duration();d("will wait %dms before reconnect attempt",i),this._reconnecting=!0;let e=this.setTimeoutFn(()=>{t.skipReconnect||(d("attempting reconnect"),this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect)||t.open(e=>{e?(d("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):(d("reconnect success"),t.onreconnect())})},i);this.opts.autoUnref&&e.unref(),this.subs.push(()=>{this.clearTimeoutFn(e)})}}onreconnect(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}i.Manager=h},{"./contrib/backo2.js":266,"./on.js":269,"./socket.js":270,"@socket.io/component-emitter":75,debug:274,"engine.io-client":93,"socket.io-parser":277}],269:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.on=function(e,t,i){return e.on(t,i),function(){e.off(t,i)}}},{}],270:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.Socket=void 0;let n=e("socket.io-parser"),a=e("./on.js");var o=e("@socket.io/component-emitter");let r=(0,s(e("debug")).default)("socket.io-client:socket"),c=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class l extends o.Emitter{constructor(e,t,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){var e;this.subs||(e=this.io,this.subs=[(0,a.on)(e,"open",this.onopen.bind(this)),(0,a.on)(e,"packet",this.onpacket.bind(this)),(0,a.on)(e,"error",this.onerror.bind(this)),(0,a.on)(e,"close",this.onclose.bind(this))])}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var i,s;if(c.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');return t.unshift(e),!this._opts.retries||this.flags.fromQueue||this.flags.volatile?(i=((e={type:n.PacketType.EVENT,data:t,options:{}}).options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(s=this.ids++,r("emitting packet with ack id %d",s),i=t.pop(),this._registerAckCallback(s,i),e.id=s),null==(s=null==(i=this.io.engine)?void 0:i.transport)?void 0:s.writable),s=this.connected&&!(null!=(s=this.io.engine)&&s._hasPingExpired()),this.flags.volatile&&!i?r("discard packet as the transport is not currently writable"):s?(this.notifyOutgoingListeners(e),this.packet(e)):this.sendBuffer.push(e),this.flags={}):this._addToQueue(t),this}_registerAckCallback(i,s){let e,n=null!=(e=this.flags.timeout)?e:this._opts.ackTimeout;if(void 0===n)this.acks[i]=s;else{let t=this.io.setTimeoutFn(()=>{delete this.acks[i];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===i&&(r("removing packet with ack id %d from the buffer",i),this.sendBuffer.splice(e,1));r("event with ack id %d has timed out after %d ms",i,n),s.call(this,new Error("operation has timed out"))},n);var a=(...e)=>{this.io.clearTimeoutFn(t),s.apply(this,e)};a.withError=!0,this.acks[i]=a}}emitWithAck(t,...n){return new Promise((i,s)=>{var e=(e,t)=>e?s(e):i(t);e.withError=!0,n.push(e),this.emit(t,...n)})}_addToQueue(e){let i,s=("function"==typeof e[e.length-1]&&(i=e.pop()),{id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)});e.push((e,...t)=>{if(s===this._queue[0])return null!==e?s.tryCount>this._opts.retries&&(r("packet [%d] is discarded after %d tries",s.id,s.tryCount),this._queue.shift(),i)&&i(e):(r("packet [%d] was successfully sent",s.id),this._queue.shift(),i&&i(null,...t)),s.pending=!1,this._drainQueue()}),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){var t;r("draining queue"),this.connected&&0!==this._queue.length&&((t=this._queue[0]).pending&&!e?r("packet [%d] has already been sent and is waiting for an ack",t.id):(t.pending=!0,t.tryCount++,r("sending packet [%d] (try n%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){r("transport is open - connecting"),"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:n.PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){r("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{var e;this.sendBuffer.some(e=>String(e.id)===t)||(e=this.acks[t],delete this.acks[t],e.withError&&e.call(this,new Error("socket has been disconnected")))})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case n.PacketType.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case n.PacketType.EVENT:case n.PacketType.BINARY_EVENT:this.onevent(e);break;case n.PacketType.ACK:case n.PacketType.BINARY_ACK:this.onack(e);break;case n.PacketType.DISCONNECT:this.ondisconnect();break;case n.PacketType.CONNECT_ERROR:this.destroy();var t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){var t=e.data||[];r("emitting event %j",t),null!=e.id&&(r("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){var t;if(this._anyListeners&&this._anyListeners.length)for(t of this._anyListeners.slice())t.apply(this,e);super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(t){let i=this,s=!1;return function(...e){s||(s=!0,r("sending ack %j",e),i.packet({type:n.PacketType.ACK,id:t,data:e}))}}onack(e){var t=this.acks[e.id];"function"!=typeof t?r("bad ack %s",e.id):(delete this.acks[e.id],r("calling ack %s with %j",e.id,e.data),t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){r("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){r("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(r("performing disconnect (%s)",this.nsp),this.packet({type:n.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(t){if(this._anyListeners)if(t){var i=this._anyListeners;for(let e=0;e<i.length;e++)if(t===i[e])return i.splice(e,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(t){if(this._anyOutgoingListeners)if(t){var i=this._anyOutgoingListeners;for(let e=0;e<i.length;e++)if(t===i[e])return i.splice(e,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){var t;if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(t of this._anyOutgoingListeners.slice())t.apply(this,e.data)}}i.Socket=l},{"./on.js":269,"@socket.io/component-emitter":75,debug:274,"socket.io-parser":277}],271:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.url=function(e,t="",i){let s=e;i=i||"undefined"!=typeof location&&location,null==e&&(e=i.protocol+"//"+i.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?i.protocol+e:i.host+e),/^(https?|wss?):\/\//.test(e)||(a("protocol-less url %s",e),e=void 0!==i?i.protocol+"//"+e:"https://"+e),a("parse %s",e),s=(0,n.parse)(e));s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443"));s.path=s.path||"/";e=-1!==s.host.indexOf(":"),e=e?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+e+":"+s.port+t,s.href=s.protocol+"://"+e+(i&&i.port===s.port?"":":"+s.port),s};let n=e("engine.io-client"),a=(0,s(e("debug")).default)("socket.io-client:url")},{debug:274,"engine.io-client":93}],272:[function(e,t,i){arguments[4][105][0].apply(i,arguments)},{"./common":273,dup:105}],273:[function(e,t,i){arguments[4][106][0].apply(i,arguments)},{dup:106,ms:202}],274:[function(e,t,i){arguments[4][107][0].apply(i,arguments)},{"./browser.js":272,"./node.js":275,dup:107}],275:[function(e,t,i){arguments[4][108][0].apply(i,arguments)},{"./common":273,dup:108,"supports-color":297,tty:void 0,util:void 0}],276:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.reconstructPacket=i.deconstructPacket=void 0;let a=e("./is-binary.js");i.deconstructPacket=function(e){var t=[],i=e.data;return e.data=function i(s,n){if(!s)return s;{if((0,a.isBinary)(s)){let e={_placeholder:!0,num:n.length};return n.push(s),e}if(Array.isArray(s)){let t=new Array(s.length);for(let e=0;e<s.length;e++)t[e]=i(s[e],n);return t}if("object"==typeof s&&!(s instanceof Date)){let e={};for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=i(s[t],n));return e}}return s}(i,t),e.attachments=t.length,{packet:e,buffers:t}},i.reconstructPacket=function(e,t){return e.data=function t(i,s){if(!i)return i;{if(i&&!0===i._placeholder){let e="number"==typeof i.num&&0<=i.num&&i.num<s.length;if(e)return s[i.num];throw new Error("illegal attachments")}if(Array.isArray(i))for(let e=0;e<i.length;e++)i[e]=t(i[e],s);else if("object"==typeof i)for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(i[e]=t(i[e],s))}return i}(e.data,t),delete e.attachments,e}},{"./is-binary.js":278}],277:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Decoder=i.Encoder=i.PacketType=i.protocol=void 0;var a,s=e("@socket.io/component-emitter");let n=e("./binary.js"),o=e("./is-binary.js"),r=(0,e("debug").default)("socket.io-parser"),c=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];i.protocol=5,(e=a=i.PacketType||(i.PacketType={}))[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK";function l(e){return"[object Object]"===Object.prototype.toString.call(e)}i.Encoder=class{constructor(e){this.replacer=e}encode(e){return r("encoding packet %j",e),e.type!==a.EVENT&&e.type!==a.ACK||!(0,o.hasBinary)(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==a.BINARY_EVENT&&e.type!==a.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),r("encoded %j as %s",e,t),t}encodeAsBinary(e){var e=(0,n.deconstructPacket)(e),t=this.encodeAsString(e.packet),e=e.buffers;return e.unshift(t),e}};class p extends s.Emitter{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");var i=(t=this.decodeString(e)).type===a.BINARY_EVENT;(!i&&t.type!==a.BINARY_ACK||(t.type=i?a.EVENT:a.ACK,this.reconstructor=new u(t),0===t.attachments))&&super.emitReserved("decoded",t)}else{if(!(0,o.isBinary)(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;var i={type:Number(e.charAt(0))};if(void 0===a[i.type])throw new Error("unknown packet type "+i.type);if(i.type===a.BINARY_EVENT||i.type===a.BINARY_ACK){for(var s=t+1;"-"!==e.charAt(++t)&&t!=e.length;);s=e.substring(s,t);if(s!=Number(s)||"-"!==e.charAt(t))throw new Error("Illegal attachments");i.attachments=Number(s)}if("/"===e.charAt(t+1)){for(s=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}i.nsp=e.substring(s,t)}else i.nsp="/";s=e.charAt(t+1);if(""!==s&&Number(s)==s){for(s=t+1;++t;){var n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}i.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){s=this.tryParse(e.substr(t));if(!p.isPayloadValid(i.type,s))throw new Error("invalid payload");i.data=s}return r("decoded %s as %j",e,i),i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case a.CONNECT:return l(t);case a.DISCONNECT:return void 0===t;case a.CONNECT_ERROR:return"string"==typeof t||l(t);case a.EVENT:case a.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===c.indexOf(t[0]));case a.ACK:case a.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}i.Decoder=p;class u{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){return this.buffers.push(e),this.buffers.length===this.reconPack.attachments?(e=(0,n.reconstructPacket)(this.reconPack,this.buffers),this.finishedReconstruction(),e):null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},{"./binary.js":276,"./is-binary.js":278,"@socket.io/component-emitter":75,debug:281}],278:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.hasBinary=i.isBinary=void 0;let s="function"==typeof ArrayBuffer;var n=Object.prototype.toString;let a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===n.call(Blob),o="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===n.call(File);function r(e){return s&&(e instanceof ArrayBuffer||(t=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer))||a&&e instanceof Blob||o&&e instanceof File;var t}i.isBinary=r,i.hasBinary=function i(s,e){if(s&&"object"==typeof s)if(Array.isArray(s)){for(let e=0,t=s.length;e<t;e++)if(i(s[e]))return!0}else{if(r(s))return!0;if(s.toJSON&&"function"==typeof s.toJSON&&1===arguments.length)return i(s.toJSON(),!0);for(var t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&i(s[t]))return!0}return!1}},{}],279:[function(e,t,i){arguments[4][105][0].apply(i,arguments)},{"./common":280,dup:105}],280:[function(e,t,i){arguments[4][106][0].apply(i,arguments)},{dup:106,ms:202}],281:[function(e,t,i){arguments[4][107][0].apply(i,arguments)},{"./browser.js":279,"./node.js":282,dup:107}],282:[function(e,t,i){arguments[4][108][0].apply(i,arguments)},{"./common":280,dup:108,"supports-color":297,tty:void 0,util:void 0}],283:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.RemoteSocket=i.BroadcastOperator=void 0;let s=e("./socket-types"),n=e("socket.io-parser");class a{constructor(e,t=new Set,i=new Set,s={}){this.adapter=e,this.rooms=t,this.exceptRooms=i,this.flags=s}to(e){let t=new Set(this.rooms);return Array.isArray(e)?e.forEach(e=>t.add(e)):t.add(e),new a(this.adapter,t,this.exceptRooms,this.flags)}in(e){return this.to(e)}except(e){let t=new Set(this.exceptRooms);return Array.isArray(e)?e.forEach(e=>t.add(e)):t.add(e),new a(this.adapter,this.rooms,t,this.flags)}compress(e){e=Object.assign({},this.flags,{compress:e});return new a(this.adapter,this.rooms,this.exceptRooms,e)}get volatile(){var e=Object.assign({},this.flags,{volatile:!0});return new a(this.adapter,this.rooms,this.exceptRooms,e)}get local(){var e=Object.assign({},this.flags,{local:!0});return new a(this.adapter,this.rooms,this.exceptRooms,e)}timeout(e){e=Object.assign({},this.flags,{timeout:e});return new a(this.adapter,this.rooms,this.exceptRooms,e)}emit(c,...l){if(s.RESERVED_EVENTS.has(c))throw new Error(`"${String(c)}" is a reserved event name`);c=[c,...l],l={type:n.PacketType.EVENT,data:c};if("function"==typeof c[c.length-1]){let e=c.pop(),t=!1,i=[],s=setTimeout(()=>{t=!0,e.apply(this,[new Error("operation has timed out"),this.flags.expectSingleResponse?null:i])},this.flags.timeout),n=-1,a=0,o=0,r=()=>{t||n!==a||i.length!==o||(clearTimeout(s),e.apply(this,[null,this.flags.expectSingleResponse?i[0]:i]))};this.adapter.broadcastWithAck(l,{rooms:this.rooms,except:this.exceptRooms,flags:this.flags},e=>{o+=e,a++,r()},e=>{i.push(e),r()}),this.adapter.serverCount().then(e=>{n=e,r()})}else this.adapter.broadcast(l,{rooms:this.rooms,except:this.exceptRooms,flags:this.flags});return!0}emitWithAck(e,...t){return new Promise((i,s)=>{t.push((e,t)=>e?(e.responses=t,s(e)):i(t)),this.emit(e,...t)})}allSockets(){if(this.adapter)return this.adapter.sockets(this.rooms);throw new Error("No adapter for this namespace, are you trying to get the list of clients of a dynamic namespace?")}fetchSockets(){return this.adapter.fetchSockets({rooms:this.rooms,except:this.exceptRooms,flags:this.flags}).then(e=>e.map(e=>e.server?e:new o(this.adapter,e)))}socketsJoin(e){this.adapter.addSockets({rooms:this.rooms,except:this.exceptRooms,flags:this.flags},Array.isArray(e)?e:[e])}socketsLeave(e){this.adapter.delSockets({rooms:this.rooms,except:this.exceptRooms,flags:this.flags},Array.isArray(e)?e:[e])}disconnectSockets(e=!1){this.adapter.disconnectSockets({rooms:this.rooms,except:this.exceptRooms,flags:this.flags},e)}}i.BroadcastOperator=a;class o{constructor(e,t){this.id=t.id,this.handshake=t.handshake,this.rooms=new Set(t.rooms),this.data=t.data,this.operator=new a(e,new Set([this.id]),new Set,{expectSingleResponse:!0})}timeout(e){return this.operator.timeout(e)}emit(e,...t){return this.operator.emit(e,...t)}join(e){return this.operator.socketsJoin(e)}leave(e){return this.operator.socketsLeave(e)}disconnect(e=!1){return this.operator.disconnectSockets(e),this}}i.RemoteSocket=o},{"./socket-types":288,"socket.io-parser":277}],284:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Client=void 0;let a=e("socket.io-parser");var s=e("debug");let o=e("url"),r=s("socket.io:client");i.Client=class{constructor(e,t){this.sockets=new Map,this.nsps=new Map,this.server=e,this.conn=t,this.encoder=e.encoder,this.decoder=new e._parser.Decoder,this.id=t.id,this.setup()}get request(){return this.conn.request}setup(){this.onclose=this.onclose.bind(this),this.ondata=this.ondata.bind(this),this.onerror=this.onerror.bind(this),this.ondecoded=this.ondecoded.bind(this),this.decoder.on("decoded",this.ondecoded),this.conn.on("data",this.ondata),this.conn.on("error",this.onerror),this.conn.on("close",this.onclose),this.connectTimeout=setTimeout(()=>{0===this.nsps.size?(r("no namespace joined yet, close the client"),this.close()):r("the client has already joined a namespace, nothing to do")},this.server._connectTimeout)}connect(t,i={}){if(this.server._nsps.has(t))return r("connecting to namespace %s",t),this.doConnect(t,i);this.server._checkNamespace(t,i,e=>{e?this.doConnect(t,i):(r("creation of namespace %s was denied",t),this._packet({type:a.PacketType.CONNECT_ERROR,nsp:t,data:{message:"Invalid namespace"}}))})}doConnect(e,t){let i=this.server.of(e);i._add(this,t,e=>{this.sockets.set(e.id,e),this.nsps.set(i.name,e),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0)})}_disconnect(){for(var e of this.sockets.values())e.disconnect();this.sockets.clear(),this.close()}_remove(e){var t;this.sockets.has(e.id)?(t=this.sockets.get(e.id).nsp.name,this.sockets.delete(e.id),this.nsps.delete(t)):r("ignoring remove for %s",e.id)}close(){"open"===this.conn.readyState&&(r("forcing transport close"),this.conn.close(),this.onclose("forced server close"))}_packet(e,t={}){"open"!==this.conn.readyState?r("ignoring packet write %j",e):(e=t.preEncoded?e:this.encoder.encode(e),this.writeToEngine(e,t))}writeToEngine(e,t){var i;if(t.volatile&&!this.conn.transport.writable)r("volatile packet is discarded since the transport is not currently writable");else for(i of Array.isArray(e)?e:[e])this.conn.write(i,t)}ondata(e){try{this.decoder.add(e)}catch(e){r("invalid packet format"),this.onerror(e)}}ondecoded(e){let t,i;var s;i=3===this.conn.protocol?(s=o.parse(e.nsp,!0),t=s.pathname,s.query):(t=e.nsp,e.data);let n=this.nsps.get(t);n||e.type!==a.PacketType.CONNECT?n&&e.type!==a.PacketType.CONNECT&&e.type!==a.PacketType.CONNECT_ERROR?process.nextTick(function(){n._onpacket(e)}):(r("invalid state (packet type: %s)",e.type),this.close()):this.connect(t,i)}onerror(e){for(var t of this.sockets.values())t._onerror(e);this.conn.close()}onclose(e,t){r("client close with reason %s",e),this.destroy();for(var i of this.sockets.values())i._onclose(e,t);this.sockets.clear(),this.decoder.destroy()}destroy(){this.conn.removeListener("data",this.ondata),this.conn.removeListener("error",this.onerror),this.conn.removeListener("close",this.onclose),this.decoder.removeListener("decoded",this.ondecoded),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0)}}},{debug:294,"socket.io-parser":277,url:void 0}],285:[function(S,A,O){!function(T){!function(){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,n)}:function(e,t,i,s){e[s=void 0===s?i:s]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&s(t,e,i);return n(t,e),t},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(O,"__esModule",{value:!0}),O.Namespace=O.Socket=O.Server=void 0;let a=S("http"),o=S("fs"),r=S("zlib"),c=S("accepts"),l=S("stream"),p=S("path"),u=S("engine.io"),i=S("./client"),d=S("events"),h=S("./namespace"),m=(Object.defineProperty(O,"Namespace",{enumerable:!0,get:function(){return h.Namespace}}),S("./parent-namespace")),f=S("socket.io-adapter"),v=e(S("socket.io-parser"));e=t(S("debug"));let y=S("./socket");Object.defineProperty(O,"Socket",{enumerable:!0,get:function(){return y.Socket}});var g=S("./typed-events");let b=S("./uws"),x=t(S("cors")),w=(0,e.default)("socket.io:server"),E=S("../package.json").version,_=/\.map/;class k extends g.StrictEventEmitter{constructor(e,t={}){super(),this._nsps=new Map,this.parentNsps=new Map,this.parentNamespacesFromRegExp=new Map,"object"==typeof e&&e instanceof Object&&!e.listen&&(t=e,e=void 0),this.path(t.path||"/socket.io"),this.connectTimeout(t.connectTimeout||45e3),this.serveClient(!1!==t.serveClient),this._parser=t.parser||v,this.encoder=new this._parser.Encoder,(this.opts=t).connectionStateRecovery?(t.connectionStateRecovery=Object.assign({maxDisconnectionDuration:12e4,skipMiddlewares:!0},t.connectionStateRecovery),this.adapter(t.adapter||f.SessionAwareAdapter)):this.adapter(t.adapter||f.Adapter),t.cleanupEmptyChildNamespaces=!!t.cleanupEmptyChildNamespaces,this.sockets=this.of("/"),!e&&"number"!=typeof e||this.attach(e),this.opts.cors&&(this._corsMiddleware=(0,x.default)(this.opts.cors))}get _opts(){return this.opts}serveClient(e){return arguments.length?(this._serveClient=e,this):this._serveClient}_checkNamespace(s,e,n){if(0===this.parentNsps.size)return n(!1);let t=this.parentNsps.keys(),a=()=>{let i=t.next();if(i.done)return n(!1);i.value(s,e,(e,t)=>e||!t?a():this._nsps.has(s)?(w("dynamic namespace %s already exists",s),n(this._nsps.get(s))):(e=this.parentNsps.get(i.value).createChild(s),w("dynamic namespace %s was created",s),void n(e)))};a()}path(e){if(!arguments.length)return this._path;this._path=e.replace(/\/$/,"");e=this._path.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return this.clientPathRegex=new RegExp("^"+e+"/socket\\.io(\\.msgpack|\\.esm)?(\\.min)?\\.js(\\.map)?(?:\\?|$)"),this}connectTimeout(e){return void 0===e?this._connectTimeout:(this._connectTimeout=e,this)}adapter(e){if(!arguments.length)return this._adapter;this._adapter=e;for(var t of this._nsps.values())t._initAdapter();return this}listen(e,t={}){return this.attach(e,t)}attach(e,t={}){var i;if("function"==typeof e)throw new Error("You are trying to attach socket.io to an express request handler function. Please pass a http.Server instance.");return"number"==typeof(e=Number(e)==e?Number(e):e)&&(w("creating http server and binding to %d",e),i=e,(e=a.createServer((e,t)=>{t.writeHead(404),t.end()})).listen(i)),Object.assign(t,this.opts),t.path=t.path||this._path,this.initEngine(e,t),this}attachApp(e,t={}){Object.assign(t,this.opts),t.path=t.path||this._path,w("creating uWebSockets.js-based engine with opts %j",t);var i=new u.uServer(t);i.attach(e,t),this.bind(i),this._serveClient&&e.get(this._path+"/*",(e,t)=>{var i,s,n,a,o,r;this.clientPathRegex.test(t.getUrl())?(i=t.getUrl().replace(this._path,"").replace(/\?.*$/,"").replace(/^\//,""),n=(s=_.test(i))?"map":"source",r="W/"+(a='"'+E+'"'),!(o=t.getHeader("if-none-match"))||a!==o&&r!==o?(w("serve client %s",n),e.writeHeader("cache-control","public, max-age=0"),e.writeHeader("content-type","application/"+(s?"json":"javascript")+"; charset=utf-8"),e.writeHeader("etag",a),r=p.join(T,"../client-dist/",i),(0,b.serveFile)(e,r)):(w("serve client %s 304",n),e.writeStatus("304 Not Modified"),e.end())):t.setYield(!0)}),(0,b.patchAdapter)(e)}initEngine(e,t){w("creating engine.io instance with opts %j",t),this.eio=(0,u.attach)(e,t),this._serveClient&&this.attachServe(e),this.httpServer=e,this.bind(this.eio)}attachServe(s){w("attaching client serving req handler");let n=s.listeners("request").slice(0);s.removeAllListeners("request"),s.on("request",(t,i)=>{if(this.clientPathRegex.test(t.url))this._corsMiddleware?this._corsMiddleware(t,i,()=>{this.serve(t,i)}):this.serve(t,i);else for(let e=0;e<n.length;e++)n[e].call(s,t,i)})}serve(e,t){var i=e.url.replace(this._path,"").replace(/\?.*$/,""),s=_.test(i),n=s?"map":"source",a='"'+E+'"',o=e.headers["if-none-match"];!o||a!==o&&"W/"+a!==o?(w("serve client %s",n),t.setHeader("Cache-Control","public, max-age=0"),t.setHeader("Content-Type","application/"+(s?"json":"javascript")+"; charset=utf-8"),t.setHeader("ETag",a),k.sendFile(i,e,t)):(w("serve client %s 304",n),t.writeHead(304),t.end())}static sendFile(e,t,i){var s=(0,o.createReadStream)(p.join(T,"../client-dist/",e)),n=e=>{e&&i.end()};switch(c(t).encodings(["br","gzip","deflate"])){case"br":i.writeHead(200,{"content-encoding":"br"}),(0,l.pipeline)(s,(0,r.createBrotliCompress)(),i,n);break;case"gzip":i.writeHead(200,{"content-encoding":"gzip"}),(0,l.pipeline)(s,(0,r.createGzip)(),i,n);break;case"deflate":i.writeHead(200,{"content-encoding":"deflate"}),(0,l.pipeline)(s,(0,r.createDeflate)(),i,n);break;default:i.writeHead(200),(0,l.pipeline)(s,i,n)}}bind(e){return this.engine=e,this.engine.on("connection",this.onconnection.bind(this)),this}onconnection(e){w("incoming connection with id %s",e.id);var t=new i.Client(this,e);return 3===e.protocol&&t.connect("/"),this}of(s,e){var t;if("function"==typeof s||s instanceof RegExp)return t=new m.ParentNamespace(this),w("initializing parent namespace %s",t.name),("function"==typeof s?this.parentNsps:(this.parentNsps.set((e,t,i)=>i(null,s.test(e)),t),this.parentNamespacesFromRegExp)).set(s,t),e&&t.on("connect",e),t;"/"!==String(s)[0]&&(s="/"+s);let i=this._nsps.get(s);if(!i){for(var[n,a]of this.parentNamespacesFromRegExp)if(n.test(s))return w("attaching namespace %s to parent namespace %s",s,n),a.createChild(s);w("initializing namespace %s",s),i=new h.Namespace(this,s),this._nsps.set(s,i),"/"!==s&&this.sockets.emitReserved("new_namespace",i)}return e&&i.on("connect",e),i}async close(e){await Promise.allSettled([...this._nsps.values()].map(async e=>{e.sockets.forEach(e=>{e._onclose("server shutting down")}),await e.adapter.close()})),this.engine.close(),(0,b.restoreAdapter)(),this.httpServer?this.httpServer.close(e):e&&e()}use(e){return this.sockets.use(e),this}to(e){return this.sockets.to(e)}in(e){return this.sockets.in(e)}except(e){return this.sockets.except(e)}send(...e){return this.sockets.emit("message",...e),this}write(...e){return this.sockets.emit("message",...e),this}serverSideEmit(e,...t){return this.sockets.serverSideEmit(e,...t)}serverSideEmitWithAck(e,...t){return this.sockets.serverSideEmitWithAck(e,...t)}allSockets(){return this.sockets.allSockets()}compress(e){return this.sockets.compress(e)}get volatile(){return this.sockets.volatile}get local(){return this.sockets.local}timeout(e){return this.sockets.timeout(e)}fetchSockets(){return this.sockets.fetchSockets()}socketsJoin(e){return this.sockets.socketsJoin(e)}socketsLeave(e){return this.sockets.socketsLeave(e)}disconnectSockets(e=!1){return this.sockets.disconnectSockets(e)}}O.Server=k,Object.keys(d.EventEmitter.prototype).filter(function(e){return"function"==typeof d.EventEmitter.prototype[e]}).forEach(function(e){k.prototype[e]=function(){return this.sockets[e].apply(this.sockets,arguments)}}),A.exports=(e,t)=>new k(e,t),A.exports.Server=k,A.exports.Namespace=h.Namespace,A.exports.Socket=y.Socket}.call(this)}.call(this,S("path").join(__dirname,"node_modules","socket.io","dist"))},{"../package.json":296,"./client":284,"./namespace":286,"./parent-namespace":287,"./socket":289,"./typed-events":290,"./uws":291,accepts:76,cors:85,debug:294,"engine.io":113,events:void 0,fs:void 0,http:void 0,path:void 0,"socket.io-adapter":261,"socket.io-parser":277,stream:void 0,zlib:void 0}],286:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.Namespace=i.RESERVED_EVENTS=void 0;let a=e("./socket");var n=e("./typed-events"),s=s(e("debug"));let o=e("./broadcast-operator"),r=(0,s.default)("socket.io:namespace");i.RESERVED_EVENTS=new Set(["connect","connection","new_namespace"]);class c extends n.StrictEventEmitter{constructor(e,t){super(),this.sockets=new Map,this._preConnectSockets=new Map,this._fns=[],this._ids=0,this.server=e,this.name=t,this._initAdapter()}_initAdapter(){this.adapter=new(this.server.adapter())(this)}use(e){return this._fns.push(e),this}run(e,s){if(!this._fns.length)return s();let n=this._fns.slice(0);!function t(i){n[i](e,e=>e?s(e):n[i+1]?void t(i+1):s())}(0)}to(e){return new o.BroadcastOperator(this.adapter).to(e)}in(e){return new o.BroadcastOperator(this.adapter).in(e)}except(e){return new o.BroadcastOperator(this.adapter).except(e)}async _add(t,e,i){r("adding socket to nsp %s",this.name);let s=await this._createSocket(t,e);if(this._preConnectSockets.set(s.id,s),null!=(e=this.server.opts.connectionStateRecovery)&&e.skipMiddlewares&&s.recovered&&"open"===t.conn.readyState)return this._doConnect(s,i);this.run(s,e=>{process.nextTick(()=>{if("open"===t.conn.readyState)return e?(r("middleware error, sending CONNECT_ERROR packet to the client"),s._cleanup(),3===t.conn.protocol?s._error(e.data||e.message):s._error({message:e.message,data:e.data})):void this._doConnect(s,i);r("next called after client was closed - ignoring socket"),s._cleanup()})})}async _createSocket(t,i){var s=i.pid,n=i.offset;if(this.server.opts.connectionStateRecovery&&"string"==typeof s&&"string"==typeof n){let e;try{e=await this.adapter.restoreSession(s,n)}catch(e){r("error while restoring session: %s",e)}if(e)return r("connection state recovered for sid %s",e.sid),new a.Socket(this,t,i,e)}return new a.Socket(this,t,i)}_doConnect(e,t){this._preConnectSockets.delete(e.id),this.sockets.set(e.id,e),e._onconnect(),t&&t(e),this.emitReserved("connect",e),this.emitReserved("connection",e)}_remove(e){this.sockets.delete(e.id)||this._preConnectSockets.delete(e.id)}emit(e,...t){return new o.BroadcastOperator(this.adapter).emit(e,...t)}send(...e){return this.emit("message",...e),this}write(...e){return this.emit("message",...e),this}serverSideEmit(e,...t){if(i.RESERVED_EVENTS.has(e))throw new Error(`"${String(e)}" is a reserved event name`);return t.unshift(e),this.adapter.serverSideEmit(t),!0}serverSideEmitWithAck(e,...t){return new Promise((i,s)=>{t.push((e,t)=>e?(e.responses=t,s(e)):i(t)),this.serverSideEmit(e,...t)})}_onServerSideEmit(e){super.emitUntyped.apply(this,e)}allSockets(){return new o.BroadcastOperator(this.adapter).allSockets()}compress(e){return new o.BroadcastOperator(this.adapter).compress(e)}get volatile(){return new o.BroadcastOperator(this.adapter).volatile}get local(){return new o.BroadcastOperator(this.adapter).local}timeout(e){return new o.BroadcastOperator(this.adapter).timeout(e)}fetchSockets(){return new o.BroadcastOperator(this.adapter).fetchSockets()}socketsJoin(e){return new o.BroadcastOperator(this.adapter).socketsJoin(e)}socketsLeave(e){return new o.BroadcastOperator(this.adapter).socketsLeave(e)}disconnectSockets(e=!1){return new o.BroadcastOperator(this.adapter).disconnectSockets(e)}}i.Namespace=c},{"./broadcast-operator":283,"./socket":289,"./typed-events":290,debug:294}],287:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.ParentNamespace=void 0;let n=e("./namespace");var a=e("socket.io-adapter");let o=(0,s(e("debug")).default)("socket.io:parent-namespace");class r extends n.Namespace{constructor(e){super(e,"/_"+r.count++),this.children=new Set}_initAdapter(){this.adapter=new c(this)}emit(t,...i){return this.children.forEach(e=>{e.emit(t,...i)}),!0}createChild(i){o("creating child namespace %s",i);let s=new n.Namespace(this.server,i);if(this._fns.forEach(e=>s.use(e)),this.listeners("connect").forEach(e=>s.on("connect",e)),this.listeners("connection").forEach(e=>s.on("connection",e)),this.children.add(s),this.server._opts.cleanupEmptyChildNamespaces){let t=s._remove;s._remove=e=>{t.call(s,e),0===s.sockets.size&&(o("closing child namespace %s",i),s.adapter.close(),this.server._nsps.delete(s.name),this.children.delete(s))}}return this.server._nsps.set(i,s),this.server.sockets.emitReserved("new_namespace",s),s}fetchSockets(){throw new Error("fetchSockets() is not supported on parent namespaces")}}(i.ParentNamespace=r).count=0;class c extends a.Adapter{broadcast(t,i){this.nsp.children.forEach(e=>{e.adapter.broadcast(t,i)})}}},{"./namespace":286,debug:294,"socket.io-adapter":261}],288:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.RESERVED_EVENTS=void 0,i.RESERVED_EVENTS=new Set(["connect","connect_error","disconnect","disconnecting","newListener","removeListener"])},{}],289:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.Socket=void 0;let n=e("socket.io-parser");var a=s(e("debug")),o=e("./typed-events");let r=s(e("base64id")),c=e("./broadcast-operator"),l=e("./socket-types"),p=(0,a.default)("socket.io:socket"),u=new Set(["transport error","transport close","forced close","ping timeout","server shutting down","forced server close"]);function d(){}class h extends o.StrictEventEmitter{constructor(e,t,i,s){super(),this.nsp=e,this.client=t,this.recovered=!1,this.data={},this.connected=!1,this.acks=new Map,this.fns=[],this.flags={},this.server=e.server,this.adapter=this.nsp.adapter,s?(this.id=s.sid,this.pid=s.pid,s.rooms.forEach(e=>this.join(e)),this.data=s.data,s.missedPackets.forEach(e=>{this.packet({type:n.PacketType.EVENT,data:e})}),this.recovered=!0):(3===t.conn.protocol?this.id="/"!==e.name?e.name+"#"+t.id:t.id:this.id=r.default.generateId(),this.server._opts.connectionStateRecovery&&(this.pid=r.default.generateId())),this.handshake=this.buildHandshake(i),this.on("error",d)}buildHandshake(e){var t;return{headers:(null==(t=this.request)?void 0:t.headers)||{},time:new Date+"",address:this.conn.remoteAddress,xdomain:!(null==(t=this.request)||!t.headers.origin),secure:!this.request||!!this.request.connection.encrypted,issued:+new Date,url:null==(t=this.request)?void 0:t.url,query:(null==(t=this.request)?void 0:t._query)||{},auth:e}}emit(e,...t){if(l.RESERVED_EVENTS.has(e))throw new Error(`"${String(e)}" is a reserved event name`);var i,e=[e,...t],t={type:n.PacketType.EVENT,data:e},e=("function"==typeof e[e.length-1]&&(i=this.nsp._ids++,p("emitting packet with ack id %d",i),this.registerAckCallback(i,e.pop()),t.id=i),Object.assign({},this.flags));return this.flags={},this.nsp.server.opts.connectionStateRecovery?this.adapter.broadcast(t,{rooms:new Set([this.id]),except:new Set,flags:e}):(this.notifyOutgoingListeners(t),this.packet(t,e)),!0}emitWithAck(e,...t){let n=void 0!==this.flags.timeout;return new Promise((i,s)=>{t.push((e,t)=>n?e?s(e):i(t):i(e)),this.emit(e,...t)})}registerAckCallback(e,i){let s=this.flags.timeout;if(void 0===s)this.acks.set(e,i);else{let t=setTimeout(()=>{p("event with ack id %d has timed out after %d ms",e,s),this.acks.delete(e),i.call(this,new Error("operation has timed out"))},s);this.acks.set(e,(...e)=>{clearTimeout(t),i.apply(this,[null,...e])})}}to(e){return this.newBroadcastOperator().to(e)}in(e){return this.newBroadcastOperator().in(e)}except(e){return this.newBroadcastOperator().except(e)}send(...e){return this.emit("message",...e),this}write(...e){return this.emit("message",...e),this}packet(e,t={}){e.nsp=this.nsp.name,t.compress=!1!==t.compress,this.client._packet(e,t)}join(e){return p("join room %s",e),this.adapter.addAll(this.id,new Set(Array.isArray(e)?e:[e]))}leave(e){return p("leave room %s",e),this.adapter.del(this.id,e)}leaveAll(){this.adapter.delAll(this.id)}_onconnect(){p("socket connected - writing packet"),this.connected=!0,this.join(this.id),3===this.conn.protocol?this.packet({type:n.PacketType.CONNECT}):this.packet({type:n.PacketType.CONNECT,data:{sid:this.id,pid:this.pid}})}_onpacket(e){switch(p("got packet %j",e),e.type){case n.PacketType.EVENT:case n.PacketType.BINARY_EVENT:this.onevent(e);break;case n.PacketType.ACK:case n.PacketType.BINARY_ACK:this.onack(e);break;case n.PacketType.DISCONNECT:this.ondisconnect()}}onevent(e){var t,i=e.data||[];if(p("emitting event %j",i),null!=e.id&&(p("attaching ack callback to event"),i.push(this.ack(e.id))),this._anyListeners&&this._anyListeners.length)for(t of this._anyListeners.slice())t.apply(this,i);this.dispatch(i)}ack(t){let i=this,s=!1;return function(){var e;s||(e=Array.prototype.slice.call(arguments),p("sending ack %j",e),i.packet({id:t,type:n.PacketType.ACK,data:e}),s=!0)}}onack(e){var t=this.acks.get(e.id);"function"==typeof t?(p("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),this.acks.delete(e.id)):p("bad ack %s",e.id)}ondisconnect(){p("got disconnect packet"),this._onclose("client namespace disconnect")}_onerror(e){this.emitReserved("error",e)}_onclose(e,t){if(!this.connected)return this;p("closing socket - reason %s",e),this.emitReserved("disconnecting",e,t),this.server._opts.connectionStateRecovery&&u.has(e)&&(p("connection state recovery is enabled for sid %s",this.id),this.adapter.persistSession({sid:this.id,pid:this.pid,rooms:[...this.rooms],data:this.data})),this._cleanup(),this.client._remove(this),this.connected=!1,this.emitReserved("disconnect",e,t)}_cleanup(){this.leaveAll(),this.nsp._remove(this),this.join=d}_error(e){this.packet({type:n.PacketType.CONNECT_ERROR,data:e})}disconnect(e=!1){return this.connected&&(e?this.client._disconnect():(this.packet({type:n.PacketType.DISCONNECT}),this._onclose("server namespace disconnect"))),this}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}get broadcast(){return this.newBroadcastOperator()}get local(){return this.newBroadcastOperator().local}timeout(e){return this.flags.timeout=e,this}dispatch(t){p("dispatching an event %j",t),this.run(t,e=>{process.nextTick(()=>{if(e)return this._onerror(e);this.connected?super.emitUntyped.apply(this,t):p("ignore packet received after disconnection")})})}use(e){return this.fns.push(e),this}run(e,s){if(!this.fns.length)return s();let n=this.fns.slice(0);!function t(i){n[i](e,e=>e?s(e):n[i+1]?void t(i+1):s())}(0)}get disconnected(){return!this.connected}get request(){return this.client.request}get conn(){return this.client.conn}get rooms(){return this.adapter.socketRooms(this.id)||new Set}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(t){if(this._anyListeners)if(t){var i=this._anyListeners;for(let e=0;e<i.length;e++)if(t===i[e])return i.splice(e,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(t){if(this._anyOutgoingListeners)if(t){var i=this._anyOutgoingListeners;for(let e=0;e<i.length;e++)if(t===i[e])return i.splice(e,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){var t;if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(t of this._anyOutgoingListeners.slice())t.apply(this,e.data)}newBroadcastOperator(){var e=Object.assign({},this.flags);return this.flags={},new c.BroadcastOperator(this.adapter,new Set,new Set([this.id]),e)}}i.Socket=h},{"./broadcast-operator":283,"./socket-types":288,"./typed-events":290,base64id:77,debug:294,"socket.io-parser":277}],290:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.StrictEventEmitter=void 0;e=e("events");class s extends e.EventEmitter{on(e,t){return super.on(e,t)}once(e,t){return super.once(e,t)}emit(e,...t){return super.emit(e,...t)}emitReserved(e,...t){return super.emit(e,...t)}emitUntyped(e,...t){return super.emit(e,...t)}listeners(e){return super.listeners(e)}}i.StrictEventEmitter=s},{events:void 0}],291:[function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.patchAdapter=function(o){n.Adapter.prototype.addAll=function(t,e){let i=!this.sids.has(t),s=(a.call(this,t,e),this.nsp.sockets.get(t)||this.nsp._preConnectSockets.get(t));s&&("websocket"===s.conn.transport.name?d(this.nsp.name,s,i,e):i&&s.conn.on("upgrade",()=>{var e=this.sids.get(t);e&&d(this.nsp.name,s,i,e)}))},n.Adapter.prototype.del=function(e,t){p.call(this,e,t);var i,e=this.nsp.sockets.get(e)||this.nsp._preConnectSockets.get(e);e&&"websocket"===e.conn.transport.name&&(i=e.conn.id,e=e.conn.transport.socket,t=""+this.nsp.name+l+t,c("unsubscribe connection %s from topic %s",i,t),e.unsubscribe(t))},n.Adapter.prototype.broadcast=function(e,n){if(n.rooms.size<=1&&0===n.except.size){var a=n.flags||{};let t={preEncoded:!0,volatile:a.volatile,compress:a.compress},i=(e.nsp=this.nsp.name,this.encoder.encode(e)),s=0===n.rooms.size?this.nsp.name:""+this.nsp.name+l+n.rooms.keys().next().value;c("fast publish to %s",s),i.forEach(e=>{var t="string"!=typeof e;o.publish(s,t?e:"4"+e,t)}),this.apply(n,e=>{"websocket"!==e.conn.transport.name&&e.client.writeToEngine(i,t)})}else u.call(this,e,n)}},i.restoreAdapter=function(){n.Adapter.prototype.addAll=a,n.Adapter.prototype.del=p,n.Adapter.prototype.broadcast=u},i.serveFile=function(n,e){let a=(0,r.statSync)(e).size,o=(0,r.createReadStream)(e),t=()=>!o.destroyed&&o.destroy(),i=e=>{throw t(),e},s=e=>{let s=h(e);n.cork(()=>{let i=n.getWriteOffset();var[e,t]=n.tryEnd(s,a);t||e||(o.pause(),n.onWritable(e=>{var[e,t]=n.tryEnd(s.slice(e-i),a);return!t&&e&&o.resume(),e}))})};n.onAborted(t),o.on("data",s).on("error",i).on("end",t)};let n=e("socket.io-adapter"),r=e("fs"),c=(0,s(e("debug")).default)("socket.io:adapter-uws"),l="",{addAll:a,del:p,broadcast:u}=n.Adapter.prototype;function d(t,e,i,s){let n=e.conn.id,a=e.conn.transport.socket;i&&(c("subscribe connection %s to topic %s",n,t),a.subscribe(t)),s.forEach(e=>{e=""+t+l+e;c("subscribe connection %s to topic %s",n,e),a.subscribe(e)})}let h=e=>{var{buffer:e,byteOffset:t,byteLength:i}=e;return e.slice(t,t+i)}},{debug:294,fs:void 0,"socket.io-adapter":261}],292:[function(e,t,i){arguments[4][105][0].apply(i,arguments)},{"./common":293,dup:105}],293:[function(e,t,i){arguments[4][106][0].apply(i,arguments)},{dup:106,ms:202}],294:[function(e,t,i){arguments[4][107][0].apply(i,arguments)},{"./browser.js":292,"./node.js":295,dup:107}],295:[function(e,t,i){arguments[4][108][0].apply(i,arguments)},{"./common":293,dup:108,"supports-color":297,tty:void 0,util:void 0}],296:[function(e,t,i){t.exports={name:"socket.io",version:"4.8.1",description:"node.js realtime framework server",keywords:["realtime","framework","websocket","tcp","events","socket","io"],files:["dist/","client-dist/","wrapper.mjs","!**/*.tsbuildinfo"],directories:{doc:"docs/",example:"example/",lib:"lib/",test:"test/"},type:"commonjs",main:"./dist/index.js",exports:{types:"./dist/index.d.ts",import:"./wrapper.mjs",require:"./dist/index.js"},types:"./dist/index.d.ts",license:"MIT",homepage:"https://github.com/socketio/socket.io/tree/main/packages/socket.io#readme",repository:{type:"git",url:"git+https://github.com/socketio/socket.io.git"},bugs:{url:"https://github.com/socketio/socket.io/issues"},scripts:{compile:"rimraf ./dist && tsc",test:"npm run format:check && npm run compile && npm run test:types && npm run test:unit","test:types":"tsd","test:unit":"nyc mocha --require ts-node/register --reporter spec --slow 200 --bail --timeout 10000 test/index.ts","format:check":'prettier --check "lib/**/*.ts" "test/**/*.ts"',"format:fix":'prettier --write "lib/**/*.ts" "test/**/*.ts"',prepack:"npm run compile"},dependencies:{accepts:"~1.3.4",base64id:"~2.0.0",cors:"~2.8.5",debug:"~4.3.2","engine.io":"~6.6.0","socket.io-adapter":"~2.5.2","socket.io-parser":"~4.2.4"},contributors:[{name:"Guillermo Rauch",email:"rauchg@gmail.com"},{name:"Arnout Kazemier",email:"info@3rd-eden.com"},{name:"Vladimir Dronnikov",email:"dronnikov@gmail.com"},{name:"Einar Otto Stangvik",email:"einaros@gmail.com"}],engines:{node:">=10.2.0"},tsd:{directory:"test"}}},{}],297:[function(e,t,i){let a=e("os");var s=e("tty");let o=e("has-flag"),r=process.env,c;function n(e,{streamIsTTY:t,sniffFlags:i=!0}={}){var s=(()=>{if("FORCE_COLOR"in r)return"true"===r.FORCE_COLOR?1:"false"===r.FORCE_COLOR?0:0===r.FORCE_COLOR.length?1:Math.min(Number.parseInt(r.FORCE_COLOR,10),3)})(),s=(void 0!==s&&(c=s),i?c:s);if(0===s)return 0;if(i){if(o("color=16m")||o("color=full")||o("color=truecolor"))return 3;if(o("color=256"))return 2}if(e&&!t&&void 0===s)return 0;i=s||0;if("dumb"===r.TERM)return i;if("win32"===process.platform)return e=a.release().split("."),10<=Number(e[0])&&10586<=Number(e[2])?14931<=Number(e[2])?3:2:1;if("CI"in r)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(e=>e in r)||"codeship"===r.CI_NAME?1:i;if("TEAMCITY_VERSION"in r)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(r.TEAMCITY_VERSION)?1:0;if("truecolor"===r.COLORTERM)return 3;if("TERM_PROGRAM"in r){var n=Number.parseInt((r.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(r.TERM_PROGRAM){case"iTerm.app":return 3<=n?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(r.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(r.TERM)||"COLORTERM"in r?1:i}function l(e,t={}){e=n(e,{streamIsTTY:e&&e.isTTY,...t});return 0!==(t=e)&&{level:t,hasBasic:!0,has256:2<=t,has16m:3<=t}}o("no-color")||o("no-colors")||o("color=false")||o("color=never")?c=0:(o("color")||o("colors")||o("color=true")||o("color=always"))&&(c=1),t.exports={supportsColor:l,stdout:l({isTTY:s.isatty(1)}),stderr:l({isTTY:s.isatty(2)})}},{"has-flag":191,os:void 0,tty:void 0}],298:[function(e,t,i){var s=e("../prototype/is");t.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!s(e)}},{"../prototype/is":305}],299:[function(e,t,i){var l=e("../string/coerce"),p=e("./to-short-string");t.exports=function(e,t,i){var s=(e=i&&i.errorMessage?l(i.errorMessage):e).indexOf("%v"),t=-1<s?p(t):null;if(i&&i.name){var n,a,o,r,c=e.indexOf("%n");if(-1<c)return-1<s?(r=s<c?(n=t,o=s,a=i.name,c):(n=i.name,o=c,a=t,s),e.slice(0,o)+n+e.slice(o+2,r)+a+e.slice(r+2)):e.slice(0,c)+i.name+e.slice(c+2)}return-1<s?e.slice(0,s)+t+e.slice(s+2):e}},{"../string/coerce":306,"./to-short-string":302}],300:[function(e,t,i){var s=e("../value/is"),n=e("./resolve-error-message");t.exports=function(e,t,i){if(i&&!s(e)){if("default"in i)return i.default;if(i.isOptional)return null}t=new(i&&i.Error||TypeError)(n(t,e,i));throw i&&i.errorCode&&(t.code=i.errorCode),t}},{"../value/is":309,"./resolve-error-message":299}],301:[function(e,t,i){t.exports=function(t){try{return t.toString()}catch(e){try{return String(t)}catch(e){return null}}}},{}],302:[function(e,t,i){var s=e("./safe-to-string"),n=/[\n\r\u2028\u2029]/g;t.exports=function(e){e=s(e);return null===e?"<Non-coercible to string value>":(e=100<e.length?e.slice(0,99)+"":e).replace(n,function(e){switch(e){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}})}},{"./safe-to-string":301}],303:[function(e,t,i){var s=e("../value/is"),n={object:!0,function:!0,undefined:!0};t.exports=function(e){return!!s(e)&&hasOwnProperty.call(n,typeof e)}},{"../value/is":309}],304:[function(e,t,i){var s=e("../function/is"),n=/^\s*class[\s{/}]/,a=Function.prototype.toString;t.exports=function(e){return!!s(e)&&!n.test(a.call(e))}},{"../function/is":298}],305:[function(e,t,i){var s=e("../object/is");t.exports=function(e){if(!s(e))return!1;try{return e.constructor?e.constructor.prototype===e:!1}catch(e){return!1}}},{"../object/is":303}],306:[function(e,t,i){var s=e("../value/is"),n=e("../object/is"),a=Object.prototype.toString;t.exports=function(e){if(!s(e))return null;if(n(e)){var t=e.toString;if("function"!=typeof t)return null;if(t===a)return null}try{return""+e}catch(e){return null}}},{"../object/is":303,"../value/is":309}],307:[function(e,t,i){var s=e("../lib/resolve-exception"),n=e("./coerce");t.exports=function(e){var t,i=n(e);return null!==i?i:(t=(i=arguments[1])&&i.name?"Expected a string for %n, received %v":"%v is not a string",s(e,t,i))}},{"../lib/resolve-exception":300,"./coerce":306}],308:[function(e,t,i){var s=e("../lib/resolve-exception"),n=e("./is");t.exports=function(e){var t,i;return n(e)?e:(i=(t=arguments[1])&&t.name?"Expected a value for %n, received %v":"Cannot use %v",s(e,i,t))}},{"../lib/resolve-exception":300,"./is":309}],309:[function(e,t,i){t.exports=function(e){return null!=e}},{}],310:[function(e,t,i){var s,n,a,o;s=this,n=function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},s=Array.prototype,j=Object.prototype,D="undefined"!=typeof Symbol?Symbol.prototype:null,B=s.push,c=s.slice,u=j.toString,U=j.hasOwnProperty,t="undefined"!=typeof ArrayBuffer,i="undefined"!=typeof DataView,q=Array.isArray,F=Object.keys,H=Object.create,W=t&&ArrayBuffer.isView,G=isNaN,z=isFinite,K=!{toString:null}.propertyIsEnumerable("toString"),V=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Y=Math.pow(2,53)-1;function p(n,a){return a=null==a?n.length-1:+a,function(){for(var e=Math.max(arguments.length-a,0),t=Array(e),i=0;i<e;i++)t[i]=arguments[i+a];switch(a){case 0:return n.call(this,t);case 1:return n.call(this,arguments[0],t);case 2:return n.call(this,arguments[0],arguments[1],t)}for(var s=Array(a+1),i=0;i<a;i++)s[i]=arguments[i];return s[a]=t,n.apply(this,s)}}function a(e){var t=typeof e;return"function"==t||"object"==t&&!!e}function $(e){return void 0===e}function Q(e){return!0===e||!1===e||"[object Boolean]"===u.call(e)}function n(e){var t="[object "+e+"]";return function(e){return u.call(e)===t}}var X=n("String"),J=n("Number"),o=n("Date"),Z=n("RegExp"),ee=n("Error"),te=n("Symbol"),ie=n("ArrayBuffer"),r=n("Function"),e=e.document&&e.document.childNodes,d=r="function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof e?function(e){return"function"==typeof e||!1}:r,e=n("Object"),se=i&&(!/\[native code\]/.test(String(DataView))||e(new DataView(new ArrayBuffer(8)))),r="undefined"!=typeof Map&&e(new Map),i=n("DataView");var h=se?function(e){return null!=e&&d(e.getInt8)&&ie(e.buffer)}:i,m=q||n("Array");function f(e,t){return null!=e&&U.call(e,t)}var ne=n("Arguments"),ae=(!function(){ne(arguments)||(ne=function(e){return f(e,"callee")})}(),ne);function oe(e){return J(e)&&G(e)}function re(e){return function(){return e}}function ce(t){return function(e){e=t(e);return"number"==typeof e&&0<=e&&e<=Y}}function le(t){return function(e){return null==e?void 0:e[t]}}var v=le("byteLength"),pe=ce(v),ue=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var de=t?function(e){return W?W(e)&&!h(e):pe(e)&&ue.test(u.call(e))}:re(!1),y=le("length");function he(e,t){t=(t=>{for(var i={},e=t.length,s=0;s<e;++s)i[t[s]]=!0;return{contains:function(e){return!0===i[e]},push:function(e){return i[e]=!0,t.push(e)}}})(t);var i=V.length,s=e.constructor,n=d(s)&&s.prototype||j,a="constructor";for(f(e,a)&&!t.contains(a)&&t.push(a);i--;)(a=V[i])in e&&e[a]!==n[a]&&!t.contains(a)&&t.push(a)}function g(e){if(!a(e))return[];if(F)return F(e);var t,i=[];for(t in e)f(e,t)&&i.push(t);return K&&he(e,i),i}function me(e,t){var i=g(t),s=i.length;if(null==e)return!s;for(var n=Object(e),a=0;a<s;a++){var o=i[a];if(t[o]!==n[o]||!(o in n))return!1}return!0}function b(e){return e instanceof b?e:this instanceof b?void(this._wrapped=e):new b(e)}function fe(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,v(e))}b.VERSION="1.13.7",b.prototype.valueOf=b.prototype.toJSON=b.prototype.value=function(){return this._wrapped},b.prototype.toString=function(){return String(this._wrapped)};var ve="[object DataView]";function ye(e,t,i,s){var n;return e===t?0!==e||1/e==1/t:null!=e&&null!=t&&(e!=e?t!=t:("function"==(n=typeof e)||"object"==n||"object"==typeof t)&&function e(t,i,s,n){t instanceof b&&(t=t._wrapped);i instanceof b&&(i=i._wrapped);var a=u.call(t);if(a!==u.call(i))return!1;if(se&&"[object Object]"==a&&h(t)){if(!h(i))return!1;a=ve}switch(a){case"[object RegExp]":case"[object String]":return""+t==""+i;case"[object Number]":return+t!=+t?+i!=+i:0==+t?1/+t==1/i:+t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object Symbol]":return D.valueOf.call(t)===D.valueOf.call(i);case"[object ArrayBuffer]":case ve:return e(fe(t),fe(i),s,n)}a="[object Array]"===a;if(!a&&de(t)){var o=v(t);if(o!==v(i))return!1;if(t.buffer===i.buffer&&t.byteOffset===i.byteOffset)return!0;a=!0}if(!a){if("object"!=typeof t||"object"!=typeof i)return!1;var o=t.constructor,r=i.constructor;if(o!==r&&!(d(o)&&o instanceof o&&d(r)&&r instanceof r)&&"constructor"in t&&"constructor"in i)return!1}s=s||[];n=n||[];var c=s.length;for(;c--;)if(s[c]===t)return n[c]===i;s.push(t);n.push(i);if(a){if((c=t.length)!==i.length)return!1;for(;c--;)if(!ye(t[c],i[c],s,n))return!1}else{var l,p=g(t);if(c=p.length,g(i).length!==c)return!1;for(;c--;)if(l=p[c],!f(i,l)||!ye(t[l],i[l],s,n))return!1}s.pop();n.pop();return!0}(e,t,i,s))}function l(e){if(!a(e))return[];var t,i=[];for(t in e)i.push(t);return K&&he(e,i),i}function ge(s){var n=y(s);return function(e){if(null==e)return!1;var t=l(e);if(y(t))return!1;for(var i=0;i<n;i++)if(!d(e[s[i]]))return!1;return s!==xe||!d(e[be])}}var be="forEach",e=["clear","delete"],i=["get","has","set"],q=e.concat(be,i),xe=e.concat(i),t=["add"].concat(e,be,"has"),i=r?ge(q):n("Map"),e=r?ge(xe):n("WeakMap"),q=r?ge(t):n("Set"),r=n("WeakSet");function x(e){for(var t=g(e),i=t.length,s=Array(i),n=0;n<i;n++)s[n]=e[t[n]];return s}function we(e){for(var t={},i=g(e),s=0,n=i.length;s<n;s++)t[e[i[s]]]=i[s];return t}function Ee(e){var t,i=[];for(t in e)d(e[t])&&i.push(t);return i.sort()}function _e(c,l){return function(e){var t=arguments.length;if(l&&(e=Object(e)),!(t<2||null==e))for(var i=1;i<t;i++)for(var s=arguments[i],n=c(s),a=n.length,o=0;o<a;o++){var r=n[o];l&&void 0!==e[r]||(e[r]=s[r])}return e}}var ke=_e(l),w=_e(g),Te=_e(l,!0);function Se(e){var t;return a(e)?H?H(e):((t=function(){}).prototype=e,e=new t,t.prototype=null,e):{}}function Ae(e){return m(e)?e:[e]}function E(e){return b.toPath(e)}function Oe(e,t){for(var i=t.length,s=0;s<i;s++){if(null==e)return;e=e[t[s]]}return i?e:void 0}function Ce(e,t,i){e=Oe(e,E(t));return $(e)?i:e}function Ie(e){return e}function _(t){return t=w({},t),function(e){return me(e,t)}}function Pe(t){return t=E(t),function(e){return Oe(e,t)}}function k(n,a,e){if(void 0===a)return n;switch(null==e?3:e){case 1:return function(e){return n.call(a,e)};case 3:return function(e,t,i){return n.call(a,e,t,i)};case 4:return function(e,t,i,s){return n.call(a,e,t,i,s)}}return function(){return n.apply(a,arguments)}}function Re(e,t,i){return null==e?Ie:d(e)?k(e,t,i):(a(e)&&!m(e)?_:Pe)(e)}function Ne(e,t){return Re(e,t,1/0)}function T(e,t,i){return b.iteratee!==Ne?b.iteratee(e,t):Re(e,t,i)}function Me(){}function Le(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}b.toPath=Ae,b.iteratee=Ne;var S=Date.now||function(){return(new Date).getTime()};function je(t){function i(e){return t[e]}var e="(?:"+g(t).join("|")+")",s=RegExp(e),n=RegExp(e,"g");return function(e){return s.test(e=null==e?"":""+e)?e.replace(n,i):e}}var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},De=je(t),t=je(we(t)),Be=b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Ue=/(.)^/,qe={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Fe=/\\|'|\r|\n|\u2028|\u2029/g;function He(e){return"\\"+qe[e]}var We=/^\s*(\w|\$)+\s*$/;var Ge=0;function ze(e,t,i,s,n){return s instanceof t?(s=Se(e.prototype),a(t=e.apply(s,n))?t:s):e.apply(i,n)}var A=p(function(n,a){function o(){for(var e=0,t=a.length,i=Array(t),s=0;s<t;s++)i[s]=a[s]===r?arguments[e++]:a[s];for(;e<arguments.length;)i.push(arguments[e++]);return ze(n,o,this,this,i)}var r=A.placeholder;return o}),Ke=(A.placeholder=b,p(function(t,i,s){var n;if(d(t))return n=p(function(e){return ze(t,n,i,this,s.concat(e))});throw new TypeError("Bind must be called on a function")})),O=ce(y);function C(e,t,i,s){if(s=s||[],t||0===t){if(t<=0)return s.concat(e)}else t=1/0;for(var n=s.length,a=0,o=y(e);a<o;a++){var r=e[a];if(O(r)&&(m(r)||ae(r)))if(1<t)C(r,t-1,i,s),n=s.length;else for(var c=0,l=r.length;c<l;)s[n++]=r[c++];else i||(s[n++]=r)}return s}var Ve=p(function(e,t){var i=(t=C(t,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var s=t[i];e[s]=Ke(e[s],e)}return e});var Ye=p(function(e,t,i){return setTimeout(function(){return e.apply(null,i)},t)}),$e=A(Ye,b,1);function Qe(e){return function(){return!e.apply(this,arguments)}}function Xe(e,t){var i;return function(){return 0<--e&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}}var Je=A(Xe,2);function Ze(e,t,i){t=T(t,i);for(var s,n=g(e),a=0,o=n.length;a<o;a++)if(t(e[s=n[a]],s,e))return s}function et(a){return function(e,t,i){t=T(t,i);for(var s=y(e),n=0<a?0:s-1;0<=n&&n<s;n+=a)if(t(e[n],n,e))return n;return-1}}var tt=et(1),it=et(-1);function st(e,t,i,s){for(var n=(i=T(i,s,1))(t),a=0,o=y(e);a<o;){var r=Math.floor((a+o)/2);i(e[r])<n?a=r+1:o=r}return a}function nt(a,o,r){return function(e,t,i){var s=0,n=y(e);if("number"==typeof i)0<a?s=0<=i?i:Math.max(i+n,s):n=0<=i?Math.min(i+1,n):i+n+1;else if(r&&i&&n)return e[i=r(e,t)]===t?i:-1;if(t!=t)return 0<=(i=o(c.call(e,s,n),oe))?i+s:-1;for(i=0<a?s:n-1;0<=i&&i<n;i+=a)if(e[i]===t)return i;return-1}}var at=nt(1,tt,st),ot=nt(-1,it);function rt(e,t,i){t=(O(e)?tt:Ze)(e,t,i);if(void 0!==t&&-1!==t)return e[t]}function I(e,t,i){if(t=k(t,i),O(e))for(n=0,a=e.length;n<a;n++)t(e[n],n,e);else for(var s=g(e),n=0,a=s.length;n<a;n++)t(e[s[n]],s[n],e);return e}function P(e,t,i){t=T(t,i);for(var s=!O(e)&&g(e),n=(s||e).length,a=Array(n),o=0;o<n;o++){var r=s?s[o]:o;a[o]=t(e[r],r,e)}return a}function ct(d){return function(e,t,i,s){var n=3<=arguments.length,a=e,o=k(t,s,4),r=i,e=n,c=!O(a)&&g(a),l=(c||a).length,p=0<d?0:l-1;for(e||(r=a[c?c[p]:p],p+=d);0<=p&&p<l;p+=d){var u=c?c[p]:p;r=o(r,a[u],u,a)}return r}}var lt=ct(1),pt=ct(-1);function R(e,s,t){var n=[];return s=T(s,t),I(e,function(e,t,i){s(e,t,i)&&n.push(e)}),n}function ut(e,t,i){t=T(t,i);for(var s=!O(e)&&g(e),n=(s||e).length,a=0;a<n;a++){var o=s?s[a]:a;if(!t(e[o],o,e))return!1}return!0}function dt(e,t,i){t=T(t,i);for(var s=!O(e)&&g(e),n=(s||e).length,a=0;a<n;a++){var o=s?s[a]:a;if(t(e[o],o,e))return!0}return!1}function N(e,t,i,s){return O(e)||(e=x(e)),0<=at(e,t,i="number"==typeof i&&!s?i:0)}var ht=p(function(e,i,s){var n,a;return d(i)?a=i:(i=E(i),n=i.slice(0,-1),i=i[i.length-1]),P(e,function(e){var t=a;if(!t){if(null==(e=n&&n.length?Oe(e,n):e))return;t=e[i]}return null==t?t:t.apply(e,s)})});function mt(e,t){return P(e,Pe(t))}function ft(e,s,t){var i,n,a=-1/0,o=-1/0;if(null==s||"number"==typeof s&&"object"!=typeof e[0]&&null!=e)for(var r=0,c=(e=O(e)?e:x(e)).length;r<c;r++)null!=(i=e[r])&&a<i&&(a=i);else s=T(s,t),I(e,function(e,t,i){n=s(e,t,i),(o<n||n===-1/0&&a===-1/0)&&(a=e,o=n)});return a}var vt=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function yt(e){return e?m(e)?c.call(e):X(e)?e.match(vt):O(e)?P(e,Ie):x(e):[]}function gt(e,t,i){if(null==t||i)return(e=O(e)?e:x(e))[Le(e.length-1)];for(var s=yt(e),i=y(s),n=(t=Math.max(Math.min(t,i),0),i-1),a=0;a<t;a++){var o=Le(a,n),r=s[a];s[a]=s[o],s[o]=r}return s.slice(0,t)}function M(a,t){return function(i,s,e){var n=t?[[],[]]:{};return s=T(s,e),I(i,function(e,t){t=s(e,t,i);a(n,e,t)}),n}}var bt=M(function(e,t,i){f(e,i)?e[i].push(t):e[i]=[t]}),xt=M(function(e,t,i){e[i]=t}),wt=M(function(e,t,i){f(e,i)?e[i]++:e[i]=1}),Et=M(function(e,t,i){e[i?0:1].push(t)},!0);function _t(e,t,i){return t in i}var kt=p(function(e,t){var i={},s=t[0];if(null!=e){d(s)?(1<t.length&&(s=k(s,t[1])),t=l(e)):(s=_t,t=C(t,!1,!1),e=Object(e));for(var n=0,a=t.length;n<a;n++){var o=t[n],r=e[o];s(r,o,e)&&(i[o]=r)}}return i}),Tt=p(function(e,i){var t,s=i[0];return d(s)?(s=Qe(s),1<i.length&&(t=i[1])):(i=P(C(i,!1,!1),String),s=function(e,t){return!N(i,t)}),kt(e,s,t)});function St(e,t,i){return c.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))}function At(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[0]:St(e,e.length-t)}function L(e,t,i){return c.call(e,null==t||i?1:t)}var Ot=p(function(e,t){return t=C(t,!0,!0),R(e,function(e){return!N(t,e)})}),Ct=p(function(e,t){return Ot(e,t)});function It(e,t,i,s){Q(t)||(s=i,i=t,t=!1),null!=i&&(i=T(i,s));for(var n=[],a=[],o=0,r=y(e);o<r;o++){var c=e[o],l=i?i(c,o,e):c;t&&!i?(o&&a===l||n.push(c),a=l):i?N(a,l)||(a.push(l),n.push(c)):N(n,c)||n.push(c)}return n}var Pt=p(function(e){return It(C(e,!0,!0))});function Rt(e){for(var t=e&&ft(e,y).length||0,i=Array(t),s=0;s<t;s++)i[s]=mt(e,s);return i}var Nt=p(Rt);function Mt(e,t){return e._chain?b(t).chain():t}function Lt(i){return I(Ee(i),function(e){var t=b[e]=i[e];b.prototype[e]=function(){var e=[this._wrapped];return B.apply(e,arguments),Mt(this,t.apply(b,e))}}),b}I(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=s[t];b.prototype[t]=function(){var e=this._wrapped;return null!=e&&(i.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0]),Mt(this,e)}}),I(["concat","join","slice"],function(e){var t=s[e];b.prototype[e]=function(){var e=this._wrapped;return Mt(this,e=null!=e?t.apply(e,arguments):e)}});o=Lt({__proto__:null,VERSION:"1.13.7",restArguments:p,isObject:a,isNull:function(e){return null===e},isUndefined:$,isBoolean:Q,isElement:function(e){return!(!e||1!==e.nodeType)},isString:X,isNumber:J,isDate:o,isRegExp:Z,isError:ee,isSymbol:te,isArrayBuffer:ie,isDataView:h,isArray:m,isFunction:d,isArguments:ae,isFinite:function(e){return!te(e)&&z(e)&&!isNaN(parseFloat(e))},isNaN:oe,isTypedArray:de,isEmpty:function(e){var t;return null==e||("number"==typeof(t=y(e))&&(m(e)||X(e)||ae(e))?0===t:0===y(g(e)))},isMatch:me,isEqual:function(e,t){return ye(e,t)},isMap:i,isWeakMap:e,isSet:q,isWeakSet:r,keys:g,allKeys:l,values:x,pairs:function(e){for(var t=g(e),i=t.length,s=Array(i),n=0;n<i;n++)s[n]=[t[n],e[t[n]]];return s},invert:we,functions:Ee,methods:Ee,extend:ke,extendOwn:w,assign:w,defaults:Te,create:function(e,t){return e=Se(e),t&&w(e,t),e},clone:function(e){return a(e)?m(e)?e.slice():ke({},e):e},tap:function(e,t){return t(e),e},get:Ce,has:function(e,t){for(var i=(t=E(t)).length,s=0;s<i;s++){var n=t[s];if(!f(e,n))return!1;e=e[n]}return!!i},mapObject:function(e,t,i){t=T(t,i);for(var s=g(e),n=s.length,a={},o=0;o<n;o++){var r=s[o];a[r]=t(e[r],r,e)}return a},identity:Ie,constant:re,noop:Me,toPath:Ae,property:Pe,propertyOf:function(t){return null==t?Me:function(e){return Ce(t,e)}},matcher:_,matches:_,times:function(e,t,i){var s=Array(Math.max(0,e));t=k(t,i,1);for(var n=0;n<e;n++)s[n]=t(n);return s},random:Le,now:S,escape:De,unescape:t,templateSettings:Be,template:function(a,e,t){e=Te({},e=!e&&t?t:e,b.templateSettings);var i,t=RegExp([(e.escape||Ue).source,(e.interpolate||Ue).source,(e.evaluate||Ue).source].join("|")+"|$","g"),o=0,r="__p+='";if(a.replace(t,function(e,t,i,s,n){return r+=a.slice(o,n).replace(Fe,He),o=n+e.length,t?r+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":i?r+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",t=e.variable){if(!We.test(t))throw new Error("variable is not a bare identifier: "+t)}else r="with(obj||{}){\n"+r+"}\n",t="obj";r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{i=new Function(t,"_",r)}catch(e){throw e.source=r,e}function s(e){return i.call(this,e,b)}return s.source="function("+t+"){\n"+r+"}",s},result:function(e,t,i){var s=(t=E(t)).length;if(!s)return d(i)?i.call(e):i;for(var n=0;n<s;n++){var a=null==e?void 0:e[t[n]];void 0===a&&(a=i,n=s),e=d(a)?a.call(e):a}return e},uniqueId:function(e){var t=++Ge+"";return e?e+t:t},chain:function(e){return(e=b(e))._chain=!0,e},iteratee:Ne,partial:A,bind:Ke,bindAll:Ve,memoize:function(i,s){function n(e){var t=n.cache,e=""+(s?s.apply(this,arguments):e);return f(t,e)||(t[e]=i.apply(this,arguments)),t[e]}return n.cache={},n},delay:Ye,defer:$e,throttle:function(i,s,n){function a(){p=!1===n.leading?0:S(),o=null,l=i.apply(r,c),o||(r=c=null)}function e(){var e=S(),t=(p||!1!==n.leading||(p=e),s-(e-p));return r=this,c=arguments,t<=0||s<t?(o&&(clearTimeout(o),o=null),p=e,l=i.apply(r,c),o||(r=c=null)):o||!1===n.trailing||(o=setTimeout(a,t)),l}var o,r,c,l,p=0;return n=n||{},e.cancel=function(){clearTimeout(o),p=0,o=r=c=null},e},debounce:function(t,i,s){function n(){var e=S()-o;e<i?a=setTimeout(n,i-e):(a=null,s||(c=t.apply(l,r)),a||(r=l=null))}var a,o,r,c,l,e=p(function(e){return l=this,r=e,o=S(),a||(a=setTimeout(n,i),s&&(c=t.apply(l,r))),c});return e.cancel=function(){clearTimeout(a),a=r=l=null},e},wrap:function(e,t){return A(t,e)},negate:Qe,compose:function(){var i=arguments,s=i.length-1;return function(){for(var e=s,t=i[s].apply(this,arguments);e--;)t=i[e].call(this,t);return t}},after:function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},before:Xe,once:Je,findKey:Ze,findIndex:tt,findLastIndex:it,sortedIndex:st,indexOf:at,lastIndexOf:ot,find:rt,detect:rt,findWhere:function(e,t){return rt(e,_(t))},each:I,forEach:I,map:P,collect:P,reduce:lt,foldl:lt,inject:lt,reduceRight:pt,foldr:pt,filter:R,select:R,reject:function(e,t,i){return R(e,Qe(T(t)),i)},every:ut,all:ut,some:dt,any:dt,contains:N,includes:N,include:N,invoke:ht,pluck:mt,where:function(e,t){return R(e,_(t))},max:ft,min:function(e,s,t){var i,n,a=1/0,o=1/0;if(null==s||"number"==typeof s&&"object"!=typeof e[0]&&null!=e)for(var r=0,c=(e=O(e)?e:x(e)).length;r<c;r++)null!=(i=e[r])&&i<a&&(a=i);else s=T(s,t),I(e,function(e,t,i){((n=s(e,t,i))<o||n===1/0&&a===1/0)&&(a=e,o=n)});return a},shuffle:function(e){return gt(e,1/0)},sample:gt,sortBy:function(e,s,t){var n=0;return s=T(s,t),mt(P(e,function(e,t,i){return{value:e,index:n++,criteria:s(e,t,i)}}).sort(function(e,t){var i=e.criteria,s=t.criteria;if(i!==s){if(s<i||void 0===i)return 1;if(i<s||void 0===s)return-1}return e.index-t.index}),"value")},groupBy:bt,indexBy:xt,countBy:wt,partition:Et,toArray:yt,size:function(e){return null==e?0:(O(e)?e:g(e)).length},pick:kt,omit:Tt,first:At,head:At,take:At,initial:St,last:function(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[e.length-1]:L(e,Math.max(0,e.length-t))},rest:L,tail:L,drop:L,compact:function(e){return R(e,Boolean)},flatten:function(e,t){return C(e,t,!1)},without:Ct,uniq:It,unique:It,union:Pt,intersection:function(e){for(var t=[],i=arguments.length,s=0,n=y(e);s<n;s++){var a=e[s];if(!N(t,a)){for(var o=1;o<i&&N(arguments[o],a);o++);o===i&&t.push(a)}}return t},difference:Ot,unzip:Rt,transpose:Rt,zip:Nt,object:function(e,t){for(var i={},s=0,n=y(e);s<n;s++)t?i[e[s]]=t[s]:i[e[s][0]]=e[s][1];return i},range:function(e,t,i){null==t&&(t=e||0,e=0),i=i||(t<e?-1:1);for(var s=Math.max(Math.ceil((t-e)/i),0),n=Array(s),a=0;a<s;a++,e+=i)n[a]=e;return n},chunk:function(e,t){if(null==t||t<1)return[];for(var i=[],s=0,n=e.length;s<n;)i.push(c.call(e,s,s+=t));return i},mixin:Lt,default:b});return o._=o},"object"==typeof i&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define("underscore",n):(s="undefined"!=typeof globalThis?globalThis:s||self,a=s._,(o=s._=n()).noConflict=function(){return s._=a,o})},{}],311:[function(e,t,i){var s=e("type/string/ensure"),n=e("./lib/uni-global"),a=Object.prototype.hasOwnProperty;t.exports=function(e){var t;return e=s(e,{name:"key"}),a.call(n,e)?n[e]:(t=Object.create?Object.create(null):{},n[e]=t)}},{"./lib/uni-global":313,"type/string/ensure":307}],312:[function(e,t,i){Object.defineProperty&&Object.create?"function"==typeof Symbol&&Symbol.for?t.exports="2015+":t.exports="5":t.exports="3"},{}],313:[function(e,t,i){var s=e("./es-env-type");switch(s){case"3":return EvalError.$ug202109?void(t.exports=EvalError.$ug202109):void(t.exports=EvalError.$ug202109={});case"5":return EvalError.$uniGlobal202109?void(t.exports=EvalError.$uniGlobal202109):void Object.defineProperty(EvalError,"$uniGlobal202109",{value:t.exports=Object.create(null)});case"2015+":var n=Symbol.for("$uniGlobal202109");return EvalError[n]?void(t.exports=EvalError[n]):void Object.defineProperty(EvalError,n,{value:t.exports=Object.create(null)});default:throw new Error("Unrecognized environment type: "+s)}},{"./es-env-type":312}],314:[function(e,t,i){t.exports=function(e){if(!e)throw new TypeError("argument stream is required");if("function"==typeof e.unpipe)e.unpipe();else if((e=>{for(var t=e.listeners("data"),i=0;i<t.length;i++)if("ondata"===t[i].name)return 1})(e))for(var t,i=e.listeners("close"),s=0;s<i.length;s++)"cleanup"!==(t=i[s]).name&&"onclose"!==t.name||t.call(e)}},{}],315:[function(e,t,i){t.exports=function(e,t){if(e&&t)for(var i in t)e[i]=t[i];return e}},{}],316:[function(e,t,i){t.exports=function(e,t){if(!e||!e.getHeader||!e.setHeader)throw new TypeError("res argument is required");var i=e.getHeader("Vary")||"";(i=s(Array.isArray(i)?i.join(", "):String(i),t))&&e.setHeader("Vary",i)},t.exports.append=s;var c=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/;function s(e,t){if("string"!=typeof e)throw new TypeError("header argument is required");if(!t)throw new TypeError("field argument is required");for(var i=Array.isArray(t)?t:l(String(t)),s=0;s<i.length;s++)if(!c.test(i[s]))throw new TypeError("field argument contains an invalid header name");if("*"===e)return e;var n=e,a=l(e.toLowerCase());if(-1!==i.indexOf("*")||-1!==a.indexOf("*"))return"*";for(var o=0;o<i.length;o++){var r=i[o].toLowerCase();-1===a.indexOf(r)&&(a.push(r),n=n?n+", "+i[o]:i[o])}return n}function l(e){for(var t=0,i=[],s=0,n=0,a=e.length;n<a;n++)switch(e.charCodeAt(n)){case 32:s===t&&(s=t=n+1);break;case 44:i.push(e.substring(s,t)),s=t=n+1;break;default:t=n+1}return i.push(e.substring(s,t)),i}},{}],317:[function(e,t,i){var s=e("./lib/websocket");s.createWebSocketStream=e("./lib/stream"),s.Server=e("./lib/websocket-server"),s.Receiver=e("./lib/receiver"),s.Sender=e("./lib/sender"),(s.WebSocket=s).WebSocketServer=s.Server,t.exports=s},{"./lib/receiver":324,"./lib/sender":325,"./lib/stream":326,"./lib/websocket":330,"./lib/websocket-server":329}],318:[function(e,t,i){let a=e("./constants").EMPTY_BUFFER,o=Buffer[Symbol.species];function r(t,i,s,n,a){for(let e=0;e<a;e++)s[n+e]=t[e]^i[3&e]}function s(t,i){for(let e=0;e<t.length;e++)t[e]^=i[3&e]}function n(e){if(n.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=new o(e):ArrayBuffer.isView(e)?t=new o(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),n.readOnly=!1),t}if(t.exports={concat:function(t,e){if(0===t.length)return a;if(1===t.length)return t[0];var i=Buffer.allocUnsafe(e);let s=0;for(let e=0;e<t.length;e++){var n=t[e];i.set(n,s),s+=n.length}return s<e?new o(i.buffer,i.byteOffset,s):i},mask:r,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:n,unmask:s},!process.env.WS_NO_BUFFER_UTIL)try{let a=e("bufferutil");t.exports.mask=function(e,t,i,s,n){n<48?r(e,t,i,s,n):a.mask(e,t,i,s,n)},t.exports.unmask=function(e,t){e.length<32?s(e,t):a.unmask(e,t)}}catch(e){}},{"./constants":319,bufferutil:void 0}],319:[function(e,t,i){t.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},{}],320:[function(e,t,i){let{kForOnEventAttribute:a,kListener:o}=e("./constants"),s=Symbol("kCode"),n=Symbol("kData"),r=Symbol("kError"),c=Symbol("kMessage"),l=Symbol("kReason"),p=Symbol("kTarget"),u=Symbol("kType"),d=Symbol("kWasClean");class h{constructor(e){this[p]=null,this[u]=e}get target(){return this[p]}get type(){return this[u]}}Object.defineProperty(h.prototype,"target",{enumerable:!0}),Object.defineProperty(h.prototype,"type",{enumerable:!0});class m extends h{constructor(e,t={}){super(e),this[s]=void 0===t.code?0:t.code,this[l]=void 0===t.reason?"":t.reason,this[d]=void 0!==t.wasClean&&t.wasClean}get code(){return this[s]}get reason(){return this[l]}get wasClean(){return this[d]}}Object.defineProperty(m.prototype,"code",{enumerable:!0}),Object.defineProperty(m.prototype,"reason",{enumerable:!0}),Object.defineProperty(m.prototype,"wasClean",{enumerable:!0});class f extends h{constructor(e,t={}){super(e),this[r]=void 0===t.error?null:t.error,this[c]=void 0===t.message?"":t.message}get error(){return this[r]}get message(){return this[c]}}Object.defineProperty(f.prototype,"error",{enumerable:!0}),Object.defineProperty(f.prototype,"message",{enumerable:!0});class v extends h{constructor(e,t={}){super(e),this[n]=void 0===t.data?null:t.data}get data(){return this[n]}}function y(e,t,i){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,i):e.call(t,i)}Object.defineProperty(v.prototype,"data",{enumerable:!0}),t.exports={CloseEvent:m,ErrorEvent:f,Event:h,EventTarget:{addEventListener(e,i,t={}){for(var s of this.listeners(e))if(!t[a]&&s[o]===i&&!s[a])return;let n;if("message"===e)n=function(e,t){t=new v("message",{data:t?e:e.toString()});t[p]=this,y(i,this,t)};else if("close"===e)n=function(e,t){e=new m("close",{code:e,reason:t.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});e[p]=this,y(i,this,e)};else if("error"===e)n=function(e){e=new f("error",{error:e,message:e.message});e[p]=this,y(i,this,e)};else{if("open"!==e)return;n=function(){var e=new h("open");e[p]=this,y(i,this,e)}}n[a]=!!t[a],n[o]=i,t.once?this.once(e,n):this.on(e,n)},removeEventListener(e,t){for(var i of this.listeners(e))if(i[o]===t&&!i[a]){this.removeListener(e,i);break}}},MessageEvent:v}},{"./constants":319}],321:[function(e,t,i){let m=e("./validation").tokenChars;function f(e,t,i){void 0===e[t]?e[t]=[i]:e[t].push(i)}t.exports={format:function(i){return Object.keys(i).map(e=>{let t=i[e];return(t=Array.isArray(t)?t:[t]).map(i=>[e].concat(Object.keys(i).map(t=>{let e=i[t];return(e=Array.isArray(e)?e:[e]).map(e=>!0===e?t:t+"="+e).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(t){var i=Object.create(null);let s=Object.create(null),n=!1,e=!1,a=!1,o,r,c=-1,l=-1,p=-1,u=0;for(;u<t.length;u++)if(l=t.charCodeAt(u),void 0===o)if(-1===p&&1===m[l])-1===c&&(c=u);else if(0===u||32!==l&&9!==l){if(59!==l&&44!==l)throw new SyntaxError("Unexpected character at index "+u);if(-1===c)throw new SyntaxError("Unexpected character at index "+u);-1===p&&(p=u);var d=t.slice(c,p);44===l?(f(i,d,s),s=Object.create(null)):o=d,c=p=-1}else-1===p&&-1!==c&&(p=u);else if(void 0===r)if(-1===p&&1===m[l])-1===c&&(c=u);else if(32===l||9===l)-1===p&&-1!==c&&(p=u);else{if(59===l||44===l){if(-1===c)throw new SyntaxError("Unexpected character at index "+u);-1===p&&(p=u),f(s,t.slice(c,p),!0),44===l&&(f(i,o,s),s=Object.create(null),o=void 0)}else{if(61!==l||-1===c||-1!==p)throw new SyntaxError("Unexpected character at index "+u);r=t.slice(c,u)}c=p=-1}else if(e){if(1!==m[l])throw new SyntaxError("Unexpected character at index "+u);-1===c?c=u:n=n||!0,e=!1}else if(a)if(1===m[l])-1===c&&(c=u);else if(34===l&&-1!==c)a=!1,p=u;else{if(92!==l)throw new SyntaxError("Unexpected character at index "+u);e=!0}else if(34===l&&61===t.charCodeAt(u-1))a=!0;else if(-1===p&&1===m[l])-1===c&&(c=u);else if(-1===c||32!==l&&9!==l){if(59!==l&&44!==l)throw new SyntaxError("Unexpected character at index "+u);{if(-1===c)throw new SyntaxError("Unexpected character at index "+u);-1===p&&(p=u);let e=t.slice(c,p);n&&(e=e.replace(/\\/g,""),n=!1),f(s,r,e),44===l&&(f(i,o,s),s=Object.create(null),o=void 0),r=void 0,c=p=-1}}else-1===p&&(p=u);if(-1===c||a||32===l||9===l)throw new SyntaxError("Unexpected end of input");-1===p&&(p=u);var h=t.slice(c,p);return void 0===o?f(i,h,s):(void 0===r?f(s,h,!0):n?f(s,r,h.replace(/\\/g,"")):f(s,r,h),f(i,o,s)),i}}},{"./validation":328}],322:[function(e,t,i){let s=Symbol("kDone"),n=Symbol("kRun");class a{constructor(e){this[s]=()=>{this.pending--,this[n]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[n]()}[n](){var e;this.pending!==this.concurrency&&this.jobs.length&&(e=this.jobs.shift(),this.pending++,e(this[s]))}}t.exports=a},{}],323:[function(e,t,i){let a=e("zlib"),o=e("./buffer-util"),s=e("./limiter"),n=e("./constants").kStatusCode,r=Buffer[Symbol.species],c=Buffer.from([0,0,255,255]),l=Symbol("permessage-deflate"),p=Symbol("total-length"),u=Symbol("callback"),d=Symbol("buffers"),h=Symbol("error"),m;function f(e){this[d].push(e),this[p]+=e.length}function v(e){this[p]+=e.length,this[l]._maxPayload<1||this[p]<=this[l]._maxPayload?this[d].push(e):(this[h]=new RangeError("Max payload size exceeded"),this[h].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[h][n]=1009,this.removeListener("data",v),this.reset())}function y(e){this[l]._inflate=null,e[n]=1007,this[u](e)}t.exports=class{constructor(e,t,i){this._maxPayload=0|i,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,m||(i=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10,m=new s(i))}static get extensionName(){return"permessage-deflate"}offer(){var e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){var e;this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate&&(e=this._deflate[u],this._deflate.close(),this._deflate=null,e)&&e(new Error("The deflate stream was closed while data was being processed"))}acceptAsServer(e){let t=this._options;e=e.find(e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits));if(e)return t.serverNoContextTakeover&&(e.server_no_context_takeover=!0),t.clientNoContextTakeover&&(e.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(e.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?e.client_max_window_bits=t.clientMaxWindowBits:!0!==e.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete e.client_max_window_bits,e;throw new Error("None of the extension offers can be accepted")}acceptAsClient(e){e=e[0];if(!1===this._options.clientNoContextTakeover&&e.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(e.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&e.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(e.client_max_window_bits=this._options.clientMaxWindowBits);return e}normalizeParams(e){return e.forEach(s=>{Object.keys(s).forEach(e=>{let t=s[e];if(1<t.length)throw new Error(`Parameter "${e}" must have only a single value`);if(t=t[0],"client_max_window_bits"===e){if(!0!==t){var i=+t;if(!Number.isInteger(i)||i<8||15<i)throw new TypeError(`Invalid value for parameter "${e}": `+t);t=i}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${e}": `+t)}else if("server_max_window_bits"===e){i=+t;if(!Number.isInteger(i)||i<8||15<i)throw new TypeError(`Invalid value for parameter "${e}": `+t);t=i}else{if("client_no_context_takeover"!==e&&"server_no_context_takeover"!==e)throw new Error(`Unknown parameter "${e}"`);if(!0!==t)throw new TypeError(`Invalid value for parameter "${e}": `+t)}s[e]=t})}),e}decompress(e,t,s){m.add(i=>{this._decompress(e,t,(e,t)=>{i(),s(e,t)})})}compress(e,t,s){m.add(i=>{this._compress(e,t,(e,t)=>{i(),s(e,t)})})}_decompress(e,t,i){let s=this._isServer?"client":"server";var n;this._inflate||(n=s+"_max_window_bits",n="number"!=typeof this.params[n]?a.Z_DEFAULT_WINDOWBITS:this.params[n],this._inflate=a.createInflateRaw({...this._options.zlibInflateOptions,windowBits:n}),(this._inflate[l]=this)._inflate[p]=0,this._inflate[d]=[],this._inflate.on("error",y),this._inflate.on("data",v)),this._inflate[u]=i,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush(()=>{var e=this._inflate[h];e?(this._inflate.close(),this._inflate=null,i(e)):(e=o.concat(this._inflate[d],this._inflate[p]),this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[p]=0,this._inflate[d]=[],t&&this.params[s+"_no_context_takeover"]&&this._inflate.reset()),i(null,e))})}_compress(e,t,i){let s=this._isServer?"server":"client";var n;this._deflate||(n=s+"_max_window_bits",n="number"!=typeof this.params[n]?a.Z_DEFAULT_WINDOWBITS:this.params[n],this._deflate=a.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:n}),this._deflate[p]=0,this._deflate[d]=[],this._deflate.on("data",f)),this._deflate[u]=i,this._deflate.write(e),this._deflate.flush(a.Z_SYNC_FLUSH,()=>{if(this._deflate){let e=o.concat(this._deflate[d],this._deflate[p]);t&&(e=new r(e.buffer,e.byteOffset,e.length-4)),this._deflate[u]=null,this._deflate[p]=0,this._deflate[d]=[],t&&this.params[s+"_no_context_takeover"]&&this._deflate.reset(),i(null,e)}})}}},{"./buffer-util":318,"./constants":319,"./limiter":322,zlib:void 0}],324:[function(e,t,i){var s=e("stream").Writable;let n=e("./permessage-deflate"),{BINARY_TYPES:a,EMPTY_BUFFER:o,kStatusCode:r,kWebSocket:c}=e("./constants"),{concat:l,toArrayBuffer:p,unmask:u}=e("./buffer-util"),{isValidStatusCode:d,isValidUTF8:h}=e("./validation"),m=Buffer[Symbol.species];class f extends s{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||a[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[c]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,i){if(8===this._opcode&&0==this._state)return i();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(i)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();var t;if(e<this._buffers[0].length)return t=this._buffers[0],this._buffers[0]=new m(t.buffer,t.byteOffset+e,t.length-e),new m(t.buffer,t.byteOffset,e);var i=Buffer.allocUnsafe(e);do{var s=this._buffers[0],n=i.length-e;e>=s.length?i.set(this._buffers.shift(),n):(i.set(new Uint8Array(s.buffer,s.byteOffset,e),n),this._buffers[0]=new m(s.buffer,s.byteOffset+e,s.length-e)),e-=s.length}while(0<e);return i}startLoop(e){this._loop=!0;do{switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:return void(this._loop=!1)}}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2)this._loop=!1;else{var t=this.consume(2);if(0!=(48&t[0]))e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));else{var i=64==(64&t[0]);if(i&&!this._extensions[n.extensionName])e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));else{if(this._fin=128==(128&t[0]),this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(i)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void e(this.createError(RangeError,"invalid opcode "+this._opcode,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=i}else{if(!(7<this._opcode&&this._opcode<11))return void e(this.createError(RangeError,"invalid opcode "+this._opcode,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(i)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(125<this._payloadLength||8===this._opcode&&1===this._payloadLength)return void e(this.createError(RangeError,"invalid payload length "+this._payloadLength,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&t[1]),this._isServer){if(!this._masked)return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}}}}getPayloadLength16(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}getPayloadLength64(e){var t,i;this._bufferedBytes<8?this._loop=!1:(i=(t=this.consume(8)).readUInt32BE(0))>Math.pow(2,21)-1?e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=i*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e))}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&0<this._maxPayload))return void e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!=(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&u(t,this._mask)}7<this._opcode?this.controlMessage(t,e):this._compressed?(this._state=5,this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e))}decompress(e,i){this._extensions[n.extensionName].decompress(e,this._fin,(e,t)=>{if(e)return i(e);if(t.length){if(this._messageLength+=t.length,this._messageLength>this._maxPayload&&0<this._maxPayload)return e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"),void i(e);this._fragments.push(t)}this.dataMessage(i),0===this._state&&this.startLoop(i)})}dataMessage(t){if(this._fin){var i=this._messageLength,s=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let e;e="nodebuffer"===this._binaryType?l(s,i):"arraybuffer"===this._binaryType?p(l(s,i)):s,this._allowSynchronousEvents?(this.emit("message",e,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",e,!0),this._state=0,this.startLoop(t)}))}else{let e=l(s,i);this._skipUTF8Validation||h(e)?5===this._state||this._allowSynchronousEvents?(this.emit("message",e,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",e,!1),this._state=0,this.startLoop(t)})):(s=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"),t(s))}}else this._state=0}controlMessage(e,t){if(8===this._opcode){if(0===e.length)this._loop=!1,this.emit("conclude",1005,o);else{var i=e.readUInt16BE(0);if(!d(i))return n=this.createError(RangeError,"invalid status code "+i,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"),void t(n);var s,n=new m(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!h(n))return s=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"),void t(s);this._loop=!1,this.emit("conclude",i,n)}this.end(),this._state=0}else this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)}))}createError(e,t,i,s,n){this._loop=!1,this._errored=!0;e=new e(i?"Invalid WebSocket frame: "+t:t);return Error.captureStackTrace(e,this.createError),e.code=n,e[r]=s,e}}t.exports=f},{"./buffer-util":318,"./constants":319,"./permessage-deflate":323,"./validation":328,stream:void 0}],325:[function(e,t,i){var{}=e("stream");let l=e("crypto").randomFillSync,c=e("./permessage-deflate"),o=e("./constants").EMPTY_BUFFER,r=e("./validation").isValidStatusCode,{mask:p,toBuffer:u}=e("./buffer-util"),d=Symbol("kByteLength"),h=Buffer.alloc(4),m,f=8192;class v{constructor(e,t,i){this._extensions=t||{},i&&(this._generateMask=i,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let i,s=!1,n=2,a=!1;t.mask&&(i=t.maskBuffer||h,t.generateMask?t.generateMask(i):(8192===f&&(void 0===m&&(m=Buffer.alloc(8192)),l(m,0,8192),f=0),i[0]=m[f++],i[1]=m[f++],i[2]=m[f++],i[3]=m[f++]),a=0==(i[0]|i[1]|i[2]|i[3]),n=6);let o,r=("string"==typeof e?o=t.mask&&!a||void 0===t[d]?(e=Buffer.from(e)).length:t[d]:(o=e.length,s=t.mask&&t.readOnly&&!a),o);65536<=o?(n+=8,r=127):125<o&&(n+=2,r=126);var c=Buffer.allocUnsafe(s?o+n:n);if(c[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(c[0]|=64),126===(c[1]=r)?c.writeUInt16BE(o,2):127===r&&(c[2]=c[3]=0,c.writeUIntBE(o,4,6)),t.mask&&(c[1]|=128,c[n-4]=i[0],c[n-3]=i[1],c[n-2]=i[2],c[n-1]=i[3],!a)){if(s)return p(e,i,c,n,o),[c];p(e,i,e,0,o)}return[c,e]}close(e,t,i,s){let n;if(void 0===e)n=o;else{if("number"!=typeof e||!r(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){var a=Buffer.byteLength(t);if(123<a)throw new RangeError("The message must not be greater than 123 bytes");(n=Buffer.allocUnsafe(2+a)).writeUInt16BE(e,0),"string"==typeof t?n.write(t,2):n.set(t,2)}else(n=Buffer.allocUnsafe(2)).writeUInt16BE(e,0)}a={[d]:n.length,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,n,!1,a,s]):this.sendFrame(v.frame(n,a),s)}ping(e,t,i){let s,n;if(n="string"==typeof e?(s=Buffer.byteLength(e),!1):(e=u(e),s=e.length,u.readOnly),125<s)throw new RangeError("The data size must not be greater than 125 bytes");t={[d]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:n,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,t,i]):this.sendFrame(v.frame(e,t),i)}pong(e,t,i){let s,n;if(n="string"==typeof e?(s=Buffer.byteLength(e),!1):(e=u(e),s=e.length,u.readOnly),125<s)throw new RangeError("The data size must not be greater than 125 bytes");t={[d]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:n,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,t,i]):this.sendFrame(v.frame(e,t),i)}send(e,t,i){var s=this._extensions[c.extensionName];let n=t.binary?2:1,a=t.compress,o,r;r="string"==typeof e?(o=Buffer.byteLength(e),!1):(e=u(e),o=e.length,u.readOnly),this._firstFragment?(this._firstFragment=!1,a&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(a=o>=s._threshold),this._compress=a):(a=!1,n=0),t.fin&&(this._firstFragment=!0),s?(s={[d]:o,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:r,rsv1:a},this._deflating?this.enqueue([this.dispatch,e,this._compress,s,i]):this.dispatch(e,this._compress,s,i)):this.sendFrame(v.frame(e,{[d]:o,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:r,rsv1:!1}),i)}dispatch(e,t,n,a){t?(t=this._extensions[c.extensionName],this._bufferedBytes+=n[d],this._deflating=!0,t.compress(e,n.fin,(e,t)=>{if(this._socket.destroyed){var i=new Error("The socket was closed while data was being compressed");"function"==typeof a&&a(i);for(let e=0;e<this._queue.length;e++){var s=this._queue[e],s=s[s.length-1];"function"==typeof s&&s(i)}}else this._bufferedBytes-=n[d],this._deflating=!1,n.readOnly=!1,this.sendFrame(v.frame(t,n),a),this.dequeue()})):this.sendFrame(v.frame(e,n),a)}dequeue(){for(;!this._deflating&&this._queue.length;){var e=this._queue.shift();this._bufferedBytes-=e[3][d],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][d],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}t.exports=v},{"./buffer-util":318,"./constants":319,"./permessage-deflate":323,"./validation":328,crypto:void 0,stream:void 0}],326:[function(e,t,i){let o=e("stream").Duplex;function r(e){e.emit("close")}function c(){!this.destroyed&&this._writableState.finished&&this.destroy()}function l(e){this.removeListener("error",l),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}t.exports=function(s,e){let n=!0,a=new o({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return s.on("message",function(e,t){t=!t&&a._readableState.objectMode?e.toString():e;a.push(t)||s.pause()}),s.once("error",function(e){a.destroyed||(n=!1,a.destroy(e))}),s.once("close",function(){a.destroyed||a.push(null)}),a._destroy=function(e,i){if(s.readyState===s.CLOSED)i(e),process.nextTick(r,a);else{let t=!1;s.once("error",function(e){t=!0,i(e)}),s.once("close",function(){t||i(e),process.nextTick(r,a)}),n&&s.terminate()}},a._final=function(e){s.readyState===s.CONNECTING?s.once("open",function(){a._final(e)}):null!==s._socket&&(s._socket._writableState.finished?(e(),a._readableState.endEmitted&&a.destroy()):(s._socket.once("finish",function(){e()}),s.close()))},a._read=function(){s.isPaused&&s.resume()},a._write=function(e,t,i){s.readyState===s.CONNECTING?s.once("open",function(){a._write(e,t,i)}):s.send(e,i)},a.on("end",c),a.on("error",l),a}},{stream:void 0}],327:[function(e,t,i){let r=e("./validation").tokenChars;t.exports={parse:function(t){var i=new Set;let s=-1,n=-1,a=0;for(a;a<t.length;a++){var e=t.charCodeAt(a);if(-1===n&&1===r[e])-1===s&&(s=a);else if(0===a||32!==e&&9!==e){if(44!==e)throw new SyntaxError("Unexpected character at index "+a);{if(-1===s)throw new SyntaxError("Unexpected character at index "+a);-1===n&&(n=a);let e=t.slice(s,n);if(i.has(e))throw new SyntaxError(`The "${e}" subprotocol is duplicated`);i.add(e),s=n=-1}}else-1===n&&-1!==s&&(n=a)}if(-1===s||-1!==n)throw new SyntaxError("Unexpected end of input");let o=t.slice(s,a);if(i.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);return i.add(o),i}}},{"./validation":328}],328:[function(e,i,t){let s=e("buffer").isUtf8;function n(e){var t=e.length;let i=0;for(;i<t;)if(0==(128&e[i]))i++;else if(192==(224&e[i])){if(i+1===t||128!=(192&e[i+1])||192==(254&e[i]))return!1;i+=2}else if(224==(240&e[i])){if(i+2>=t||128!=(192&e[i+1])||128!=(192&e[i+2])||224===e[i]&&128==(224&e[i+1])||237===e[i]&&160==(224&e[i+1]))return!1;i+=3}else{if(240!=(248&e[i]))return!1;if(i+3>=t||128!=(192&e[i+1])||128!=(192&e[i+2])||128!=(192&e[i+3])||240===e[i]&&128==(240&e[i+1])||244===e[i]&&143<e[i+1]||244<e[i])return!1;i+=4}return!0}if(i.exports={isValidStatusCode:function(e){return 1e3<=e&&e<=1014&&1004!==e&&1005!==e&&1006!==e||3e3<=e&&e<=4999},isValidUTF8:n,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},s)i.exports.isValidUTF8=function(e){return(e.length<24?n:s)(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=e("utf-8-validate");i.exports.isValidUTF8=function(e){return(e.length<32?n:t)(e)}}catch(e){}},{buffer:void 0,"utf-8-validate":void 0}],329:[function(e,t,i){var s=e("events");let n=e("http");var{}=e("stream");let c=e("crypto").createHash,u=e("./extension"),d=e("./permessage-deflate"),h=e("./subprotocol"),a=e("./websocket"),{GUID:l,kWebSocket:p}=e("./constants"),m=/^[+/0-9A-Za-z]{22}==$/;class o extends s{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:a,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=n.createServer((e,t)=>{var i=n.STATUS_CODES[426];t.writeHead(426,{"Content-Length":i.length,"Content-Type":"text/plain"}),t.end(i)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let s=this.emit.bind(this,"connection");this._removeListeners=((t,i)=>{for(var e of Object.keys(i))t.on(e,i[e]);return function(){for(var e of Object.keys(i))t.removeListener(e,i[e])}})(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(e,t,i)=>{this.handleUpgrade(e,t,i,s)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){var t;2===this._state?(e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(f,this)):(e&&this.once("close",e),1!==this._state&&(this._state=1,this.options.noServer||this.options.server?(this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(f,this)):(t=this._server,this._removeListeners(),this._removeListeners=this._server=null,t.close(()=>{f(this)}))))}shouldHandle(e){if(this.options.path){var t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(o,r,c,l){r.on("error",v);let p=o.headers["sec-websocket-key"];var e=o.headers.upgrade,t=+o.headers["sec-websocket-version"];if("GET"!==o.method)g(this,o,r,405,"Invalid HTTP method");else if(void 0===e||"websocket"!==e.toLowerCase())g(this,o,r,400,"Invalid Upgrade header");else if(void 0!==p&&m.test(p))if(8!=t&&13!=t)g(this,o,r,400,"Missing or invalid Sec-WebSocket-Version header");else if(this.shouldHandle(o)){e=o.headers["sec-websocket-protocol"];let n=new Set;if(void 0!==e)try{n=h.parse(e)}catch(e){return void g(this,o,r,400,"Invalid Sec-WebSocket-Protocol header")}e=o.headers["sec-websocket-extensions"];let a={};if(this.options.perMessageDeflate&&void 0!==e){var i=new d(this.options.perMessageDeflate,!0,this.options.maxPayload);try{var s=u.parse(e);s[d.extensionName]&&(i.accept(s[d.extensionName]),a[d.extensionName]=i)}catch(e){return void g(this,o,r,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){e={origin:o.headers[8==t?"sec-websocket-origin":"origin"],secure:!(!o.socket.authorized&&!o.socket.encrypted),req:o};if(2===this.options.verifyClient.length)return void this.options.verifyClient(e,(e,t,i,s)=>{if(!e)return y(r,t||401,i,s);this.completeUpgrade(a,p,n,o,r,c,l)});if(!this.options.verifyClient(e))return y(r,401)}this.completeUpgrade(a,p,n,o,r,c,l)}else y(r,400);else g(this,o,r,400,"Missing or invalid Sec-WebSocket-Key header")}completeUpgrade(e,t,i,s,n,a,o){if(!n.readable||!n.writable)return n.destroy();if(n[p])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(0<this._state)return y(n,503);t=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: "+c("sha1").update(t+l).digest("base64")];let r=new this.options.WebSocket(null,void 0,this.options);i.size&&(i=this.options.handleProtocols?this.options.handleProtocols(i,s):i.values().next().value)&&(t.push("Sec-WebSocket-Protocol: "+i),r._protocol=i),e[d.extensionName]&&(i=e[d.extensionName].params,i=u.format({[d.extensionName]:[i]}),t.push("Sec-WebSocket-Extensions: "+i),r._extensions=e),this.emit("headers",t,s),n.write(t.concat("\r\n").join("\r\n")),n.removeListener("error",v),r.setSocket(n,a,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(r),r.on("close",()=>{this.clients.delete(r),this._shouldEmitClose&&!this.clients.size&&process.nextTick(f,this)})),o(r,s)}}function f(e){e._state=2,e.emit("close")}function v(){this.destroy()}function y(e,t,i,s){i=i||n.STATUS_CODES[t],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(i),...s},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${n.STATUS_CODES[t]}\r
`+Object.keys(s).map(e=>e+": "+s[e]).join("\r\n")+"\r\n\r\n"+i)}function g(e,t,i,s,n){var a;e.listenerCount("wsClientError")?(a=new Error(n),Error.captureStackTrace(a,g),e.emit("wsClientError",a,i,t)):y(i,s,n)}t.exports=o},{"./constants":319,"./extension":321,"./permessage-deflate":323,"./subprotocol":327,"./websocket":330,crypto:void 0,events:void 0,http:void 0,stream:void 0}],330:[function(e,t,j){var i=e("events");let y=e("https"),g=e("http"),s=e("net"),n=e("tls"),{randomBytes:b,createHash:x}=e("crypto");var{}=e("stream");let w=e("url").URL,E=e("./permessage-deflate"),a=e("./receiver"),o=e("./sender"),{BINARY_TYPES:r,EMPTY_BUFFER:c,GUID:_,kForOnEventAttribute:l,kListener:p,kStatusCode:u,kWebSocket:d,NOOP:h}=e("./constants");var{addEventListener:m,removeEventListener:f}=e("./event-target").EventTarget;let{format:D,parse:B}=e("./extension"),U=e("./buffer-util").toBuffer,k=Symbol("kAborted"),T=[8,13],v=["CONNECTING","OPEN","CLOSING","CLOSED"],q=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class S extends i{constructor(e,t,i){super(),this._binaryType=r[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=c,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=S.CONNECTING,this._receiver=null,this._sender=null,(this._socket=null)!==e?(this._bufferedAmount=0,this._isServer=!1,void(this._redirects=0)===t?t=[]:Array.isArray(t)||(t="object"==typeof t&&null!==t?(i=t,[]):[t]),function s(o,n,a,r){let c={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:T[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};o._autoPong=c.autoPong;if(!T.includes(c.protocolVersion))throw new RangeError(`Unsupported protocol version: ${c.protocolVersion} `+`(supported versions: ${T.join(", ")})`);let t;if(n instanceof w)t=n;else try{t=new w(n)}catch(e){throw new SyntaxError("Invalid URL: "+n)}"http:"===t.protocol?t.protocol="ws:":"https:"===t.protocol&&(t.protocol="wss:");o._url=t.href;let l="wss:"===t.protocol;let p="ws+unix:"===t.protocol;let i;"ws:"===t.protocol||l||p?p&&!t.pathname?i="The URL's pathname is empty":t.hash&&(i="The URL contains a fragment identifier"):i='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"';if(i){let e=new SyntaxError(i);if(0===o._redirects)throw e;return void A(o,e)}let e=l?443:80;let u=b(16).toString("base64");let d=(l?y:g).request;let h=new Set;let m;c.createConnection=c.createConnection||(l?H:F);c.defaultPort=c.defaultPort||e;c.port=t.port||e;c.host=t.hostname.startsWith("[")?t.hostname.slice(1,-1):t.hostname;c.headers={...c.headers,"Sec-WebSocket-Version":c.protocolVersion,"Sec-WebSocket-Key":u,Connection:"Upgrade",Upgrade:"websocket"};c.path=t.pathname+t.search;c.timeout=c.handshakeTimeout;c.perMessageDeflate&&(m=new E(!0!==c.perMessageDeflate?c.perMessageDeflate:{},!1,c.maxPayload),c.headers["Sec-WebSocket-Extensions"]=D({[E.extensionName]:m.offer()}));if(a.length){for(var f of a){if("string"!=typeof f||!q.test(f)||h.has(f))throw new SyntaxError("An invalid or duplicated subprotocol was specified");h.add(f)}c.headers["Sec-WebSocket-Protocol"]=a.join(",")}c.origin&&(c.protocolVersion<13?c.headers["Sec-WebSocket-Origin"]=c.origin:c.headers.Origin=c.origin);(t.username||t.password)&&(c.auth=t.username+":"+t.password);if(p){let e=c.path.split(":");c.socketPath=e[0],c.path=e[1]}let v;if(c.followRedirects){if(0===o._redirects){o._originalIpc=p,o._originalSecure=l,o._originalHostOrSocketPath=p?c.socketPath:t.host;let i=r&&r.headers;if(r={...r,headers:{}},i)for(let[e,t]of Object.entries(i))r.headers[e.toLowerCase()]=t}else if(0===o.listenerCount("redirect")){let e=p?!!o._originalIpc&&c.socketPath===o._originalHostOrSocketPath:!o._originalIpc&&t.host===o._originalHostOrSocketPath;e&&(!o._originalSecure||l)||(delete c.headers.authorization,delete c.headers.cookie,e||delete c.headers.host,c.auth=void 0)}c.auth&&!r.headers.authorization&&(r.headers.authorization="Basic "+Buffer.from(c.auth).toString("base64")),v=o._req=d(c),o._redirects&&o.emit("redirect",o.url,v)}else v=o._req=d(c);c.timeout&&v.on("timeout",()=>{O(o,v,"Opening handshake has timed out")});v.on("error",e=>{null===v||v[k]||(v=o._req=null,A(o,e))});v.on("response",e=>{let i=e.headers.location,t=e.statusCode;if(i&&c.followRedirects&&300<=t&&t<400)if(++o._redirects>c.maxRedirects)O(o,v,"Maximum redirects exceeded");else{v.abort();let e;try{e=new w(i,n)}catch(e){let t=new SyntaxError("Invalid URL: "+i);return void A(o,t)}s(o,e,a,r)}else o.emit("unexpected-response",v,e)||O(o,v,"Unexpected server response: "+e.statusCode)});v.on("upgrade",(s,n,a)=>{if(o.emit("upgrade",s),o.readyState===S.CONNECTING){v=o._req=null;let e=s.headers.upgrade;if(void 0===e||"websocket"!==e.toLowerCase())O(o,n,"Invalid Upgrade header");else{let e=x("sha1").update(u+_).digest("base64");if(s.headers["sec-websocket-accept"]!==e)O(o,n,"Invalid Sec-WebSocket-Accept header");else{let e=s.headers["sec-websocket-protocol"],t;if(void 0!==e?h.size?h.has(e)||(t="Server sent an invalid subprotocol"):t="Server sent a subprotocol but none was requested":h.size&&(t="Server sent no subprotocol"),t)O(o,n,t);else{e&&(o._protocol=e);let i=s.headers["sec-websocket-extensions"];if(void 0!==i){if(!m){let e="Server sent a Sec-WebSocket-Extensions header but no extension was requested";return void O(o,n,e)}let e;try{e=B(i)}catch(e){let t="Invalid Sec-WebSocket-Extensions header";return void O(o,n,t)}let t=Object.keys(e);if(1!==t.length||t[0]!==E.extensionName){let e="Server indicated an extension that was not requested";return void O(o,n,e)}try{m.accept(e[E.extensionName])}catch(e){let t="Invalid Sec-WebSocket-Extensions header";return void O(o,n,t)}o._extensions[E.extensionName]=m}o.setSocket(n,a,{allowSynchronousEvents:c.allowSynchronousEvents,generateMask:c.generateMask,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation})}}}}});c.finishRequest?c.finishRequest(v,o):v.end()}(this,e,t,i)):(this._autoPong=i.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){r.includes(e)&&(this._binaryType=e,this._receiver)&&(this._receiver._binaryType=e)}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,i){var s=new a({allowSynchronousEvents:i.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation});this._sender=new o(e,this._extensions,i.generateMask),this._receiver=s,this._socket=e,s[d]=this,e[d]=this,s.on("conclude",W),s.on("drain",G),s.on("error",z),s.on("message",K),s.on("ping",V),s.on("pong",Y),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),0<t.length&&e.unshift(t),e.on("close",R),e.on("data",N),e.on("end",M),e.on("error",L),this._readyState=S.OPEN,this.emit("open")}emitClose(){this._socket&&(this._extensions[E.extensionName]&&this._extensions[E.extensionName].cleanup(),this._receiver.removeAllListeners()),this._readyState=S.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){this.readyState!==S.CLOSED&&(this.readyState===S.CONNECTING?O(this,this._req,"WebSocket was closed before the connection was established"):this.readyState===S.CLOSING?this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end():(this._readyState=S.CLOSING,this._sender.close(e,t,!this._isServer,e=>{!e&&(this._closeFrameSent=!0,this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end()}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)))}pause(){this.readyState!==S.CONNECTING&&this.readyState!==S.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,i){if(this.readyState===S.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==S.OPEN?C(this,e,i):(void 0===t&&(t=!this._isServer),this._sender.ping(e||c,t,i))}pong(e,t,i){if(this.readyState===S.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==S.OPEN?C(this,e,i):(void 0===t&&(t=!this._isServer),this._sender.pong(e||c,t,i))}resume(){this.readyState===S.CONNECTING||this.readyState===S.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain)||this._socket.resume()}send(e,t,i){if(this.readyState===S.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof t&&(i=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==S.OPEN?C(this,e,i):(t={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t},this._extensions[E.extensionName]||(t.compress=!1),this._sender.send(e||c,t,i))}terminate(){this.readyState!==S.CLOSED&&(this.readyState===S.CONNECTING?O(this,this._req,"WebSocket was closed before the connection was established"):this._socket&&(this._readyState=S.CLOSING,this._socket.destroy()))}}function A(e,t){e._readyState=S.CLOSING,e.emit("error",t),e.emitClose()}function F(e){return e.path=e.socketPath,s.connect(e)}function H(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=s.isIP(e.host)?"":e.host),n.connect(e)}function O(e,t,i){e._readyState=S.CLOSING;i=new Error(i);Error.captureStackTrace(i,O),t.setHeader?(t[k]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(A,e,i)):(t.destroy(i),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function C(e,t,i){t&&(t=U(t).length,e._socket?e._sender._bufferedBytes+=t:e._bufferedAmount+=t),i&&(t=new Error(`WebSocket is not open: readyState ${e.readyState} `+`(${v[e.readyState]})`),process.nextTick(i,t))}function W(e,t){var i=this[d];i._closeFrameReceived=!0,i._closeMessage=t,i._closeCode=e,void 0!==i._socket[d]&&(i._socket.removeListener("data",N),process.nextTick(P,i._socket),1005===e?i.close():i.close(e,t))}function G(){var e=this[d];e.isPaused||e._socket.resume()}function z(e){var t=this[d];void 0!==t._socket[d]&&(t._socket.removeListener("data",N),process.nextTick(P,t._socket),t.close(e[u])),t.emit("error",e)}function I(){this[d].emitClose()}function K(e,t){this[d].emit("message",e,t)}function V(e){var t=this[d];t._autoPong&&t.pong(e,!this._isServer,h),t.emit("ping",e)}function Y(e){this[d].emit("pong",e)}function P(e){e.resume()}function R(){var e=this[d];this.removeListener("close",R),this.removeListener("data",N),this.removeListener("end",M),e._readyState=S.CLOSING;let t;this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[d]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",I),e._receiver.on("finish",I))}function N(e){this[d]._receiver.write(e)||this.pause()}function M(){var e=this[d];e._readyState=S.CLOSING,e._receiver.end(),this.end()}function L(){var e=this[d];this.removeListener("error",L),this.on("error",h),e&&(e._readyState=S.CLOSING,this.destroy())}Object.defineProperty(S,"CONNECTING",{enumerable:!0,value:v.indexOf("CONNECTING")}),Object.defineProperty(S.prototype,"CONNECTING",{enumerable:!0,value:v.indexOf("CONNECTING")}),Object.defineProperty(S,"OPEN",{enumerable:!0,value:v.indexOf("OPEN")}),Object.defineProperty(S.prototype,"OPEN",{enumerable:!0,value:v.indexOf("OPEN")}),Object.defineProperty(S,"CLOSING",{enumerable:!0,value:v.indexOf("CLOSING")}),Object.defineProperty(S.prototype,"CLOSING",{enumerable:!0,value:v.indexOf("CLOSING")}),Object.defineProperty(S,"CLOSED",{enumerable:!0,value:v.indexOf("CLOSED")}),Object.defineProperty(S.prototype,"CLOSED",{enumerable:!0,value:v.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(e=>{Object.defineProperty(S.prototype,e,{enumerable:!0})}),["open","error","close","message"].forEach(i=>{Object.defineProperty(S.prototype,"on"+i,{enumerable:!0,get(){for(var e of this.listeners(i))if(e[l])return e[p];return null},set(e){for(var t of this.listeners(i))if(t[l]){this.removeListener(i,t);break}"function"==typeof e&&this.addEventListener(i,e,{[l]:!0})}})}),S.prototype.addEventListener=m,S.prototype.removeEventListener=f,t.exports=S},{"./buffer-util":318,"./constants":319,"./event-target":320,"./extension":321,"./permessage-deflate":323,"./receiver":324,"./sender":325,crypto:void 0,events:void 0,http:void 0,https:void 0,net:void 0,stream:void 0,tls:void 0,url:void 0}],331:[function(t,e,i){var k=t("fs"),T=t("url"),S=t("child_process").spawn;function s(h){h=h||{};var m,f,v=this,y=t("http"),g=t("https"),b={},s=!1,e={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},x=Object.assign({},e),n=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],o=["TRACE","TRACK","CONNECT"],w=!1,E=!1,r=!1,a={},_=(this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),this.status=null,this.statusText=null,this.open=function(e,t,i,s,n){if(this.abort(),r=E=!1,!(a=e)||-1!==o.indexOf(a))throw new Error("SecurityError: Request method not allowed");var a;b={method:e,url:t.toString(),async:"boolean"!=typeof i||i,user:s||null,password:n||null},_(this.OPENED)},this.setDisableHeaderCheck=function(e){s=e},this.setRequestHeader=function(e,t){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(i=e,!(s||i&&-1===n.indexOf(i.toLowerCase())))return console.warn('Refused to set unsafe header "'+e+'"'),!1;var i;if(w)throw new Error("INVALID_STATE_ERR: send flag is true");return x[e]=t,!0},this.getResponseHeader=function(e){return"string"==typeof e&&this.readyState>this.OPENED&&f.headers[e.toLowerCase()]&&!E?f.headers[e.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||E)return"";var e,t="";for(e in f.headers)"set-cookie"!==e&&"set-cookie2"!==e&&(t+=e+": "+f.headers[e]+"\r\n");return t.substr(0,t.length-2)},this.getRequestHeader=function(e){return"string"==typeof e&&x[e]?x[e]:""},this.send=function(e){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(w)throw new Error("INVALID_STATE_ERR: send has already been called");var t,i=!1,s=!1,n=T.parse(b.url);switch(n.protocol){case"https:":i=!0;case"http:":t=n.hostname;break;case"file:":s=!0;break;case void 0:case"":t="localhost";break;default:throw new Error("Protocol not supported.")}if(s){if("GET"!==b.method)throw new Error("XMLHttpRequest: Only GET method is supported");if(b.async)k.readFile(unescape(n.pathname),function(e,t){e?v.handleError(e,e.errno||-1):(v.status=200,v.responseText=t.toString("utf8"),v.response=t,_(v.DONE))});else try{this.response=k.readFileSync(unescape(n.pathname)),this.responseText=this.response.toString("utf8"),this.status=200,_(v.DONE)}catch(e){this.handleError(e,e.errno||-1)}}else{var a=n.port||(i?443:80),o=n.pathname+(n.search||""),r=(x.Host=t,i&&443===a||80===a||(x.Host+=":"+n.port),b.user&&(void 0===b.password&&(b.password=""),r=new Buffer(b.user+":"+b.password),x.Authorization="Basic "+r.toString("base64")),"GET"===b.method||"HEAD"===b.method?e=null:e?(x["Content-Length"]=Buffer.isBuffer(e)?e.length:Buffer.byteLength(e),Object.keys(x).some(function(e){return"content-type"===e.toLowerCase()})||(x["Content-Type"]="text/plain;charset=UTF-8")):"POST"===b.method&&(x["Content-Length"]=0),h.agent||!1),c={host:t,port:a,path:o,method:b.method,headers:x,agent:r};if(i&&(c.pfx=h.pfx,c.key=h.key,c.passphrase=h.passphrase,c.cert=h.cert,c.ca=h.ca,c.ciphers=h.ciphers,c.rejectUnauthorized=!1!==h.rejectUnauthorized),E=!1,b.async){var l=(i?g:y).request,p=(w=!0,v.dispatchEvent("readystatechange"),function(e){302===(f=e).statusCode||303===f.statusCode||307===f.statusCode?(b.url=f.headers.location,e=T.parse(b.url),t=e.hostname,e={hostname:e.hostname,port:e.port,path:e.path,method:303===f.statusCode?"GET":b.method,headers:x},i&&(e.pfx=h.pfx,e.key=h.key,e.passphrase=h.passphrase,e.cert=h.cert,e.ca=h.ca,e.ciphers=h.ciphers,e.rejectUnauthorized=!1!==h.rejectUnauthorized),(m=l(e,p).on("error",u)).end()):(_(v.HEADERS_RECEIVED),v.status=f.statusCode,f.on("data",function(e){e&&(e=Buffer.from(e),v.response=Buffer.concat([v.response,e])),w&&_(v.LOADING)}),f.on("end",function(){w&&(w=!1,_(v.DONE),v.responseText=v.response.toString("utf8"))}),f.on("error",function(e){v.handleError(e)}))}),u=function(e){if(m.reusedSocket&&"ECONNRESET"===e.code)return l(c,p).on("error",u);v.handleError(e)};m=l(c,p).on("error",u),h.autoUnref&&m.on("socket",e=>{e.unref()}),e&&m.write(e),m.end(),v.dispatchEvent("loadstart")}else{for(var a=".node-xmlhttprequest-content-"+process.pid,d=".node-xmlhttprequest-sync-"+process.pid,o=(k.writeFileSync(d,"","utf8"),"var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(i?"s":"")+".request;var options = "+JSON.stringify(c)+";var responseText = '';var responseData = Buffer.alloc(0);var req = doRequest(options, function(response) {response.on('data', function(chunk) {  var data = Buffer.from(chunk);  responseText += data.toString('utf8');  responseData = Buffer.concat([responseData, data]);});response.on('end', function() {fs.writeFileSync('"+a+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText, data: responseData.toString('base64')}}), 'utf8');fs.unlinkSync('"+d+"');});response.on('error', function(error) {fs.writeFileSync('"+a+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+d+"');});}).on('error', function(error) {fs.writeFileSync('"+a+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+d+"');});"+(e?"req.write('"+JSON.stringify(e).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();"),r=S(process.argv[0],["-e",o]);k.existsSync(d););v.responseText=k.readFileSync(a,"utf8"),r.stdin.end(),k.unlinkSync(a),v.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)?(e=JSON.parse(v.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,"")),v.handleError(e,503)):(v.status=v.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1"),o=JSON.parse(v.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1")),f={statusCode:v.status,headers:o.data.headers},v.responseText=o.data.text,v.response=Buffer.from(o.data.data,"base64"),_(v.DONE,!0))}}},this.handleError=function(e,t){this.status=t||0,this.statusText=e,this.responseText=e.stack,E=!0,_(this.DONE)},this.abort=function(){m&&(m.abort(),m=null),x=Object.assign({},e),this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),E=r=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!w||this.readyState===this.DONE||(w=!1,_(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(e,t){e in a||(a[e]=[]),a[e].push(t)},this.removeEventListener=function(e,t){e in a&&(a[e]=a[e].filter(function(e){return e!==t}))},this.dispatchEvent=function(i){if("function"==typeof v["on"+i]&&(this.readyState===this.DONE&&b.async?setTimeout(function(){v["on"+i]()},0):v["on"+i]()),i in a)for(let e=0,t=a[i].length;e<t;e++)this.readyState===this.DONE?setTimeout(function(){a[i][e].call(v)},0):a[i][e].call(v)},function(e){if(!(v.readyState===e||v.readyState===v.UNSENT&&r)&&(v.readyState=e,(b.async||v.readyState<v.OPENED||v.readyState===v.DONE)&&v.dispatchEvent("readystatechange"),v.readyState===v.DONE)){let e;e=r?"abort":E?"error":"load",v.dispatchEvent(e),v.dispatchEvent("loadend")}})}(e.exports=s).XMLHttpRequest=s},{child_process:void 0,fs:void 0,http:void 0,https:void 0,url:void 0}],332:[function(e,t,i){t.exports=[{type:1,objectType:2,objectKind:0,objectCount:[10,25,50,100,200,500,1e3,2500,5e3,1e4]},{type:2,objectType:0,objectKind:0,objectCount:[10,25,50,100,200,500,1e3]},{type:4,objectType:0,objectKind:0,objectCount:[1e3,2500,5e3,1e4,25e3,5e4,1e5,25e4,5e5,1e6]},{type:5,objectType:0,objectKind:0,objectCount:[10,25,50,100,200,500,1e3],data1:"hammer"},{type:6,objectType:0,objectKind:0,objectCount:[10,25,50,100,200,500,1e3]},{type:5,objectType:0,objectKind:0,objectCount:[20,50,100,200,500,1e3,2e3],data1:"any"}]},{}],333:[function(e,t,i){t.exports=[{name:"Sword 1",type:"weapon",sprite:"sword1",buy:0},{name:"Sword 2",type:"weapon",sprite:"sword2",buy:500},{name:"Axe",type:"weapon",sprite:"axe",buy:1e3},{name:"Morning Star",type:"weapon",sprite:"morningstar",buy:1500},{name:"Blue Sword",type:"weapon",sprite:"bluesword",buy:2e3},{name:"Red Sword",type:"weapon",sprite:"redsword",buy:2500},{name:"Golden Sword",type:"weapon",sprite:"goldensword",buy:3e3},{name:"Side Sword",type:"weapon",sprite:"sidesword",buy:3500},{name:"Spear",type:"weapon",sprite:"spear",buy:4e3},{name:"Scimitar",type:"weapon",sprite:"scimitar",buy:4500},{name:"Trident",type:"weapon",sprite:"trident",buy:5e3},{name:"Blue Scimitar",type:"weapon",sprite:"bluescimitar",buy:5500},{name:"Hammer",type:"weapon",sprite:"hammer",buy:6e3},{name:"Green Light Saber",type:"weapon",sprite:"greenlightsaber",buy:6500},{name:"Sky Light Saber",type:"weapon",sprite:"skylightsaber",buy:7e3},{name:"Red Light Saber",type:"weapon",sprite:"redlightsaber",buy:7500},{name:"Bastard Sword",type:"weapon",sprite:"bastardsword",buy:8e3},{name:"Red Metal Sword",type:"weapon",sprite:"redmetalsword",buy:8500},{name:"Justice Hammer",type:"weapon",sprite:"justicehammer",buy:9e3},{name:"Rose",type:"weapon",sprite:"rose",buy:9500},{name:"Ice Rose",type:"weapon",sprite:"icerose",buy:1e4},{name:"Halberd",type:"weapon",sprite:"halberd",buy:10500},{name:"Whip",type:"weapon",sprite:"whip",buy:11e3},{name:"Forest Guardian Sword",type:"weapon",sprite:"forestguardiansword",buy:11500},{name:"Sickle",type:"weapon",sprite:"sickle",buy:12e3},{name:"Plunger",type:"weapon",sprite:"plunger",buy:12500},{name:"Red Sickle",type:"weapon",sprite:"redsickle",buy:13e3},{name:"Day Walker",type:"weapon",sprite:"daywalker",buy:13500},{name:"Purple Cloud Kallege",type:"weapon",sprite:"purplecloudkallege",buy:14e3},{name:"Sea Rage",type:"weapon",sprite:"searage",buy:14500},{name:"Breaker",type:"weapon",sprite:"breaker",buy:15e3},{name:"Enel Trident",type:"weapon",sprite:"eneltrident",buy:15500},{name:"Rainbow Sword",type:"weapon",sprite:"rainbowsword",buy:16e3},{name:"Typhoon",type:"weapon",sprite:"typhoon",buy:16500},{name:"Memme",type:"weapon",sprite:"memme",buy:17e3},{name:"Candybar",type:"weapon",sprite:"candybar",buy:17500},{name:"Butcher Knife",type:"weapon",sprite:"butcherknife",buy:18e3},{name:"Fire Shot",type:"weapon",sprite:"fireshot",buy:18500},{name:"Comb",type:"weapon",sprite:"comb",buy:19e3},{name:"Squeaky Hammer",type:"weapon",sprite:"squeakyhammer",buy:19500},{name:"Fire Play",type:"weapon",sprite:"fireplay",buy:2e4},{name:"Wea Staff",type:"weapon",sprite:"weastaff",buy:20500},{name:"Pink Sword",type:"weapon",sprite:"pinksword",buy:21e3},{name:"Conference Call",type:"weapon",sprite:"conferencecall",buy:21500},{name:"Cactus Axe",type:"weapon",sprite:"cactusaxe",buy:22e3},{name:"Devil Kazya Sword",type:"weapon",sprite:"devilkazyasword",buy:22500},{name:"Bamboo Spear",type:"weapon",sprite:"bamboospear",buy:23e3},{name:"Paewoldo",type:"weapon",sprite:"paewoldo",buy:23500},{name:"Magic Spear",type:"weapon",sprite:"magicspear",buy:24e3},{name:"Fire Sword",type:"weapon",sprite:"firesword",buy:24500},{name:"Wooden Bow",type:"weaponarcher",sprite:"woodenbow",buy:0},{name:"Plastic Bow",type:"weaponarcher",sprite:"plasticbow",buy:500},{name:"Iron Bow",type:"weaponarcher",sprite:"ironbow",buy:1e3},{name:"Red Bow",type:"weaponarcher",sprite:"redbow",buy:1500},{name:"Violet Bow",type:"weaponarcher",sprite:"violetbow",buy:2e3},{name:"Death Bow",type:"weaponarcher",sprite:"deathbow",buy:2500},{name:"Golden Bow",type:"weaponarcher",sprite:"goldenbow",buy:3e3},{name:"Watermelon Bow",type:"weaponarcher",sprite:"watermelonbow",buy:3500},{name:"Green Bow",type:"weaponarcher",sprite:"greenbow",buy:4e3},{name:"Redenel Bow",type:"weaponarcher",sprite:"redenelbow",buy:4500},{name:"Mermaid Bow",type:"weaponarcher",sprite:"mermaidbow",buy:5e3},{name:"Seahorse Bow",type:"weaponarcher",sprite:"seahorsebow",buy:5500},{name:"Hunter Bow",type:"weaponarcher",sprite:"hunterbow",buy:6e3},{name:"Green Light Bow",type:"weaponarcher",sprite:"greenlightbow",buy:6500},{name:"Sky Light Bow",type:"weaponarcher",sprite:"skylightbow",buy:7e3},{name:"Red Light Bow",type:"weaponarcher",sprite:"redlightbow",buy:7500},{name:"Captain Bow",type:"weaponarcher",sprite:"captainbow",buy:8e3},{name:"Red Metal Bow",type:"weaponarcher",sprite:"redmetalbow",buy:8500},{name:"Justice Bow",type:"weaponarcher",sprite:"justicebow",buy:9e3},{name:"Rose Bow",type:"weaponarcher",sprite:"rosebow",buy:9500},{name:"Marine Bow",type:"weaponarcher",sprite:"marinebow",buy:1e4},{name:"Crystal Bow",type:"weaponarcher",sprite:"crystalbow",buy:10500},{name:"Colorful Bow",type:"weaponarcher",sprite:"gaybow",buy:11e3},{name:"Forest Bow",type:"weaponarcher",sprite:"forestbow",buy:11500},{name:"Sickle Bow",type:"weaponarcher",sprite:"sicklebow",buy:12e3},{name:"Blood Bow",type:"weaponarcher",sprite:"bloodbow",buy:12500},{name:"Red Sickle Bow",type:"weaponarcher",sprite:"redsicklebow",buy:13e3},{name:"Cloth Armor",type:"armor",sprite:"clotharmor",buy:0},{name:"Leather Armor",type:"armor",sprite:"leatherarmor",buy:500},{name:"Mail Armor",type:"armor",sprite:"mailarmor",buy:1e3},{name:"Plate Armor",type:"armor",sprite:"platearmor",buy:1500},{name:"Red Armor",type:"armor",sprite:"redarmor",buy:2e3},{name:"Golden Armor",type:"armor",sprite:"goldenarmor",buy:2500},{name:"Green Armor",type:"armor",sprite:"greenarmor",buy:3e3},{name:"Green Wing Armor",type:"armor",sprite:"greenwingarmor",buy:3500},{name:"Guard Armor",type:"armor",sprite:"guardarmor",buy:4e3},{name:"Red Guard Armor",type:"armor",sprite:"redguardarmor",buy:4500},{name:"White Armor",type:"armor",sprite:"whitearmor",buy:5e3},{name:"Rat Armor",type:"armor",sprite:"ratarmor",buy:5500},{name:"Blue Pirate Armor",type:"armor",sprite:"bluepiratearmor",buy:6e3},{name:"Cheoli Armor",type:"armor",sprite:"cheoliarmor",buy:6500},{name:"Dovakin Armor",type:"armor",sprite:"dovakinarmor",buy:7e3},{name:"GB Wing Armor",type:"armor",sprite:"gbwingarmor",buy:7500},{name:"Red Wing Armor",type:"armor",sprite:"redwingarmor",buy:8e3},{name:"Snow Fox Armor",type:"armor",sprite:"snowfoxarmor",buy:8500},{name:"Wolf Armor",type:"armor",sprite:"wolfarmor",buy:9e3},{name:"Blue Wing Armor",type:"armor",sprite:"bluewingarmor",buy:9500},{name:"Thief Armor",type:"armor",sprite:"thiefarmor",buy:1e4},{name:"Ninja Armor",type:"armor",sprite:"ninjaarmor",buy:10500},{name:"Dragon Armor",type:"armor",sprite:"dragonarmor",buy:11e3},{name:"Fallen Armor",type:"armor",sprite:"fallenarmor",buy:11500},{name:"Paladin Armor",type:"armor",sprite:"paladinarmor",buy:12e3},{name:"Crystal Armor",type:"armor",sprite:"crystalarmor",buy:12500},{name:"Adherer Robe",type:"armor",sprite:"adhererrobe",buy:13e3},{name:"Frost Armor",type:"armor",sprite:"frostarmor",buy:13500},{name:"Strap Armor",type:"armor",sprite:"gayarmor",buy:14e3},{name:"School Uniform",type:"armor",sprite:"schooluniform",buy:14500},{name:"Beautiful Life",type:"armor",sprite:"beautifullife",buy:15e3},{name:"Region Armor",type:"armor",sprite:"regionarmor",buy:15500},{name:"Ghost Rider",type:"armor",sprite:"ghostrider",buy:16e3},{name:"Taekwondo",type:"armor",sprite:"taekwondo",buy:16500},{name:"Rabbit Armor",type:"armor",sprite:"rabbitarmor",buy:17e3},{name:"Portal Armor",type:"armor",sprite:"portalarmor",buy:17500},{name:"Pirate King",type:"armor",sprite:"pirateking",buy:18e3},{name:"Sea Dragon Armor",type:"armor",sprite:"seadragonarmor",buy:18500},{name:"Shadow Region Armor",type:"armor",sprite:"shadowregionarmor",buy:19e3},{name:"Enel Armor",type:"armor",sprite:"enelarmor",buy:19500},{name:"Mini Sea Dragon Armor",type:"armor",sprite:"miniseadragonarmor",buy:2e4},{name:"Huni Armor",type:"armor",sprite:"huniarmor",buy:20500},{name:"Dambo Armor",type:"armor",sprite:"damboarmor",buy:21e3},{name:"Squid Armor",type:"armor",sprite:"squidarmor",buy:21500},{name:"Bee Armor",type:"armor",sprite:"beearmor",buy:22e3},{name:"Blue Dambo Armor",type:"armor",sprite:"bluedamboarmor",buy:22500},{name:"Rudolf Armor",type:"armor",sprite:"rudolfarmor",buy:23e3},{name:"Christmas Armor",type:"armor",sprite:"christmasarmor",buy:23500},{name:"Robocop Armor",type:"armor",sprite:"robocoparmor",buy:24e3},{name:"Pink Cockroach Armor",type:"armor",sprite:"pinkcockroacharmor",buy:24500},{name:"Cockroach Suit",type:"armor",sprite:"cockroachsuit",buy:25e3},{name:"Dinosaur Armor",type:"armor",sprite:"dinosaurarmor",buy:25500},{name:"Cat Armor",type:"armor",sprite:"catarmor",buy:26e3},{name:"Snowman Armor",type:"armor",sprite:"snowmanarmor",buy:26500},{name:"Beetle Armor",type:"armor",sprite:"beetlearmor",buy:27e3},{name:"Hongcheol Armor",type:"armor",sprite:"hongcheolarmor",buy:27500},{name:"Tiger Armor",type:"armor",sprite:"tigerarmor",buy:28e3},{name:"Wizard Rob",type:"armor",sprite:"wizardrobe",buy:28500},{name:"Iron Knight Armor",type:"armor",sprite:"ironknightarmor",buy:29e3},{name:"Evil Armor",type:"armor",sprite:"evilarmor",buy:29500},{name:"Green Dambo Armor",type:"armor",sprite:"greendamboarmor",buy:3e4},{name:"Red Dambo Armor",type:"armor",sprite:"reddamboarmor",buy:30500},{name:"Devil Kazya Armor",type:"armor",sprite:"devilkazyaarmor",buy:31e3},{name:"Bridal Mask",type:"armor",sprite:"bridalmask",buy:31500},{name:"Black Spider Armor",type:"armor",sprite:"blackspiderarmor",buy:32e3},{name:"Frog Armor",type:"armor",sprite:"frogarmor",buy:32500},{name:"Bearseonbi Armor",type:"armor",sprite:"bearseonbiarmor",buy:33e3},{name:"Raindow A Pro",type:"armor",sprite:"rainbowapro",buy:33500},{name:"Coke Armor",type:"armor",sprite:"cokearmor",buy:34e3},{name:"Fried Potato Armor",type:"armor",sprite:"friedpotatoarmor",buy:34500},{name:"Burger Armor",type:"armor",sprite:"burgerarmor",buy:35e3},{name:"Halloween JK Armor",type:"armor",sprite:"halloweenjkarmor",buy:35500},{name:"Frankenstein Armor",type:"armor",sprite:"frankensteinarmor",buy:36e3},{name:"Admin armor",type:"armor",sprite:"adminarmor",buy:36500},{name:"Cloth Armor",type:"armorarcher",sprite:"clotharmor",buy:0},{name:"Leather Armor",type:"armorarcher",sprite:"leatherarcherarmor",buy:500},{name:"Mail Armor",type:"armorarcher",sprite:"mailarcherarmor",buy:1e3},{name:"Plate Armor",type:"armorarcher",sprite:"platearcherarmor",buy:1500},{name:"Red Armor",type:"armorarcher",sprite:"redarcherarmor",buy:2e3},{name:"Golden Armor",type:"armorarcher",sprite:"goldenarcherarmor",buy:2500},{name:"Green Armor",type:"armorarcher",sprite:"greenarcherarmor",buy:3e3},{name:"Green Wing Armor",type:"armorarcher",sprite:"greenwingarcherarmor",buy:3500},{name:"Guard Armor",type:"armorarcher",sprite:"guardarcherarmor",buy:4e3},{name:"Red Guard Armor",type:"armorarcher",sprite:"redguardarcherarmor",buy:4500},{name:"White Armor",type:"armorarcher",sprite:"whitearcherarmor",buy:5e3},{name:"Pirate Armor",type:"armorarcher",sprite:"piratearcherarmor",buy:5500},{name:"Cheoli Armor",type:"armorarcher",sprite:"cheoliarcherarmor",buy:6e3},{name:"Dovakin Armor",type:"armorarcher",sprite:"dovakinarcherarmor",buy:6500},{name:"GB Wing Armor",type:"armorarcher",sprite:"gbwingarcherarmor",buy:7e3},{name:"Red Wing Armor",type:"armorarcher",sprite:"redwingarcherarmor",buy:7500},{name:"Snow Fox Armor",type:"armorarcher",sprite:"snowfoxarcherarmor",buy:8e3},{name:"Wolf Armor",type:"armorarcher",sprite:"wolfarcherarmor",buy:8500},{name:"Blue Wing Armor",type:"armorarcher",sprite:"bluewingarcherarmor",buy:9e3},{name:"Fallen Armor",type:"armorarcher",sprite:"fallenarcherarmor",buy:9500},{name:"Crystal Armor",type:"armorarcher",sprite:"crystalarcherarmor",buy:1e4},{name:"Legolas Armor",type:"armorarcher",sprite:"legolasarmor",buy:10500},{name:"Adherer Armor",type:"armorarcher",sprite:"adhererarcherarmor",buy:11e3},{name:"School Uniform",type:"armorarcher",sprite:"archerschooluniform",buy:11500},{name:"Combat Uniform",type:"armorarcher",sprite:"combatuniform",buy:12e3},{name:"Strap Armor",type:"armorarcher",sprite:"gayarcherarmor",buy:12500}]},{}],334:[function(e,t,i){t.exports=[{i:[[310,16]],o:104},{i:[[310,4]],o:105},{i:[[310,4]],o:106},{i:[[310,4]],o:107},{i:[[311,16]],o:108},{i:[[311,4]],o:109},{i:[[311,4]],o:110},{i:[[311,4]],o:111},{i:[[312,16]],o:112},{i:[[312,4]],o:113},{i:[[312,4]],o:114},{i:[[312,4]],o:115},{i:[[301,1],[302,3]],o:305},{i:[[301,1],[303,3]],o:306},{i:[[301,1],[304,3]],o:307},{i:[[301,6],[305,10]],o:201},{i:[[301,6],[305,10]],o:211},{i:[[301,6],[305,10]],o:221},{i:[[301,6],[305,10]],o:231},{i:[[301,6],[306,10]],o:202},{i:[[301,6],[306,10]],o:212},{i:[[301,6],[306,10]],o:222},{i:[[301,6],[306,10]],o:232},{i:[[301,6],[307,10]],o:203},{i:[[301,6],[307,10]],o:213},{i:[[301,6],[307,10]],o:223},{i:[[301,6],[307,10]],o:233}]},{}],335:[function(e,t,i){t.exports=[]},{}],336:[function(e,t,i){t.exports=[{name:"Scrolls",sprite:"itemloot.png",offset:[0,0],rarity:"1"},{name:"Dice",sprite:"itemloot.png",offset:[0,1],rarity:"1"},{name:"Book",sprite:"itemloot.png",offset:[0,2],rarity:"1"},{name:"Key",sprite:"itemloot.png",offset:[0,3],rarity:"1"},{name:"Bell",sprite:"itemloot.png",offset:[0,4],rarity:"1"},{name:"Padlock",sprite:"itemloot.png",offset:[0,5],rarity:"1"},{name:"Candle",sprite:"itemloot.png",offset:[0,6],rarity:"1"},{name:"Drumstick",sprite:"itemloot.png",offset:[0,7],rarity:"1"},{name:"IronHelmet",sprite:"itemloot.png",offset:[0,8],rarity:"1"},{name:"Gumnut",sprite:"itemloot.png",offset:[0,9],rarity:"1"},{name:"Fireball",sprite:"itemloot.png",offset:[1,0],rarity:"2"},{name:"WitchHat",sprite:"itemloot.png",offset:[1,1],rarity:"2"},{name:"Chest",sprite:"itemloot.png",offset:[1,2],rarity:"2"},{name:"Shield",sprite:"itemloot.png",offset:[1,3],rarity:"2"},{name:"Log",sprite:"itemloot.png",offset:[1,4],rarity:"2"},{name:"RingOne",sprite:"itemloot.png",offset:[1,5],rarity:"2"},{name:"DreamCatcher",sprite:"itemloot.png",offset:[1,6],rarity:"2"},{name:"SealedScroll",sprite:"itemloot.png",offset:[1,7],rarity:"2"},{name:"Spider",sprite:"itemloot.png",offset:[1,8],rarity:"2"},{name:"MeltedCandles",sprite:"itemloot.png",offset:[1,9],rarity:"2"},{name:"Feather",sprite:"itemloot.png",offset:[2,0],rarity:"3"},{name:"Compass",sprite:"itemloot.png",offset:[2,1],rarity:"3"},{name:"PinkFireball",sprite:"itemloot.png",offset:[2,2],rarity:"3"},{name:"Gem",sprite:"itemloot.png",offset:[2,3],rarity:"3"},{name:"FireEye",sprite:"itemloot.png",offset:[2,4],rarity:"3"},{name:"TotemFace",sprite:"itemloot.png",offset:[2,5],rarity:"3"},{name:"Gadget",sprite:"itemloot.png",offset:[2,6],rarity:"3"},{name:"Frog",sprite:"itemloot.png",offset:[2,7],rarity:"3"},{name:"ThrowingDagger",sprite:"itemloot.png",offset:[2,8],rarity:"3"},{name:"UrnOne",sprite:"itemloot.png",offset:[2,9],rarity:"3"},{name:"NecklaceOne",sprite:"itemloot.png",offset:[3,0],rarity:"4"},{name:"Squid",sprite:"itemloot.png",offset:[3,1],rarity:"4"},{name:"ClubOne",sprite:"itemloot.png",offset:[3,2],rarity:"4"},{name:"Crystals",sprite:"itemloot.png",offset:[3,3],rarity:"4"},{name:"Mace",sprite:"itemloot.png",offset:[3,4],rarity:"4"},{name:"CoinPouch",sprite:"itemloot.png",offset:[3,5],rarity:"4"},{name:"NecklaceTwo",sprite:"itemloot.png",offset:[3,6],rarity:"4"},{name:"Bones",sprite:"itemloot.png",offset:[3,7],rarity:"4"},{name:"RingTwo",sprite:"itemloot.png",offset:[3,8],rarity:"4"},{name:"AnimalSkull",sprite:"itemloot.png",offset:[3,9],rarity:"4"},{name:"Leaf",sprite:"itemloot.png",offset:[4,0],rarity:"5"},{name:"Cheese",sprite:"itemloot.png",offset:[4,1],rarity:"5"},{name:"Mushrooms",sprite:"itemloot.png",offset:[4,2],rarity:"5"},{name:"FeatherQuill",sprite:"itemloot.png",offset:[4,3],rarity:"5"},{name:"BoneEaring",sprite:"itemloot.png",offset:[4,4],rarity:"5"},{name:"Crate",sprite:"itemloot.png",offset:[4,5],rarity:"5"},{name:"Bat",sprite:"itemloot.png",offset:[4,6],rarity:"5"},{name:"PoisonVial",sprite:"itemloot.png",offset:[4,7],rarity:"5"},{name:"ScrollsThree",sprite:"itemloot.png",offset:[4,8],rarity:"5"},{name:"Bug",sprite:"itemloot.png",offset:[4,9],rarity:"5"},{name:"Anvil",sprite:"itemloot.png",offset:[5,0],rarity:"6"},{name:"BrokenGlass",sprite:"itemloot.png",offset:[5,1],rarity:"6"},{name:"Goblet",sprite:"itemloot.png",offset:[5,2],rarity:"6"},{name:"SkullRingTwo",sprite:"itemloot.png",offset:[5,3],rarity:"6"},{name:"MonsterClaw",sprite:"itemloot.png",offset:[5,4],rarity:"6"},{name:"PoisonVialTwo",sprite:"itemloot.png",offset:[5,5],rarity:"6"},{name:"BronzeHelmet",sprite:"itemloot.png",offset:[5,6],rarity:"6"},{name:"BasicKnife",sprite:"itemloot.png",offset:[5,7],rarity:"6"},{name:"Worms",sprite:"itemloot.png",offset:[5,8],rarity:"6"},{name:"AutumnLeaf",sprite:"itemloot.png",offset:[5,9],rarity:"6"},{name:"Drum",sprite:"itemloot.png",offset:[6,0],rarity:"7"},{name:"Acorns",sprite:"itemloot.png",offset:[6,1],rarity:"7"},{name:"Pendant",sprite:"itemloot.png",offset:[6,2],rarity:"7"},{name:"Lute",sprite:"itemloot.png",offset:[6,3],rarity:"7"},{name:"RingThree",sprite:"itemloot.png",offset:[6,4],rarity:"7"},{name:"BattleAxe",sprite:"itemloot.png",offset:[6,5],rarity:"7"},{name:"AncientShield",sprite:"itemloot.png",offset:[6,6],rarity:"7"},{name:"Broach",sprite:"itemloot.png",offset:[6,7],rarity:"7"},{name:"Maul",sprite:"itemloot.png",offset:[6,8],rarity:"7"},{name:"SmokePipe",sprite:"itemloot.png",offset:[6,9],rarity:"7"},{name:"Lizard",sprite:"itemloot.png",offset:[7,0],rarity:"8"},{name:"DragonEgg",sprite:"itemloot.png",offset:[7,1],rarity:"8"},{name:"MarbleJar",sprite:"itemloot.png",offset:[7,2],rarity:"8"},{name:"OldBottle",sprite:"itemloot.png",offset:[7,3],rarity:"8"},{name:"ShortSword",sprite:"itemloot.png",offset:[7,4],rarity:"8"},{name:"BookTwo",sprite:"itemloot.png",offset:[7,5],rarity:"8"},{name:"Bread",sprite:"itemloot.png",offset:[7,6],rarity:"8"},{name:"Mirror",sprite:"itemloot.png",offset:[7,7],rarity:"8"},{name:"Cards",sprite:"itemloot.png",offset:[7,8],rarity:"8"},{name:"PotOfGold",sprite:"itemloot.png",offset:[7,9],rarity:"8"},{name:"FaceMask",sprite:"itemloot.png",offset:[8,0],rarity:"9"},{name:"Bomb",sprite:"itemloot.png",offset:[8,1],rarity:"9"},{name:"HandBag",sprite:"itemloot.png",offset:[8,2],rarity:"9"},{name:"ToothNecklace",sprite:"itemloot.png",offset:[8,3],rarity:"9"},{name:"NecklaceThree",sprite:"itemloot.png",offset:[8,4],rarity:"9"},{name:"LeafWreath",sprite:"itemloot.png",offset:[8,5],rarity:"9"},{name:"Eyeball",sprite:"itemloot.png",offset:[8,6],rarity:"9"},{name:"CrudeDagger",sprite:"itemloot.png",offset:[8,7],rarity:"9"},{name:"SapJewel",sprite:"itemloot.png",offset:[8,8],rarity:"9"},{name:"Clever",sprite:"itemloot.png",offset:[8,9],rarity:"9"},{name:"MortAndPestle",sprite:"itemloot.png",offset:[9,0],rarity:"10"},{name:"WoodHorn",sprite:"itemloot.png",offset:[9,1],rarity:"10"},{name:"Pumpkin",sprite:"itemloot.png",offset:[9,2],rarity:"10"},{name:"HumanSkull",sprite:"itemloot.png",offset:[9,3],rarity:"10"},{name:"Thorns",sprite:"itemloot.png",offset:[9,4],rarity:"10"},{name:"FineComb",sprite:"itemloot.png",offset:[9,5],rarity:"10"},{name:"Cauldron",sprite:"itemloot.png",offset:[9,6],rarity:"10"},{name:"MagicBall",sprite:"itemloot.png",offset:[9,7],rarity:"10"},{name:"Mushroom",sprite:"itemloot.png",offset:[9,8],rarity:"10"},{name:"Hook",sprite:"itemloot.png",offset:[9,9],rarity:"10"},{name:"NordicCup",sprite:"itemloot.png",offset:[10,0],rarity:"10"}]},{}],337:[function(e,t,i){t.exports=[{id:1,name:"Crude Club",type:"weapon",typemod:"attack",modifier:10,staticsheet:2,legacy:1,offset:[3,10]},{id:2,name:"Crude Sword",type:"weapon",typemod:"attack",modifier:20,staticsheet:2,legacy:1,offset:[5,9]},{id:3,name:"Beginnner Sword",type:"weapon",typemod:"attack",modifier:30,staticsheet:2,legacy:1,offset:[8,11]},{id:4,name:"Iron Sword",type:"weapon",typemod:"attack",modifier:40,staticsheet:2,legacy:1,offset:[4,0]},{id:5,name:"Steel Sword",type:"weapon",typemod:"attack",modifier:50,staticsheet:2,legacy:1,offset:[4,1]},{id:6,name:"Bronze Sword",type:"weapon",typemod:"attack",modifier:60,staticsheet:2,legacy:1,offset:[4,2]},{id:7,name:"Golden Sword",type:"weapon",typemod:"attack",modifier:70,staticsheet:2,legacy:1,offset:[4,3]},{id:8,name:"Glass Sword",type:"weapon",typemod:"attack",modifier:80,staticsheet:2,legacy:1,offset:[4,4]},{id:9,name:"Adamantite Sword",type:"weapon",typemod:"attack",modifier:90,staticsheet:2,legacy:1,offset:[4,5]},{id:10,name:"Plate Sword",type:"weapon",typemod:"attack",modifier:100,staticsheet:2,legacy:1,offset:[4,6]},{id:11,name:"Draconian Sword",type:"weapon",typemod:"attack",modifier:110,staticsheet:2,legacy:1,offset:[4,7]},{id:12,name:"Slingshot",type:"weaponarcher",typemod:"attack",modifier:10,staticsheet:2,legacy:1,offset:[1,10]},{id:13,name:"Crude Bow",type:"weaponarcher",typemod:"attack",modifier:20,staticsheet:2,legacy:1,offset:[7,8]},{id:14,name:"Beginner Bow",type:"weaponarcher",typemod:"attack",modifier:30,staticsheet:2,legacy:1,offset:[9,11]},{id:15,name:"Iron Bow",type:"weaponarcher",typemod:"attack",modifier:40,staticsheet:2,legacy:1,offset:[7,0]},{id:16,name:"Steel Bow",type:"weaponarcher",typemod:"attack",modifier:50,staticsheet:2,legacy:1,offset:[7,1]},{id:17,name:"Bronze Bow",type:"weaponarcher",typemod:"attack",modifier:60,staticsheet:2,legacy:1,offset:[7,2]},{id:18,name:"Gold Bow",type:"weaponarcher",typemod:"attack",modifier:70,staticsheet:2,legacy:1,offset:[7,3]},{id:19,name:"Glass Bow",type:"weaponarcher",typemod:"attack",modifier:80,staticsheet:2,legacy:1,offset:[7,4]},{id:20,name:"Adamantite Bow",type:"weaponarcher",typemod:"attack",modifier:90,staticsheet:2,legacy:1,offset:[7,5]},{id:21,name:"Plate Bow",type:"weaponarcher",typemod:"attack",modifier:100,staticsheet:2,legacy:1,offset:[7,6]},{id:22,name:"Draconian Bow",type:"weaponarcher",typemod:"attack",modifier:110,staticsheet:2,legacy:1,offset:[7,7]},{id:23,name:"Fur Armor",type:"armor",typemod:"defense",modifier:10,staticsheet:2,legacy:1,offset:[11,12]},{id:24,name:"Padded Armor",type:"armor",typemod:"defense",modifier:20,staticsheet:2,legacy:1,offset:[11,11]},{id:25,name:"Leather Armor",type:"armor",typemod:"defense",modifier:30,staticsheet:2,legacy:1,offset:[11,10]},{id:26,name:"Iron Armor",type:"armor",typemod:"defense",modifier:40,staticsheet:2,legacy:1,offset:[11,0]},{id:27,name:"Steel Armor",type:"armor",typemod:"defense",modifier:50,staticsheet:2,legacy:1,offset:[11,1]},{id:28,name:"Bronze Armor",type:"armor",typemod:"defense",modifier:60,staticsheet:2,legacy:1,offset:[11,2]},{id:29,name:"Golden Armor",type:"armor",typemod:"defense",modifier:70,staticsheet:2,legacy:1,offset:[11,3]},{id:30,name:"Glass Armor",type:"armor",typemod:"defense",modifier:80,staticsheet:2,legacy:1,offset:[11,4]},{id:31,name:"Adamantite Armor",type:"armor",typemod:"defense",modifier:90,staticsheet:2,legacy:1,offset:[11,5]},{id:32,name:"Plate Armor",type:"armor",typemod:"defense",modifier:100,staticsheet:2,legacy:1,offset:[11,6]},{id:33,name:"Draconian Armor",type:"armor",typemod:"defense",modifier:110,staticsheet:2,legacy:1,offset:[11,7]},{id:34,name:"Flask +500 HP",type:"object",typemod:"health",modifier:500,sprite:"item/item-flask.png",spriteName:"item-flask",offset:[0,0],buy:10,buycount:10},{id:35,name:"Burger +250 Energy",type:"object",typemod:"energy",modifier:250,sprite:"item/item-burger.png",spriteName:"item-burger",offset:[0,0],buy:30,buycount:10},{id:36,name:"Big Flask +25% HP",type:"object",typemod:"healthpercent",modifier:25,sprite:"item/item-bigflask.png",spriteName:"item-bigflask",offset:[0,0],buy:50,buycount:10},{id:100,name:"Leather Chest 1",type:"chest",typemod:"defense",level:10,modifier:10,staticsheet:1,spriteName:"armors",offset:[0,5]},{id:101,name:"Leather Helmet 1",type:"helm",typemod:"defense",level:12,modifier:5,staticsheet:1,spriteName:"armors",offset:[0,4]},{id:102,name:"Leather Gloves 1",type:"gloves",typemod:"defense",level:14,modifier:5,staticsheet:1,spriteName:"armors",offset:[0,6]},{id:103,name:"Leather Boots 1",type:"boots",typemod:"defense",level:16,modifier:5,staticsheet:1,spriteName:"armors",offset:[0,7]},{id:104,name:"Leather Chest 2",type:"chest",typemod:"defense",level:20,modifier:20,staticsheet:1,spriteName:"armors",offset:[1,5]},{id:105,name:"Leather Helmet 2",type:"helm",typemod:"defense",level:22,modifier:10,staticsheet:1,spriteName:"armors",offset:[1,4]},{id:106,name:"Leather Gloves 2",type:"gloves",typemod:"defense",level:24,modifier:10,staticsheet:1,spriteName:"armors",offset:[1,6]},{id:107,name:"Leather Boots 2",type:"boots",typemod:"defense",level:26,modifier:10,staticsheet:1,spriteName:"armors",offset:[1,7]},{id:108,name:"Leather Chest 3",type:"chest",typemod:"defense",level:30,modifier:30,staticsheet:1,spriteName:"armors",offset:[2,5]},{id:109,name:"Leather Helmet 3",type:"helm",typemod:"defense",level:32,modifier:15,staticsheet:1,spriteName:"armors",offset:[2,4]},{id:110,name:"Leather Gloves 3",type:"gloves",typemod:"defense",level:34,modifier:15,staticsheet:1,spriteName:"armors",offset:[2,6]},{id:111,name:"Leather Boots 3",type:"boots",typemod:"defense",level:36,modifier:15,staticsheet:1,spriteName:"armors",offset:[2,7]},{id:112,name:"Leather Chest 4",type:"chest",typemod:"defense",level:40,modifier:40,staticsheet:1,spriteName:"armors",offset:[3,5]},{id:113,name:"Leather Helmet 4",type:"helm",typemod:"defense",level:42,modifier:20,staticsheet:1,spriteName:"armors",offset:[3,4]},{id:114,name:"Leather Gloves 4",type:"gloves",typemod:"defense",level:44,modifier:20,staticsheet:1,spriteName:"armors",offset:[3,6]},{id:115,name:"Leather Boots 4",type:"boots",typemod:"defense",level:46,modifier:20,staticsheet:1,spriteName:"armors",offset:[3,7]},{id:200,name:"Sword 1",type:"sword",typemod:"attack",level:10,modifier:10,staticsheet:4,spriteName:"weapons",offset:[0,0]},{id:201,name:"Sword 2",type:"sword",typemod:"attack",level:20,modifier:20,staticsheet:4,spriteName:"weapons",offset:[1,0]},{id:202,name:"Sword 3",type:"sword",typemod:"attack",level:30,modifier:30,staticsheet:4,spriteName:"weapons",offset:[2,0]},{id:203,name:"Sword 4",type:"sword",typemod:"attack",level:40,modifier:40,staticsheet:4,spriteName:"weapons",offset:[3,0]},{id:204,name:"Sword 5",type:"sword",typemod:"attack",level:50,modifier:50,staticsheet:4,spriteName:"weapons",offset:[4,0]},{id:205,name:"Sword 6",type:"sword",typemod:"attack",level:60,modifier:60,staticsheet:4,spriteName:"weapons",offset:[5,0]},{id:206,name:"Sword 7",type:"sword",typemod:"attack",level:70,modifier:70,staticsheet:4,spriteName:"weapons",offset:[6,0]},{id:207,name:"Sword 8",type:"sword",typemod:"attack",level:80,modifier:80,staticsheet:4,spriteName:"weapons",offset:[7,0]},{id:208,name:"Sword 9",type:"sword",typemod:"attack",level:90,modifier:90,staticsheet:4,spriteName:"weapons",offset:[8,0]},{id:209,name:"Sword 10",type:"sword",typemod:"attack",level:100,modifier:100,staticsheet:4,spriteName:"weapons",offset:[9,0]},{id:210,name:"Bow 1",type:"bow",typemod:"attack",level:10,modifier:10,staticsheet:4,spriteName:"weapons",offset:[0,3]},{id:211,name:"Bow 2",type:"bow",typemod:"attack",level:20,modifier:20,staticsheet:4,spriteName:"weapons",offset:[1,3]},{id:212,name:"Bow 3",type:"bow",typemod:"attack",level:30,modifier:30,staticsheet:4,spriteName:"weapons",offset:[2,3]},{id:213,name:"Bow 4",type:"bow",typemod:"attack",level:40,modifier:40,staticsheet:4,spriteName:"weapons",offset:[3,3]},{id:214,name:"Bow 5",type:"bow",typemod:"attack",level:50,modifier:50,staticsheet:4,spriteName:"weapons",offset:[4,3]},{id:215,name:"Bow 6",type:"bow",typemod:"attack",level:60,modifier:60,staticsheet:4,spriteName:"weapons",offset:[5,3]},{id:216,name:"Bow 7",type:"bow",typemod:"attack",level:70,modifier:70,staticsheet:4,spriteName:"weapons",offset:[6,3]},{id:217,name:"Bow 8",type:"bow",typemod:"attack",level:80,modifier:80,staticsheet:4,spriteName:"weapons",offset:[7,3]},{id:218,name:"Bow 9",type:"bow",typemod:"attack",level:90,modifier:90,staticsheet:4,spriteName:"weapons",offset:[8,3]},{id:219,name:"Bow 10",type:"bow",typemod:"attack",level:100,modifier:100,staticsheet:4,spriteName:"weapons",offset:[9,3]},{id:220,name:"Hammer 1",type:"hammer",typemod:"attack",level:10,modifier:10,staticsheet:4,spriteName:"weapons",offset:[0,5]},{id:221,name:"Hammer 2",type:"hammer",typemod:"attack",level:20,modifier:20,staticsheet:4,spriteName:"weapons",offset:[1,5]},{id:222,name:"Hammer 3",type:"hammer",typemod:"attack",level:30,modifier:30,staticsheet:4,spriteName:"weapons",offset:[2,5]},{id:223,name:"Hammer 4",type:"hammer",typemod:"attack",level:40,modifier:40,staticsheet:4,spriteName:"weapons",offset:[3,5]},{id:224,name:"Hammer 5",type:"hammer",typemod:"attack",level:50,modifier:50,staticsheet:4,spriteName:"weapons",offset:[4,5]},{id:225,name:"Hammer 6",type:"hammer",typemod:"attack",level:60,modifier:60,staticsheet:4,spriteName:"weapons",offset:[5,5]},{id:226,name:"Hammer 7",type:"hammer",typemod:"attack",level:70,modifier:70,staticsheet:4,spriteName:"weapons",offset:[6,5]},{id:227,name:"Hammer 8",type:"hammer",typemod:"attack",level:80,modifier:80,staticsheet:4,spriteName:"weapons",offset:[7,5]},{id:228,name:"Hammer 9",type:"hammer",typemod:"attack",level:90,modifier:90,staticsheet:4,spriteName:"weapons",offset:[8,5]},{id:229,name:"Hammer 10",type:"hammer",typemod:"attack",level:100,modifier:100,staticsheet:4,spriteName:"weapons",offset:[9,5]},{id:230,name:"Axe 1",type:"axe",typemod:"attack",level:10,modifier:10,staticsheet:4,spriteName:"weapons",offset:[0,8]},{id:231,name:"Axe 2",type:"axe",typemod:"attack",level:20,modifier:20,staticsheet:4,spriteName:"weapons",offset:[1,8]},{id:232,name:"Axe 3",type:"axe",typemod:"attack",level:30,modifier:30,staticsheet:4,spriteName:"weapons",offset:[2,8]},{id:233,name:"Axe 4",type:"axe",typemod:"attack",level:40,modifier:40,staticsheet:4,spriteName:"weapons",offset:[3,8]},{id:234,name:"Axe 5",type:"axe",typemod:"attack",level:50,modifier:50,staticsheet:4,spriteName:"weapons",offset:[4,8]},{id:235,name:"Axe 6",type:"axe",typemod:"attack",level:60,modifier:60,staticsheet:4,spriteName:"weapons",offset:[5,8]},{id:236,name:"Axe 7",type:"axe",typemod:"attack",level:70,modifier:70,staticsheet:4,spriteName:"weapons",offset:[6,8]},{id:237,name:"Axe 8",type:"axe",typemod:"attack",level:80,modifier:80,staticsheet:4,spriteName:"weapons",offset:[7,8]},{id:238,name:"Axe 9",type:"axe",typemod:"attack",level:90,modifier:90,staticsheet:4,spriteName:"weapons",offset:[8,8]},{id:239,name:"Axe 10",type:"axe",typemod:"attack",level:100,modifier:100,staticsheet:4,spriteName:"weapons",offset:[9,8]},{id:300,name:"Stone",type:"craft",level:10,staticsheet:5,spriteName:"gather1",offset:[1,0]},{id:301,name:"Coal",type:"craft",level:20,staticsheet:8,spriteName:"nodeset2",offset:[1,0]},{id:302,name:"Light Iron",type:"craft",staticsheet:8,spriteName:"nodeset2",offset:[1,1]},{id:303,name:"Medium Iron",type:"craft",staticsheet:8,spriteName:"nodeset2",offset:[1,2]},{id:304,name:"Hard Iron",type:"craft",staticsheet:8,spriteName:"nodeset2",offset:[1,3]},{id:305,name:"Iron Ingot 1",type:"craft",staticsheet:8,spriteName:"nodeset2",offset:[2,1]},{id:306,name:"Iron Ingot 2",type:"craft",staticsheet:8,spriteName:"nodeset2",offset:[2,2]},{id:307,name:"Iron Ingot 3",type:"craft",staticsheet:8,spriteName:"nodeset2",offset:[2,3]},{id:310,name:"Leather 1",type:"craft",staticsheet:6,spriteName:"craft1",offset:[0,0]},{id:311,name:"Leather 2",type:"craft",staticsheet:6,spriteName:"craft1",offset:[1,0]},{id:312,name:"Leather 3",type:"craft",staticsheet:6,spriteName:"craft1",offset:[2,0]},{id:313,name:"Leather 4",type:"craft",staticsheet:6,spriteName:"craft1",offset:[3,0]},{id:320,name:"Wood",type:"craft",staticsheet:7,spriteName:"craft2",offset:[0,0]}]},{}],338:[function(e,t,i){t.exports={EN:{BANK_FULL:"Bank is full.",EQUIPMENT_FULL:"Equipment is full.",INVENTORY_FULL:"Inventory is full.",ITEM_ADDED:"{0} added",GOLD_ADDED:"{0} gold added",GOLD_ZERO:"0 gold",GOLD_REMOVED:"{0} gold removed",EQUIPMENT_LEVEL:"You need to be level {0} to equip this.",EQUIPMENT_WRONGCLASS:"Your class cannot use this Item.",CHAT_MUTED:"You are currently muted.",MAP_ENTERED:"{0} has entered the {1} map.",NOTICE_1:"Go to the Google Play Store and rate Retro RPG Online!",TRADE_REQUESTED:"You requested a trade with {0}.",TRADE_REQUEST:"{0} has requested to trade you.",TUTORIAL_MOVE:"Click or Tap on land to move.",TUTORIAL_ATTACK:"Now click or tap on a Monster to attack",TUTORIAL_ATTACK2:"Thats it now kill more Monsters.",TUTORIAL_EQUIP:"Now I want to equip my brought gear by going into Menu Backpack and selecting it.",TUTORIAL_SHOPBUY:"I should find the Beginner Store by going to the menu and pressing Town.",TUTORIAL_SHOPBUY2:"I want to buy my first Armor and Weapon that is Level 10.",TUTORIAL_STATS:"You can now assign custom Stats in Menu >> Character >> 3rd Page (Character Stats),",TUTORIAL_PORTAL:"In the Town House move to the blue Portal near the bottom left.",SHOP_REPAIRED:"{0} item repaired.",SHOP_REMOVED:"{0} item removed.",SHOP_SOLD:"{0} has been sold.",SHOP_BUY:"{0} has been bought.",SHOP_ENCHANTED:"{0} has been enchanted.",SHOP_NOGOLD:"You don't have enough Gold.",SHOP_NOGEMS:"You don't have enough Gems.",SHOP_NOSPACE:"There is not enough space in your inventory.",SHOP_MISMATCH:"The price has been changed, please try again.",AUCTION_ADDED:"The auction item you listed has been added.",SHOP_NOCRAFTITEMS:"You do not have enough craft Items.",SHOP_MISSINGITEMS:"You are missing {0} {1}'s",SHOP_UNLOCK_CONFIRM:"Do you want to unlock this appearance for {0} gems?",COMBAT_PLAYERKILLED:"/1 {0} killed {1} in combat.",COMBAT_TARGETINVINCIBLE:"Target is invincible.",GROUP_PLAYERLEFT:"{0} has left your group.",ATTACK_TOOFAR:"You are too far away to attack.",TUTORIAL:"TUTORIAL",TUTORIAL_1:"To Move, Mouse click on the Map or an Object, or use the WASD or arrow keys.",TUTORIAL_2:"To Attack, Mouse click on the Object or get in attack range and press Space bar.",TUTORIAL_3:"To Cycle Targets, use keys T to target the closest Object or Y to reverse target.",TUTORIAL_4:"You can use Keys 1-4 for Skill Shortcuts, and Keys 5-8 for consumables like Potions.",TUTORIAL_5:"If you need to buy items you can select Menu >> Town to instantly warp to Town.",TUTORIAL_6:"At level 10 you can equip Items in Menu >> Equipment, and at level 20 you can assign Stat Points.",ACHIEVEMENTS_0:"Kill {0} Monsters.",ACHIEVEMENTS_1:"Collect {0} Items.",ACHIEVEMENTS_2:"Do {0} Damage to Monsters.",ACHIEVEMENTS_3:"Mine {0} Nodes.",ACHIEVEMENTS_4:"Log {0} Trees.",ACHIEVEMENTS_5:"Interact with {0} Objects.",ACHIEVEMENTS_0_COMPLETE:"Achievement - Kill {0} Monsters Completed. {1}XP Added.",ACHIEVEMENTS_1_COMPLETE:"Achievement - Collect {0} Items Completed. {1}XP Added.",ACHIEVEMENTS_2_COMPLETE:"Achievement - Do {0} Damage to Monsters Completed. {1}XP Added.",ACHIEVEMENTS_3_COMPLETE:"Achievement - Mine {0} Nodes Completed. {1}XP Added.",ACHIEVEMENTS_4_COMPLETE:"Achievement - Log {0} Trees Completed. {1}XP Added.",ACHIEVEMENTS_5_COMPLETE:"Achievement - Interact with {0} Objects Completed. {1}XP Added.",PARTY_PLAYER_INVITE_SENT:"Party invite sent to player {0}",PARTY_MAX_PLAYERS:"Max players reached in party.",PARTY_PLAYER_JOINED:"{0} joined your party.",PARTY_PLAYER_ADDED:"You are now partied with {0}",PARTY_YOU_REJECTED_INVITE:"You rejected {0}'s invite.",PARTY_THEY_REJECTED_INVITE:"{0} rejected your invite.",PARTY_CANNOT_KICK:"You cannot kick as you are not in a party or leader.",PARTY_PLAYER_KICKED:"You have been kicked from the party.",PARTY_NOT_LEADER:"You cannot set the leader as you are not in a party.",PARTY_YOU_LEADER:"You are now the leader.",PARTY_PLAYER_LEADER:"{0} is now leader.",PARTY_IS_LEADER:"{0} is already leader.",PARTY_NOT_IN:"You cannot leave as you are not in a party.",PARTY_PLAYER_LEFT:"{0} has left your party.",PARTY_YOU_LEFT:"You have left {0}'s party.",PARTY_ALL_LEFT:"The party has been disbanded.",NO_PLAYER_EXIST:"Player {0} does not exist.",HARVEST_INVALID:"You cannot use this at this time.",HARVEST_ADDED:"{0} has been added to your inventory",HARVEST_WRONG_TYPE:"You need to have a {0}.",HARVET_NO_WEAPON:"You do not have a harvest item equipped."}}},{}],339:[function(e,t,i){t.exports={Rat:{name:"Rat",kind:1,attackMod:1,defenseMod:1,hpMod:1,xpMod:1,minLevel:1,maxLevel:3,aggroRange:0,attackRange:1,isAggressive:0,attackRateMod:1,reactionMod:1,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"rat",idleSpeedMod:1},Crab:{name:"Crab",kind:2,attackMod:1.2,defenseMod:1.2,hpMod:1,minLevel:4,maxLevel:6,aggroRange:5,attackRange:1,isAggressive:0,attackRateMod:1,reactionMod:1,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"crab",idleSpeedMod:1,modDamage:{hammer:1.2,axe:1,sword:1,bow:.8}},Skeleton:{name:"Skeleton",kind:3,attackMod:1.1,defenseMod:1.1,hpMod:1.2,minLevel:7,maxLevel:9,aggroRange:2,attackRange:1,isAggressive:1,attackRateMod:1.5,reactionMod:1.5,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"skeleton",idleSpeedMod:1,modDamage:{hammer:1.2,axe:1,sword:1,bow:.8}},Goblin:{name:"Goblin",kind:4,attackMod:1.2,defenseMod:.9,hpMod:.9,minLevel:10,maxLevel:12,aggroRange:3,attackRange:1,isAggressive:1,attackRateMod:1,reactionMod:1,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"goblin",idleSpeedMod:1},Snake:{name:"Snake",kind:5,attackMod:1.4,defenseMod:1,hpMod:.8,minLevel:13,maxLevel:15,aggroRange:3,attackRange:1,isAggressive:1,attackRateMod:1,reactionMod:1,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"snek",idleSpeedMod:1,modDamage:{axe:1.1,sword:1.1}},Bat:{name:"Bat",kind:6,attackMod:1.3,defenseMod:1,hpMod:1,minLevel:16,maxLevel:18,aggroRange:6,attackRange:1,isAggressive:1,attackRateMod:1,reactionMod:1,moveSpeedMod:1,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"bat",idleSpeedMod:1,modDamage:{hammer:.8,axe:.9,sword:.9,bow:1}},Skeleton2:{name:"HardSkeleton",kind:7,attackMod:1.3,defenseMod:1.3,hpMod:1.2,minLevel:19,maxLevel:21,aggroRange:2,attackRange:1,isAggressive:1,attackRateMod:2,reactionMod:2,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"skeleton2",idleSpeedMod:1},Ogre:{name:"Ogre",kind:8,attackMod:1.3,defenseMod:1.1,hpMod:1.3,minLevel:22,maxLevel:24,aggroRange:5,attackRange:1,isAggressive:1,attackRateMod:1,reactionMod:1,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"ogre",idleSpeedMod:1},Eye:{name:"Eye",kind:9,attackMod:1.4,defenseMod:1,hpMod:1,minLevel:25,maxLevel:29,aggroRange:3,attackRange:1,isAggressive:1,attackRateMod:1,reactionMod:1,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"eye",idleSpeedMod:1},Wizard:{name:"Wizard",kind:10,attackMod:1.4,defenseMod:1,hpMod:1,minLevel:30,maxLevel:34,aggroRange:6,attackRange:3,isAggressive:1,attackRateMod:1,reactionMod:1,moveSpeedMod:3,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"wizard",idleSpeedMod:1},Spectre:{name:"Spectre",kind:11,attackMod:1.3,defenseMod:1.3,hpMod:1,minLevel:35,maxLevel:40,aggroRange:2,attackRange:2,isAggressive:1,attackRateMod:2,reactionMod:.5,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"spectre",idleSpeedMod:1},DeathKnight:{name:"DeathKnight",kind:12,attackMod:1.5,defenseMod:1.5,hpMod:1.5,minLevel:41,maxLevel:50,aggroRange:4,attackRange:1,isAggressive:1,attackRateMod:2,reactionMod:.5,moveSpeedMod:2,respawnMod:1,dropRate:1,spawnChance:50,dropBonus:0,spriteName:"deathknight",idleSpeedMod:1}}},{}],340:[function(e,t,i){t.exports={plot:["You have awoken","You're awake","It's awake?","You will die this time","How could this happen?","Is that you?","It cant be..","But, but I thought you were dead..","This time you will not survive.","I will kill you for good.","None can survive me!","Curses youre alive still.","But, We destroyed you..","We killed your father and well kill you.","How can you be alive still?","Your brother gasped as he died.","Its, its you..","The chosen one, ha you will pay in blood"],battle:["Argh","Ugh","Oooh","Ahhh","MMmm","Eaat","Delicious","Die","Kill it","Kill","Destroy","Maimm","Death","Foood","Starving","Rawr","Roar","Yummy","Grrr","Growl"]}},{}],341:[function(e,t,i){t.exports=[{textid:"NOTICE1",interval:60}]},{}],342:[function(e,t,i){t.exports={0:{type:0,text:"Kill %count Monsters Level %level or more"},1:{type:2,text:"%names! Kill %count of em"},2:{type:2,text:"I am dying kill %count of %names"},3:{type:2,text:"%names have destroyed my home kill %count"},4:{type:2,text:"%names have swarmed us kill %count"},5:{type:2,text:"We've been overtaken by %names kill %count"},6:{type:2,text:"Kill %count %names for fun, there evil."},7:{type:1,text:"Get %count %name. Return them to Collect in town."},8:{type:4,text:"Find %name. We playing hide and seek!"}}},{}],343:[function(e,t,i){t.exports=["Aeris","Baelan","Caelum","Darian","Eldryn","Faelan","Gavriel","Haven","Ilys","Jaelin","Kaelan","Lirael","Maelis","Naelen","Ovryn","Peregrine","Quillen","Raelin","Sylas","Tyrian","Uvaine","Vaelis","Wylan","Xaelor","Yaelith","Zephyr","Aldryn","Briar","Cyran","Daelin","Elowen","Fenris","Gaelan","Harlow","Ivory","Jadis","Kieran","Loren","Myst","Nyssa"]},{}],344:[function(e,t,i){t.exports={0:["Alters","Altes","Amel","Amew","Ancin","Ancis","Andent","Anies","Arryn","Artin","Artip","Berny","Berter","Brancent","Brancis","Chames","Charles","Charliam","Drewis","Driffin","Drobert","Droguy","Edmugh","Edmund","Enryn","Ephed","Epher","Ephes","Eran","Ernam","Ethes","Ewis","Exam","Exard","Folke","Friffin","Gauwill","Gauwyn","Geoffrey","Georguy","Gerey","Gery","Gilas","Gilip","Grarder","Grobern","Gylip","Hames","Hamund","Hany","Harrey","Hony","Ilham","Ilhard","Illiam","Inghan","Jamath","Johny","Lasym","Lesym","Mesym","Munder","Narder","Nichye","Phughye","Raffin","Ralphye","Reder","Reward","Rewilh","Rewyn","Reyny","Richye","Robern","Robern","Roge","Roge","Ryany","Stephye","Stiny","Symas","Thamath","Vyncent","Vyncis","Waltin","Wilhye","Wyny"],1:["Abeth","Adon","Aebun","Aedad","Aelburg","Aengeth","Aenthrynn","Alhhild","Alyn","Anel","Argel","Auciet","Balde","Beatrey","Bely","Bily","Breawe","Brictlu","Briga","Brihta","Brione","Brithuia","Bruda","Bryne","Brytha","Burha","Cilia","Conga","Corna","Cyna","Deburg","Deleue","Ealhbun","Ealhburh","Ealket","Eanchild","Eanswild","Ebun","Ecin","Efrix","Elil","Elin","Ellet","Ellyn","Ellys","Elyn","Enen","Enet","Engard","Ennet","Ethen","Evet","Frowe","Frude","Fruna","Godga","Goldburg","Gythiue","Hely","Heve","Hily","Hone","Idgen","Isan","Izan","Joane","Kater","Kathon","Lizab","Lyse","Malia","Mara","Marey","Marget","Mary","Mery","Mildgiue","Olburh","Phone","Ricta","Ridget","Rithuia","Sabenn","Sane","Sarry","Sidwe","Stilda","Suse","Sybel","Tortga","Ware","Wellu","Wene","Wenga","Wilthroua","Wise","Witha","Withburh","Withiue","Wrtheahburg","Wuthe"]}},{}],345:[function(e,t,i){t.exports=[{uid:"default",index:0},{uid:"agent",name:"Auction",index:1},{uid:"ancientmanumentnpc",index:2},{uid:"angelnpc",index:3},{uid:"beachnpc",name:"Beachgoer",index:4},{uid:"bluebikinigirlnpc",index:5},{uid:"bluestoremannpc",name:"Bank",index:6},{uid:"boxingman",name:"Bank",index:7},{uid:"coder",name:"Looks",index:8},{uid:"desertnpc",name:"Repair",index:9},{uid:"doctor",name:"Looks",index:10},{uid:"elfnpc",index:11},{uid:"fairynpc",index:12},{uid:"firstsonangelnpc",index:13},{uid:"fisherman",index:14},{uid:"forestnpc",index:15},{uid:"guard",index:16},{uid:"iamverycoldnpc",index:17},{uid:"iceelfnpc",index:18},{uid:"king",index:19},{uid:"lavanpc",name:"Dying Man",index:20},{uid:"mermaidnpc",name:"Mermaid",index:21},{uid:"mojojojonpc",index:22},{uid:"momangelnpc",index:23},{uid:"nyan",index:24},{uid:"octocat",index:25},{uid:"octopus",index:26},{uid:"oddeyecat",index:27},{uid:"pirategirlnpc",index:28},{uid:"priest",index:29},{uid:"redbikinigirlnpc",index:30},{uid:"redstoremannpc",name:"Craft",index:31},{uid:"rick",name:"Collect",index:32},{uid:"scientist",index:33},{uid:"secondsonangelnpc",index:34},{uid:"shepherdboy",name:"Shop",index:35},{uid:"snowshepherdboy",name:"Beginner shop",index:36},{uid:"soldier",index:37},{uid:"sorcerer",index:38},{uid:"sponge",index:39},{uid:"superiorangelnpc",index:40},{uid:"vampire",index:41},{uid:"vendingmachine",name:"Enchant",index:42},{uid:"villagegirl",name:"Enchant",index:43},{uid:"villager",name:"Quests",index:44},{uid:"zombiegf",name:"Quests",index:45}]},{}],346:[function(e,t,i){t.exports={2e5:{npcKind:0,name:"Intro 1-1",type:1,level:0,object:{type:2,kind:1,count:5},gold:30,expMultiplier:2},200001:{npcKind:0,name:"Intro 1-2",type:1,level:0,object:{type:2,kind:1,count:10},gold:30},200100:{npcKind:1,name:"Intro 2",type:2,level:0,object:{type:2,kind:1,level:[0,5]},object2:{type:4,kind:1,count:3,chance:20}},200200:{npcKind:2,name:"Intro 3",type:2,level:0,object:{type:2,kind:1,level:[0,5]},object2:{type:4,kind:41,count:5,chance:20}},200300:{npcKind:3,name:"Intro 4",type:2,level:0,object:{type:2,kind:2,level:[3,5]},object2:{type:4,kind:43,count:1,chance:5}},200400:{npcKind:4,name:"Intro 5",type:1,level:0,object:{type:2,kind:2,count:10}},200500:{npcKind:5,name:"Intro 6",type:2,level:0,object:{type:2,kind:2,level:[5,6]},object2:{type:4,kind:31,count:5,chance:15}},200600:{npcKind:6,name:"Intro 7",type:5,level:0,data1:2,object:{type:10,kind:3,count:5}},200700:{npcKind:7,name:"Intro 8",type:1,level:0,object:{type:2,kind:3,count:10}},200800:{npcKind:8,name:"Intro 9",type:2,level:0,object:{type:2,kind:3,level:[7,11]},object2:{type:4,kind:93,count:5,chance:15}},200900:{npcKind:9,name:"Intro 10",type:5,level:0,data1:1,object:{type:10,kind:3,count:5}},201e3:{npcKind:10,name:"Intro 11",type:1,level:0,object:{type:2,kind:4,count:20},reward:[{itemKind:100}]}}},{}],347:[function(e,t,i){t.exports=[{name:"Beserker",skillType:"self",recharge:30,iconOffset:[1,7],detail:"Beserker [l] - Boosts your attack by 2xlevel for 10 seconds,",targetType:"self",duration:10,effects:[["self","start","attack",2],["self","end","attack",0]]},{name:"Explosive Attack",skillType:"attack",recharge:10,iconOffset:[3,12],detail:"Explosive Attack [l] - Area of Effect up to 50 damage per level",targetType:"enemy_aoe",countTotal:1,aoe:3,effects:[["self","start","damage",10],["self","end","damage",0]]},{name:"Deadly Attack",skillType:"attack",recharge:10,iconOffset:[4,7],detail:"Deadly Attack [l] - Does an attack of up to 250 damage per level.",targetType:"enemy",countTotal:1,effects:[["self","start","damage",50],["self","end","damage",0]]},{name:"Daze",skillType:"target",recharge:30,iconOffset:[0,12],detail:"Daze [l] - Dazes the target for [dpl]% seconds.",targetType:"enemy",durationPL:1,effects:[["target","start","freeze",1],["target","end","freeze",0]]},{name:"Shield",skillType:"self",recharge:30,iconOffset:[9,0],detail:"Shied [l] - Boosts your defense by 2xlevel for 10 seconds.",targetType:"self",duration:10,effects:[["self","start","defense",2],["self","end","defense",0]]},{name:"Bandaid",skillType:"self",recharge:30,iconOffset:[11,4],detail:"Bandaid [l] - Heals players 10hp per level per interval for 10 seconds.",targetType:"self",duration:10,effects:[["self","interval","hp",20],["self","end","hp",0]]},{name:"Healing",skillType:"self",recharge:30,iconOffset:[6,5],detail:"Healing [l] - Heals players 7.5% per level.",targetType:"self",duration:1,effects:[["self","start","hp",.075],["self","end","hp",0]]}]},{}],348:[function(e,t,i){var s;e=e("semver").satisfies(process.version,">=0.7.1")?e("fs"):e("path"),s=e.exists,e=e.existsSync,void 0!==i&&(t.exports.exists=s,t.exports.existsSync=e)},{fs:void 0,path:void 0,semver:240}],349:[function(e,t,s){EventType={KILLMOB:1,LOOTITEM:2,KILLPLAYER:3,DAMAGE:4,USE_NODE:5,HARVEST:6},QuestType={KILLMOBKIND:1,GETITEMKIND:2,KILLMOBS:3,HIDEANDSEEK:4,USENODE:5},QuestStatus={STARTED:0,INPROGRESS:1,COMPLETE:2},InventoryMode={MODE_NORMAL:0,MODE_SELL:1,MODE_REPAIR:2,MODE_ENCHANT:3,MODE_BANK:4,MODE_AUCTION:5},SkillEffects={SkillType:{SELF:0,TARGET:1,ATTACK:2},TargetType:{SELF:0,ENEMY:1,PLAYER_AOE:2,ENEMY_AOE:3},EffectStat:{HP:0,EP:1,ATTACK:2,DEFENSE:3,DAMAGE:4,FREEZE:5,MOVESPEED:6}};Types={UserMessages:{CU_CONNECT_USER:1,CU_CREATE_USER:2,CU_LOGIN_USER:3,CU_CREATE_PLAYER:4,CU_LOGIN_PLAYER:5,CU_REMOVE_USER:6,UC_WORLD_READY:101,UC_WORLDS:102,UC_VERSION:103,UC_PLAYER_SUM:104,UC_ERROR:105,WU_CONNECT_WORLD:501,WU_GAMESERVER_INFO:502,WU_PLAYER_LOADED:503,WU_SAVE_PLAYER_AUCTIONS:504,WU_SAVE_PLAYER_LOOKS:505,WU_SAVE_PLAYERS_LIST:506,WU_SAVE_PLAYER_DATA:507,WU_PLAYER_LOGGED_IN:508,WU_SAVE_USER_BANS:509,WU_ADD_PLAYER_GOLD:510,WU_UPDATE_PLAYER_COUNT:511,UW_LOAD_PLAYER_AUCTIONS:601,UW_LOAD_PLAYER_LOOKS:602,UW_WORLD_SAVE:603,UW_WORLD_CLOSE:604,UW_LOAD_PLAYER_DATA:605,UW_LOAD_USER_BANS:606},Messages:{BI_SYNCTIME:200,CW_LOGIN_PLAYER:201,CW_ITEMSLOT:202,CW_APPEARANCEUNLOCK:203,CW_ATTACK:204,CW_AUCTIONBUY:205,CW_AUCTIONDELETE:206,CW_AUCTIONOPEN:207,CW_AUCTIONSELL:208,CW_BANKRETRIEVE:209,CW_BANKSTORE:210,CW_CHAT:211,CW_COLOR_TINT:212,CW_BLOCK_MODIFY:213,CW_GOLD:214,CW_PARTY:215,CW_HARVEST:216,CW_USE_NODE:217,CW_LOOKUPDATE:218,CW_LOOT:219,CW_MOVE:220,CW_MOVEPATH:221,CW_QUEST:222,CW_STATADD:223,CW_STOREBUY:224,CW_STORE_MODITEM:225,CW_STORESELL:226,CW_TALKTONPC:227,CW_CRAFT:228,CW_TELEPORT_MAP:229,CW_WHO:230,CW_SKILL:231,CW_SHORTCUT:232,CW_REQUEST:233,WC_ERROR:300,WC_PLAYER:301,WC_ACHIEVEMENT:302,WC_AUCTIONOPEN:303,WC_ITEMSLOT:304,WC_CHANGEPOINTS:305,WC_CHAT:306,WC_COLOR_TINT:307,WC_DAMAGE:308,WC_DESPAWN:309,WC_APPEARANCE:311,WC_GOLD:312,WC_PARTY:313,WC_PLAYERINFO:314,WC_PLAYERINFO:337,WC_ITEMLEVELUP:315,WC_STAT:316,WC_LEVELUP:317,WC_LIST:318,WC_LOG:320,WC_HARVEST:321,WC_MOVE:322,WC_MOVEPATH:323,WC_NOTIFY:324,WC_QUEST:325,WC_SKILLEFFECTS:326,WC_SKILLLOAD:327,WC_SPAWN:328,WC_SPEECH:329,WC_STATINFO:330,WC_TELEPORT_MAP:331,WC_SKILL_XP:332,WC_DIALOGUE:333,WC_SET_SPRITE:334,WC_SET_ANIMATION:335,WC_BLOCK_MODIFY:336,WC_VERSION:338},Orientations:{NONE:0,UP:1,DOWN:2,LEFT:3,RIGHT:4},EntityTypes:{NONE:0,PLAYER:1,MOB:2,ITEM:3,ITEMLOOT:4,NPCSTATIC:5,NPCMOVE:6,CHEST:7,BLOCK:8,TRAP:9,NODE:10},Keys:{ENTER:13,UP:38,DOWN:40,LEFT:37,RIGHT:39,W:87,A:65,S:83,D:68,SPACE:32,I:73,H:72,M:77,P:80,T:84,Y:89,KEYPAD_4:100,KEYPAD_6:102,KEYPAD_8:104,KEYPAD_2:98,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57},Skills:{BLOODSUCKING:1,RECOVERHEALTH:2,HEALANDHEAL:3,AVOIDATTACK:4,ADDEXPERIENCE:5,ATTACKWITHBLOOD:6,CRITICALATTACK:7,CRITICALRATIO:8},PlayerClass:{FIGHTER:0,ARCHER:1,DEFENDER:2,MAGE:3},PlayerState:{Roaming:0,Moving:1,Following:2,Aggro:3,Hurting:4,GettingItems:5,FollowPlayer:6}};for(Types.expForLevel=[],Types.defenseExp=[],Types.attackExp=[],Types.moveExp=[],Types.skillExp=[],Types.weaponExp=[],Types.expForLevel[0]=0,Types.defenseExp[0]=0,Types.attackExp[0]=0,Types.moveExp[0]=0,Types.skillExp[0]=0,Types.weaponExp[0]=0,i=1;i<50;i++){var n=Math.floor(300*i*Math.pow(1.5,i/5));console.info("level_"+i+"="+n),Types.expForLevel[i]=n,Types.defenseExp[i]=10*n+50,Types.attackExp[i]=10*n+50,Types.moveExp[i]=5*n+20,Types.skillExp[i]=~~(n/1.5),Types.weaponExp[i]=10*n+50}Types.getLevel=function(e){if(void 0===e||0==e)return 1;for(var t=1;t<200;t++)if(e<Types.expForLevel[t])return t;return 50},Types.getAttackLevel=function(e){if(0==e)return 1;for(var t=1;t<200;t++)if(e<Types.attackExp[t])return t;return 50},Types.getDefenseLevel=function(e){if(0==e)return 1;for(var t=1;t<200;t++)if(e<Types.defenseExp[t])return t;return 50},Types.getMoveLevel=function(e){if(0==e)return 1;for(var t=1;t<200;t++)if(e<Types.moveExp[t])return t;return 50},Types.getWeaponLevel=function(e){if(0==e)return 1;for(var t=1;t<200;t++)if(e<Types.weaponExp[t])return t;return 50},Types.getSkillLevel=function(e,t){if(void 0===e||0==e)return 1;for(var i=t=t||1;i<10;i++)if(e<Types.skillExp[i])return i;return 20},Types.isPlayer=function(e){return 1===e||222===e},Types.getOrientationAsString=function(e){switch(e){case Types.Orientations.LEFT:return"left";case Types.Orientations.RIGHT:return"right";case Types.Orientations.UP:return"up";case Types.Orientations.DOWN:return"down"}},Types.getMessageTypeAsString=function(i){var s;return _.each(Types.Messages,function(e,t){e===i&&(s=t)}),s=s||"UNKNOWN"},void 0!==s&&(t.exports=Types)},{}],350:[function(e,t,s){var o={},r={};o.setKindData=function(e){r=e,o.KindData=e},o.getData=function(e){e=r[e];return e&&1!=e.legacy?e:null},o.getName=function(t){try{var e=r[t];return e?e.name:""}catch(e){console.error("No name found for item: "+r[t]),console.error("Error stack: "+e.stack)}},o.getWeaponLevel=function(t){try{var e=r[t];return e?e.modifier:0}catch(e){console.error("No level found for weapon: "+r[t]),console.error("Error stack: "+e.stack)}},o.getArmorLevel=function(t){try{var e=r[t];return e?e.modifier:0}catch(e){console.error("No level found for armor: "+r[t]),console.error("Error stack: "+e.stack)}},o.getItemByLevel=function(e,t){for(var i in r){i=r[i];if(("armor"==i.type||"armorarcher"==i.type)&&i.type==e&&t==i.modifier)return i;if(("weapon"==i.type||"weaponarcher"==i.type)&&i.type==e&&t==i.modifier)return i}return null},o.getLevelByKind=function(e){var t=r[e];return o.isArmor(e)||o.isWeapon(e)?t.level:null},o.getType=function(t){try{return r[t].type}catch(e){console.error("No type found for item: "+t),console.error("Error stack: "+e.stack)}},o.getBuyPrice=function(e){var t,i=r[e];return i?"bow"==(t=i.type)||"chest"==t?Math.floor(i.modifier*i.modifier*5):o.isArmor(e)?Math.floor(i.modifier*i.modifier*10):o.isWeapon(e)?Math.floor(i.modifier*i.modifier*5):"object"==t&&0<i.buy?1<i.buyCount?i.buy*i.buyCount:i.buy:0:0},o.getCraftPrice=function(e){var t=r[e];return t&&1!=t.legacy?0<t.buy?t.buy:~~(o.getBuyPrice(e)/4):0},o.getEnchantSellPrice=function(e){var t=o.getBuyPrice(e.itemKind)/10;return 1<e.itemNumber&&(t+=~~(o.getEnchantPrice(e)/10)),t*=e.itemDurabilityMax/900,Math.floor(t)},o.getEnchantPrice=function(e,t){if(!e)return NaN;var i=r[e.itemKind],t=(t=t||!1)?e.itemNumber:e.itemNumber+1;if(25<=t)return NaN;experience=e.itemExperience;e=i.modifier,console.info("getEnchantPrice: "+o.itemExpForLevel[t]),i=Math.floor(e*e*10*Math.pow(2,t)*(1-experience/o.itemExpForLevel[t]));return console.info("cost: "+i),i};for(o.getRepairPrice=function(e){var t=o.getBuyPrice(e.itemKind)/10;if(e.itemDurability==e.itemDurabilityMax)return 0;1<e.itemNumber&&(t=o.getEnchantPrice(e,!0)/10);var i,s,e=e.itemDurabilityMax/900*(1-e.itemDurability/e.itemDurabilityMax);return log.info("getRepairPrice - mp: "+e),1+~~(t*=(s=1,(e=e)<(i=0)?i:s<e?s:e))},o.isEquippable=function(e){return!!(o.isArmor(e)||o.isWeapon(e)||o.isArcherWeapon(e)||o.isClothes(e))},o.isClothes=function(e){e=r[e];return!!e&&("helm"===e.type||"chest"===e.type||"gloves"===e.type||"boots"===e.type)},o.isArmor=function(e){return!!r[e]&&o.isClothes(e)},o.isWeapon=function(e){return!!r[e]&&(o.isMeleeWeapon(e)||o.isArcherWeapon(e))},o.isEquipment=function(e){return!!r[e]&&(o.isWeapon(e)||o.isArmor(e))},o.getSpriteCode=function(e){var t=r[e];if(o.isArmor(e))return e;if(o.isWeapon(e)){e=t.type;if(!e)return 0;if("sword"==e)return 1;if("axe"==e)return 2;if("hammer"==e)return 12;if("bow"==e)return 50}return 0},o.getEquipmentSlot=function(e){return o.isWeapon(e)?4:(e=r[e])?"helm"===e.type?0:"chest"===e.type?1:"gloves"===e.type?2:"boots"===e.type?3:-1:-1},o.isMeleeWeapon=function(e){e=r[e];return!!e&&("sword"===e.type||"hammer"===e.type||"axe"===e.type)},o.isHarvestWeapon=function(e){e=r[e];return!!e&&("hammer"===e.type||"axe"===e.type)},o.isArcherWeapon=function(e){e=r[e];return!!e&&"bow"===e.type},o.isObject=function(e){e=r[e];return!!e&&"object"===e.type},o.isCraftItem=function(e){e=r[e];return!!e&&"craft"===e.type},o.isLootItem=function(e){return 1e3<=e&&e<2e3},o.isConsumableItem=function(e){e=r[e];return!!e&&"object"===e.type},o.isHealingItem=function(e){e=r[e];return!!e&&"object"===e.type&&("health"==e.typemod||"healthpercent"==e.typemod)},o.isItem=function(e){var t=o.KindData[e];return!!t&&(o.isArmor(e)||o.isWeapon(e)||"object"==t.type||"craft"==t.type)},o.isStackedItem=function(e){return!!r[e]&&(o.isCraftItem(e)||o.isLootItem(e)||o.isConsumableItem(e))},o.forEachKind=function(e){for(var t in kindData)e(r[t],t)},o.forEachArmorKind=function(i){Types.forEachKind(function(e,t){o.isArmor(e)&&i(e,t)})},o.forEachWeaponKind=function(i){Types.forEachKind(function(e,t){o.isWeapon(e)&&i(e,t)})},o.forEachArcherWeaponKind=function(i){Types.forEachKind(function(e,t){o.isArcherWeapon(e)&&i(e,t)})},o.getItemListBy=function(e,t,i){var s,n=[];for(s in r){var a=r[s];a&&1!=a.legacy&&(4!=e||o.isArmor(s)||o.isWeapon(s)||n.push({name:a.name,kind:s,type:a.type,buyCount:a.buycount,buyPrice:a.buy,craftPrice:o.getCraftPrice(s),itemKind:s,itemNumber:a.buycount,craft:a.craft}),1==e&&"object"==a.type&&0<a.buy?n.push({name:a.name,kind:s,type:a.type,buyCount:a.buycount,buyPrice:a.buy,craftPrice:o.getCraftPrice(s),itemKind:s,itemNumber:a.buycount,craft:a.craft}):(2==e&&o.isArmor(s)&&a.modifier>=t&&a.modifier<=i||3==e&&o.isWeapon(s)&&a.modifier>=t&&a.modifier<=i)&&n.push({name:a.name,kind:s,type:a.type,buyCount:a.buyCount,buyPrice:o.getBuyPrice(s),craftPrice:o.getCraftPrice(s),rank:a.level,itemKind:s,itemNumber:a.buycount,craft:a.craft}))}return 0<n.length&&0<n[0].rank&&n.sort(function(e,t){return e.rank-t.rank}),n},o.Store={isBuy:function(e){e=r[e];return!!e&&0<e.buy},isBuyMultiple:function(e){e=r[e];return!!e&&0<e.buycount},isSell:function(e){e=r[e];return!!e&&2<=e.buy},getBuyCount:function(e){e=r[e];return!!e&&(1<e.buyCount?e.buyCount:1)},getItems:function(e,t,i){return o.getItemListBy(e,t,i)}},o.itemExpForLevel=[],o.itemExpForLevel[0]=0,i=1;i<30;i++){var n=Math.floor(150*i*Math.pow(2,i/10));o.itemExpForLevel[i]=n}o.getItemLevel=function(e){if(0==e)return 1;for(var t=1,t=1;t<30;t++)if(e>o.itemExpForLevel[t-1]&&e<=o.itemExpForLevel[t])return t;return 30},void 0!==s&&(t.exports=o)},{}]},{},[45]);
